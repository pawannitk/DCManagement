{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ContourLayer } from 'deck.gl';\nimport React from 'react';\nimport { t } from '@superset-ui/core';\nimport { commonLayerProps } from '../common';\nimport sandboxedEval from '../../utils/sandbox';\nimport { createDeckGLComponent } from '../../factory';\nimport TooltipRow from '../../TooltipRow';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nfunction setTooltipContent(o) {var _o$object, _o$object$contour;\n  return ___EmotionJSX(\"div\", { className: \"deckgl-tooltip\" },\n  ___EmotionJSX(TooltipRow, { label: t('Centroid (Longitude and Latitude): '), value: `(${o == null ? void 0 : o.coordinate[0]}, ${o == null ? void 0 : o.coordinate[1]})` }),\n  ___EmotionJSX(TooltipRow, { label: t('Threshold: '), value: `${o == null ? void 0 : (_o$object = o.object) == null ? void 0 : (_o$object$contour = _o$object.contour) == null ? void 0 : _o$object$contour.threshold}` })\n  );\n}\nexport const getLayer = function (formData, payload, onAddFilter, setTooltip) {\n  const fd = formData;\n  const { aggregation = 'SUM', js_data_mutator: jsFnMutator, contours: rawContours, cellSize = '200' } = fd;\n  let data = payload.data.features;\n  const contours = rawContours == null ? void 0 : rawContours.map((contour) => {\n    const { lowerThreshold, upperThreshold, color, strokeWidth } = contour;\n    if (upperThreshold) {\n      // Isoband format\n      return {\n        threshold: [lowerThreshold, upperThreshold],\n        color: [color.r, color.g, color.b]\n      };\n    }\n    // Isoline format\n    return {\n      threshold: lowerThreshold,\n      color: [color.r, color.g, color.b],\n      strokeWidth\n    };\n  });\n  if (jsFnMutator) {\n    // Applying user defined data mutator if defined\n    const jsFnMutatorFunction = sandboxedEval(fd.js_data_mutator);\n    data = jsFnMutatorFunction(data);\n  }\n  return new ContourLayer({\n    id: `contourLayer-${fd.slice_id}`,\n    data,\n    contours,\n    cellSize: Number(cellSize || '200'),\n    aggregation: aggregation.toUpperCase(),\n    getPosition: (d) => d.position,\n    getWeight: (d) => d.weight || 0,\n    ...commonLayerProps(fd, setTooltip, setTooltipContent)\n  });\n};\nfunction getPoints(data) {\n  return data.map((d) => d.position);\n}const _default =\ncreateDeckGLComponent(getLayer, getPoints);export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(setTooltipContent, \"setTooltipContent\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/layers/Contour/Contour.tsx\");reactHotLoader.register(getLayer, \"getLayer\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/layers/Contour/Contour.tsx\");reactHotLoader.register(getPoints, \"getPoints\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/layers/Contour/Contour.tsx\");reactHotLoader.register(_default, \"default\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/layers/Contour/Contour.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["ContourLayer","React","t","commonLayerProps","sandboxedEval","createDeckGLComponent","TooltipRow","jsx","___EmotionJSX","setTooltipContent","o","_o$object","_o$object$contour","className","label","value","coordinate","object","contour","threshold","getLayer","formData","payload","onAddFilter","setTooltip","fd","aggregation","js_data_mutator","jsFnMutator","contours","rawContours","cellSize","data","features","map","lowerThreshold","upperThreshold","color","strokeWidth","r","g","b","jsFnMutatorFunction","id","slice_id","Number","toUpperCase","getPosition","d","position","getWeight","weight","getPoints","_default","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/layers/Contour/Contour.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ContourLayer } from 'deck.gl';\nimport React from 'react';\nimport { t } from '@superset-ui/core';\nimport { commonLayerProps } from '../common';\nimport sandboxedEval from '../../utils/sandbox';\nimport { createDeckGLComponent, getLayerType } from '../../factory';\nimport { ColorType } from '../../types';\nimport TooltipRow from '../../TooltipRow';\n\nfunction setTooltipContent(o: any) {\n  return (\n    <div className=\"deckgl-tooltip\">\n      <TooltipRow\n        label={t('Centroid (Longitude and Latitude): ')}\n        value={`(${o?.coordinate[0]}, ${o?.coordinate[1]})`}\n      />\n      <TooltipRow\n        label={t('Threshold: ')}\n        value={`${o?.object?.contour?.threshold}`}\n      />\n    </div>\n  );\n}\nexport const getLayer: getLayerType<unknown> = function (\n  formData,\n  payload,\n  onAddFilter,\n  setTooltip,\n) {\n  const fd = formData;\n  const {\n    aggregation = 'SUM',\n    js_data_mutator: jsFnMutator,\n    contours: rawContours,\n    cellSize = '200',\n  } = fd;\n  let data = payload.data.features;\n\n  const contours = rawContours?.map(\n    (contour: {\n      color: ColorType;\n      lowerThreshold: number;\n      upperThreshold?: number;\n      strokeWidth?: number;\n    }) => {\n      const { lowerThreshold, upperThreshold, color, strokeWidth } = contour;\n      if (upperThreshold) {\n        // Isoband format\n        return {\n          threshold: [lowerThreshold, upperThreshold],\n          color: [color.r, color.g, color.b],\n        };\n      }\n      // Isoline format\n      return {\n        threshold: lowerThreshold,\n        color: [color.r, color.g, color.b],\n        strokeWidth,\n      };\n    },\n  );\n\n  if (jsFnMutator) {\n    // Applying user defined data mutator if defined\n    const jsFnMutatorFunction = sandboxedEval(fd.js_data_mutator);\n    data = jsFnMutatorFunction(data);\n  }\n\n  return new ContourLayer({\n    id: `contourLayer-${fd.slice_id}`,\n    data,\n    contours,\n    cellSize: Number(cellSize || '200'),\n    aggregation: aggregation.toUpperCase(),\n    getPosition: (d: { position: number[]; weight: number }) => d.position,\n    getWeight: (d: { weight: number }) => d.weight || 0,\n    ...commonLayerProps(fd, setTooltip, setTooltipContent),\n  });\n};\n\nfunction getPoints(data: any[]) {\n  return data.map(d => d.position);\n}\n\nexport default createDeckGLComponent(getLayer, getPoints);\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}