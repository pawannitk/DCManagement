{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint no-use-before-define: [\"error\", { \"functions\": false }] */\n/* eslint-disable no-restricted-syntax */\n/* eslint-disable react/sort-prop-types */\nimport d3 from 'd3';\nimport PropTypes from 'prop-types';\nimport nv from 'nvd3-fork';\nimport {\n  getTimeFormatter,\n  getNumberFormatter,\n  CategoricalColorNamespace } from\n'@superset-ui/core';\n\nconst propTypes = {\n  // Data is an object hashed by numeric value, perhaps timestamp\n  data: PropTypes.objectOf(\n    PropTypes.arrayOf(\n      PropTypes.shape({\n        key: PropTypes.arrayOf(PropTypes.string),\n        name: PropTypes.arrayOf(PropTypes.string),\n        time: PropTypes.number,\n        value: PropTypes.number\n      })\n    )\n  ),\n  width: PropTypes.number,\n  height: PropTypes.number,\n  dateTimeFormat: PropTypes.string,\n  numberFormat: PropTypes.string,\n  useRichTooltip: PropTypes.bool,\n  useAreaProportions: PropTypes.bool\n};\n\nfunction copyArc(d) {\n  return {\n    startAngle: d.startAngle,\n    endAngle: d.endAngle,\n    innerRadius: d.innerRadius,\n    outerRadius: d.outerRadius\n  };\n}\n\nfunction sortValues(a, b) {\n  if (a.value === b.value) {\n    return a.name > b.name ? 1 : -1;\n  }\n\n  return b.value - a.value;\n}\n\nfunction Rose(element, props) {\n  const {\n    data,\n    width,\n    height,\n    colorScheme,\n    dateTimeFormat,\n    numberFormat,\n    useRichTooltip,\n    useAreaProportions,\n    sliceId\n  } = props;\n\n  const div = d3.select(element);\n  div.classed('superset-legacy-chart-rose', true);\n\n  const datum = data;\n  const times = Object.keys(datum).\n  map((t) => parseInt(t, 10)).\n  sort((a, b) => a - b);\n  const numGrains = times.length;\n  const numGroups = datum[times[0]].length;\n  const format = getNumberFormatter(numberFormat);\n  const timeFormat = getTimeFormatter(dateTimeFormat);\n  const colorFn = CategoricalColorNamespace.getScale(colorScheme);\n\n  d3.select('.nvtooltip').remove();\n  div.selectAll('*').remove();\n\n  const arc = d3.svg.arc();\n  const legend = nv.models.legend();\n  const tooltip = nv.models.tooltip();\n  const state = { disabled: datum[times[0]].map(() => false) };\n\n  const svg = div.append('svg').attr('width', width).attr('height', height);\n\n  const g = svg.append('g').attr('class', 'rose').append('g');\n\n  const legendWrap = g.append('g').attr('class', 'legendWrap');\n\n  function legendData(adatum) {\n    return adatum[times[0]].map((v, i) => ({\n      disabled: state.disabled[i],\n      key: v.name\n    }));\n  }\n\n  function tooltipData(d, i, adatum) {\n    const timeIndex = Math.floor(d.arcId / numGroups);\n    const series = useRichTooltip ?\n    adatum[times[timeIndex]].\n    filter((v) => !state.disabled[v.id % numGroups]).\n    map((v) => ({\n      key: v.name,\n      value: v.value,\n      color: colorFn(v.name, sliceId),\n      highlight: v.id === d.arcId\n    })) :\n    [{ key: d.name, value: d.val, color: colorFn(d.name, sliceId) }];\n\n    return {\n      key: 'Date',\n      value: d.time,\n      series\n    };\n  }\n\n  legend.width(width).color((d) => colorFn(d.key, sliceId));\n  legendWrap.datum(legendData(datum)).call(legend);\n\n  tooltip.headerFormatter(timeFormat).valueFormatter(format);\n  tooltip.classes('tooltip');\n\n  // Compute max radius, which the largest value will occupy\n  const roseHeight = height - legend.height();\n  const margin = { top: legend.height() };\n  const edgeMargin = 35; // space between outermost radius and slice edge\n  const maxRadius = Math.min(width, roseHeight) / 2 - edgeMargin;\n  const labelThreshold = 0.05;\n  const gro = 8; // mouseover radius growth in pixels\n  const mini = 0.075;\n\n  const centerTranslate = `translate(${width / 2},${\n  roseHeight / 2 + margin.top\n  })`;\n  const roseWrap = g.\n  append('g').\n  attr('transform', centerTranslate).\n  attr('class', 'roseWrap');\n\n  const labelsWrap = g.\n  append('g').\n  attr('transform', centerTranslate).\n  attr('class', 'labelsWrap');\n\n  const groupLabelsWrap = g.\n  append('g').\n  attr('transform', centerTranslate).\n  attr('class', 'groupLabelsWrap');\n\n  // Compute inner and outer angles for each data point\n  function computeArcStates(adatum) {\n    // Find the max sum of values across all time\n    let maxSum = 0;\n    let grain = 0;\n    const sums = [];\n    for (const t of times) {\n      const sum = datum[t].reduce(\n        (a, v, i) => a + (state.disabled[i] ? 0 : v.value),\n        0\n      );\n      maxSum = sum > maxSum ? sum : maxSum;\n      sums[grain] = sum;\n      grain += 1;\n    }\n\n    // Compute angle occupied by each time grain\n    const dtheta = Math.PI * 2 / numGrains;\n    const angles = [];\n    for (let i = 0; i <= numGrains; i += 1) {\n      angles.push(dtheta * i - Math.PI / 2);\n    }\n\n    // Compute proportion\n    const P = maxRadius / maxSum;\n    const Q = P * maxRadius;\n    const computeOuterRadius = (value, innerRadius) =>\n    useAreaProportions ?\n    Math.sqrt(Q * value + innerRadius * innerRadius) :\n    P * value + innerRadius;\n\n    const arcSt = {\n      data: [],\n      extend: {},\n      push: {},\n      pieStart: {},\n      pie: {},\n      pieOver: {},\n      mini: {},\n      labels: [],\n      groupLabels: []\n    };\n    let arcId = 0;\n    for (let i = 0; i < numGrains; i += 1) {\n      const t = times[i];\n      const startAngle = angles[i];\n      const endAngle = angles[i + 1];\n      const G = 2 * Math.PI / sums[i];\n      let innerRadius = 0;\n      let outerRadius;\n      let pieStartAngle = 0;\n      let pieEndAngle;\n      for (const v of adatum[t]) {\n        const val = state.disabled[arcId % numGroups] ? 0 : v.value;\n        const { name, time } = v;\n        v.id = arcId;\n        outerRadius = computeOuterRadius(val, innerRadius);\n        arcSt.data.push({\n          startAngle,\n          endAngle,\n          innerRadius,\n          outerRadius,\n          name,\n          arcId,\n          val,\n          time\n        });\n        arcSt.extend[arcId] = {\n          startAngle,\n          endAngle,\n          innerRadius,\n          name,\n          outerRadius: outerRadius + gro\n        };\n        arcSt.push[arcId] = {\n          startAngle,\n          endAngle,\n          innerRadius: innerRadius + gro,\n          outerRadius: outerRadius + gro\n        };\n        arcSt.pieStart[arcId] = {\n          startAngle,\n          endAngle,\n          innerRadius: mini * maxRadius,\n          outerRadius: maxRadius\n        };\n        arcSt.mini[arcId] = {\n          startAngle,\n          endAngle,\n          innerRadius: innerRadius * mini,\n          outerRadius: outerRadius * mini\n        };\n        arcId += 1;\n        innerRadius = outerRadius;\n      }\n      const labelArc = { ...arcSt.data[i * numGroups] };\n      labelArc.outerRadius = maxRadius + 20;\n      labelArc.innerRadius = maxRadius + 15;\n      arcSt.labels.push(labelArc);\n      for (const v of adatum[t].concat().sort(sortValues)) {\n        const val = state.disabled[v.id % numGroups] ? 0 : v.value;\n        pieEndAngle = G * val + pieStartAngle;\n        arcSt.pie[v.id] = {\n          startAngle: pieStartAngle,\n          endAngle: pieEndAngle,\n          innerRadius: maxRadius * mini,\n          outerRadius: maxRadius,\n          percent: v.value / sums[i]\n        };\n        arcSt.pieOver[v.id] = {\n          startAngle: pieStartAngle,\n          endAngle: pieEndAngle,\n          innerRadius: maxRadius * mini,\n          outerRadius: maxRadius + gro\n        };\n        pieStartAngle = pieEndAngle;\n      }\n    }\n    arcSt.groupLabels = arcSt.data.slice(0, numGroups);\n\n    return arcSt;\n  }\n\n  let arcSt = computeArcStates(datum);\n\n  function tween(target, resFunc) {\n    return function doTween(d) {\n      const interpolate = d3.interpolate(copyArc(d), copyArc(target));\n\n      return (t) => resFunc(Object.assign(d, interpolate(t)));\n    };\n  }\n\n  function arcTween(target) {\n    return tween(target, (d) => arc(d));\n  }\n\n  function translateTween(target) {\n    return tween(target, (d) => `translate(${arc.centroid(d)})`);\n  }\n\n  // Grab the ID range of segments stand between\n  // this segment and the edge of the circle\n  const segmentsToEdgeCache = {};\n  function getSegmentsToEdge(arcId) {\n    if (segmentsToEdgeCache[arcId]) {\n      return segmentsToEdgeCache[arcId];\n    }\n    const timeIndex = Math.floor(arcId / numGroups);\n    segmentsToEdgeCache[arcId] = [arcId + 1, numGroups * (timeIndex + 1) - 1];\n\n    return segmentsToEdgeCache[arcId];\n  }\n\n  // Get the IDs of all segments in a timeIndex\n  const segmentsInTimeCache = {};\n  function getSegmentsInTime(arcId) {\n    if (segmentsInTimeCache[arcId]) {\n      return segmentsInTimeCache[arcId];\n    }\n    const timeIndex = Math.floor(arcId / numGroups);\n    segmentsInTimeCache[arcId] = [\n    timeIndex * numGroups,\n    (timeIndex + 1) * numGroups - 1];\n\n\n    return segmentsInTimeCache[arcId];\n  }\n\n  let clickId = -1;\n  let inTransition = false;\n  const ae = roseWrap.\n  selectAll('g').\n  data(JSON.parse(JSON.stringify(arcSt.data))) // deep copy data state\n  .enter().\n  append('g').\n  attr('class', 'segment').\n  classed('clickable', true).\n  on('mouseover', mouseover).\n  on('mouseout', mouseout).\n  on('mousemove', mousemove).\n  on('click', click);\n\n  const labels = labelsWrap.\n  selectAll('g').\n  data(JSON.parse(JSON.stringify(arcSt.labels))).\n  enter().\n  append('g').\n  attr('class', 'roseLabel').\n  attr('transform', (d) => `translate(${arc.centroid(d)})`);\n\n  labels.\n  append('text').\n  style('text-anchor', 'middle').\n  style('fill', '#000').\n  text((d) => timeFormat(d.time));\n\n  const groupLabels = groupLabelsWrap.\n  selectAll('g').\n  data(JSON.parse(JSON.stringify(arcSt.groupLabels))).\n  enter().\n  append('g');\n\n  groupLabels.\n  style('opacity', 0).\n  attr('class', 'roseGroupLabels').\n  append('text').\n  style('text-anchor', 'middle').\n  style('fill', '#000').\n  text((d) => d.name);\n\n  const arcs = ae.\n  append('path').\n  attr('class', 'arc').\n  attr('fill', (d) => colorFn(d.name, sliceId)).\n  attr('d', arc);\n\n  function mousemove() {\n    tooltip();\n  }\n\n  function mouseover(b, i) {\n    tooltip.data(tooltipData(b, i, datum)).hidden(false);\n    const $this = d3.select(this);\n    $this.classed('hover', true);\n    if (clickId < 0 && !inTransition) {\n      $this.\n      select('path').\n      interrupt().\n      transition().\n      duration(180).\n      attrTween('d', arcTween(arcSt.extend[i]));\n      const edge = getSegmentsToEdge(i);\n      arcs.\n      filter((d) => edge[0] <= d.arcId && d.arcId <= edge[1]).\n      interrupt().\n      transition().\n      duration(180).\n      attrTween('d', (d) => arcTween(arcSt.push[d.arcId])(d));\n    } else if (!inTransition) {\n      const segments = getSegmentsInTime(clickId);\n      if (segments[0] <= b.arcId && b.arcId <= segments[1]) {\n        $this.\n        select('path').\n        interrupt().\n        transition().\n        duration(180).\n        attrTween('d', arcTween(arcSt.pieOver[i]));\n      }\n    }\n  }\n\n  function mouseout(b, i) {\n    tooltip.hidden(true);\n    const $this = d3.select(this);\n    $this.classed('hover', false);\n    if (clickId < 0 && !inTransition) {\n      $this.\n      select('path').\n      interrupt().\n      transition().\n      duration(180).\n      attrTween('d', arcTween(arcSt.data[i]));\n      const edge = getSegmentsToEdge(i);\n      arcs.\n      filter((d) => edge[0] <= d.arcId && d.arcId <= edge[1]).\n      interrupt().\n      transition().\n      duration(180).\n      attrTween('d', (d) => arcTween(arcSt.data[d.arcId])(d));\n    } else if (!inTransition) {\n      const segments = getSegmentsInTime(clickId);\n      if (segments[0] <= b.arcId && b.arcId <= segments[1]) {\n        $this.\n        select('path').\n        interrupt().\n        transition().\n        duration(180).\n        attrTween('d', arcTween(arcSt.pie[i]));\n      }\n    }\n  }\n\n  function click(b, i) {\n    if (inTransition) {\n      return;\n    }\n    const delay = d3.event.altKey ? 3750 : 375;\n    const segments = getSegmentsInTime(i);\n    if (clickId < 0) {\n      inTransition = true;\n      clickId = i;\n      labels.\n      interrupt().\n      transition().\n      duration(delay).\n      attrTween('transform', (d) =>\n      translateTween({\n        outerRadius: 0,\n        innerRadius: 0,\n        startAngle: d.startAngle,\n        endAngle: d.endAngle\n      })(d)\n      ).\n      style('opacity', 0);\n      groupLabels.\n      attr(\n        'transform',\n        `translate(${arc.centroid({\n          outerRadius: maxRadius + 20,\n          innerRadius: maxRadius + 15,\n          startAngle: arcSt.data[i].startAngle,\n          endAngle: arcSt.data[i].endAngle\n        })})`\n      ).\n      interrupt().\n      transition().\n      delay(delay).\n      duration(delay).\n      attrTween('transform', (d) =>\n      translateTween({\n        outerRadius: maxRadius + 20,\n        innerRadius: maxRadius + 15,\n        startAngle: arcSt.pie[segments[0] + d.arcId].startAngle,\n        endAngle: arcSt.pie[segments[0] + d.arcId].endAngle\n      })(d)\n      ).\n      style('opacity', (d) =>\n      state.disabled[d.arcId] ||\n      arcSt.pie[segments[0] + d.arcId].percent < labelThreshold ?\n      0 :\n      1\n      );\n      ae.classed(\n        'clickable',\n        (d) => segments[0] > d.arcId || d.arcId > segments[1]\n      );\n      arcs.\n      filter((d) => segments[0] <= d.arcId && d.arcId <= segments[1]).\n      interrupt().\n      transition().\n      duration(delay).\n      attrTween('d', (d) => arcTween(arcSt.pieStart[d.arcId])(d)).\n      transition().\n      duration(delay).\n      attrTween('d', (d) => arcTween(arcSt.pie[d.arcId])(d)).\n      each('end', () => {\n        inTransition = false;\n      });\n      arcs.\n      filter((d) => segments[0] > d.arcId || d.arcId > segments[1]).\n      interrupt().\n      transition().\n      duration(delay).\n      attrTween('d', (d) => arcTween(arcSt.mini[d.arcId])(d));\n    } else if (clickId < segments[0] || segments[1] < clickId) {\n      inTransition = true;\n      const clickSegments = getSegmentsInTime(clickId);\n      labels.\n      interrupt().\n      transition().\n      delay(delay).\n      duration(delay).\n      attrTween('transform', (d) =>\n      translateTween(arcSt.labels[d.arcId / numGroups])(d)\n      ).\n      style('opacity', 1);\n      groupLabels.\n      interrupt().\n      transition().\n      duration(delay).\n      attrTween(\n        'transform',\n        translateTween({\n          outerRadius: maxRadius + 20,\n          innerRadius: maxRadius + 15,\n          startAngle: arcSt.data[clickId].startAngle,\n          endAngle: arcSt.data[clickId].endAngle\n        })\n      ).\n      style('opacity', 0);\n      ae.classed('clickable', true);\n      arcs.\n      filter((d) => clickSegments[0] <= d.arcId && d.arcId <= clickSegments[1]).\n      interrupt().\n      transition().\n      duration(delay).\n      attrTween('d', (d) => arcTween(arcSt.pieStart[d.arcId])(d)).\n      transition().\n      duration(delay).\n      attrTween('d', (d) => arcTween(arcSt.data[d.arcId])(d)).\n      each('end', () => {\n        clickId = -1;\n        inTransition = false;\n      });\n      arcs.\n      filter((d) => clickSegments[0] > d.arcId || d.arcId > clickSegments[1]).\n      interrupt().\n      transition().\n      delay(delay).\n      duration(delay).\n      attrTween('d', (d) => arcTween(arcSt.data[d.arcId])(d));\n    }\n  }\n\n  function updateActive() {\n    const delay = d3.event.altKey ? 3000 : 300;\n    legendWrap.datum(legendData(datum)).call(legend);\n    const nArcSt = computeArcStates(datum);\n    inTransition = true;\n    if (clickId < 0) {\n      arcs.\n      style('opacity', 1).\n      interrupt().\n      transition().\n      duration(delay).\n      attrTween('d', (d) => arcTween(nArcSt.data[d.arcId])(d)).\n      each('end', () => {\n        inTransition = false;\n        arcSt = nArcSt;\n      }).\n      transition().\n      duration(0).\n      style('opacity', (d) => state.disabled[d.arcId % numGroups] ? 0 : 1);\n    } else {\n      const segments = getSegmentsInTime(clickId);\n      arcs.\n      style('opacity', 1).\n      interrupt().\n      transition().\n      duration(delay).\n      attrTween('d', (d) =>\n      segments[0] <= d.arcId && d.arcId <= segments[1] ?\n      arcTween(nArcSt.pie[d.arcId])(d) :\n      arcTween(nArcSt.mini[d.arcId])(d)\n      ).\n      each('end', () => {\n        inTransition = false;\n        arcSt = nArcSt;\n      }).\n      transition().\n      duration(0).\n      style('opacity', (d) => state.disabled[d.arcId % numGroups] ? 0 : 1);\n      groupLabels.\n      interrupt().\n      transition().\n      duration(delay).\n      attrTween('transform', (d) =>\n      translateTween({\n        outerRadius: maxRadius + 20,\n        innerRadius: maxRadius + 15,\n        startAngle: nArcSt.pie[segments[0] + d.arcId].startAngle,\n        endAngle: nArcSt.pie[segments[0] + d.arcId].endAngle\n      })(d)\n      ).\n      style('opacity', (d) =>\n      state.disabled[d.arcId] ||\n      arcSt.pie[segments[0] + d.arcId].percent < labelThreshold ?\n      0 :\n      1\n      );\n    }\n  }\n\n  legend.dispatch.on('stateChange', (newState) => {\n    if (state.disabled !== newState.disabled) {\n      state.disabled = newState.disabled;\n      updateActive();\n    }\n  });\n}\n\nRose.displayName = 'Rose';\nRose.propTypes = propTypes;const _default =\n\nRose;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(propTypes, \"propTypes\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-plugin-chart-rose/src/Rose.js\");reactHotLoader.register(copyArc, \"copyArc\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-plugin-chart-rose/src/Rose.js\");reactHotLoader.register(sortValues, \"sortValues\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-plugin-chart-rose/src/Rose.js\");reactHotLoader.register(Rose, \"Rose\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-plugin-chart-rose/src/Rose.js\");reactHotLoader.register(_default, \"default\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-plugin-chart-rose/src/Rose.js\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["d3","PropTypes","nv","getTimeFormatter","getNumberFormatter","CategoricalColorNamespace","propTypes","data","objectOf","arrayOf","shape","key","string","name","time","number","value","width","height","dateTimeFormat","numberFormat","useRichTooltip","bool","useAreaProportions","copyArc","d","startAngle","endAngle","innerRadius","outerRadius","sortValues","a","b","Rose","element","props","colorScheme","sliceId","div","select","classed","datum","times","Object","keys","map","t","parseInt","sort","numGrains","length","numGroups","format","timeFormat","colorFn","getScale","remove","selectAll","arc","svg","legend","models","tooltip","state","disabled","append","attr","g","legendWrap","legendData","adatum","v","i","tooltipData","timeIndex","Math","floor","arcId","series","filter","id","color","highlight","val","call","headerFormatter","valueFormatter","classes","roseHeight","margin","top","edgeMargin","maxRadius","min","labelThreshold","gro","mini","centerTranslate","roseWrap","labelsWrap","groupLabelsWrap","computeArcStates","maxSum","grain","sums","sum","reduce","dtheta","PI","angles","push","P","Q","computeOuterRadius","sqrt","arcSt","extend","pieStart","pie","pieOver","labels","groupLabels","G","pieStartAngle","pieEndAngle","labelArc","concat","percent","slice","tween","target","resFunc","doTween","interpolate","assign","arcTween","translateTween","centroid","segmentsToEdgeCache","getSegmentsToEdge","segmentsInTimeCache","getSegmentsInTime","clickId","inTransition","ae","JSON","parse","stringify","enter","on","mouseover","mouseout","mousemove","click","style","text","arcs","hidden","$this","interrupt","transition","duration","attrTween","edge","segments","delay","event","altKey","each","clickSegments","updateActive","nArcSt","dispatch","newState","displayName","_default","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-plugin-chart-rose/src/Rose.js"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint no-use-before-define: [\"error\", { \"functions\": false }] */\n/* eslint-disable no-restricted-syntax */\n/* eslint-disable react/sort-prop-types */\nimport d3 from 'd3';\nimport PropTypes from 'prop-types';\nimport nv from 'nvd3-fork';\nimport {\n  getTimeFormatter,\n  getNumberFormatter,\n  CategoricalColorNamespace,\n} from '@superset-ui/core';\n\nconst propTypes = {\n  // Data is an object hashed by numeric value, perhaps timestamp\n  data: PropTypes.objectOf(\n    PropTypes.arrayOf(\n      PropTypes.shape({\n        key: PropTypes.arrayOf(PropTypes.string),\n        name: PropTypes.arrayOf(PropTypes.string),\n        time: PropTypes.number,\n        value: PropTypes.number,\n      }),\n    ),\n  ),\n  width: PropTypes.number,\n  height: PropTypes.number,\n  dateTimeFormat: PropTypes.string,\n  numberFormat: PropTypes.string,\n  useRichTooltip: PropTypes.bool,\n  useAreaProportions: PropTypes.bool,\n};\n\nfunction copyArc(d) {\n  return {\n    startAngle: d.startAngle,\n    endAngle: d.endAngle,\n    innerRadius: d.innerRadius,\n    outerRadius: d.outerRadius,\n  };\n}\n\nfunction sortValues(a, b) {\n  if (a.value === b.value) {\n    return a.name > b.name ? 1 : -1;\n  }\n\n  return b.value - a.value;\n}\n\nfunction Rose(element, props) {\n  const {\n    data,\n    width,\n    height,\n    colorScheme,\n    dateTimeFormat,\n    numberFormat,\n    useRichTooltip,\n    useAreaProportions,\n    sliceId,\n  } = props;\n\n  const div = d3.select(element);\n  div.classed('superset-legacy-chart-rose', true);\n\n  const datum = data;\n  const times = Object.keys(datum)\n    .map(t => parseInt(t, 10))\n    .sort((a, b) => a - b);\n  const numGrains = times.length;\n  const numGroups = datum[times[0]].length;\n  const format = getNumberFormatter(numberFormat);\n  const timeFormat = getTimeFormatter(dateTimeFormat);\n  const colorFn = CategoricalColorNamespace.getScale(colorScheme);\n\n  d3.select('.nvtooltip').remove();\n  div.selectAll('*').remove();\n\n  const arc = d3.svg.arc();\n  const legend = nv.models.legend();\n  const tooltip = nv.models.tooltip();\n  const state = { disabled: datum[times[0]].map(() => false) };\n\n  const svg = div.append('svg').attr('width', width).attr('height', height);\n\n  const g = svg.append('g').attr('class', 'rose').append('g');\n\n  const legendWrap = g.append('g').attr('class', 'legendWrap');\n\n  function legendData(adatum) {\n    return adatum[times[0]].map((v, i) => ({\n      disabled: state.disabled[i],\n      key: v.name,\n    }));\n  }\n\n  function tooltipData(d, i, adatum) {\n    const timeIndex = Math.floor(d.arcId / numGroups);\n    const series = useRichTooltip\n      ? adatum[times[timeIndex]]\n          .filter(v => !state.disabled[v.id % numGroups])\n          .map(v => ({\n            key: v.name,\n            value: v.value,\n            color: colorFn(v.name, sliceId),\n            highlight: v.id === d.arcId,\n          }))\n      : [{ key: d.name, value: d.val, color: colorFn(d.name, sliceId) }];\n\n    return {\n      key: 'Date',\n      value: d.time,\n      series,\n    };\n  }\n\n  legend.width(width).color(d => colorFn(d.key, sliceId));\n  legendWrap.datum(legendData(datum)).call(legend);\n\n  tooltip.headerFormatter(timeFormat).valueFormatter(format);\n  tooltip.classes('tooltip');\n\n  // Compute max radius, which the largest value will occupy\n  const roseHeight = height - legend.height();\n  const margin = { top: legend.height() };\n  const edgeMargin = 35; // space between outermost radius and slice edge\n  const maxRadius = Math.min(width, roseHeight) / 2 - edgeMargin;\n  const labelThreshold = 0.05;\n  const gro = 8; // mouseover radius growth in pixels\n  const mini = 0.075;\n\n  const centerTranslate = `translate(${width / 2},${\n    roseHeight / 2 + margin.top\n  })`;\n  const roseWrap = g\n    .append('g')\n    .attr('transform', centerTranslate)\n    .attr('class', 'roseWrap');\n\n  const labelsWrap = g\n    .append('g')\n    .attr('transform', centerTranslate)\n    .attr('class', 'labelsWrap');\n\n  const groupLabelsWrap = g\n    .append('g')\n    .attr('transform', centerTranslate)\n    .attr('class', 'groupLabelsWrap');\n\n  // Compute inner and outer angles for each data point\n  function computeArcStates(adatum) {\n    // Find the max sum of values across all time\n    let maxSum = 0;\n    let grain = 0;\n    const sums = [];\n    for (const t of times) {\n      const sum = datum[t].reduce(\n        (a, v, i) => a + (state.disabled[i] ? 0 : v.value),\n        0,\n      );\n      maxSum = sum > maxSum ? sum : maxSum;\n      sums[grain] = sum;\n      grain += 1;\n    }\n\n    // Compute angle occupied by each time grain\n    const dtheta = (Math.PI * 2) / numGrains;\n    const angles = [];\n    for (let i = 0; i <= numGrains; i += 1) {\n      angles.push(dtheta * i - Math.PI / 2);\n    }\n\n    // Compute proportion\n    const P = maxRadius / maxSum;\n    const Q = P * maxRadius;\n    const computeOuterRadius = (value, innerRadius) =>\n      useAreaProportions\n        ? Math.sqrt(Q * value + innerRadius * innerRadius)\n        : P * value + innerRadius;\n\n    const arcSt = {\n      data: [],\n      extend: {},\n      push: {},\n      pieStart: {},\n      pie: {},\n      pieOver: {},\n      mini: {},\n      labels: [],\n      groupLabels: [],\n    };\n    let arcId = 0;\n    for (let i = 0; i < numGrains; i += 1) {\n      const t = times[i];\n      const startAngle = angles[i];\n      const endAngle = angles[i + 1];\n      const G = (2 * Math.PI) / sums[i];\n      let innerRadius = 0;\n      let outerRadius;\n      let pieStartAngle = 0;\n      let pieEndAngle;\n      for (const v of adatum[t]) {\n        const val = state.disabled[arcId % numGroups] ? 0 : v.value;\n        const { name, time } = v;\n        v.id = arcId;\n        outerRadius = computeOuterRadius(val, innerRadius);\n        arcSt.data.push({\n          startAngle,\n          endAngle,\n          innerRadius,\n          outerRadius,\n          name,\n          arcId,\n          val,\n          time,\n        });\n        arcSt.extend[arcId] = {\n          startAngle,\n          endAngle,\n          innerRadius,\n          name,\n          outerRadius: outerRadius + gro,\n        };\n        arcSt.push[arcId] = {\n          startAngle,\n          endAngle,\n          innerRadius: innerRadius + gro,\n          outerRadius: outerRadius + gro,\n        };\n        arcSt.pieStart[arcId] = {\n          startAngle,\n          endAngle,\n          innerRadius: mini * maxRadius,\n          outerRadius: maxRadius,\n        };\n        arcSt.mini[arcId] = {\n          startAngle,\n          endAngle,\n          innerRadius: innerRadius * mini,\n          outerRadius: outerRadius * mini,\n        };\n        arcId += 1;\n        innerRadius = outerRadius;\n      }\n      const labelArc = { ...arcSt.data[i * numGroups] };\n      labelArc.outerRadius = maxRadius + 20;\n      labelArc.innerRadius = maxRadius + 15;\n      arcSt.labels.push(labelArc);\n      for (const v of adatum[t].concat().sort(sortValues)) {\n        const val = state.disabled[v.id % numGroups] ? 0 : v.value;\n        pieEndAngle = G * val + pieStartAngle;\n        arcSt.pie[v.id] = {\n          startAngle: pieStartAngle,\n          endAngle: pieEndAngle,\n          innerRadius: maxRadius * mini,\n          outerRadius: maxRadius,\n          percent: v.value / sums[i],\n        };\n        arcSt.pieOver[v.id] = {\n          startAngle: pieStartAngle,\n          endAngle: pieEndAngle,\n          innerRadius: maxRadius * mini,\n          outerRadius: maxRadius + gro,\n        };\n        pieStartAngle = pieEndAngle;\n      }\n    }\n    arcSt.groupLabels = arcSt.data.slice(0, numGroups);\n\n    return arcSt;\n  }\n\n  let arcSt = computeArcStates(datum);\n\n  function tween(target, resFunc) {\n    return function doTween(d) {\n      const interpolate = d3.interpolate(copyArc(d), copyArc(target));\n\n      return t => resFunc(Object.assign(d, interpolate(t)));\n    };\n  }\n\n  function arcTween(target) {\n    return tween(target, d => arc(d));\n  }\n\n  function translateTween(target) {\n    return tween(target, d => `translate(${arc.centroid(d)})`);\n  }\n\n  // Grab the ID range of segments stand between\n  // this segment and the edge of the circle\n  const segmentsToEdgeCache = {};\n  function getSegmentsToEdge(arcId) {\n    if (segmentsToEdgeCache[arcId]) {\n      return segmentsToEdgeCache[arcId];\n    }\n    const timeIndex = Math.floor(arcId / numGroups);\n    segmentsToEdgeCache[arcId] = [arcId + 1, numGroups * (timeIndex + 1) - 1];\n\n    return segmentsToEdgeCache[arcId];\n  }\n\n  // Get the IDs of all segments in a timeIndex\n  const segmentsInTimeCache = {};\n  function getSegmentsInTime(arcId) {\n    if (segmentsInTimeCache[arcId]) {\n      return segmentsInTimeCache[arcId];\n    }\n    const timeIndex = Math.floor(arcId / numGroups);\n    segmentsInTimeCache[arcId] = [\n      timeIndex * numGroups,\n      (timeIndex + 1) * numGroups - 1,\n    ];\n\n    return segmentsInTimeCache[arcId];\n  }\n\n  let clickId = -1;\n  let inTransition = false;\n  const ae = roseWrap\n    .selectAll('g')\n    .data(JSON.parse(JSON.stringify(arcSt.data))) // deep copy data state\n    .enter()\n    .append('g')\n    .attr('class', 'segment')\n    .classed('clickable', true)\n    .on('mouseover', mouseover)\n    .on('mouseout', mouseout)\n    .on('mousemove', mousemove)\n    .on('click', click);\n\n  const labels = labelsWrap\n    .selectAll('g')\n    .data(JSON.parse(JSON.stringify(arcSt.labels)))\n    .enter()\n    .append('g')\n    .attr('class', 'roseLabel')\n    .attr('transform', d => `translate(${arc.centroid(d)})`);\n\n  labels\n    .append('text')\n    .style('text-anchor', 'middle')\n    .style('fill', '#000')\n    .text(d => timeFormat(d.time));\n\n  const groupLabels = groupLabelsWrap\n    .selectAll('g')\n    .data(JSON.parse(JSON.stringify(arcSt.groupLabels)))\n    .enter()\n    .append('g');\n\n  groupLabels\n    .style('opacity', 0)\n    .attr('class', 'roseGroupLabels')\n    .append('text')\n    .style('text-anchor', 'middle')\n    .style('fill', '#000')\n    .text(d => d.name);\n\n  const arcs = ae\n    .append('path')\n    .attr('class', 'arc')\n    .attr('fill', d => colorFn(d.name, sliceId))\n    .attr('d', arc);\n\n  function mousemove() {\n    tooltip();\n  }\n\n  function mouseover(b, i) {\n    tooltip.data(tooltipData(b, i, datum)).hidden(false);\n    const $this = d3.select(this);\n    $this.classed('hover', true);\n    if (clickId < 0 && !inTransition) {\n      $this\n        .select('path')\n        .interrupt()\n        .transition()\n        .duration(180)\n        .attrTween('d', arcTween(arcSt.extend[i]));\n      const edge = getSegmentsToEdge(i);\n      arcs\n        .filter(d => edge[0] <= d.arcId && d.arcId <= edge[1])\n        .interrupt()\n        .transition()\n        .duration(180)\n        .attrTween('d', d => arcTween(arcSt.push[d.arcId])(d));\n    } else if (!inTransition) {\n      const segments = getSegmentsInTime(clickId);\n      if (segments[0] <= b.arcId && b.arcId <= segments[1]) {\n        $this\n          .select('path')\n          .interrupt()\n          .transition()\n          .duration(180)\n          .attrTween('d', arcTween(arcSt.pieOver[i]));\n      }\n    }\n  }\n\n  function mouseout(b, i) {\n    tooltip.hidden(true);\n    const $this = d3.select(this);\n    $this.classed('hover', false);\n    if (clickId < 0 && !inTransition) {\n      $this\n        .select('path')\n        .interrupt()\n        .transition()\n        .duration(180)\n        .attrTween('d', arcTween(arcSt.data[i]));\n      const edge = getSegmentsToEdge(i);\n      arcs\n        .filter(d => edge[0] <= d.arcId && d.arcId <= edge[1])\n        .interrupt()\n        .transition()\n        .duration(180)\n        .attrTween('d', d => arcTween(arcSt.data[d.arcId])(d));\n    } else if (!inTransition) {\n      const segments = getSegmentsInTime(clickId);\n      if (segments[0] <= b.arcId && b.arcId <= segments[1]) {\n        $this\n          .select('path')\n          .interrupt()\n          .transition()\n          .duration(180)\n          .attrTween('d', arcTween(arcSt.pie[i]));\n      }\n    }\n  }\n\n  function click(b, i) {\n    if (inTransition) {\n      return;\n    }\n    const delay = d3.event.altKey ? 3750 : 375;\n    const segments = getSegmentsInTime(i);\n    if (clickId < 0) {\n      inTransition = true;\n      clickId = i;\n      labels\n        .interrupt()\n        .transition()\n        .duration(delay)\n        .attrTween('transform', d =>\n          translateTween({\n            outerRadius: 0,\n            innerRadius: 0,\n            startAngle: d.startAngle,\n            endAngle: d.endAngle,\n          })(d),\n        )\n        .style('opacity', 0);\n      groupLabels\n        .attr(\n          'transform',\n          `translate(${arc.centroid({\n            outerRadius: maxRadius + 20,\n            innerRadius: maxRadius + 15,\n            startAngle: arcSt.data[i].startAngle,\n            endAngle: arcSt.data[i].endAngle,\n          })})`,\n        )\n        .interrupt()\n        .transition()\n        .delay(delay)\n        .duration(delay)\n        .attrTween('transform', d =>\n          translateTween({\n            outerRadius: maxRadius + 20,\n            innerRadius: maxRadius + 15,\n            startAngle: arcSt.pie[segments[0] + d.arcId].startAngle,\n            endAngle: arcSt.pie[segments[0] + d.arcId].endAngle,\n          })(d),\n        )\n        .style('opacity', d =>\n          state.disabled[d.arcId] ||\n          arcSt.pie[segments[0] + d.arcId].percent < labelThreshold\n            ? 0\n            : 1,\n        );\n      ae.classed(\n        'clickable',\n        d => segments[0] > d.arcId || d.arcId > segments[1],\n      );\n      arcs\n        .filter(d => segments[0] <= d.arcId && d.arcId <= segments[1])\n        .interrupt()\n        .transition()\n        .duration(delay)\n        .attrTween('d', d => arcTween(arcSt.pieStart[d.arcId])(d))\n        .transition()\n        .duration(delay)\n        .attrTween('d', d => arcTween(arcSt.pie[d.arcId])(d))\n        .each('end', () => {\n          inTransition = false;\n        });\n      arcs\n        .filter(d => segments[0] > d.arcId || d.arcId > segments[1])\n        .interrupt()\n        .transition()\n        .duration(delay)\n        .attrTween('d', d => arcTween(arcSt.mini[d.arcId])(d));\n    } else if (clickId < segments[0] || segments[1] < clickId) {\n      inTransition = true;\n      const clickSegments = getSegmentsInTime(clickId);\n      labels\n        .interrupt()\n        .transition()\n        .delay(delay)\n        .duration(delay)\n        .attrTween('transform', d =>\n          translateTween(arcSt.labels[d.arcId / numGroups])(d),\n        )\n        .style('opacity', 1);\n      groupLabels\n        .interrupt()\n        .transition()\n        .duration(delay)\n        .attrTween(\n          'transform',\n          translateTween({\n            outerRadius: maxRadius + 20,\n            innerRadius: maxRadius + 15,\n            startAngle: arcSt.data[clickId].startAngle,\n            endAngle: arcSt.data[clickId].endAngle,\n          }),\n        )\n        .style('opacity', 0);\n      ae.classed('clickable', true);\n      arcs\n        .filter(d => clickSegments[0] <= d.arcId && d.arcId <= clickSegments[1])\n        .interrupt()\n        .transition()\n        .duration(delay)\n        .attrTween('d', d => arcTween(arcSt.pieStart[d.arcId])(d))\n        .transition()\n        .duration(delay)\n        .attrTween('d', d => arcTween(arcSt.data[d.arcId])(d))\n        .each('end', () => {\n          clickId = -1;\n          inTransition = false;\n        });\n      arcs\n        .filter(d => clickSegments[0] > d.arcId || d.arcId > clickSegments[1])\n        .interrupt()\n        .transition()\n        .delay(delay)\n        .duration(delay)\n        .attrTween('d', d => arcTween(arcSt.data[d.arcId])(d));\n    }\n  }\n\n  function updateActive() {\n    const delay = d3.event.altKey ? 3000 : 300;\n    legendWrap.datum(legendData(datum)).call(legend);\n    const nArcSt = computeArcStates(datum);\n    inTransition = true;\n    if (clickId < 0) {\n      arcs\n        .style('opacity', 1)\n        .interrupt()\n        .transition()\n        .duration(delay)\n        .attrTween('d', d => arcTween(nArcSt.data[d.arcId])(d))\n        .each('end', () => {\n          inTransition = false;\n          arcSt = nArcSt;\n        })\n        .transition()\n        .duration(0)\n        .style('opacity', d => (state.disabled[d.arcId % numGroups] ? 0 : 1));\n    } else {\n      const segments = getSegmentsInTime(clickId);\n      arcs\n        .style('opacity', 1)\n        .interrupt()\n        .transition()\n        .duration(delay)\n        .attrTween('d', d =>\n          segments[0] <= d.arcId && d.arcId <= segments[1]\n            ? arcTween(nArcSt.pie[d.arcId])(d)\n            : arcTween(nArcSt.mini[d.arcId])(d),\n        )\n        .each('end', () => {\n          inTransition = false;\n          arcSt = nArcSt;\n        })\n        .transition()\n        .duration(0)\n        .style('opacity', d => (state.disabled[d.arcId % numGroups] ? 0 : 1));\n      groupLabels\n        .interrupt()\n        .transition()\n        .duration(delay)\n        .attrTween('transform', d =>\n          translateTween({\n            outerRadius: maxRadius + 20,\n            innerRadius: maxRadius + 15,\n            startAngle: nArcSt.pie[segments[0] + d.arcId].startAngle,\n            endAngle: nArcSt.pie[segments[0] + d.arcId].endAngle,\n          })(d),\n        )\n        .style('opacity', d =>\n          state.disabled[d.arcId] ||\n          arcSt.pie[segments[0] + d.arcId].percent < labelThreshold\n            ? 0\n            : 1,\n        );\n    }\n  }\n\n  legend.dispatch.on('stateChange', newState => {\n    if (state.disabled !== newState.disabled) {\n      state.disabled = newState.disabled;\n      updateActive();\n    }\n  });\n}\n\nRose.displayName = 'Rose';\nRose.propTypes = propTypes;\n\nexport default Rose;\n"],"mappings":"wSAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAOA,EAAE,MAAM,IAAI;AACnB,OAAOC,SAAS,MAAM,YAAY;AAClC,OAAOC,EAAE,MAAM,WAAW;AAC1B;EACEC,gBAAgB;EAChBC,kBAAkB;EAClBC,yBAAyB;AACpB,mBAAmB;;AAE1B,MAAMC,SAAS,GAAG;EAChB;EACAC,IAAI,EAAEN,SAAS,CAACO,QAAQ;IACtBP,SAAS,CAACQ,OAAO;MACfR,SAAS,CAACS,KAAK,CAAC;QACdC,GAAG,EAAEV,SAAS,CAACQ,OAAO,CAACR,SAAS,CAACW,MAAM,CAAC;QACxCC,IAAI,EAAEZ,SAAS,CAACQ,OAAO,CAACR,SAAS,CAACW,MAAM,CAAC;QACzCE,IAAI,EAAEb,SAAS,CAACc,MAAM;QACtBC,KAAK,EAAEf,SAAS,CAACc;MACnB,CAAC;IACH;EACF,CAAC;EACDE,KAAK,EAAEhB,SAAS,CAACc,MAAM;EACvBG,MAAM,EAAEjB,SAAS,CAACc,MAAM;EACxBI,cAAc,EAAElB,SAAS,CAACW,MAAM;EAChCQ,YAAY,EAAEnB,SAAS,CAACW,MAAM;EAC9BS,cAAc,EAAEpB,SAAS,CAACqB,IAAI;EAC9BC,kBAAkB,EAAEtB,SAAS,CAACqB;AAChC,CAAC;;AAED,SAASE,OAAOA,CAACC,CAAC,EAAE;EAClB,OAAO;IACLC,UAAU,EAAED,CAAC,CAACC,UAAU;IACxBC,QAAQ,EAAEF,CAAC,CAACE,QAAQ;IACpBC,WAAW,EAAEH,CAAC,CAACG,WAAW;IAC1BC,WAAW,EAAEJ,CAAC,CAACI;EACjB,CAAC;AACH;;AAEA,SAASC,UAAUA,CAACC,CAAC,EAAEC,CAAC,EAAE;EACxB,IAAID,CAAC,CAACf,KAAK,KAAKgB,CAAC,CAAChB,KAAK,EAAE;IACvB,OAAOe,CAAC,CAAClB,IAAI,GAAGmB,CAAC,CAACnB,IAAI,GAAG,CAAC,GAAG,CAAC,CAAC;EACjC;;EAEA,OAAOmB,CAAC,CAAChB,KAAK,GAAGe,CAAC,CAACf,KAAK;AAC1B;;AAEA,SAASiB,IAAIA,CAACC,OAAO,EAAEC,KAAK,EAAE;EAC5B,MAAM;IACJ5B,IAAI;IACJU,KAAK;IACLC,MAAM;IACNkB,WAAW;IACXjB,cAAc;IACdC,YAAY;IACZC,cAAc;IACdE,kBAAkB;IAClBc;EACF,CAAC,GAAGF,KAAK;;EAET,MAAMG,GAAG,GAAGtC,EAAE,CAACuC,MAAM,CAACL,OAAO,CAAC;EAC9BI,GAAG,CAACE,OAAO,CAAC,4BAA4B,EAAE,IAAI,CAAC;;EAE/C,MAAMC,KAAK,GAAGlC,IAAI;EAClB,MAAMmC,KAAK,GAAGC,MAAM,CAACC,IAAI,CAACH,KAAK,CAAC;EAC7BI,GAAG,CAAC,CAAAC,CAAC,KAAIC,QAAQ,CAACD,CAAC,EAAE,EAAE,CAAC,CAAC;EACzBE,IAAI,CAAC,CAACjB,CAAC,EAAEC,CAAC,KAAKD,CAAC,GAAGC,CAAC,CAAC;EACxB,MAAMiB,SAAS,GAAGP,KAAK,CAACQ,MAAM;EAC9B,MAAMC,SAAS,GAAGV,KAAK,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC,CAACQ,MAAM;EACxC,MAAME,MAAM,GAAGhD,kBAAkB,CAACgB,YAAY,CAAC;EAC/C,MAAMiC,UAAU,GAAGlD,gBAAgB,CAACgB,cAAc,CAAC;EACnD,MAAMmC,OAAO,GAAGjD,yBAAyB,CAACkD,QAAQ,CAACnB,WAAW,CAAC;;EAE/DpC,EAAE,CAACuC,MAAM,CAAC,YAAY,CAAC,CAACiB,MAAM,CAAC,CAAC;EAChClB,GAAG,CAACmB,SAAS,CAAC,GAAG,CAAC,CAACD,MAAM,CAAC,CAAC;;EAE3B,MAAME,GAAG,GAAG1D,EAAE,CAAC2D,GAAG,CAACD,GAAG,CAAC,CAAC;EACxB,MAAME,MAAM,GAAG1D,EAAE,CAAC2D,MAAM,CAACD,MAAM,CAAC,CAAC;EACjC,MAAME,OAAO,GAAG5D,EAAE,CAAC2D,MAAM,CAACC,OAAO,CAAC,CAAC;EACnC,MAAMC,KAAK,GAAG,EAAEC,QAAQ,EAAEvB,KAAK,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC,CAACG,GAAG,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC;;EAE5D,MAAMc,GAAG,GAAGrB,GAAG,CAAC2B,MAAM,CAAC,KAAK,CAAC,CAACC,IAAI,CAAC,OAAO,EAAEjD,KAAK,CAAC,CAACiD,IAAI,CAAC,QAAQ,EAAEhD,MAAM,CAAC;;EAEzE,MAAMiD,CAAC,GAAGR,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,CAACD,MAAM,CAAC,GAAG,CAAC;;EAE3D,MAAMG,UAAU,GAAGD,CAAC,CAACF,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,OAAO,EAAE,YAAY,CAAC;;EAE5D,SAASG,UAAUA,CAACC,MAAM,EAAE;IAC1B,OAAOA,MAAM,CAAC5B,KAAK,CAAC,CAAC,CAAC,CAAC,CAACG,GAAG,CAAC,CAAC0B,CAAC,EAAEC,CAAC,MAAM;MACrCR,QAAQ,EAAED,KAAK,CAACC,QAAQ,CAACQ,CAAC,CAAC;MAC3B7D,GAAG,EAAE4D,CAAC,CAAC1D;IACT,CAAC,CAAC,CAAC;EACL;;EAEA,SAAS4D,WAAWA,CAAChD,CAAC,EAAE+C,CAAC,EAAEF,MAAM,EAAE;IACjC,MAAMI,SAAS,GAAGC,IAAI,CAACC,KAAK,CAACnD,CAAC,CAACoD,KAAK,GAAG1B,SAAS,CAAC;IACjD,MAAM2B,MAAM,GAAGzD,cAAc;IACzBiD,MAAM,CAAC5B,KAAK,CAACgC,SAAS,CAAC,CAAC;IACrBK,MAAM,CAAC,CAAAR,CAAC,KAAI,CAACR,KAAK,CAACC,QAAQ,CAACO,CAAC,CAACS,EAAE,GAAG7B,SAAS,CAAC,CAAC;IAC9CN,GAAG,CAAC,CAAA0B,CAAC,MAAK;MACT5D,GAAG,EAAE4D,CAAC,CAAC1D,IAAI;MACXG,KAAK,EAAEuD,CAAC,CAACvD,KAAK;MACdiE,KAAK,EAAE3B,OAAO,CAACiB,CAAC,CAAC1D,IAAI,EAAEwB,OAAO,CAAC;MAC/B6C,SAAS,EAAEX,CAAC,CAACS,EAAE,KAAKvD,CAAC,CAACoD;IACxB,CAAC,CAAC,CAAC;IACL,CAAC,EAAElE,GAAG,EAAEc,CAAC,CAACZ,IAAI,EAAEG,KAAK,EAAES,CAAC,CAAC0D,GAAG,EAAEF,KAAK,EAAE3B,OAAO,CAAC7B,CAAC,CAACZ,IAAI,EAAEwB,OAAO,CAAC,CAAC,CAAC,CAAC;;IAEpE,OAAO;MACL1B,GAAG,EAAE,MAAM;MACXK,KAAK,EAAES,CAAC,CAACX,IAAI;MACbgE;IACF,CAAC;EACH;;EAEAlB,MAAM,CAAC3C,KAAK,CAACA,KAAK,CAAC,CAACgE,KAAK,CAAC,CAAAxD,CAAC,KAAI6B,OAAO,CAAC7B,CAAC,CAACd,GAAG,EAAE0B,OAAO,CAAC,CAAC;EACvD+B,UAAU,CAAC3B,KAAK,CAAC4B,UAAU,CAAC5B,KAAK,CAAC,CAAC,CAAC2C,IAAI,CAACxB,MAAM,CAAC;;EAEhDE,OAAO,CAACuB,eAAe,CAAChC,UAAU,CAAC,CAACiC,cAAc,CAAClC,MAAM,CAAC;EAC1DU,OAAO,CAACyB,OAAO,CAAC,SAAS,CAAC;;EAE1B;EACA,MAAMC,UAAU,GAAGtE,MAAM,GAAG0C,MAAM,CAAC1C,MAAM,CAAC,CAAC;EAC3C,MAAMuE,MAAM,GAAG,EAAEC,GAAG,EAAE9B,MAAM,CAAC1C,MAAM,CAAC,CAAC,CAAC,CAAC;EACvC,MAAMyE,UAAU,GAAG,EAAE,CAAC,CAAC;EACvB,MAAMC,SAAS,GAAGjB,IAAI,CAACkB,GAAG,CAAC5E,KAAK,EAAEuE,UAAU,CAAC,GAAG,CAAC,GAAGG,UAAU;EAC9D,MAAMG,cAAc,GAAG,IAAI;EAC3B,MAAMC,GAAG,GAAG,CAAC,CAAC,CAAC;EACf,MAAMC,IAAI,GAAG,KAAK;;EAElB,MAAMC,eAAe,GAAI,aAAYhF,KAAK,GAAG,CAAE;EAC7CuE,UAAU,GAAG,CAAC,GAAGC,MAAM,CAACC;EACzB,GAAE;EACH,MAAMQ,QAAQ,GAAG/B,CAAC;EACfF,MAAM,CAAC,GAAG,CAAC;EACXC,IAAI,CAAC,WAAW,EAAE+B,eAAe,CAAC;EAClC/B,IAAI,CAAC,OAAO,EAAE,UAAU,CAAC;;EAE5B,MAAMiC,UAAU,GAAGhC,CAAC;EACjBF,MAAM,CAAC,GAAG,CAAC;EACXC,IAAI,CAAC,WAAW,EAAE+B,eAAe,CAAC;EAClC/B,IAAI,CAAC,OAAO,EAAE,YAAY,CAAC;;EAE9B,MAAMkC,eAAe,GAAGjC,CAAC;EACtBF,MAAM,CAAC,GAAG,CAAC;EACXC,IAAI,CAAC,WAAW,EAAE+B,eAAe,CAAC;EAClC/B,IAAI,CAAC,OAAO,EAAE,iBAAiB,CAAC;;EAEnC;EACA,SAASmC,gBAAgBA,CAAC/B,MAAM,EAAE;IAChC;IACA,IAAIgC,MAAM,GAAG,CAAC;IACd,IAAIC,KAAK,GAAG,CAAC;IACb,MAAMC,IAAI,GAAG,EAAE;IACf,KAAK,MAAM1D,CAAC,IAAIJ,KAAK,EAAE;MACrB,MAAM+D,GAAG,GAAGhE,KAAK,CAACK,CAAC,CAAC,CAAC4D,MAAM;QACzB,CAAC3E,CAAC,EAAEwC,CAAC,EAAEC,CAAC,KAAKzC,CAAC,IAAIgC,KAAK,CAACC,QAAQ,CAACQ,CAAC,CAAC,GAAG,CAAC,GAAGD,CAAC,CAACvD,KAAK,CAAC;QAClD;MACF,CAAC;MACDsF,MAAM,GAAGG,GAAG,GAAGH,MAAM,GAAGG,GAAG,GAAGH,MAAM;MACpCE,IAAI,CAACD,KAAK,CAAC,GAAGE,GAAG;MACjBF,KAAK,IAAI,CAAC;IACZ;;IAEA;IACA,MAAMI,MAAM,GAAIhC,IAAI,CAACiC,EAAE,GAAG,CAAC,GAAI3D,SAAS;IACxC,MAAM4D,MAAM,GAAG,EAAE;IACjB,KAAK,IAAIrC,CAAC,GAAG,CAAC,EAAEA,CAAC,IAAIvB,SAAS,EAAEuB,CAAC,IAAI,CAAC,EAAE;MACtCqC,MAAM,CAACC,IAAI,CAACH,MAAM,GAAGnC,CAAC,GAAGG,IAAI,CAACiC,EAAE,GAAG,CAAC,CAAC;IACvC;;IAEA;IACA,MAAMG,CAAC,GAAGnB,SAAS,GAAGU,MAAM;IAC5B,MAAMU,CAAC,GAAGD,CAAC,GAAGnB,SAAS;IACvB,MAAMqB,kBAAkB,GAAGA,CAACjG,KAAK,EAAEY,WAAW;IAC5CL,kBAAkB;IACdoD,IAAI,CAACuC,IAAI,CAACF,CAAC,GAAGhG,KAAK,GAAGY,WAAW,GAAGA,WAAW,CAAC;IAChDmF,CAAC,GAAG/F,KAAK,GAAGY,WAAW;;IAE7B,MAAMuF,KAAK,GAAG;MACZ5G,IAAI,EAAE,EAAE;MACR6G,MAAM,EAAE,CAAC,CAAC;MACVN,IAAI,EAAE,CAAC,CAAC;MACRO,QAAQ,EAAE,CAAC,CAAC;MACZC,GAAG,EAAE,CAAC,CAAC;MACPC,OAAO,EAAE,CAAC,CAAC;MACXvB,IAAI,EAAE,CAAC,CAAC;MACRwB,MAAM,EAAE,EAAE;MACVC,WAAW,EAAE;IACf,CAAC;IACD,IAAI5C,KAAK,GAAG,CAAC;IACb,KAAK,IAAIL,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGvB,SAAS,EAAEuB,CAAC,IAAI,CAAC,EAAE;MACrC,MAAM1B,CAAC,GAAGJ,KAAK,CAAC8B,CAAC,CAAC;MAClB,MAAM9C,UAAU,GAAGmF,MAAM,CAACrC,CAAC,CAAC;MAC5B,MAAM7C,QAAQ,GAAGkF,MAAM,CAACrC,CAAC,GAAG,CAAC,CAAC;MAC9B,MAAMkD,CAAC,GAAI,CAAC,GAAG/C,IAAI,CAACiC,EAAE,GAAIJ,IAAI,CAAChC,CAAC,CAAC;MACjC,IAAI5C,WAAW,GAAG,CAAC;MACnB,IAAIC,WAAW;MACf,IAAI8F,aAAa,GAAG,CAAC;MACrB,IAAIC,WAAW;MACf,KAAK,MAAMrD,CAAC,IAAID,MAAM,CAACxB,CAAC,CAAC,EAAE;QACzB,MAAMqC,GAAG,GAAGpB,KAAK,CAACC,QAAQ,CAACa,KAAK,GAAG1B,SAAS,CAAC,GAAG,CAAC,GAAGoB,CAAC,CAACvD,KAAK;QAC3D,MAAM,EAAEH,IAAI,EAAEC,IAAI,CAAC,CAAC,GAAGyD,CAAC;QACxBA,CAAC,CAACS,EAAE,GAAGH,KAAK;QACZhD,WAAW,GAAGoF,kBAAkB,CAAC9B,GAAG,EAAEvD,WAAW,CAAC;QAClDuF,KAAK,CAAC5G,IAAI,CAACuG,IAAI,CAAC;UACdpF,UAAU;UACVC,QAAQ;UACRC,WAAW;UACXC,WAAW;UACXhB,IAAI;UACJgE,KAAK;UACLM,GAAG;UACHrE;QACF,CAAC,CAAC;QACFqG,KAAK,CAACC,MAAM,CAACvC,KAAK,CAAC,GAAG;UACpBnD,UAAU;UACVC,QAAQ;UACRC,WAAW;UACXf,IAAI;UACJgB,WAAW,EAAEA,WAAW,GAAGkE;QAC7B,CAAC;QACDoB,KAAK,CAACL,IAAI,CAACjC,KAAK,CAAC,GAAG;UAClBnD,UAAU;UACVC,QAAQ;UACRC,WAAW,EAAEA,WAAW,GAAGmE,GAAG;UAC9BlE,WAAW,EAAEA,WAAW,GAAGkE;QAC7B,CAAC;QACDoB,KAAK,CAACE,QAAQ,CAACxC,KAAK,CAAC,GAAG;UACtBnD,UAAU;UACVC,QAAQ;UACRC,WAAW,EAAEoE,IAAI,GAAGJ,SAAS;UAC7B/D,WAAW,EAAE+D;QACf,CAAC;QACDuB,KAAK,CAACnB,IAAI,CAACnB,KAAK,CAAC,GAAG;UAClBnD,UAAU;UACVC,QAAQ;UACRC,WAAW,EAAEA,WAAW,GAAGoE,IAAI;UAC/BnE,WAAW,EAAEA,WAAW,GAAGmE;QAC7B,CAAC;QACDnB,KAAK,IAAI,CAAC;QACVjD,WAAW,GAAGC,WAAW;MAC3B;MACA,MAAMgG,QAAQ,GAAG,EAAE,GAAGV,KAAK,CAAC5G,IAAI,CAACiE,CAAC,GAAGrB,SAAS,CAAC,CAAC,CAAC;MACjD0E,QAAQ,CAAChG,WAAW,GAAG+D,SAAS,GAAG,EAAE;MACrCiC,QAAQ,CAACjG,WAAW,GAAGgE,SAAS,GAAG,EAAE;MACrCuB,KAAK,CAACK,MAAM,CAACV,IAAI,CAACe,QAAQ,CAAC;MAC3B,KAAK,MAAMtD,CAAC,IAAID,MAAM,CAACxB,CAAC,CAAC,CAACgF,MAAM,CAAC,CAAC,CAAC9E,IAAI,CAAClB,UAAU,CAAC,EAAE;QACnD,MAAMqD,GAAG,GAAGpB,KAAK,CAACC,QAAQ,CAACO,CAAC,CAACS,EAAE,GAAG7B,SAAS,CAAC,GAAG,CAAC,GAAGoB,CAAC,CAACvD,KAAK;QAC1D4G,WAAW,GAAGF,CAAC,GAAGvC,GAAG,GAAGwC,aAAa;QACrCR,KAAK,CAACG,GAAG,CAAC/C,CAAC,CAACS,EAAE,CAAC,GAAG;UAChBtD,UAAU,EAAEiG,aAAa;UACzBhG,QAAQ,EAAEiG,WAAW;UACrBhG,WAAW,EAAEgE,SAAS,GAAGI,IAAI;UAC7BnE,WAAW,EAAE+D,SAAS;UACtBmC,OAAO,EAAExD,CAAC,CAACvD,KAAK,GAAGwF,IAAI,CAAChC,CAAC;QAC3B,CAAC;QACD2C,KAAK,CAACI,OAAO,CAAChD,CAAC,CAACS,EAAE,CAAC,GAAG;UACpBtD,UAAU,EAAEiG,aAAa;UACzBhG,QAAQ,EAAEiG,WAAW;UACrBhG,WAAW,EAAEgE,SAAS,GAAGI,IAAI;UAC7BnE,WAAW,EAAE+D,SAAS,GAAGG;QAC3B,CAAC;QACD4B,aAAa,GAAGC,WAAW;MAC7B;IACF;IACAT,KAAK,CAACM,WAAW,GAAGN,KAAK,CAAC5G,IAAI,CAACyH,KAAK,CAAC,CAAC,EAAE7E,SAAS,CAAC;;IAElD,OAAOgE,KAAK;EACd;;EAEA,IAAIA,KAAK,GAAGd,gBAAgB,CAAC5D,KAAK,CAAC;;EAEnC,SAASwF,KAAKA,CAACC,MAAM,EAAEC,OAAO,EAAE;IAC9B,OAAO,SAASC,OAAOA,CAAC3G,CAAC,EAAE;MACzB,MAAM4G,WAAW,GAAGrI,EAAE,CAACqI,WAAW,CAAC7G,OAAO,CAACC,CAAC,CAAC,EAAED,OAAO,CAAC0G,MAAM,CAAC,CAAC;;MAE/D,OAAO,CAAApF,CAAC,KAAIqF,OAAO,CAACxF,MAAM,CAAC2F,MAAM,CAAC7G,CAAC,EAAE4G,WAAW,CAACvF,CAAC,CAAC,CAAC,CAAC;IACvD,CAAC;EACH;;EAEA,SAASyF,QAAQA,CAACL,MAAM,EAAE;IACxB,OAAOD,KAAK,CAACC,MAAM,EAAE,CAAAzG,CAAC,KAAIiC,GAAG,CAACjC,CAAC,CAAC,CAAC;EACnC;;EAEA,SAAS+G,cAAcA,CAACN,MAAM,EAAE;IAC9B,OAAOD,KAAK,CAACC,MAAM,EAAE,CAAAzG,CAAC,KAAK,aAAYiC,GAAG,CAAC+E,QAAQ,CAAChH,CAAC,CAAE,GAAE,CAAC;EAC5D;;EAEA;EACA;EACA,MAAMiH,mBAAmB,GAAG,CAAC,CAAC;EAC9B,SAASC,iBAAiBA,CAAC9D,KAAK,EAAE;IAChC,IAAI6D,mBAAmB,CAAC7D,KAAK,CAAC,EAAE;MAC9B,OAAO6D,mBAAmB,CAAC7D,KAAK,CAAC;IACnC;IACA,MAAMH,SAAS,GAAGC,IAAI,CAACC,KAAK,CAACC,KAAK,GAAG1B,SAAS,CAAC;IAC/CuF,mBAAmB,CAAC7D,KAAK,CAAC,GAAG,CAACA,KAAK,GAAG,CAAC,EAAE1B,SAAS,IAAIuB,SAAS,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;;IAEzE,OAAOgE,mBAAmB,CAAC7D,KAAK,CAAC;EACnC;;EAEA;EACA,MAAM+D,mBAAmB,GAAG,CAAC,CAAC;EAC9B,SAASC,iBAAiBA,CAAChE,KAAK,EAAE;IAChC,IAAI+D,mBAAmB,CAAC/D,KAAK,CAAC,EAAE;MAC9B,OAAO+D,mBAAmB,CAAC/D,KAAK,CAAC;IACnC;IACA,MAAMH,SAAS,GAAGC,IAAI,CAACC,KAAK,CAACC,KAAK,GAAG1B,SAAS,CAAC;IAC/CyF,mBAAmB,CAAC/D,KAAK,CAAC,GAAG;IAC3BH,SAAS,GAAGvB,SAAS;IACrB,CAACuB,SAAS,GAAG,CAAC,IAAIvB,SAAS,GAAG,CAAC,CAChC;;;IAED,OAAOyF,mBAAmB,CAAC/D,KAAK,CAAC;EACnC;;EAEA,IAAIiE,OAAO,GAAG,CAAC,CAAC;EAChB,IAAIC,YAAY,GAAG,KAAK;EACxB,MAAMC,EAAE,GAAG9C,QAAQ;EAChBzC,SAAS,CAAC,GAAG,CAAC;EACdlD,IAAI,CAAC0I,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAAChC,KAAK,CAAC5G,IAAI,CAAC,CAAC,CAAC,CAAC;EAAA,CAC7C6I,KAAK,CAAC,CAAC;EACPnF,MAAM,CAAC,GAAG,CAAC;EACXC,IAAI,CAAC,OAAO,EAAE,SAAS,CAAC;EACxB1B,OAAO,CAAC,WAAW,EAAE,IAAI,CAAC;EAC1B6G,EAAE,CAAC,WAAW,EAAEC,SAAS,CAAC;EAC1BD,EAAE,CAAC,UAAU,EAAEE,QAAQ,CAAC;EACxBF,EAAE,CAAC,WAAW,EAAEG,SAAS,CAAC;EAC1BH,EAAE,CAAC,OAAO,EAAEI,KAAK,CAAC;;EAErB,MAAMjC,MAAM,GAAGrB,UAAU;EACtB1C,SAAS,CAAC,GAAG,CAAC;EACdlD,IAAI,CAAC0I,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAAChC,KAAK,CAACK,MAAM,CAAC,CAAC,CAAC;EAC9C4B,KAAK,CAAC,CAAC;EACPnF,MAAM,CAAC,GAAG,CAAC;EACXC,IAAI,CAAC,OAAO,EAAE,WAAW,CAAC;EAC1BA,IAAI,CAAC,WAAW,EAAE,CAAAzC,CAAC,KAAK,aAAYiC,GAAG,CAAC+E,QAAQ,CAAChH,CAAC,CAAE,GAAE,CAAC;;EAE1D+F,MAAM;EACHvD,MAAM,CAAC,MAAM,CAAC;EACdyF,KAAK,CAAC,aAAa,EAAE,QAAQ,CAAC;EAC9BA,KAAK,CAAC,MAAM,EAAE,MAAM,CAAC;EACrBC,IAAI,CAAC,CAAAlI,CAAC,KAAI4B,UAAU,CAAC5B,CAAC,CAACX,IAAI,CAAC,CAAC;;EAEhC,MAAM2G,WAAW,GAAGrB,eAAe;EAChC3C,SAAS,CAAC,GAAG,CAAC;EACdlD,IAAI,CAAC0I,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAAChC,KAAK,CAACM,WAAW,CAAC,CAAC,CAAC;EACnD2B,KAAK,CAAC,CAAC;EACPnF,MAAM,CAAC,GAAG,CAAC;;EAEdwD,WAAW;EACRiC,KAAK,CAAC,SAAS,EAAE,CAAC,CAAC;EACnBxF,IAAI,CAAC,OAAO,EAAE,iBAAiB,CAAC;EAChCD,MAAM,CAAC,MAAM,CAAC;EACdyF,KAAK,CAAC,aAAa,EAAE,QAAQ,CAAC;EAC9BA,KAAK,CAAC,MAAM,EAAE,MAAM,CAAC;EACrBC,IAAI,CAAC,CAAAlI,CAAC,KAAIA,CAAC,CAACZ,IAAI,CAAC;;EAEpB,MAAM+I,IAAI,GAAGZ,EAAE;EACZ/E,MAAM,CAAC,MAAM,CAAC;EACdC,IAAI,CAAC,OAAO,EAAE,KAAK,CAAC;EACpBA,IAAI,CAAC,MAAM,EAAE,CAAAzC,CAAC,KAAI6B,OAAO,CAAC7B,CAAC,CAACZ,IAAI,EAAEwB,OAAO,CAAC,CAAC;EAC3C6B,IAAI,CAAC,GAAG,EAAER,GAAG,CAAC;;EAEjB,SAAS8F,SAASA,CAAA,EAAG;IACnB1F,OAAO,CAAC,CAAC;EACX;;EAEA,SAASwF,SAASA,CAACtH,CAAC,EAAEwC,CAAC,EAAE;IACvBV,OAAO,CAACvD,IAAI,CAACkE,WAAW,CAACzC,CAAC,EAAEwC,CAAC,EAAE/B,KAAK,CAAC,CAAC,CAACoH,MAAM,CAAC,KAAK,CAAC;IACpD,MAAMC,KAAK,GAAG9J,EAAE,CAACuC,MAAM,CAAC,IAAI,CAAC;IAC7BuH,KAAK,CAACtH,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC;IAC5B,IAAIsG,OAAO,GAAG,CAAC,IAAI,CAACC,YAAY,EAAE;MAChCe,KAAK;MACFvH,MAAM,CAAC,MAAM,CAAC;MACdwH,SAAS,CAAC,CAAC;MACXC,UAAU,CAAC,CAAC;MACZC,QAAQ,CAAC,GAAG,CAAC;MACbC,SAAS,CAAC,GAAG,EAAE3B,QAAQ,CAACpB,KAAK,CAACC,MAAM,CAAC5C,CAAC,CAAC,CAAC,CAAC;MAC5C,MAAM2F,IAAI,GAAGxB,iBAAiB,CAACnE,CAAC,CAAC;MACjCoF,IAAI;MACD7E,MAAM,CAAC,CAAAtD,CAAC,KAAI0I,IAAI,CAAC,CAAC,CAAC,IAAI1I,CAAC,CAACoD,KAAK,IAAIpD,CAAC,CAACoD,KAAK,IAAIsF,IAAI,CAAC,CAAC,CAAC,CAAC;MACrDJ,SAAS,CAAC,CAAC;MACXC,UAAU,CAAC,CAAC;MACZC,QAAQ,CAAC,GAAG,CAAC;MACbC,SAAS,CAAC,GAAG,EAAE,CAAAzI,CAAC,KAAI8G,QAAQ,CAACpB,KAAK,CAACL,IAAI,CAACrF,CAAC,CAACoD,KAAK,CAAC,CAAC,CAACpD,CAAC,CAAC,CAAC;IAC1D,CAAC,MAAM,IAAI,CAACsH,YAAY,EAAE;MACxB,MAAMqB,QAAQ,GAAGvB,iBAAiB,CAACC,OAAO,CAAC;MAC3C,IAAIsB,QAAQ,CAAC,CAAC,CAAC,IAAIpI,CAAC,CAAC6C,KAAK,IAAI7C,CAAC,CAAC6C,KAAK,IAAIuF,QAAQ,CAAC,CAAC,CAAC,EAAE;QACpDN,KAAK;QACFvH,MAAM,CAAC,MAAM,CAAC;QACdwH,SAAS,CAAC,CAAC;QACXC,UAAU,CAAC,CAAC;QACZC,QAAQ,CAAC,GAAG,CAAC;QACbC,SAAS,CAAC,GAAG,EAAE3B,QAAQ,CAACpB,KAAK,CAACI,OAAO,CAAC/C,CAAC,CAAC,CAAC,CAAC;MAC/C;IACF;EACF;;EAEA,SAAS+E,QAAQA,CAACvH,CAAC,EAAEwC,CAAC,EAAE;IACtBV,OAAO,CAAC+F,MAAM,CAAC,IAAI,CAAC;IACpB,MAAMC,KAAK,GAAG9J,EAAE,CAACuC,MAAM,CAAC,IAAI,CAAC;IAC7BuH,KAAK,CAACtH,OAAO,CAAC,OAAO,EAAE,KAAK,CAAC;IAC7B,IAAIsG,OAAO,GAAG,CAAC,IAAI,CAACC,YAAY,EAAE;MAChCe,KAAK;MACFvH,MAAM,CAAC,MAAM,CAAC;MACdwH,SAAS,CAAC,CAAC;MACXC,UAAU,CAAC,CAAC;MACZC,QAAQ,CAAC,GAAG,CAAC;MACbC,SAAS,CAAC,GAAG,EAAE3B,QAAQ,CAACpB,KAAK,CAAC5G,IAAI,CAACiE,CAAC,CAAC,CAAC,CAAC;MAC1C,MAAM2F,IAAI,GAAGxB,iBAAiB,CAACnE,CAAC,CAAC;MACjCoF,IAAI;MACD7E,MAAM,CAAC,CAAAtD,CAAC,KAAI0I,IAAI,CAAC,CAAC,CAAC,IAAI1I,CAAC,CAACoD,KAAK,IAAIpD,CAAC,CAACoD,KAAK,IAAIsF,IAAI,CAAC,CAAC,CAAC,CAAC;MACrDJ,SAAS,CAAC,CAAC;MACXC,UAAU,CAAC,CAAC;MACZC,QAAQ,CAAC,GAAG,CAAC;MACbC,SAAS,CAAC,GAAG,EAAE,CAAAzI,CAAC,KAAI8G,QAAQ,CAACpB,KAAK,CAAC5G,IAAI,CAACkB,CAAC,CAACoD,KAAK,CAAC,CAAC,CAACpD,CAAC,CAAC,CAAC;IAC1D,CAAC,MAAM,IAAI,CAACsH,YAAY,EAAE;MACxB,MAAMqB,QAAQ,GAAGvB,iBAAiB,CAACC,OAAO,CAAC;MAC3C,IAAIsB,QAAQ,CAAC,CAAC,CAAC,IAAIpI,CAAC,CAAC6C,KAAK,IAAI7C,CAAC,CAAC6C,KAAK,IAAIuF,QAAQ,CAAC,CAAC,CAAC,EAAE;QACpDN,KAAK;QACFvH,MAAM,CAAC,MAAM,CAAC;QACdwH,SAAS,CAAC,CAAC;QACXC,UAAU,CAAC,CAAC;QACZC,QAAQ,CAAC,GAAG,CAAC;QACbC,SAAS,CAAC,GAAG,EAAE3B,QAAQ,CAACpB,KAAK,CAACG,GAAG,CAAC9C,CAAC,CAAC,CAAC,CAAC;MAC3C;IACF;EACF;;EAEA,SAASiF,KAAKA,CAACzH,CAAC,EAAEwC,CAAC,EAAE;IACnB,IAAIuE,YAAY,EAAE;MAChB;IACF;IACA,MAAMsB,KAAK,GAAGrK,EAAE,CAACsK,KAAK,CAACC,MAAM,GAAG,IAAI,GAAG,GAAG;IAC1C,MAAMH,QAAQ,GAAGvB,iBAAiB,CAACrE,CAAC,CAAC;IACrC,IAAIsE,OAAO,GAAG,CAAC,EAAE;MACfC,YAAY,GAAG,IAAI;MACnBD,OAAO,GAAGtE,CAAC;MACXgD,MAAM;MACHuC,SAAS,CAAC,CAAC;MACXC,UAAU,CAAC,CAAC;MACZC,QAAQ,CAACI,KAAK,CAAC;MACfH,SAAS,CAAC,WAAW,EAAE,CAAAzI,CAAC;MACvB+G,cAAc,CAAC;QACb3G,WAAW,EAAE,CAAC;QACdD,WAAW,EAAE,CAAC;QACdF,UAAU,EAAED,CAAC,CAACC,UAAU;QACxBC,QAAQ,EAAEF,CAAC,CAACE;MACd,CAAC,CAAC,CAACF,CAAC;MACN,CAAC;MACAiI,KAAK,CAAC,SAAS,EAAE,CAAC,CAAC;MACtBjC,WAAW;MACRvD,IAAI;QACH,WAAW;QACV,aAAYR,GAAG,CAAC+E,QAAQ,CAAC;UACxB5G,WAAW,EAAE+D,SAAS,GAAG,EAAE;UAC3BhE,WAAW,EAAEgE,SAAS,GAAG,EAAE;UAC3BlE,UAAU,EAAEyF,KAAK,CAAC5G,IAAI,CAACiE,CAAC,CAAC,CAAC9C,UAAU;UACpCC,QAAQ,EAAEwF,KAAK,CAAC5G,IAAI,CAACiE,CAAC,CAAC,CAAC7C;QAC1B,CAAC,CAAE;MACL,CAAC;MACAoI,SAAS,CAAC,CAAC;MACXC,UAAU,CAAC,CAAC;MACZK,KAAK,CAACA,KAAK,CAAC;MACZJ,QAAQ,CAACI,KAAK,CAAC;MACfH,SAAS,CAAC,WAAW,EAAE,CAAAzI,CAAC;MACvB+G,cAAc,CAAC;QACb3G,WAAW,EAAE+D,SAAS,GAAG,EAAE;QAC3BhE,WAAW,EAAEgE,SAAS,GAAG,EAAE;QAC3BlE,UAAU,EAAEyF,KAAK,CAACG,GAAG,CAAC8C,QAAQ,CAAC,CAAC,CAAC,GAAG3I,CAAC,CAACoD,KAAK,CAAC,CAACnD,UAAU;QACvDC,QAAQ,EAAEwF,KAAK,CAACG,GAAG,CAAC8C,QAAQ,CAAC,CAAC,CAAC,GAAG3I,CAAC,CAACoD,KAAK,CAAC,CAAClD;MAC7C,CAAC,CAAC,CAACF,CAAC;MACN,CAAC;MACAiI,KAAK,CAAC,SAAS,EAAE,CAAAjI,CAAC;MACjBsC,KAAK,CAACC,QAAQ,CAACvC,CAAC,CAACoD,KAAK,CAAC;MACvBsC,KAAK,CAACG,GAAG,CAAC8C,QAAQ,CAAC,CAAC,CAAC,GAAG3I,CAAC,CAACoD,KAAK,CAAC,CAACkD,OAAO,GAAGjC,cAAc;MACrD,CAAC;MACD;MACN,CAAC;MACHkD,EAAE,CAACxG,OAAO;QACR,WAAW;QACX,CAAAf,CAAC,KAAI2I,QAAQ,CAAC,CAAC,CAAC,GAAG3I,CAAC,CAACoD,KAAK,IAAIpD,CAAC,CAACoD,KAAK,GAAGuF,QAAQ,CAAC,CAAC;MACpD,CAAC;MACDR,IAAI;MACD7E,MAAM,CAAC,CAAAtD,CAAC,KAAI2I,QAAQ,CAAC,CAAC,CAAC,IAAI3I,CAAC,CAACoD,KAAK,IAAIpD,CAAC,CAACoD,KAAK,IAAIuF,QAAQ,CAAC,CAAC,CAAC,CAAC;MAC7DL,SAAS,CAAC,CAAC;MACXC,UAAU,CAAC,CAAC;MACZC,QAAQ,CAACI,KAAK,CAAC;MACfH,SAAS,CAAC,GAAG,EAAE,CAAAzI,CAAC,KAAI8G,QAAQ,CAACpB,KAAK,CAACE,QAAQ,CAAC5F,CAAC,CAACoD,KAAK,CAAC,CAAC,CAACpD,CAAC,CAAC,CAAC;MACzDuI,UAAU,CAAC,CAAC;MACZC,QAAQ,CAACI,KAAK,CAAC;MACfH,SAAS,CAAC,GAAG,EAAE,CAAAzI,CAAC,KAAI8G,QAAQ,CAACpB,KAAK,CAACG,GAAG,CAAC7F,CAAC,CAACoD,KAAK,CAAC,CAAC,CAACpD,CAAC,CAAC,CAAC;MACpD+I,IAAI,CAAC,KAAK,EAAE,MAAM;QACjBzB,YAAY,GAAG,KAAK;MACtB,CAAC,CAAC;MACJa,IAAI;MACD7E,MAAM,CAAC,CAAAtD,CAAC,KAAI2I,QAAQ,CAAC,CAAC,CAAC,GAAG3I,CAAC,CAACoD,KAAK,IAAIpD,CAAC,CAACoD,KAAK,GAAGuF,QAAQ,CAAC,CAAC,CAAC,CAAC;MAC3DL,SAAS,CAAC,CAAC;MACXC,UAAU,CAAC,CAAC;MACZC,QAAQ,CAACI,KAAK,CAAC;MACfH,SAAS,CAAC,GAAG,EAAE,CAAAzI,CAAC,KAAI8G,QAAQ,CAACpB,KAAK,CAACnB,IAAI,CAACvE,CAAC,CAACoD,KAAK,CAAC,CAAC,CAACpD,CAAC,CAAC,CAAC;IAC1D,CAAC,MAAM,IAAIqH,OAAO,GAAGsB,QAAQ,CAAC,CAAC,CAAC,IAAIA,QAAQ,CAAC,CAAC,CAAC,GAAGtB,OAAO,EAAE;MACzDC,YAAY,GAAG,IAAI;MACnB,MAAM0B,aAAa,GAAG5B,iBAAiB,CAACC,OAAO,CAAC;MAChDtB,MAAM;MACHuC,SAAS,CAAC,CAAC;MACXC,UAAU,CAAC,CAAC;MACZK,KAAK,CAACA,KAAK,CAAC;MACZJ,QAAQ,CAACI,KAAK,CAAC;MACfH,SAAS,CAAC,WAAW,EAAE,CAAAzI,CAAC;MACvB+G,cAAc,CAACrB,KAAK,CAACK,MAAM,CAAC/F,CAAC,CAACoD,KAAK,GAAG1B,SAAS,CAAC,CAAC,CAAC1B,CAAC;MACrD,CAAC;MACAiI,KAAK,CAAC,SAAS,EAAE,CAAC,CAAC;MACtBjC,WAAW;MACRsC,SAAS,CAAC,CAAC;MACXC,UAAU,CAAC,CAAC;MACZC,QAAQ,CAACI,KAAK,CAAC;MACfH,SAAS;QACR,WAAW;QACX1B,cAAc,CAAC;UACb3G,WAAW,EAAE+D,SAAS,GAAG,EAAE;UAC3BhE,WAAW,EAAEgE,SAAS,GAAG,EAAE;UAC3BlE,UAAU,EAAEyF,KAAK,CAAC5G,IAAI,CAACuI,OAAO,CAAC,CAACpH,UAAU;UAC1CC,QAAQ,EAAEwF,KAAK,CAAC5G,IAAI,CAACuI,OAAO,CAAC,CAACnH;QAChC,CAAC;MACH,CAAC;MACA+H,KAAK,CAAC,SAAS,EAAE,CAAC,CAAC;MACtBV,EAAE,CAACxG,OAAO,CAAC,WAAW,EAAE,IAAI,CAAC;MAC7BoH,IAAI;MACD7E,MAAM,CAAC,CAAAtD,CAAC,KAAIgJ,aAAa,CAAC,CAAC,CAAC,IAAIhJ,CAAC,CAACoD,KAAK,IAAIpD,CAAC,CAACoD,KAAK,IAAI4F,aAAa,CAAC,CAAC,CAAC,CAAC;MACvEV,SAAS,CAAC,CAAC;MACXC,UAAU,CAAC,CAAC;MACZC,QAAQ,CAACI,KAAK,CAAC;MACfH,SAAS,CAAC,GAAG,EAAE,CAAAzI,CAAC,KAAI8G,QAAQ,CAACpB,KAAK,CAACE,QAAQ,CAAC5F,CAAC,CAACoD,KAAK,CAAC,CAAC,CAACpD,CAAC,CAAC,CAAC;MACzDuI,UAAU,CAAC,CAAC;MACZC,QAAQ,CAACI,KAAK,CAAC;MACfH,SAAS,CAAC,GAAG,EAAE,CAAAzI,CAAC,KAAI8G,QAAQ,CAACpB,KAAK,CAAC5G,IAAI,CAACkB,CAAC,CAACoD,KAAK,CAAC,CAAC,CAACpD,CAAC,CAAC,CAAC;MACrD+I,IAAI,CAAC,KAAK,EAAE,MAAM;QACjB1B,OAAO,GAAG,CAAC,CAAC;QACZC,YAAY,GAAG,KAAK;MACtB,CAAC,CAAC;MACJa,IAAI;MACD7E,MAAM,CAAC,CAAAtD,CAAC,KAAIgJ,aAAa,CAAC,CAAC,CAAC,GAAGhJ,CAAC,CAACoD,KAAK,IAAIpD,CAAC,CAACoD,KAAK,GAAG4F,aAAa,CAAC,CAAC,CAAC,CAAC;MACrEV,SAAS,CAAC,CAAC;MACXC,UAAU,CAAC,CAAC;MACZK,KAAK,CAACA,KAAK,CAAC;MACZJ,QAAQ,CAACI,KAAK,CAAC;MACfH,SAAS,CAAC,GAAG,EAAE,CAAAzI,CAAC,KAAI8G,QAAQ,CAACpB,KAAK,CAAC5G,IAAI,CAACkB,CAAC,CAACoD,KAAK,CAAC,CAAC,CAACpD,CAAC,CAAC,CAAC;IAC1D;EACF;;EAEA,SAASiJ,YAAYA,CAAA,EAAG;IACtB,MAAML,KAAK,GAAGrK,EAAE,CAACsK,KAAK,CAACC,MAAM,GAAG,IAAI,GAAG,GAAG;IAC1CnG,UAAU,CAAC3B,KAAK,CAAC4B,UAAU,CAAC5B,KAAK,CAAC,CAAC,CAAC2C,IAAI,CAACxB,MAAM,CAAC;IAChD,MAAM+G,MAAM,GAAGtE,gBAAgB,CAAC5D,KAAK,CAAC;IACtCsG,YAAY,GAAG,IAAI;IACnB,IAAID,OAAO,GAAG,CAAC,EAAE;MACfc,IAAI;MACDF,KAAK,CAAC,SAAS,EAAE,CAAC,CAAC;MACnBK,SAAS,CAAC,CAAC;MACXC,UAAU,CAAC,CAAC;MACZC,QAAQ,CAACI,KAAK,CAAC;MACfH,SAAS,CAAC,GAAG,EAAE,CAAAzI,CAAC,KAAI8G,QAAQ,CAACoC,MAAM,CAACpK,IAAI,CAACkB,CAAC,CAACoD,KAAK,CAAC,CAAC,CAACpD,CAAC,CAAC,CAAC;MACtD+I,IAAI,CAAC,KAAK,EAAE,MAAM;QACjBzB,YAAY,GAAG,KAAK;QACpB5B,KAAK,GAAGwD,MAAM;MAChB,CAAC,CAAC;MACDX,UAAU,CAAC,CAAC;MACZC,QAAQ,CAAC,CAAC,CAAC;MACXP,KAAK,CAAC,SAAS,EAAE,CAAAjI,CAAC,KAAKsC,KAAK,CAACC,QAAQ,CAACvC,CAAC,CAACoD,KAAK,GAAG1B,SAAS,CAAC,GAAG,CAAC,GAAG,CAAE,CAAC;IACzE,CAAC,MAAM;MACL,MAAMiH,QAAQ,GAAGvB,iBAAiB,CAACC,OAAO,CAAC;MAC3Cc,IAAI;MACDF,KAAK,CAAC,SAAS,EAAE,CAAC,CAAC;MACnBK,SAAS,CAAC,CAAC;MACXC,UAAU,CAAC,CAAC;MACZC,QAAQ,CAACI,KAAK,CAAC;MACfH,SAAS,CAAC,GAAG,EAAE,CAAAzI,CAAC;MACf2I,QAAQ,CAAC,CAAC,CAAC,IAAI3I,CAAC,CAACoD,KAAK,IAAIpD,CAAC,CAACoD,KAAK,IAAIuF,QAAQ,CAAC,CAAC,CAAC;MAC5C7B,QAAQ,CAACoC,MAAM,CAACrD,GAAG,CAAC7F,CAAC,CAACoD,KAAK,CAAC,CAAC,CAACpD,CAAC,CAAC;MAChC8G,QAAQ,CAACoC,MAAM,CAAC3E,IAAI,CAACvE,CAAC,CAACoD,KAAK,CAAC,CAAC,CAACpD,CAAC;MACtC,CAAC;MACA+I,IAAI,CAAC,KAAK,EAAE,MAAM;QACjBzB,YAAY,GAAG,KAAK;QACpB5B,KAAK,GAAGwD,MAAM;MAChB,CAAC,CAAC;MACDX,UAAU,CAAC,CAAC;MACZC,QAAQ,CAAC,CAAC,CAAC;MACXP,KAAK,CAAC,SAAS,EAAE,CAAAjI,CAAC,KAAKsC,KAAK,CAACC,QAAQ,CAACvC,CAAC,CAACoD,KAAK,GAAG1B,SAAS,CAAC,GAAG,CAAC,GAAG,CAAE,CAAC;MACvEsE,WAAW;MACRsC,SAAS,CAAC,CAAC;MACXC,UAAU,CAAC,CAAC;MACZC,QAAQ,CAACI,KAAK,CAAC;MACfH,SAAS,CAAC,WAAW,EAAE,CAAAzI,CAAC;MACvB+G,cAAc,CAAC;QACb3G,WAAW,EAAE+D,SAAS,GAAG,EAAE;QAC3BhE,WAAW,EAAEgE,SAAS,GAAG,EAAE;QAC3BlE,UAAU,EAAEiJ,MAAM,CAACrD,GAAG,CAAC8C,QAAQ,CAAC,CAAC,CAAC,GAAG3I,CAAC,CAACoD,KAAK,CAAC,CAACnD,UAAU;QACxDC,QAAQ,EAAEgJ,MAAM,CAACrD,GAAG,CAAC8C,QAAQ,CAAC,CAAC,CAAC,GAAG3I,CAAC,CAACoD,KAAK,CAAC,CAAClD;MAC9C,CAAC,CAAC,CAACF,CAAC;MACN,CAAC;MACAiI,KAAK,CAAC,SAAS,EAAE,CAAAjI,CAAC;MACjBsC,KAAK,CAACC,QAAQ,CAACvC,CAAC,CAACoD,KAAK,CAAC;MACvBsC,KAAK,CAACG,GAAG,CAAC8C,QAAQ,CAAC,CAAC,CAAC,GAAG3I,CAAC,CAACoD,KAAK,CAAC,CAACkD,OAAO,GAAGjC,cAAc;MACrD,CAAC;MACD;MACN,CAAC;IACL;EACF;;EAEAlC,MAAM,CAACgH,QAAQ,CAACvB,EAAE,CAAC,aAAa,EAAE,CAAAwB,QAAQ,KAAI;IAC5C,IAAI9G,KAAK,CAACC,QAAQ,KAAK6G,QAAQ,CAAC7G,QAAQ,EAAE;MACxCD,KAAK,CAACC,QAAQ,GAAG6G,QAAQ,CAAC7G,QAAQ;MAClC0G,YAAY,CAAC,CAAC;IAChB;EACF,CAAC,CAAC;AACJ;;AAEAzI,IAAI,CAAC6I,WAAW,GAAG,MAAM;AACzB7I,IAAI,CAAC3B,SAAS,GAAGA,SAAS,CAAC,MAAAyK,QAAA;;AAEZ9I,IAAI,CAAnB,eAAA8I,QAAA,CAAoB,mBAAAC,cAAA,UAAAC,oBAAA,mBAAAA,oBAAA,CAAAC,OAAA,GAAAC,SAAA,MAAAH,cAAA,WAAAA,cAAA,CAAAI,QAAA,CApmBd9K,SAAS,sHAAA0K,cAAA,CAAAI,QAAA,CAoBN5J,OAAO,oHAAAwJ,cAAA,CAAAI,QAAA,CASPtJ,UAAU,uHAAAkJ,cAAA,CAAAI,QAAA,CAQVnJ,IAAI,iHAAA+I,cAAA,CAAAI,QAAA,CAAAL,QAAA,4IAAAM,WAAA,UAAAJ,oBAAA,mBAAAA,oBAAA,CAAAI,WAAA,GAAAF,SAAA,CAAAE,WAAA,IAAAA,WAAA,CAAAC,MAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}