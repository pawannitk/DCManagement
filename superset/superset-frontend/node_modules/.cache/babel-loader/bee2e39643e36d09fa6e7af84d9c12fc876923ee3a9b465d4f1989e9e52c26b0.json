{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport parseCookie from 'src/utils/parseCookie';\nimport rison from 'rison';\nimport shortid from 'shortid';\nexport default function handleResourceExport(resource, ids, done, interval = 200) {\n  const token = shortid.generate();\n  const url = `/api/v1/${resource}/export/?q=${rison.encode(ids)}&token=${token}`;\n  // create new iframe for export\n  const iframe = document.createElement('iframe');\n  iframe.style.display = 'none';\n  iframe.src = url;\n  document.body.appendChild(iframe);\n  const timer = window.setInterval(() => {\n    const cookie = parseCookie();\n    if (cookie[token] === 'done') {\n      window.clearInterval(timer);\n      document.body.removeChild(iframe);\n      done();\n    }\n  }, interval);\n};(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(handleResourceExport, \"handleResourceExport\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/utils/export.ts\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["parseCookie","rison","shortid","handleResourceExport","resource","ids","done","interval","token","generate","url","encode","iframe","document","createElement","style","display","src","body","appendChild","timer","window","setInterval","cookie","clearInterval","removeChild","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/src/utils/export.ts"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport parseCookie from 'src/utils/parseCookie';\nimport rison from 'rison';\nimport shortid from 'shortid';\n\nexport default function handleResourceExport(\n  resource: string,\n  ids: number[],\n  done: () => void,\n  interval = 200,\n): void {\n  const token = shortid.generate();\n  const url = `/api/v1/${resource}/export/?q=${rison.encode(\n    ids,\n  )}&token=${token}`;\n\n  // create new iframe for export\n  const iframe = document.createElement('iframe');\n  iframe.style.display = 'none';\n  iframe.src = url;\n  document.body.appendChild(iframe);\n\n  const timer = window.setInterval(() => {\n    const cookie: { [cookieId: string]: string } = parseCookie();\n    if (cookie[token] === 'done') {\n      window.clearInterval(timer);\n      document.body.removeChild(iframe);\n      done();\n    }\n  }, interval);\n}\n"],"mappings":"wSAAA;;;;;;;;;;;;;;;;;;AAkBA,OAAOA,WAAW,MAAM,uBAAuB;AAC/C,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,OAAO,MAAM,SAAS;AAE7B,eAAc,SAAUC,oBAAoBA,CAC1CC,QAAgB,EAChBC,GAAa,EACbC,IAAgB,EAChBC,QAAQ,GAAG,GAAG;EAEd,MAAMC,KAAK,GAAGN,OAAO,CAACO,QAAQ,EAAE;EAChC,MAAMC,GAAG,GAAG,WAAWN,QAAQ,cAAcH,KAAK,CAACU,MAAM,CACvDN,GAAG,CACJ,UAAUG,KAAK,EAAE;EAElB;EACA,MAAMI,MAAM,GAAGC,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;EAC/CF,MAAM,CAACG,KAAK,CAACC,OAAO,GAAG,MAAM;EAC7BJ,MAAM,CAACK,GAAG,GAAGP,GAAG;EAChBG,QAAQ,CAACK,IAAI,CAACC,WAAW,CAACP,MAAM,CAAC;EAEjC,MAAMQ,KAAK,GAAGC,MAAM,CAACC,WAAW,CAAC,MAAK;IACpC,MAAMC,MAAM,GAAmCvB,WAAW,EAAE;IAC5D,IAAIuB,MAAM,CAACf,KAAK,CAAC,KAAK,MAAM,EAAE;MAC5Ba,MAAM,CAACG,aAAa,CAACJ,KAAK,CAAC;MAC3BP,QAAQ,CAACK,IAAI,CAACO,WAAW,CAACb,MAAM,CAAC;MACjCN,IAAI,EAAE;;EAEV,CAAC,EAAEC,QAAQ,CAAC;AACd,CAAC,mBAAAmB,cAAA,UAAAC,oBAAA,mBAAAA,oBAAA,CAAAC,OAAA,GAAAC,SAAA,MAAAH,cAAA,WAAAA,cAAA,CAAAI,QAAA,CAzBuB3B,oBAAoB,gIAAA4B,WAAA,UAAAJ,oBAAA,mBAAAA,oBAAA,CAAAI,WAAA,GAAAF,SAAA,CAAAE,WAAA,IAAAA,WAAA,CAAAC,MAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}