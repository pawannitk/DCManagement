{"ast":null,"code":"import _debounce from \"lodash/debounce\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable no-param-reassign */\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { AppSection, ensureIsArray, getColumnLabel, finestTemporalGrainFormatter, t, tn } from '@superset-ui/core';\n\nimport { useImmerReducer } from 'use-immer';\nimport { Select } from 'src/components';\nimport { SLOW_DEBOUNCE } from 'src/constants';\nimport { hasOption, propertyComparator } from 'src/components/Select/utils';\nimport { FilterBarOrientation } from 'src/dashboard/types';\nimport { FilterPluginStyle, StatusMessage, StyledFormItem } from '../common';\nimport { getDataRecordFormatter, getSelectExtraFormData } from '../../utils';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nfunction reducer(draft, action) {\n  switch (action.type) {\n    case 'ownState':\n      draft.ownState = {\n        ...draft.ownState,\n        ...action.ownState\n      };\n      return draft;\n    case 'filterState':\n      if (JSON.stringify(draft.extraFormData) !==\n      JSON.stringify(action.extraFormData)) {\n        draft.extraFormData = action.extraFormData;\n      }\n      if (JSON.stringify(draft.filterState) !== JSON.stringify(action.filterState)) {\n        draft.filterState = { ...draft.filterState, ...action.filterState };\n      }\n      return draft;\n    default:\n      return draft;\n  }\n}\nexport default function PluginFilterSelect(props) {\n  const { coltypeMap, data, filterState, formData, height, isRefreshing, width, setDataMask, setHoveredFilter, unsetHoveredFilter, setFocusedFilter, unsetFocusedFilter, setFilterActive, appSection, showOverflow, parentRef, inputRef, filterBarOrientation } = props;\n  const { enableEmptyFilter, multiSelect, showSearch, inverseSelection, defaultToFirstItem, searchAllOptions } = formData;\n  const groupby = useMemo(() => ensureIsArray(formData.groupby).map(getColumnLabel), [formData.groupby]);\n  const [col] = groupby;\n  const [initialColtypeMap] = useState(coltypeMap);\n  const [search, setSearch] = useState('');\n  const [dataMask, dispatchDataMask] = useImmerReducer(reducer, {\n    extraFormData: {},\n    filterState\n  });\n  const datatype = coltypeMap[col];\n  const labelFormatter = useMemo(() => getDataRecordFormatter({\n    timeFormatter: finestTemporalGrainFormatter(data.map((el) => el[col]))\n  }), [data, col]);\n  const updateDataMask = useCallback((values) => {\n    const emptyFilter = enableEmptyFilter && !inverseSelection && !(values != null && values.length);\n    const suffix = inverseSelection && values != null && values.length ? t(' (excluded)') : '';\n    dispatchDataMask({\n      type: 'filterState',\n      extraFormData: getSelectExtraFormData(col, values, emptyFilter, inverseSelection),\n      filterState: {\n        ...filterState,\n        label: values != null && values.length ?\n        `${(values || []).\n        map((value) => labelFormatter(value, datatype)).\n        join(', ')}${suffix}` :\n        undefined,\n        value: appSection === AppSection.FilterConfigModal && defaultToFirstItem ?\n        undefined :\n        values\n      }\n    });\n  },\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  [\n  appSection,\n  col,\n  datatype,\n  defaultToFirstItem,\n  dispatchDataMask,\n  enableEmptyFilter,\n  inverseSelection,\n  JSON.stringify(filterState),\n  labelFormatter]\n  );\n  const isDisabled = appSection === AppSection.FilterConfigModal && defaultToFirstItem;\n  const onSearch = useMemo(() => _debounce((search) => {\n    setSearch(search);\n    if (searchAllOptions) {\n      dispatchDataMask({\n        type: 'ownState',\n        ownState: {\n          coltypeMap: initialColtypeMap,\n          search\n        }\n      });\n    }\n  }, SLOW_DEBOUNCE), [dispatchDataMask, initialColtypeMap, searchAllOptions]);\n  const handleBlur = useCallback(() => {\n    unsetFocusedFilter();\n    onSearch('');\n  }, [onSearch, unsetFocusedFilter]);\n  const handleChange = useCallback((value) => {\n    const values = value === null ? [null] : ensureIsArray(value);\n    if (values.length === 0) {\n      updateDataMask(null);\n    } else\n    {\n      updateDataMask(values);\n    }\n  }, [updateDataMask]);\n  const placeholderText = data.length === 0 ?\n  t('No data') :\n  tn('%s option', '%s options', data.length, data.length);\n  const formItemExtra = useMemo(() => {\n    if (filterState.validateMessage) {\n      return ___EmotionJSX(StatusMessage, { status: filterState.validateStatus },\n      filterState.validateMessage\n      );\n    }\n    return undefined;\n  }, [filterState.validateMessage, filterState.validateStatus]);\n  const uniqueOptions = useMemo(() => {\n    const allOptions = new Set([...data.map((el) => el[col])]);\n    return [...allOptions].map((value) => ({\n      label: labelFormatter(value, datatype),\n      value,\n      isNewOption: false\n    }));\n  }, [data, datatype, col, labelFormatter]);\n  const options = useMemo(() => {\n    if (search && !multiSelect && !hasOption(search, uniqueOptions, true)) {\n      uniqueOptions.unshift({\n        label: search,\n        value: search,\n        isNewOption: true\n      });\n    }\n    return uniqueOptions;\n  }, [multiSelect, search, uniqueOptions]);\n  const sortComparator = useCallback((a, b) => {\n    const labelComparator = propertyComparator('label');\n    if (formData.sortAscending) {\n      return labelComparator(a, b);\n    }\n    return labelComparator(b, a);\n  }, [formData.sortAscending]);\n  useEffect(() => {\n    if (defaultToFirstItem && filterState.value === undefined) {\n      // initialize to first value if set to default to first item\n      const firstItem = data[0] ?\n      groupby.map((col) => data[0][col]) :\n      null;\n      // firstItem[0] !== undefined for a case when groupby changed but new data still not fetched\n      // TODO: still need repopulate default value in config modal when column changed\n      if ((firstItem == null ? void 0 : firstItem[0]) !== undefined) {\n        updateDataMask(firstItem);\n      }\n    } else\n    if (isDisabled) {\n      // empty selection if filter is disabled\n      updateDataMask(null);\n    } else\n    {\n      // reset data mask based on filter state\n      updateDataMask(filterState.value);\n    }\n  }, [\n  col,\n  isDisabled,\n  defaultToFirstItem,\n  enableEmptyFilter,\n  inverseSelection,\n  updateDataMask,\n  data,\n  groupby,\n  JSON.stringify(filterState.value)]\n  );\n  useEffect(() => {\n    setDataMask(dataMask);\n  }, [JSON.stringify(dataMask)]);\n  return ___EmotionJSX(FilterPluginStyle, { height: height, width: width },\n  ___EmotionJSX(StyledFormItem, { validateStatus: filterState.validateStatus, extra: formItemExtra },\n  ___EmotionJSX(Select, { allowClear: true, allowNewOptions: !searchAllOptions, allowSelectAll: !searchAllOptions\n    // @ts-ignore\n    , value: filterState.value || [], disabled: isDisabled, getPopupContainer: showOverflow ?\n    () => (parentRef == null ? void 0 : parentRef.current) || document.body :\n    (trigger) => (trigger == null ? void 0 : trigger.parentNode) || document.body, showSearch: showSearch, mode: multiSelect ? 'multiple' : 'single', placeholder: placeholderText, onClear: () => onSearch(''), onSearch: onSearch, onBlur: handleBlur, onFocus: setFocusedFilter, onMouseEnter: setHoveredFilter, onMouseLeave: unsetHoveredFilter\n    // @ts-ignore\n    , onChange: handleChange, ref: inputRef, loading: isRefreshing, oneLine: filterBarOrientation === FilterBarOrientation.Horizontal, invertSelection: inverseSelection, options: options, sortComparator: sortComparator, onDropdownVisibleChange: setFilterActive })\n  )\n  );\n}__signature__(PluginFilterSelect, \"useMemo{groupby}\\nuseState{[initialColtypeMap](coltypeMap)}\\nuseState{[search, setSearch]('')}\\nuseImmerReducer{[dataMask, dispatchDataMask]}\\nuseMemo{labelFormatter}\\nuseCallback{updateDataMask}\\nuseMemo{onSearch}\\nuseCallback{handleBlur}\\nuseCallback{handleChange}\\nuseMemo{formItemExtra}\\nuseMemo{uniqueOptions}\\nuseMemo{options}\\nuseCallback{sortComparator}\\nuseEffect{}\\nuseEffect{}\", () => [useImmerReducer]);;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(reducer, \"reducer\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/filters/components/Select/SelectFilterPlugin.tsx\");reactHotLoader.register(PluginFilterSelect, \"PluginFilterSelect\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/filters/components/Select/SelectFilterPlugin.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["React","useCallback","useEffect","useMemo","useState","AppSection","ensureIsArray","getColumnLabel","finestTemporalGrainFormatter","t","tn","useImmerReducer","Select","SLOW_DEBOUNCE","hasOption","propertyComparator","FilterBarOrientation","FilterPluginStyle","StatusMessage","StyledFormItem","getDataRecordFormatter","getSelectExtraFormData","jsx","___EmotionJSX","reducer","draft","action","type","ownState","JSON","stringify","extraFormData","filterState","PluginFilterSelect","props","coltypeMap","data","formData","height","isRefreshing","width","setDataMask","setHoveredFilter","unsetHoveredFilter","setFocusedFilter","unsetFocusedFilter","setFilterActive","appSection","showOverflow","parentRef","inputRef","filterBarOrientation","enableEmptyFilter","multiSelect","showSearch","inverseSelection","defaultToFirstItem","searchAllOptions","groupby","map","col","initialColtypeMap","search","setSearch","dataMask","dispatchDataMask","datatype","labelFormatter","timeFormatter","el","updateDataMask","values","emptyFilter","length","suffix","label","value","join","undefined","FilterConfigModal","isDisabled","onSearch","_debounce","handleBlur","handleChange","placeholderText","formItemExtra","validateMessage","status","validateStatus","uniqueOptions","allOptions","Set","isNewOption","options","unshift","sortComparator","a","b","labelComparator","sortAscending","firstItem","extra","allowClear","allowNewOptions","allowSelectAll","disabled","getPopupContainer","current","document","body","trigger","parentNode","mode","placeholder","onClear","onBlur","onFocus","onMouseEnter","onMouseLeave","onChange","ref","loading","oneLine","Horizontal","invertSelection","onDropdownVisibleChange","__signature__","reactHotLoader","reactHotLoaderGlobal","default","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/src/filters/components/Select/SelectFilterPlugin.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable no-param-reassign */\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport {\n  AppSection,\n  DataMask,\n  ensureIsArray,\n  ExtraFormData,\n  GenericDataType,\n  getColumnLabel,\n  JsonObject,\n  finestTemporalGrainFormatter,\n  t,\n  tn,\n} from '@superset-ui/core';\nimport { LabeledValue as AntdLabeledValue } from 'antd/lib/select';\nimport { debounce } from 'lodash';\nimport { useImmerReducer } from 'use-immer';\nimport { Select } from 'src/components';\nimport { SLOW_DEBOUNCE } from 'src/constants';\nimport { hasOption, propertyComparator } from 'src/components/Select/utils';\nimport { FilterBarOrientation } from 'src/dashboard/types';\nimport { PluginFilterSelectProps, SelectValue } from './types';\nimport { FilterPluginStyle, StatusMessage, StyledFormItem } from '../common';\nimport { getDataRecordFormatter, getSelectExtraFormData } from '../../utils';\n\ntype DataMaskAction =\n  | { type: 'ownState'; ownState: JsonObject }\n  | {\n      type: 'filterState';\n      extraFormData: ExtraFormData;\n      filterState: { value: SelectValue; label?: string };\n    };\n\nfunction reducer(draft: DataMask, action: DataMaskAction) {\n  switch (action.type) {\n    case 'ownState':\n      draft.ownState = {\n        ...draft.ownState,\n        ...action.ownState,\n      };\n      return draft;\n    case 'filterState':\n      if (\n        JSON.stringify(draft.extraFormData) !==\n        JSON.stringify(action.extraFormData)\n      ) {\n        draft.extraFormData = action.extraFormData;\n      }\n      if (\n        JSON.stringify(draft.filterState) !== JSON.stringify(action.filterState)\n      ) {\n        draft.filterState = { ...draft.filterState, ...action.filterState };\n      }\n\n      return draft;\n    default:\n      return draft;\n  }\n}\n\nexport default function PluginFilterSelect(props: PluginFilterSelectProps) {\n  const {\n    coltypeMap,\n    data,\n    filterState,\n    formData,\n    height,\n    isRefreshing,\n    width,\n    setDataMask,\n    setHoveredFilter,\n    unsetHoveredFilter,\n    setFocusedFilter,\n    unsetFocusedFilter,\n    setFilterActive,\n    appSection,\n    showOverflow,\n    parentRef,\n    inputRef,\n    filterBarOrientation,\n  } = props;\n  const {\n    enableEmptyFilter,\n    multiSelect,\n    showSearch,\n    inverseSelection,\n    defaultToFirstItem,\n    searchAllOptions,\n  } = formData;\n  const groupby = useMemo(\n    () => ensureIsArray(formData.groupby).map(getColumnLabel),\n    [formData.groupby],\n  );\n  const [col] = groupby;\n  const [initialColtypeMap] = useState(coltypeMap);\n  const [search, setSearch] = useState('');\n  const [dataMask, dispatchDataMask] = useImmerReducer(reducer, {\n    extraFormData: {},\n    filterState,\n  });\n  const datatype: GenericDataType = coltypeMap[col];\n  const labelFormatter = useMemo(\n    () =>\n      getDataRecordFormatter({\n        timeFormatter: finestTemporalGrainFormatter(data.map(el => el[col])),\n      }),\n    [data, col],\n  );\n\n  const updateDataMask = useCallback(\n    (values: SelectValue) => {\n      const emptyFilter =\n        enableEmptyFilter && !inverseSelection && !values?.length;\n\n      const suffix = inverseSelection && values?.length ? t(' (excluded)') : '';\n      dispatchDataMask({\n        type: 'filterState',\n        extraFormData: getSelectExtraFormData(\n          col,\n          values,\n          emptyFilter,\n          inverseSelection,\n        ),\n        filterState: {\n          ...filterState,\n          label: values?.length\n            ? `${(values || [])\n                .map(value => labelFormatter(value, datatype))\n                .join(', ')}${suffix}`\n            : undefined,\n          value:\n            appSection === AppSection.FilterConfigModal && defaultToFirstItem\n              ? undefined\n              : values,\n        },\n      });\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [\n      appSection,\n      col,\n      datatype,\n      defaultToFirstItem,\n      dispatchDataMask,\n      enableEmptyFilter,\n      inverseSelection,\n      JSON.stringify(filterState),\n      labelFormatter,\n    ],\n  );\n\n  const isDisabled =\n    appSection === AppSection.FilterConfigModal && defaultToFirstItem;\n\n  const onSearch = useMemo(\n    () =>\n      debounce((search: string) => {\n        setSearch(search);\n        if (searchAllOptions) {\n          dispatchDataMask({\n            type: 'ownState',\n            ownState: {\n              coltypeMap: initialColtypeMap,\n              search,\n            },\n          });\n        }\n      }, SLOW_DEBOUNCE),\n    [dispatchDataMask, initialColtypeMap, searchAllOptions],\n  );\n\n  const handleBlur = useCallback(() => {\n    unsetFocusedFilter();\n    onSearch('');\n  }, [onSearch, unsetFocusedFilter]);\n\n  const handleChange = useCallback(\n    (value?: SelectValue | number | string) => {\n      const values = value === null ? [null] : ensureIsArray(value);\n\n      if (values.length === 0) {\n        updateDataMask(null);\n      } else {\n        updateDataMask(values);\n      }\n    },\n    [updateDataMask],\n  );\n\n  const placeholderText =\n    data.length === 0\n      ? t('No data')\n      : tn('%s option', '%s options', data.length, data.length);\n\n  const formItemExtra = useMemo(() => {\n    if (filterState.validateMessage) {\n      return (\n        <StatusMessage status={filterState.validateStatus}>\n          {filterState.validateMessage}\n        </StatusMessage>\n      );\n    }\n    return undefined;\n  }, [filterState.validateMessage, filterState.validateStatus]);\n\n  const uniqueOptions = useMemo(() => {\n    const allOptions = new Set([...data.map(el => el[col])]);\n    return [...allOptions].map((value: string) => ({\n      label: labelFormatter(value, datatype),\n      value,\n      isNewOption: false,\n    }));\n  }, [data, datatype, col, labelFormatter]);\n\n  const options = useMemo(() => {\n    if (search && !multiSelect && !hasOption(search, uniqueOptions, true)) {\n      uniqueOptions.unshift({\n        label: search,\n        value: search,\n        isNewOption: true,\n      });\n    }\n    return uniqueOptions;\n  }, [multiSelect, search, uniqueOptions]);\n\n  const sortComparator = useCallback(\n    (a: AntdLabeledValue, b: AntdLabeledValue) => {\n      const labelComparator = propertyComparator('label');\n      if (formData.sortAscending) {\n        return labelComparator(a, b);\n      }\n      return labelComparator(b, a);\n    },\n    [formData.sortAscending],\n  );\n\n  useEffect(() => {\n    if (defaultToFirstItem && filterState.value === undefined) {\n      // initialize to first value if set to default to first item\n      const firstItem: SelectValue = data[0]\n        ? (groupby.map(col => data[0][col]) as string[])\n        : null;\n      // firstItem[0] !== undefined for a case when groupby changed but new data still not fetched\n      // TODO: still need repopulate default value in config modal when column changed\n      if (firstItem?.[0] !== undefined) {\n        updateDataMask(firstItem);\n      }\n    } else if (isDisabled) {\n      // empty selection if filter is disabled\n      updateDataMask(null);\n    } else {\n      // reset data mask based on filter state\n      updateDataMask(filterState.value);\n    }\n  }, [\n    col,\n    isDisabled,\n    defaultToFirstItem,\n    enableEmptyFilter,\n    inverseSelection,\n    updateDataMask,\n    data,\n    groupby,\n    JSON.stringify(filterState.value),\n  ]);\n\n  useEffect(() => {\n    setDataMask(dataMask);\n  }, [JSON.stringify(dataMask)]);\n\n  return (\n    <FilterPluginStyle height={height} width={width}>\n      <StyledFormItem\n        validateStatus={filterState.validateStatus}\n        extra={formItemExtra}\n      >\n        <Select\n          allowClear\n          allowNewOptions={!searchAllOptions}\n          allowSelectAll={!searchAllOptions}\n          // @ts-ignore\n          value={filterState.value || []}\n          disabled={isDisabled}\n          getPopupContainer={\n            showOverflow\n              ? () => (parentRef?.current as HTMLElement) || document.body\n              : (trigger: HTMLElement) =>\n                  (trigger?.parentNode as HTMLElement) || document.body\n          }\n          showSearch={showSearch}\n          mode={multiSelect ? 'multiple' : 'single'}\n          placeholder={placeholderText}\n          onClear={() => onSearch('')}\n          onSearch={onSearch}\n          onBlur={handleBlur}\n          onFocus={setFocusedFilter}\n          onMouseEnter={setHoveredFilter}\n          onMouseLeave={unsetHoveredFilter}\n          // @ts-ignore\n          onChange={handleChange}\n          ref={inputRef}\n          loading={isRefreshing}\n          oneLine={filterBarOrientation === FilterBarOrientation.Horizontal}\n          invertSelection={inverseSelection}\n          options={options}\n          sortComparator={sortComparator}\n          onDropdownVisibleChange={setFilterActive}\n        />\n      </StyledFormItem>\n    </FilterPluginStyle>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}