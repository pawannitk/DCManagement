{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ensureIsArray } from '../utils';\nconst DAY_IN_MS = 24 * 60 * 60 * 1000;\nexport const parseDttmToDate = (dttm) => {\n  const now = new Date();\n  now.setUTCHours(0, 0, 0, 0);\n  if (dttm === 'now' || dttm === 'today' || dttm === 'No filter') {\n    return now;\n  }\n  if (dttm === 'Last week') {\n    now.setUTCDate(now.getUTCDate() - 7);\n    return now;\n  }\n  if (dttm === 'Last month') {\n    now.setUTCMonth(now.getUTCMonth() - 1);\n    now.setUTCDate(1);\n    return now;\n  }\n  if (dttm === 'Last quarter') {\n    now.setUTCMonth(now.getUTCMonth() - 3);\n    now.setUTCDate(1);\n    return now;\n  }\n  if (dttm === 'Last year') {\n    now.setUTCFullYear(now.getUTCFullYear() - 1);\n    now.setUTCDate(1);\n    return now;\n  }\n  if (dttm === 'previous calendar week') {\n    now.setUTCDate(now.getUTCDate() - now.getUTCDay());\n    return now;\n  }\n  if (dttm === 'previous calendar month') {\n    now.setUTCMonth(now.getUTCMonth() - 1, 1);\n    return now;\n  }\n  if (dttm === 'previous calendar year') {\n    now.setUTCFullYear(now.getUTCFullYear() - 1, 0, 1);\n    return now;\n  }\n  if (dttm != null && dttm.includes('ago')) {\n    const parts = dttm.split(' ');\n    const amount = parseInt(parts[0], 10);\n    const unit = parts[1];\n    switch (unit) {\n      case 'day':\n      case 'days':\n        now.setUTCDate(now.getUTCDate() - amount);\n        break;\n      case 'week':\n      case 'weeks':\n        now.setUTCDate(now.getUTCDate() - amount * 7);\n        break;\n      case 'month':\n      case 'months':\n        now.setUTCMonth(now.getUTCMonth() - amount);\n        break;\n      case 'year':\n      case 'years':\n        now.setUTCFullYear(now.getUTCFullYear() - amount);\n        break;\n      default:\n        break;\n    }\n    return now;\n  }\n  const parsed = new Date(dttm);\n  parsed.setUTCHours(0, 0, 0, 0);\n  return parsed;\n};\nexport const getTimeOffset = (timeRangeFilter, shifts, startDate) => {\n  const isCustom = shifts == null ? void 0 : shifts.includes('custom');\n  const isInherit = shifts == null ? void 0 : shifts.includes('inherit');\n  const customStartDate = isCustom && parseDttmToDate(startDate).getTime();\n  const filterStartDate = parseDttmToDate(timeRangeFilter.comparator.split(' : ')[0]).getTime();\n  const filterEndDate = parseDttmToDate(timeRangeFilter.comparator.split(' : ')[1]).getTime();\n  const customShift = customStartDate &&\n  Math.ceil((filterStartDate - customStartDate) / DAY_IN_MS);\n  const inInheritShift = isInherit && Math.ceil((filterEndDate - filterStartDate) / DAY_IN_MS);\n  let newShifts = shifts;\n  if (isCustom) {\n    newShifts = [`${customShift} days ago`];\n  }\n  if (isInherit) {\n    newShifts = [`${inInheritShift} days ago`];\n  }\n  return ensureIsArray(newShifts);\n};;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(DAY_IN_MS, \"DAY_IN_MS\", \"/home/pawank/Documents/dcim/superset/superset-frontend/packages/superset-ui-core/src/time-comparison/getTimeOffset.ts\");reactHotLoader.register(parseDttmToDate, \"parseDttmToDate\", \"/home/pawank/Documents/dcim/superset/superset-frontend/packages/superset-ui-core/src/time-comparison/getTimeOffset.ts\");reactHotLoader.register(getTimeOffset, \"getTimeOffset\", \"/home/pawank/Documents/dcim/superset/superset-frontend/packages/superset-ui-core/src/time-comparison/getTimeOffset.ts\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["ensureIsArray","DAY_IN_MS","parseDttmToDate","dttm","now","Date","setUTCHours","setUTCDate","getUTCDate","setUTCMonth","getUTCMonth","setUTCFullYear","getUTCFullYear","getUTCDay","includes","parts","split","amount","parseInt","unit","parsed","getTimeOffset","timeRangeFilter","shifts","startDate","isCustom","isInherit","customStartDate","getTime","filterStartDate","comparator","filterEndDate","customShift","Math","ceil","inInheritShift","newShifts","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/packages/superset-ui-core/src/time-comparison/getTimeOffset.ts"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ensureIsArray } from '../utils';\n\nconst DAY_IN_MS = 24 * 60 * 60 * 1000;\nexport const parseDttmToDate = (dttm: string): Date => {\n  const now = new Date();\n  now.setUTCHours(0, 0, 0, 0);\n\n  if (dttm === 'now' || dttm === 'today' || dttm === 'No filter') {\n    return now;\n  }\n  if (dttm === 'Last week') {\n    now.setUTCDate(now.getUTCDate() - 7);\n    return now;\n  }\n  if (dttm === 'Last month') {\n    now.setUTCMonth(now.getUTCMonth() - 1);\n    now.setUTCDate(1);\n    return now;\n  }\n  if (dttm === 'Last quarter') {\n    now.setUTCMonth(now.getUTCMonth() - 3);\n    now.setUTCDate(1);\n    return now;\n  }\n  if (dttm === 'Last year') {\n    now.setUTCFullYear(now.getUTCFullYear() - 1);\n    now.setUTCDate(1);\n    return now;\n  }\n  if (dttm === 'previous calendar week') {\n    now.setUTCDate(now.getUTCDate() - now.getUTCDay());\n    return now;\n  }\n  if (dttm === 'previous calendar month') {\n    now.setUTCMonth(now.getUTCMonth() - 1, 1);\n    return now;\n  }\n  if (dttm === 'previous calendar year') {\n    now.setUTCFullYear(now.getUTCFullYear() - 1, 0, 1);\n    return now;\n  }\n  if (dttm?.includes('ago')) {\n    const parts = dttm.split(' ');\n    const amount = parseInt(parts[0], 10);\n    const unit = parts[1];\n\n    switch (unit) {\n      case 'day':\n      case 'days':\n        now.setUTCDate(now.getUTCDate() - amount);\n        break;\n      case 'week':\n      case 'weeks':\n        now.setUTCDate(now.getUTCDate() - amount * 7);\n        break;\n      case 'month':\n      case 'months':\n        now.setUTCMonth(now.getUTCMonth() - amount);\n        break;\n      case 'year':\n      case 'years':\n        now.setUTCFullYear(now.getUTCFullYear() - amount);\n        break;\n      default:\n        break;\n    }\n    return now;\n  }\n  const parsed = new Date(dttm);\n  parsed.setUTCHours(0, 0, 0, 0);\n  return parsed;\n};\n\nexport const getTimeOffset = (\n  timeRangeFilter: any,\n  shifts: string[],\n  startDate: string,\n): string[] => {\n  const isCustom = shifts?.includes('custom');\n  const isInherit = shifts?.includes('inherit');\n  const customStartDate = isCustom && parseDttmToDate(startDate).getTime();\n  const filterStartDate = parseDttmToDate(\n    timeRangeFilter.comparator.split(' : ')[0],\n  ).getTime();\n  const filterEndDate = parseDttmToDate(\n    timeRangeFilter.comparator.split(' : ')[1],\n  ).getTime();\n\n  const customShift =\n    customStartDate &&\n    Math.ceil((filterStartDate - customStartDate) / DAY_IN_MS);\n  const inInheritShift =\n    isInherit && Math.ceil((filterEndDate - filterStartDate) / DAY_IN_MS);\n\n  let newShifts = shifts;\n  if (isCustom) {\n    newShifts = [`${customShift} days ago`];\n  }\n  if (isInherit) {\n    newShifts = [`${inInheritShift} days ago`];\n  }\n  return ensureIsArray(newShifts);\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}