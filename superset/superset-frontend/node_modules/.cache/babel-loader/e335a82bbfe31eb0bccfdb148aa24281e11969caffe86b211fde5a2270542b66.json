{"ast":null,"code":"import _omit from \"lodash/omit\"; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;};\n\nimport { SupersetClient } from '@superset-ui/core';\nconst TEMPORARY_CONTROLS = ['url_params'];\nexport const sanitizeFormData = (formData) => _omit(formData, TEMPORARY_CONTROLS);\nconst assembleEndpoint = (key, tabId) => {\n  let endpoint = 'api/v1/explore/form_data';\n  if (key) {\n    endpoint = endpoint.concat(`/${key}`);\n  }\n  if (tabId) {\n    endpoint = endpoint.concat(`?tab_id=${tabId}`);\n  }\n  return endpoint;\n};\nconst assemblePayload = (datasourceId, datasourceType, formData, chartId) => {\n  const payload = {\n    datasource_id: datasourceId,\n    datasource_type: datasourceType,\n    form_data: JSON.stringify(sanitizeFormData(formData))\n  };\n  if (chartId) {\n    payload.chart_id = chartId;\n  }\n  return payload;\n};\nexport const postFormData = (datasourceId, datasourceType, formData, chartId, tabId) => SupersetClient.post({\n  endpoint: assembleEndpoint(undefined, tabId),\n  jsonPayload: assemblePayload(datasourceId, datasourceType, formData, chartId)\n}).then((r) => r.json.key);\nexport const putFormData = (datasourceId, datasourceType, key, formData, chartId, tabId) => SupersetClient.put({\n  endpoint: assembleEndpoint(key, tabId),\n  jsonPayload: assemblePayload(datasourceId, datasourceType, formData, chartId)\n}).then((r) => r.json.message);;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(TEMPORARY_CONTROLS, \"TEMPORARY_CONTROLS\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/explore/exploreUtils/formData.ts\");reactHotLoader.register(sanitizeFormData, \"sanitizeFormData\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/explore/exploreUtils/formData.ts\");reactHotLoader.register(assembleEndpoint, \"assembleEndpoint\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/explore/exploreUtils/formData.ts\");reactHotLoader.register(assemblePayload, \"assemblePayload\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/explore/exploreUtils/formData.ts\");reactHotLoader.register(postFormData, \"postFormData\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/explore/exploreUtils/formData.ts\");reactHotLoader.register(putFormData, \"putFormData\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/explore/exploreUtils/formData.ts\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["enterModule","reactHotLoaderGlobal","undefined","module","__signature__","default","signature","a","SupersetClient","TEMPORARY_CONTROLS","sanitizeFormData","formData","_omit","assembleEndpoint","key","tabId","endpoint","concat","assemblePayload","datasourceId","datasourceType","chartId","payload","datasource_id","datasource_type","form_data","JSON","stringify","chart_id","postFormData","post","jsonPayload","then","r","json","putFormData","put","message","reactHotLoader","register","leaveModule"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/src/explore/exploreUtils/formData.ts"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { omit } from 'lodash';\nimport { SupersetClient, JsonObject } from '@superset-ui/core';\n\ntype Payload = {\n  datasource_id: number;\n  datasource_type: string;\n  form_data: string;\n  chart_id?: number;\n};\n\nconst TEMPORARY_CONTROLS = ['url_params'];\n\nexport const sanitizeFormData = (formData: JsonObject): JsonObject =>\n  omit(formData, TEMPORARY_CONTROLS);\n\nconst assembleEndpoint = (key?: string, tabId?: string) => {\n  let endpoint = 'api/v1/explore/form_data';\n  if (key) {\n    endpoint = endpoint.concat(`/${key}`);\n  }\n  if (tabId) {\n    endpoint = endpoint.concat(`?tab_id=${tabId}`);\n  }\n  return endpoint;\n};\n\nconst assemblePayload = (\n  datasourceId: number,\n  datasourceType: string,\n  formData: JsonObject,\n  chartId?: number,\n) => {\n  const payload: Payload = {\n    datasource_id: datasourceId,\n    datasource_type: datasourceType,\n    form_data: JSON.stringify(sanitizeFormData(formData)),\n  };\n  if (chartId) {\n    payload.chart_id = chartId;\n  }\n  return payload;\n};\n\nexport const postFormData = (\n  datasourceId: number,\n  datasourceType: string,\n  formData: JsonObject,\n  chartId?: number,\n  tabId?: string,\n): Promise<string> =>\n  SupersetClient.post({\n    endpoint: assembleEndpoint(undefined, tabId),\n    jsonPayload: assemblePayload(\n      datasourceId,\n      datasourceType,\n      formData,\n      chartId,\n    ),\n  }).then(r => r.json.key);\n\nexport const putFormData = (\n  datasourceId: number,\n  datasourceType: string,\n  key: string,\n  formData: JsonObject,\n  chartId?: number,\n  tabId?: string,\n): Promise<string> =>\n  SupersetClient.put({\n    endpoint: assembleEndpoint(key, tabId),\n    jsonPayload: assemblePayload(\n      datasourceId,\n      datasourceType,\n      formData,\n      chartId,\n    ),\n  }).then(r => r.json.message);\n"],"mappings":"iCAAA;;;;;;;;;;;;;;;;;GAAA,kBAAAA,WAAA,UAAAC,oBAAA,mBAAAA,oBAAA,CAAAD,WAAA,GAAAE,SAAA,CAAAF,WAAA,IAAAA,WAAA,CAAAG,MAAA,WAAAC,aAAA,UAAAH,oBAAA,mBAAAA,oBAAA,CAAAI,OAAA,CAAAC,SAAA,aAAAC,CAAA,UAAAA,CAAA;;AAmBA,SAASC,cAAc,QAAoB,mBAAmB;AAS9D,MAAMC,kBAAkB,GAAG,CAAC,YAAY,CAAC;AAEzC,OAAO,MAAMC,gBAAgB,GAAGA,CAACC,QAAoB,KACnDC,KAAA,CAAKD,QAAQ,EAAEF,kBAAkB,CAAC;AAEpC,MAAMI,gBAAgB,GAAGA,CAACC,GAAY,EAAEC,KAAc,KAAI;EACxD,IAAIC,QAAQ,GAAG,0BAA0B;EACzC,IAAIF,GAAG,EAAE;IACPE,QAAQ,GAAGA,QAAQ,CAACC,MAAM,CAAC,IAAIH,GAAG,EAAE,CAAC;;EAEvC,IAAIC,KAAK,EAAE;IACTC,QAAQ,GAAGA,QAAQ,CAACC,MAAM,CAAC,WAAWF,KAAK,EAAE,CAAC;;EAEhD,OAAOC,QAAQ;AACjB,CAAC;AAED,MAAME,eAAe,GAAGA,CACtBC,YAAoB,EACpBC,cAAsB,EACtBT,QAAoB,EACpBU,OAAgB,KACd;EACF,MAAMC,OAAO,GAAY;IACvBC,aAAa,EAAEJ,YAAY;IAC3BK,eAAe,EAAEJ,cAAc;IAC/BK,SAAS,EAAEC,IAAI,CAACC,SAAS,CAACjB,gBAAgB,CAACC,QAAQ,CAAC;GACrD;EACD,IAAIU,OAAO,EAAE;IACXC,OAAO,CAACM,QAAQ,GAAGP,OAAO;;EAE5B,OAAOC,OAAO;AAChB,CAAC;AAED,OAAO,MAAMO,YAAY,GAAGA,CAC1BV,YAAoB,EACpBC,cAAsB,EACtBT,QAAoB,EACpBU,OAAgB,EAChBN,KAAc,KAEdP,cAAc,CAACsB,IAAI,CAAC;EAClBd,QAAQ,EAAEH,gBAAgB,CAACX,SAAS,EAAEa,KAAK,CAAC;EAC5CgB,WAAW,EAAEb,eAAe,CAC1BC,YAAY,EACZC,cAAc,EACdT,QAAQ,EACRU,OAAO;CAEV,CAAC,CAACW,IAAI,CAAC,CAAAC,CAAC,KAAIA,CAAC,CAACC,IAAI,CAACpB,GAAG,CAAC;AAE1B,OAAO,MAAMqB,WAAW,GAAGA,CACzBhB,YAAoB,EACpBC,cAAsB,EACtBN,GAAW,EACXH,QAAoB,EACpBU,OAAgB,EAChBN,KAAc,KAEdP,cAAc,CAAC4B,GAAG,CAAC;EACjBpB,QAAQ,EAAEH,gBAAgB,CAACC,GAAG,EAAEC,KAAK,CAAC;EACtCgB,WAAW,EAAEb,eAAe,CAC1BC,YAAY,EACZC,cAAc,EACdT,QAAQ,EACRU,OAAO;CAEV,CAAC,CAACW,IAAI,CAAC,CAAAC,CAAC,KAAIA,CAAC,CAACC,IAAI,CAACG,OAAO,CAAC,CAAC,mBAAAC,cAAA,UAAArC,oBAAA,mBAAAA,oBAAA,CAAAI,OAAA,GAAAH,SAAA,MAAAoC,cAAA,WAAAA,cAAA,CAAAC,QAAA,CAlEzB9B,kBAAkB,uHAAA6B,cAAA,CAAAC,QAAA,CAEX7B,gBAAgB,qHAAA4B,cAAA,CAAAC,QAAA,CAGvB1B,gBAAgB,qHAAAyB,cAAA,CAAAC,QAAA,CAWhBrB,eAAe,oHAAAoB,cAAA,CAAAC,QAAA,CAiBRV,YAAY,iHAAAS,cAAA,CAAAC,QAAA,CAiBZJ,WAAW,wIAAAK,WAAA,UAAAvC,oBAAA,mBAAAA,oBAAA,CAAAuC,WAAA,GAAAtC,SAAA,CAAAsC,WAAA,IAAAA,WAAA,CAAArC,MAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}