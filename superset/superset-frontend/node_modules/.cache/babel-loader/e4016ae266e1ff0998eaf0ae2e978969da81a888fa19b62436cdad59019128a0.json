{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;};import { project, fp64LowPart } from '@deck.gl/core';\nconst patternVs = \"\\n#ifdef NON_INSTANCED_MODEL\\n  #define FILL_PATTERN_FRAME_ATTRIB fillPatternFrames\\n  #define FILL_PATTERN_SCALE_ATTRIB fillPatternScales\\n  #define FILL_PATTERN_OFFSET_ATTRIB fillPatternOffsets\\n#else\\n  #define FILL_PATTERN_FRAME_ATTRIB instanceFillPatternFrames\\n  #define FILL_PATTERN_SCALE_ATTRIB instanceFillPatternScales\\n  #define FILL_PATTERN_OFFSET_ATTRIB instanceFillPatternOffsets\\n#endif\\n\\nattribute vec4 FILL_PATTERN_FRAME_ATTRIB;\\nattribute float FILL_PATTERN_SCALE_ATTRIB;\\nattribute vec2 FILL_PATTERN_OFFSET_ATTRIB;\\n\\nuniform bool fill_patternEnabled;\\nuniform vec2 fill_patternTextureSize;\\n\\nvarying vec2 fill_uv;\\nvarying vec4 fill_patternBounds;\\nvarying vec4 fill_patternPlacement;\\n\";\nconst patternFs = \"\\nuniform bool fill_patternEnabled;\\nuniform bool fill_patternMask;\\nuniform sampler2D fill_patternTexture;\\nuniform vec2 fill_uvCoordinateOrigin;\\nuniform vec2 fill_uvCoordinateOrigin64Low;\\n\\nvarying vec4 fill_patternBounds;\\nvarying vec4 fill_patternPlacement;\\nvarying vec2 fill_uv;\\n\\nconst float FILL_UV_SCALE = 512.0 / 40000000.0;\\n\";\nconst inject = {\n  'vs:DECKGL_FILTER_GL_POSITION': \"\\n    fill_uv = geometry.position.xy;\\n  \",\n  'vs:DECKGL_FILTER_COLOR': \"\\n    if (fill_patternEnabled) {\\n      fill_patternBounds = FILL_PATTERN_FRAME_ATTRIB / vec4(fill_patternTextureSize, fill_patternTextureSize);\\n      fill_patternPlacement.xy = FILL_PATTERN_OFFSET_ATTRIB;\\n      fill_patternPlacement.zw = FILL_PATTERN_SCALE_ATTRIB * FILL_PATTERN_FRAME_ATTRIB.zw;\\n    }\\n  \",\n  'fs:DECKGL_FILTER_COLOR': \"\\n    if (fill_patternEnabled) {\\n      vec2 scale = FILL_UV_SCALE * fill_patternPlacement.zw;\\n      vec2 patternUV = mod(mod(fill_uvCoordinateOrigin, scale) + fill_uvCoordinateOrigin64Low + fill_uv, scale) / scale;\\n      patternUV = mod(fill_patternPlacement.xy + patternUV, 1.0);\\n\\n      vec2 texCoords = fill_patternBounds.xy + fill_patternBounds.zw * patternUV;\\n\\n      vec4 patternColor = texture2D(fill_patternTexture, texCoords);\\n      color.a *= patternColor.a;\\n      if (!fill_patternMask) {\\n        color.rgb = patternColor.rgb;\\n      }\\n    }\\n  \"\n};\n\nfunction getPatternUniforms(opts, uniforms) {\n  if (!opts) {\n    return {};\n  }\n\n  if ('fillPatternTexture' in opts) {\n    const {\n      fillPatternTexture\n    } = opts;\n    return {\n      fill_patternTexture: fillPatternTexture,\n      fill_patternTextureSize: [fillPatternTexture.width, fillPatternTexture.height]\n    };\n  }\n\n  if ('viewport' in opts) {\n    const {\n      fillPatternMask = true,\n      fillPatternEnabled = true\n    } = opts;\n    const {\n      project_uCommonOrigin: coordinateOriginCommon\n    } = uniforms;\n    const coordinateOriginCommon64Low = [fp64LowPart(coordinateOriginCommon[0]), fp64LowPart(coordinateOriginCommon[1])];\n    return {\n      fill_uvCoordinateOrigin: coordinateOriginCommon.slice(0, 2),\n      fill_uvCoordinateOrigin64Low: coordinateOriginCommon64Low,\n      fill_patternMask: fillPatternMask,\n      fill_patternEnabled: fillPatternEnabled\n    };\n  }\n\n  return {};\n}\n\nexport const patternShaders = {\n  name: 'fill-pattern',\n  vs: patternVs,\n  fs: patternFs,\n  inject,\n  dependencies: [project],\n  getUniforms: getPatternUniforms\n};;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(patternVs, \"patternVs\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/node_modules/@deck.gl/extensions/dist/esm/fill-style/shaders.glsl.js\");reactHotLoader.register(patternFs, \"patternFs\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/node_modules/@deck.gl/extensions/dist/esm/fill-style/shaders.glsl.js\");reactHotLoader.register(inject, \"inject\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/node_modules/@deck.gl/extensions/dist/esm/fill-style/shaders.glsl.js\");reactHotLoader.register(getPatternUniforms, \"getPatternUniforms\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/node_modules/@deck.gl/extensions/dist/esm/fill-style/shaders.glsl.js\");reactHotLoader.register(patternShaders, \"patternShaders\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/node_modules/@deck.gl/extensions/dist/esm/fill-style/shaders.glsl.js\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["project","fp64LowPart","patternVs","patternFs","inject","getPatternUniforms","opts","uniforms","fillPatternTexture","fill_patternTexture","fill_patternTextureSize","width","height","fillPatternMask","fillPatternEnabled","project_uCommonOrigin","coordinateOriginCommon","coordinateOriginCommon64Low","fill_uvCoordinateOrigin","slice","fill_uvCoordinateOrigin64Low","fill_patternMask","fill_patternEnabled","patternShaders","name","vs","fs","dependencies","getUniforms","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["../../../src/fill-style/shaders.glsl.ts"],"sourcesContent":["import {project, fp64LowPart} from '@deck.gl/core';\nimport type {Viewport, _ShaderModule as ShaderModule, ProjectUniforms} from '@deck.gl/core';\n\nimport type {Texture2D} from '@luma.gl/webgl';\n\n/*\n * fill pattern shader module\n */\nconst patternVs = `\n#ifdef NON_INSTANCED_MODEL\n  #define FILL_PATTERN_FRAME_ATTRIB fillPatternFrames\n  #define FILL_PATTERN_SCALE_ATTRIB fillPatternScales\n  #define FILL_PATTERN_OFFSET_ATTRIB fillPatternOffsets\n#else\n  #define FILL_PATTERN_FRAME_ATTRIB instanceFillPatternFrames\n  #define FILL_PATTERN_SCALE_ATTRIB instanceFillPatternScales\n  #define FILL_PATTERN_OFFSET_ATTRIB instanceFillPatternOffsets\n#endif\n\nattribute vec4 FILL_PATTERN_FRAME_ATTRIB;\nattribute float FILL_PATTERN_SCALE_ATTRIB;\nattribute vec2 FILL_PATTERN_OFFSET_ATTRIB;\n\nuniform bool fill_patternEnabled;\nuniform vec2 fill_patternTextureSize;\n\nvarying vec2 fill_uv;\nvarying vec4 fill_patternBounds;\nvarying vec4 fill_patternPlacement;\n`;\n\nconst patternFs = `\nuniform bool fill_patternEnabled;\nuniform bool fill_patternMask;\nuniform sampler2D fill_patternTexture;\nuniform vec2 fill_uvCoordinateOrigin;\nuniform vec2 fill_uvCoordinateOrigin64Low;\n\nvarying vec4 fill_patternBounds;\nvarying vec4 fill_patternPlacement;\nvarying vec2 fill_uv;\n\nconst float FILL_UV_SCALE = 512.0 / 40000000.0;\n`;\n\nconst inject = {\n  'vs:DECKGL_FILTER_GL_POSITION': `\n    fill_uv = geometry.position.xy;\n  `,\n\n  'vs:DECKGL_FILTER_COLOR': `\n    if (fill_patternEnabled) {\n      fill_patternBounds = FILL_PATTERN_FRAME_ATTRIB / vec4(fill_patternTextureSize, fill_patternTextureSize);\n      fill_patternPlacement.xy = FILL_PATTERN_OFFSET_ATTRIB;\n      fill_patternPlacement.zw = FILL_PATTERN_SCALE_ATTRIB * FILL_PATTERN_FRAME_ATTRIB.zw;\n    }\n  `,\n\n  'fs:DECKGL_FILTER_COLOR': `\n    if (fill_patternEnabled) {\n      vec2 scale = FILL_UV_SCALE * fill_patternPlacement.zw;\n      vec2 patternUV = mod(mod(fill_uvCoordinateOrigin, scale) + fill_uvCoordinateOrigin64Low + fill_uv, scale) / scale;\n      patternUV = mod(fill_patternPlacement.xy + patternUV, 1.0);\n\n      vec2 texCoords = fill_patternBounds.xy + fill_patternBounds.zw * patternUV;\n\n      vec4 patternColor = texture2D(fill_patternTexture, texCoords);\n      color.a *= patternColor.a;\n      if (!fill_patternMask) {\n        color.rgb = patternColor.rgb;\n      }\n    }\n  `\n};\n\ntype FillStyleModuleSettings =\n  | {\n      viewport: Viewport;\n      fillPatternEnabled?: boolean;\n      fillPatternMask?: boolean;\n    }\n  | {\n      fillPatternTexture: Texture2D;\n    };\n\n/* eslint-disable camelcase */\nfunction getPatternUniforms(\n  opts: FillStyleModuleSettings | {},\n  uniforms: Record<string, any>\n): Record<string, any> {\n  if (!opts) {\n    return {};\n  }\n  if ('fillPatternTexture' in opts) {\n    const {fillPatternTexture} = opts;\n    return {\n      fill_patternTexture: fillPatternTexture,\n      fill_patternTextureSize: [fillPatternTexture.width, fillPatternTexture.height]\n    };\n  }\n  if ('viewport' in opts) {\n    const {fillPatternMask = true, fillPatternEnabled = true} = opts;\n    const {project_uCommonOrigin: coordinateOriginCommon} = uniforms as ProjectUniforms;\n\n    const coordinateOriginCommon64Low = [\n      fp64LowPart(coordinateOriginCommon[0]),\n      fp64LowPart(coordinateOriginCommon[1])\n    ];\n\n    return {\n      fill_uvCoordinateOrigin: coordinateOriginCommon.slice(0, 2),\n      fill_uvCoordinateOrigin64Low: coordinateOriginCommon64Low,\n      fill_patternMask: fillPatternMask,\n      fill_patternEnabled: fillPatternEnabled\n    };\n  }\n  return {};\n}\n\nexport const patternShaders: ShaderModule<FillStyleModuleSettings> = {\n  name: 'fill-pattern',\n  vs: patternVs,\n  fs: patternFs,\n  inject,\n  dependencies: [project],\n  getUniforms: getPatternUniforms\n};\n"],"mappings":"uSAAA,SAAQA,OAAR,EAAiBC,WAAjB,QAAmC,eAAnC;AAQA,MAAMC,SAAS,ysBAAf;AAuBA,MAAMC,SAAS,wVAAf;AAcA,MAAMC,MAAM,GAAG;EACb,2EADa;EAKb,iVALa;EAab;AAba,CAAf;;AAyCA,SAASC,kBAATA,CACEC,IADF,EAEEC,QAFF,EAGuB;EACrB,IAAI,CAACD,IAAL,EAAW;IACT,OAAO,EAAP;EACD;;EACD,IAAI,wBAAwBA,IAA5B,EAAkC;IAChC,MAAM;MAACE;IAAD,IAAuBF,IAA7B;IACA,OAAO;MACLG,mBAAmB,EAAED,kBADhB;MAELE,uBAAuB,EAAE,CAACF,kBAAkB,CAACG,KAApB,EAA2BH,kBAAkB,CAACI,MAA9C;IAFpB,CAAP;EAID;;EACD,IAAI,cAAcN,IAAlB,EAAwB;IACtB,MAAM;MAACO,eAAe,GAAG,IAAnB;MAAyBC,kBAAkB,GAAG;IAA9C,IAAsDR,IAA5D;IACA,MAAM;MAACS,qBAAqB,EAAEC;IAAxB,IAAkDT,QAAxD;IAEA,MAAMU,2BAA2B,GAAG,CAClChB,WAAW,CAACe,sBAAsB,CAAC,CAAD,CAAvB,CADuB,EAElCf,WAAW,CAACe,sBAAsB,CAAC,CAAD,CAAvB,CAFuB,CAApC;IAKA,OAAO;MACLE,uBAAuB,EAAEF,sBAAsB,CAACG,KAAvB,CAA6B,CAA7B,EAAgC,CAAhC,CADpB;MAELC,4BAA4B,EAAEH,2BAFzB;MAGLI,gBAAgB,EAAER,eAHb;MAILS,mBAAmB,EAAER;IAJhB,CAAP;EAMD;;EACD,OAAO,EAAP;AACD;;AAED,OAAO,MAAMS,cAAqD,GAAG;EACnEC,IAAI,EAAE,cAD6D;EAEnEC,EAAE,EAAEvB,SAF+D;EAGnEwB,EAAE,EAAEvB,SAH+D;EAInEC,MAJmE;EAKnEuB,YAAY,EAAE,CAAC3B,OAAD,CALqD;EAMnE4B,WAAW,EAAEvB;AANsD,CAA9D,oBAAAwB,cAAA,UAAAC,oBAAA,mBAAAA,oBAAA,CAAAC,OAAA,GAAAC,SAAA,MAAAH,cAAA,WAAAA,cAAA,CAAAI,QAAA,CA/GD/B,SAAS,iLAAA2B,cAAA,CAAAI,QAAA,CAuBT9B,SAAS,iLAAA0B,cAAA,CAAAI,QAAA,CAcT7B,MAAM,8KAAAyB,cAAA,CAAAI,QAAA,CAyCH5B,kBAAT,0LAAAwB,cAAA,CAAAI,QAAA,CAiCaV,cAAqD,8MAAAW,WAAA,UAAAJ,oBAAA,mBAAAA,oBAAA,CAAAI,WAAA,GAAAF,SAAA,CAAAE,WAAA,IAAAA,WAAA,CAAAC,MAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}