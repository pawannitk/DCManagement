{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useSelector } from 'react-redux';\nimport { useCallback, useEffect, useState } from 'react';\nimport { URL_PARAMS } from 'src/constants';\nimport { getUrlParam } from 'src/utils/urlUtils';\nimport { useFilters, useNativeFiltersDataMask } from '../nativeFilters/FilterBar/state';\n// eslint-disable-next-line import/prefer-default-export\nexport const useNativeFilters = () => {\n  const [isInitialized, setIsInitialized] = useState(false);\n  const canEdit = useSelector(({ dashboardInfo }) => dashboardInfo.dash_edit_perm);\n  const filters = useFilters();\n  const filterValues = Object.values(filters);\n  const expandFilters = getUrlParam(URL_PARAMS.expandFilters);\n  const [dashboardFiltersOpen, setDashboardFiltersOpen] = useState(expandFilters != null ? expandFilters : !!filterValues.length);\n  const nativeFiltersEnabled = canEdit || !canEdit && filterValues.length !== 0;\n  const requiredFirstFilter = filterValues.filter((filter) => filter.requiredFirst);\n  const dataMask = useNativeFiltersDataMask();\n  const showDashboard = isInitialized ||\n  !nativeFiltersEnabled ||\n  !(nativeFiltersEnabled &&\n  requiredFirstFilter.length &&\n  requiredFirstFilter.find(({ id }) => {var _dataMask$id, _dataMask$id$filterSt;return ((_dataMask$id = dataMask[id]) == null ? void 0 : (_dataMask$id$filterSt = _dataMask$id.filterState) == null ? void 0 : _dataMask$id$filterSt.value) === undefined;}));\n  const toggleDashboardFiltersOpen = useCallback((visible) => {\n    setDashboardFiltersOpen(visible != null ? visible : !dashboardFiltersOpen);\n  }, [dashboardFiltersOpen]);\n  useEffect(() => {\n    if (expandFilters === false ||\n    filterValues.length === 0 && nativeFiltersEnabled) {\n      toggleDashboardFiltersOpen(false);\n    } else\n    {\n      toggleDashboardFiltersOpen(true);\n    }\n  }, [filterValues.length]);\n  useEffect(() => {\n    if (showDashboard) {\n      setIsInitialized(true);\n    }\n  }, [showDashboard]);\n  return {\n    showDashboard,\n    dashboardFiltersOpen,\n    toggleDashboardFiltersOpen,\n    nativeFiltersEnabled\n  };\n};__signature__(useNativeFilters, \"useState{[isInitialized, setIsInitialized](false)}\\nuseSelector{canEdit}\\nuseFilters{filters}\\nuseState{[dashboardFiltersOpen, setDashboardFiltersOpen](expandFilters ?? !!filterValues.length)}\\nuseNativeFiltersDataMask{dataMask}\\nuseCallback{toggleDashboardFiltersOpen}\\nuseEffect{}\\nuseEffect{}\", () => [useSelector, useFilters, useNativeFiltersDataMask]);;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(useNativeFilters, \"useNativeFilters\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/components/DashboardBuilder/state.ts\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["useSelector","useCallback","useEffect","useState","URL_PARAMS","getUrlParam","useFilters","useNativeFiltersDataMask","useNativeFilters","isInitialized","setIsInitialized","canEdit","dashboardInfo","dash_edit_perm","filters","filterValues","Object","values","expandFilters","dashboardFiltersOpen","setDashboardFiltersOpen","length","nativeFiltersEnabled","requiredFirstFilter","filter","requiredFirst","dataMask","showDashboard","find","id","_dataMask$id","_dataMask$id$filterSt","filterState","value","undefined","toggleDashboardFiltersOpen","visible","__signature__","reactHotLoader","reactHotLoaderGlobal","default","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/components/DashboardBuilder/state.ts"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useSelector } from 'react-redux';\nimport { useCallback, useEffect, useState } from 'react';\nimport { URL_PARAMS } from 'src/constants';\nimport { getUrlParam } from 'src/utils/urlUtils';\nimport { RootState } from 'src/dashboard/types';\nimport {\n  useFilters,\n  useNativeFiltersDataMask,\n} from '../nativeFilters/FilterBar/state';\n\n// eslint-disable-next-line import/prefer-default-export\nexport const useNativeFilters = () => {\n  const [isInitialized, setIsInitialized] = useState(false);\n  const canEdit = useSelector<RootState, boolean>(\n    ({ dashboardInfo }) => dashboardInfo.dash_edit_perm,\n  );\n\n  const filters = useFilters();\n  const filterValues = Object.values(filters);\n  const expandFilters = getUrlParam(URL_PARAMS.expandFilters);\n  const [dashboardFiltersOpen, setDashboardFiltersOpen] = useState(\n    expandFilters ?? !!filterValues.length,\n  );\n\n  const nativeFiltersEnabled =\n    canEdit || (!canEdit && filterValues.length !== 0);\n\n  const requiredFirstFilter = filterValues.filter(\n    filter => filter.requiredFirst,\n  );\n  const dataMask = useNativeFiltersDataMask();\n  const showDashboard =\n    isInitialized ||\n    !nativeFiltersEnabled ||\n    !(\n      nativeFiltersEnabled &&\n      requiredFirstFilter.length &&\n      requiredFirstFilter.find(\n        ({ id }) => dataMask[id]?.filterState?.value === undefined,\n      )\n    );\n\n  const toggleDashboardFiltersOpen = useCallback(\n    (visible?: boolean) => {\n      setDashboardFiltersOpen(visible ?? !dashboardFiltersOpen);\n    },\n    [dashboardFiltersOpen],\n  );\n\n  useEffect(() => {\n    if (\n      expandFilters === false ||\n      (filterValues.length === 0 && nativeFiltersEnabled)\n    ) {\n      toggleDashboardFiltersOpen(false);\n    } else {\n      toggleDashboardFiltersOpen(true);\n    }\n  }, [filterValues.length]);\n\n  useEffect(() => {\n    if (showDashboard) {\n      setIsInitialized(true);\n    }\n  }, [showDashboard]);\n\n  return {\n    showDashboard,\n    dashboardFiltersOpen,\n    toggleDashboardFiltersOpen,\n    nativeFiltersEnabled,\n  };\n};\n"],"mappings":"wSAAA;;;;;;;;;;;;;;;;;;AAkBA,SAASA,WAAW,QAAQ,aAAa;AACzC,SAASC,WAAW,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AACxD,SAASC,UAAU,QAAQ,eAAe;AAC1C,SAASC,WAAW,QAAQ,oBAAoB;AAEhD,SACEC,UAAU,EACVC,wBAAwB,QACnB,kCAAkC;AAEzC;AACA,OAAO,MAAMC,gBAAgB,GAAGA,CAAA,KAAK;EACnC,MAAM,CAACC,aAAa,EAAEC,gBAAgB,CAAC,GAAGP,QAAQ,CAAC,KAAK,CAAC;EACzD,MAAMQ,OAAO,GAAGX,WAAW,CACzB,CAAC,EAAEY,aAAa,EAAE,KAAKA,aAAa,CAACC,cAAc,CACpD;EAED,MAAMC,OAAO,GAAGR,UAAU,EAAE;EAC5B,MAAMS,YAAY,GAAGC,MAAM,CAACC,MAAM,CAACH,OAAO,CAAC;EAC3C,MAAMI,aAAa,GAAGb,WAAW,CAACD,UAAU,CAACc,aAAa,CAAC;EAC3D,MAAM,CAACC,oBAAoB,EAAEC,uBAAuB,CAAC,GAAGjB,QAAQ,CAC9De,aAAa,WAAbA,aAAa,GAAI,CAAC,CAACH,YAAY,CAACM,MAAM,CACvC;EAED,MAAMC,oBAAoB,GACxBX,OAAO,IAAK,CAACA,OAAO,IAAII,YAAY,CAACM,MAAM,KAAK,CAAE;EAEpD,MAAME,mBAAmB,GAAGR,YAAY,CAACS,MAAM,CAC7C,CAAAA,MAAM,KAAIA,MAAM,CAACC,aAAa,CAC/B;EACD,MAAMC,QAAQ,GAAGnB,wBAAwB,EAAE;EAC3C,MAAMoB,aAAa,GACjBlB,aAAa;EACb,CAACa,oBAAoB;EACrB,EACEA,oBAAoB;EACpBC,mBAAmB,CAACF,MAAM;EAC1BE,mBAAmB,CAACK,IAAI,CACtB,CAAC,EAAEC,EAAE,EAAE,UAAAC,YAAA,EAAAC,qBAAA,QAAK,EAAAD,YAAA,GAAAJ,QAAQ,CAACG,EAAE,CAAC,sBAAAE,qBAAA,GAAZD,YAAA,CAAcE,WAAW,qBAAzBD,qBAAA,CAA2BE,KAAK,MAAKC,SAAS,GAC3D,CACF;EAEH,MAAMC,0BAA0B,GAAGlC,WAAW,CAC5C,CAACmC,OAAiB,KAAI;IACpBhB,uBAAuB,CAACgB,OAAO,WAAPA,OAAO,GAAI,CAACjB,oBAAoB,CAAC;EAC3D,CAAC,EACD,CAACA,oBAAoB,CAAC,CACvB;EAEDjB,SAAS,CAAC,MAAK;IACb,IACEgB,aAAa,KAAK,KAAK;IACtBH,YAAY,CAACM,MAAM,KAAK,CAAC,IAAIC,oBAAqB,EACnD;MACAa,0BAA0B,CAAC,KAAK,CAAC;KAClC;IAAM;MACLA,0BAA0B,CAAC,IAAI,CAAC;;EAEpC,CAAC,EAAE,CAACpB,YAAY,CAACM,MAAM,CAAC,CAAC;EAEzBnB,SAAS,CAAC,MAAK;IACb,IAAIyB,aAAa,EAAE;MACjBjB,gBAAgB,CAAC,IAAI,CAAC;;EAE1B,CAAC,EAAE,CAACiB,aAAa,CAAC,CAAC;EAEnB,OAAO;IACLA,aAAa;IACbR,oBAAoB;IACpBgB,0BAA0B;IAC1Bb;GACD;AACH,CAAC,CAACe,aAAA,CA7DW7B,gBAAgB,oTAEXR,WAAW,EAIXM,UAAU,EAaTC,wBAAwB,sBAAA+B,cAAA,UAAAC,oBAAA,mBAAAA,oBAAA,CAAAC,OAAA,GAAAN,SAAA,MAAAI,cAAA,WAAAA,cAAA,CAAAG,QAAA,CAnB9BjC,gBAAgB,2JAAAkC,WAAA,UAAAH,oBAAA,mBAAAA,oBAAA,CAAAG,WAAA,GAAAR,SAAA,CAAAQ,WAAA,IAAAA,WAAA,CAAAC,MAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}