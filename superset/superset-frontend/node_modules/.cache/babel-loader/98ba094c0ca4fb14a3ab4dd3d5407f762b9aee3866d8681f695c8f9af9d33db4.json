{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;};import { api } from './queryApi';\nexport const mapQueryResponse = (query) => ({\n  queryId: query.id,\n  id: query.client_id,\n  dbId: query.database.id,\n  db: query.database,\n  executedSql: query.executed_sql,\n  errorMessage: query.error_message,\n  queryLimit: query.limit,\n  ctas: query.select_as_cta,\n  limitingFactor: query.limiting_factor,\n  progress: query.progress,\n  rows: query.rows,\n  schema: query.schema,\n  sql: query.sql,\n  sqlEditorId: query.sql_editor_id,\n  state: query.status,\n  tab: query.tab_name,\n  startDttm: Number(query.start_time),\n  endDttm: Number(query.end_time),\n  tempTable: query.tmp_table_name || '',\n  trackingUrl: query.tracking_url,\n  resultsKey: query.results_key,\n  userId: query.user.id,\n  cached: false,\n  extra: {\n    progress: null\n  },\n  isDataPreview: false,\n  user: query.user\n});\nconst queryHistoryApi = api.injectEndpoints({\n  endpoints: (builder) => ({\n    editorQueries: builder.query({\n      providesTags: ['EditorQueries'],\n      query: ({ editorId, pageIndex = 0, pageSize = 25 }) => ({\n        method: 'GET',\n        endpoint: `/api/v1/query/`,\n        urlParams: {\n          keys: ['none'],\n          columns: [\n          'id',\n          'client_id',\n          'changed_on',\n          'database.id',\n          'database.database_name',\n          'executed_sql',\n          'error_message',\n          'limit',\n          'limiting_factor',\n          'progress',\n          'rows',\n          'select_as_cta',\n          'schema',\n          'sql',\n          'sql_editor_id',\n          'status',\n          'tab_name',\n          'user.first_name',\n          'user.id',\n          'user.last_name',\n          'start_time',\n          'end_time',\n          'tmp_table_name',\n          'tmp_schema_name',\n          'tracking_url',\n          'results_key'],\n\n          order_column: 'start_time',\n          order_direction: 'desc',\n          page: pageIndex,\n          page_size: pageSize,\n          filters: [\n          {\n            col: 'sql_editor_id',\n            opr: 'eq',\n            value: editorId\n          }]\n\n        },\n        headers: { 'Content-Type': 'application/json' },\n        transformResponse: ({ json }) => ({\n          ...json,\n          result: json.result.map(mapQueryResponse)\n        })\n      }),\n      serializeQueryArgs: ({ queryArgs: { editorId } }) => ({ editorId }),\n      // Refetch when the page arg changes\n      forceRefetch({ currentArg, previousArg }) {\n        return currentArg !== previousArg;\n      },\n      merge: (currentCache, newItems) => {\n        currentCache.result.push(...newItems.result);\n      }\n    })\n  })\n});\nexport const { useEditorQueriesQuery } = queryHistoryApi;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(mapQueryResponse, \"mapQueryResponse\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/hooks/apiResources/queries.ts\");reactHotLoader.register(queryHistoryApi, \"queryHistoryApi\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/hooks/apiResources/queries.ts\");reactHotLoader.register(useEditorQueriesQuery, \"useEditorQueriesQuery\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/hooks/apiResources/queries.ts\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["api","mapQueryResponse","query","queryId","id","client_id","dbId","database","db","executedSql","executed_sql","errorMessage","error_message","queryLimit","limit","ctas","select_as_cta","limitingFactor","limiting_factor","progress","rows","schema","sql","sqlEditorId","sql_editor_id","state","status","tab","tab_name","startDttm","Number","start_time","endDttm","end_time","tempTable","tmp_table_name","trackingUrl","tracking_url","resultsKey","results_key","userId","user","cached","extra","isDataPreview","queryHistoryApi","injectEndpoints","endpoints","builder","editorQueries","providesTags","editorId","pageIndex","pageSize","method","endpoint","urlParams","keys","columns","order_column","order_direction","page","page_size","filters","col","opr","value","headers","transformResponse","json","result","map","serializeQueryArgs","queryArgs","forceRefetch","currentArg","previousArg","merge","currentCache","newItems","push","useEditorQueriesQuery","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/src/hooks/apiResources/queries.ts"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport type { Query, QueryResponse } from '@superset-ui/core';\nimport type { JsonResponse } from './queryApi';\nimport { api } from './queryApi';\n\nexport type QueryResult = {\n  count: number;\n  ids: Query['id'][];\n  result: QueryResponse[];\n};\n\nexport type EditorQueriesParams = {\n  editorId: string;\n  pageIndex?: number;\n  pageSize?: number;\n};\n\ninterface ResponseResult {\n  id: Query['queryId'];\n  client_id: Query['id'];\n  database: {\n    id: Query['dbId'];\n    database_name: string;\n  };\n  executed_sql: Query['executedSql'];\n  error_message: Query['errorMessage'];\n  limit: Query['queryLimit'];\n  limiting_factor: Query['limitingFactor'];\n  progress: Query['progress'];\n  rows: Query['rows'];\n  select_as_cta: Query['ctas'];\n  schema: Query['schema'];\n  sql: Query['sql'];\n  sql_editor_id: Query['sqlEditorId'];\n  status: Query['state'];\n  tab_name: Query['tab'];\n  user: {\n    id: Query['userId'];\n  };\n  start_time: string;\n  end_time: string;\n  tmp_table_name: Query['tempTable'] | null;\n  tracking_url: Query['trackingUrl'];\n  results_key: Query['resultsKey'];\n}\n\nexport const mapQueryResponse = (\n  query: ResponseResult,\n): Omit<\n  Query,\n  | 'tempSchema'\n  | 'started'\n  | 'time'\n  | 'duration'\n  | 'templateParams'\n  | 'querylink'\n  | 'output'\n  | 'actions'\n  | 'type'\n  | 'columns'\n> => ({\n  queryId: query.id,\n  id: query.client_id,\n  dbId: query.database.id,\n  db: query.database,\n  executedSql: query.executed_sql,\n  errorMessage: query.error_message,\n  queryLimit: query.limit,\n  ctas: query.select_as_cta,\n  limitingFactor: query.limiting_factor,\n  progress: query.progress,\n  rows: query.rows,\n  schema: query.schema,\n  sql: query.sql,\n  sqlEditorId: query.sql_editor_id,\n  state: query.status,\n  tab: query.tab_name,\n  startDttm: Number(query.start_time),\n  endDttm: Number(query.end_time),\n  tempTable: query.tmp_table_name || '',\n  trackingUrl: query.tracking_url,\n  resultsKey: query.results_key,\n  userId: query.user.id,\n  cached: false,\n  extra: {\n    progress: null,\n  },\n  isDataPreview: false,\n  user: query.user,\n});\n\nconst queryHistoryApi = api.injectEndpoints({\n  endpoints: builder => ({\n    editorQueries: builder.query<QueryResult, EditorQueriesParams>({\n      providesTags: ['EditorQueries'],\n      query: ({ editorId, pageIndex = 0, pageSize = 25 }) => ({\n        method: 'GET',\n        endpoint: `/api/v1/query/`,\n        urlParams: {\n          keys: ['none'],\n          columns: [\n            'id',\n            'client_id',\n            'changed_on',\n            'database.id',\n            'database.database_name',\n            'executed_sql',\n            'error_message',\n            'limit',\n            'limiting_factor',\n            'progress',\n            'rows',\n            'select_as_cta',\n            'schema',\n            'sql',\n            'sql_editor_id',\n            'status',\n            'tab_name',\n            'user.first_name',\n            'user.id',\n            'user.last_name',\n            'start_time',\n            'end_time',\n            'tmp_table_name',\n            'tmp_schema_name',\n            'tracking_url',\n            'results_key',\n          ],\n          order_column: 'start_time',\n          order_direction: 'desc',\n          page: pageIndex,\n          page_size: pageSize,\n          filters: [\n            {\n              col: 'sql_editor_id',\n              opr: 'eq',\n              value: editorId,\n            },\n          ],\n        },\n        headers: { 'Content-Type': 'application/json' },\n        transformResponse: ({ json }: JsonResponse) => ({\n          ...json,\n          result: json.result.map(mapQueryResponse),\n        }),\n      }),\n      serializeQueryArgs: ({ queryArgs: { editorId } }) => ({ editorId }),\n      // Refetch when the page arg changes\n      forceRefetch({ currentArg, previousArg }) {\n        return currentArg !== previousArg;\n      },\n      merge: (currentCache, newItems) => {\n        currentCache.result.push(...newItems.result);\n      },\n    }),\n  }),\n});\n\nexport const { useEditorQueriesQuery } = queryHistoryApi;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}