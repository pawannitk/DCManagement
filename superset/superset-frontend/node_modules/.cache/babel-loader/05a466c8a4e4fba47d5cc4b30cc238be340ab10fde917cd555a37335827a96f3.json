{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport PropTypes from 'prop-types';\nimport { extent as d3Extent, range as d3Range } from 'd3-array';\nimport { select as d3Select } from 'd3-selection';\nimport { getSequentialSchemeRegistry, t } from '@superset-ui/core';\nimport CalHeatMap from './vendor/cal-heatmap';\n\nconst propTypes = {\n  data: PropTypes.shape({\n    // Object hashed by metric name,\n    // then hashed by timestamp (in seconds, not milliseconds) as float\n    // the innermost value is count\n    // e.g. { count_distinct_something: { 1535034236.0: 3 } }\n    data: PropTypes.object,\n    domain: PropTypes.string,\n    range: PropTypes.number,\n    // timestamp in milliseconds\n    start: PropTypes.number,\n    subdomain: PropTypes.string\n  }),\n  height: PropTypes.number,\n  // eslint-disable-next-line react/sort-prop-types\n  cellPadding: PropTypes.number,\n  // eslint-disable-next-line react/sort-prop-types\n  cellRadius: PropTypes.number,\n  // eslint-disable-next-line react/sort-prop-types\n  cellSize: PropTypes.number,\n  linearColorScheme: PropTypes.string,\n  showLegend: PropTypes.bool,\n  showMetricName: PropTypes.bool,\n  showValues: PropTypes.bool,\n  steps: PropTypes.number,\n  timeFormatter: PropTypes.func,\n  valueFormatter: PropTypes.func,\n  verboseMap: PropTypes.object,\n  theme: PropTypes.object\n};\n\nfunction Calendar(element, props) {\n  const {\n    data,\n    height,\n    cellPadding = 3,\n    cellRadius = 0,\n    cellSize = 10,\n    domainGranularity,\n    linearColorScheme,\n    showLegend,\n    showMetricName,\n    showValues,\n    steps,\n    subdomainGranularity,\n    timeFormatter,\n    valueFormatter,\n    verboseMap,\n    theme\n  } = props;\n\n  const container = d3Select(element).\n  classed('superset-legacy-chart-calendar', true).\n  style('height', height);\n  container.selectAll('*').remove();\n  const div = container.append('div');\n\n  const subDomainTextFormat = showValues ?\n  (date, value) => valueFormatter(value) :\n  null;\n\n  const metricsData = data.data;\n\n  const METRIC_TEXT = t('Metric');\n\n  Object.keys(metricsData).forEach((metric) => {\n    const calContainer = div.append('div');\n    if (showMetricName) {\n      calContainer.text(`${METRIC_TEXT}: ${verboseMap[metric] || metric}`);\n    }\n    const timestamps = metricsData[metric];\n    const extents = d3Extent(Object.keys(timestamps), (key) => timestamps[key]);\n    const step = (extents[1] - extents[0]) / (steps - 1);\n    const colorScale = getSequentialSchemeRegistry().\n    get(linearColorScheme).\n    createLinearScale(extents);\n\n    const legend = d3Range(steps).map((i) => extents[0] + step * i);\n    const legendColors = legend.map((x) => colorScale(x));\n\n    const cal = new CalHeatMap();\n    cal.init({\n      start: data.start,\n      data: timestamps,\n      itemSelector: calContainer.node(),\n      legendVerticalPosition: 'top',\n      cellSize,\n      cellPadding,\n      cellRadius,\n      legendCellSize: cellSize,\n      legendCellPadding: 2,\n      legendCellRadius: cellRadius,\n      tooltip: true,\n      domain: domainGranularity,\n      subDomain: subdomainGranularity,\n      range: data.range,\n      browsing: true,\n      legend,\n      legendColors: {\n        colorScale,\n        min: legendColors[0],\n        max: legendColors[legendColors.length - 1],\n        empty: theme.colors.grayscale.light5\n      },\n      displayLegend: showLegend,\n      itemName: '',\n      valueFormatter,\n      timeFormatter,\n      subDomainTextFormat\n    });\n  });\n}\n\nCalendar.displayName = 'Calendar';\nCalendar.propTypes = propTypes;const _default =\n\nCalendar;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(propTypes, \"propTypes\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-plugin-chart-calendar/src/Calendar.js\");reactHotLoader.register(Calendar, \"Calendar\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-plugin-chart-calendar/src/Calendar.js\");reactHotLoader.register(_default, \"default\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-plugin-chart-calendar/src/Calendar.js\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["PropTypes","extent","d3Extent","range","d3Range","select","d3Select","getSequentialSchemeRegistry","t","CalHeatMap","propTypes","data","shape","object","domain","string","number","start","subdomain","height","cellPadding","cellRadius","cellSize","linearColorScheme","showLegend","bool","showMetricName","showValues","steps","timeFormatter","func","valueFormatter","verboseMap","theme","Calendar","element","props","domainGranularity","subdomainGranularity","container","classed","style","selectAll","remove","div","append","subDomainTextFormat","date","value","metricsData","METRIC_TEXT","Object","keys","forEach","metric","calContainer","text","timestamps","extents","key","step","colorScale","get","createLinearScale","legend","map","i","legendColors","x","cal","init","itemSelector","node","legendVerticalPosition","legendCellSize","legendCellPadding","legendCellRadius","tooltip","subDomain","browsing","min","max","length","empty","colors","grayscale","light5","displayLegend","itemName","displayName","_default","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-plugin-chart-calendar/src/Calendar.js"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport PropTypes from 'prop-types';\nimport { extent as d3Extent, range as d3Range } from 'd3-array';\nimport { select as d3Select } from 'd3-selection';\nimport { getSequentialSchemeRegistry, t } from '@superset-ui/core';\nimport CalHeatMap from './vendor/cal-heatmap';\n\nconst propTypes = {\n  data: PropTypes.shape({\n    // Object hashed by metric name,\n    // then hashed by timestamp (in seconds, not milliseconds) as float\n    // the innermost value is count\n    // e.g. { count_distinct_something: { 1535034236.0: 3 } }\n    data: PropTypes.object,\n    domain: PropTypes.string,\n    range: PropTypes.number,\n    // timestamp in milliseconds\n    start: PropTypes.number,\n    subdomain: PropTypes.string,\n  }),\n  height: PropTypes.number,\n  // eslint-disable-next-line react/sort-prop-types\n  cellPadding: PropTypes.number,\n  // eslint-disable-next-line react/sort-prop-types\n  cellRadius: PropTypes.number,\n  // eslint-disable-next-line react/sort-prop-types\n  cellSize: PropTypes.number,\n  linearColorScheme: PropTypes.string,\n  showLegend: PropTypes.bool,\n  showMetricName: PropTypes.bool,\n  showValues: PropTypes.bool,\n  steps: PropTypes.number,\n  timeFormatter: PropTypes.func,\n  valueFormatter: PropTypes.func,\n  verboseMap: PropTypes.object,\n  theme: PropTypes.object,\n};\n\nfunction Calendar(element, props) {\n  const {\n    data,\n    height,\n    cellPadding = 3,\n    cellRadius = 0,\n    cellSize = 10,\n    domainGranularity,\n    linearColorScheme,\n    showLegend,\n    showMetricName,\n    showValues,\n    steps,\n    subdomainGranularity,\n    timeFormatter,\n    valueFormatter,\n    verboseMap,\n    theme,\n  } = props;\n\n  const container = d3Select(element)\n    .classed('superset-legacy-chart-calendar', true)\n    .style('height', height);\n  container.selectAll('*').remove();\n  const div = container.append('div');\n\n  const subDomainTextFormat = showValues\n    ? (date, value) => valueFormatter(value)\n    : null;\n\n  const metricsData = data.data;\n\n  const METRIC_TEXT = t('Metric');\n\n  Object.keys(metricsData).forEach(metric => {\n    const calContainer = div.append('div');\n    if (showMetricName) {\n      calContainer.text(`${METRIC_TEXT}: ${verboseMap[metric] || metric}`);\n    }\n    const timestamps = metricsData[metric];\n    const extents = d3Extent(Object.keys(timestamps), key => timestamps[key]);\n    const step = (extents[1] - extents[0]) / (steps - 1);\n    const colorScale = getSequentialSchemeRegistry()\n      .get(linearColorScheme)\n      .createLinearScale(extents);\n\n    const legend = d3Range(steps).map(i => extents[0] + step * i);\n    const legendColors = legend.map(x => colorScale(x));\n\n    const cal = new CalHeatMap();\n    cal.init({\n      start: data.start,\n      data: timestamps,\n      itemSelector: calContainer.node(),\n      legendVerticalPosition: 'top',\n      cellSize,\n      cellPadding,\n      cellRadius,\n      legendCellSize: cellSize,\n      legendCellPadding: 2,\n      legendCellRadius: cellRadius,\n      tooltip: true,\n      domain: domainGranularity,\n      subDomain: subdomainGranularity,\n      range: data.range,\n      browsing: true,\n      legend,\n      legendColors: {\n        colorScale,\n        min: legendColors[0],\n        max: legendColors[legendColors.length - 1],\n        empty: theme.colors.grayscale.light5,\n      },\n      displayLegend: showLegend,\n      itemName: '',\n      valueFormatter,\n      timeFormatter,\n      subDomainTextFormat,\n    });\n  });\n}\n\nCalendar.displayName = 'Calendar';\nCalendar.propTypes = propTypes;\n\nexport default Calendar;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}