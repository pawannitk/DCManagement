{"ast":null,"code":"import _isEmpty from \"lodash/isEmpty\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint camelcase: 0 */\nimport { t, SupersetClient } from '@superset-ui/core';\nimport rison from 'rison';\nimport {\n  addDangerToast,\n  addSuccessToast } from\n'src/components/MessageToasts/actions';\n\n\nexport const SET_REPORT = 'SET_REPORT';\nexport function setReport(report, resourceId, creationMethod, filterField) {\n  return { type: SET_REPORT, report, resourceId, creationMethod, filterField };\n}\n\nexport function fetchUISpecificReport({\n  userId,\n  filterField,\n  creationMethod,\n  resourceId\n}) {\n  const queryParams = rison.encode({\n    filters: [\n    {\n      col: filterField,\n      opr: 'eq',\n      value: resourceId\n    },\n    {\n      col: 'creation_method',\n      opr: 'eq',\n      value: creationMethod\n    },\n    {\n      col: 'created_by',\n      opr: 'rel_o_m',\n      value: userId\n    }]\n\n  });\n  return function fetchUISpecificReportThunk(dispatch) {\n    return SupersetClient.get({\n      endpoint: `/api/v1/report/?q=${queryParams}`\n    }).\n    then(({ json }) => {\n      dispatch(setReport(json, resourceId, creationMethod, filterField));\n    }).\n    catch(() =>\n    dispatch(\n      addDangerToast(\n        t(\n          'There was an issue fetching reports attached to this dashboard.'\n        )\n      )\n    )\n    );\n  };\n}\n\nconst structureFetchAction = (dispatch, getState) => {\n  const state = getState();\n  const { user, dashboardInfo, charts, explore } = state;\n  if (!_isEmpty(dashboardInfo)) {\n    dispatch(\n      fetchUISpecificReport({\n        userId: user.userId,\n        filterField: 'dashboard_id',\n        creationMethod: 'dashboards',\n        resourceId: dashboardInfo.id\n      })\n    );\n  } else {var _explore$user;\n    const [chartArr] = Object.keys(charts);\n    dispatch(\n      fetchUISpecificReport({\n        userId: ((_explore$user = explore.user) == null ? void 0 : _explore$user.userId) || (user == null ? void 0 : user.userId),\n        filterField: 'chart_id',\n        creationMethod: 'charts',\n        resourceId: charts[chartArr].id\n      })\n    );\n  }\n};\n\nexport const ADD_REPORT = 'ADD_REPORT';\n\nexport const addReport = (report) => (dispatch) =>\nSupersetClient.post({\n  endpoint: `/api/v1/report/`,\n  jsonPayload: report\n}).then(({ json }) => {\n  dispatch({ type: ADD_REPORT, json });\n  dispatch(addSuccessToast(t('The report has been created')));\n});\n\nexport const EDIT_REPORT = 'EDIT_REPORT';\n\nexport const editReport = (id, report) => (dispatch) =>\nSupersetClient.put({\n  endpoint: `/api/v1/report/${id}`,\n  jsonPayload: report\n}).then(({ json }) => {\n  dispatch({ type: EDIT_REPORT, json });\n  dispatch(addSuccessToast(t('Report updated')));\n});\n\nexport function toggleActive(report, isActive) {\n  return function toggleActiveThunk(dispatch) {\n    return SupersetClient.put({\n      endpoint: encodeURI(`/api/v1/report/${report.id}`),\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        active: isActive\n      })\n    }).\n    catch(() => {\n      dispatch(\n        addDangerToast(\n          t('We were unable to active or deactivate this report.')\n        )\n      );\n    }).\n    finally(() => {\n      dispatch(structureFetchAction);\n    });\n  };\n}\n\nexport const DELETE_REPORT = 'DELETE_REPORT';\n\nexport function deleteActiveReport(report) {\n  return function deleteActiveReportThunk(dispatch) {\n    return SupersetClient.delete({\n      endpoint: encodeURI(`/api/v1/report/${report.id}`)\n    }).\n    catch(() => {\n      dispatch(addDangerToast(t('Your report could not be deleted')));\n    }).\n    finally(() => {\n      dispatch({ type: DELETE_REPORT, report });\n      dispatch(addSuccessToast(t('Deleted: %s', report.name)));\n    });\n  };\n};(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(SET_REPORT, \"SET_REPORT\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/reports/ReportModal/actions.js\");reactHotLoader.register(setReport, \"setReport\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/reports/ReportModal/actions.js\");reactHotLoader.register(fetchUISpecificReport, \"fetchUISpecificReport\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/reports/ReportModal/actions.js\");reactHotLoader.register(structureFetchAction, \"structureFetchAction\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/reports/ReportModal/actions.js\");reactHotLoader.register(ADD_REPORT, \"ADD_REPORT\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/reports/ReportModal/actions.js\");reactHotLoader.register(addReport, \"addReport\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/reports/ReportModal/actions.js\");reactHotLoader.register(EDIT_REPORT, \"EDIT_REPORT\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/reports/ReportModal/actions.js\");reactHotLoader.register(editReport, \"editReport\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/reports/ReportModal/actions.js\");reactHotLoader.register(toggleActive, \"toggleActive\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/reports/ReportModal/actions.js\");reactHotLoader.register(DELETE_REPORT, \"DELETE_REPORT\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/reports/ReportModal/actions.js\");reactHotLoader.register(deleteActiveReport, \"deleteActiveReport\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/reports/ReportModal/actions.js\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["t","SupersetClient","rison","addDangerToast","addSuccessToast","SET_REPORT","setReport","report","resourceId","creationMethod","filterField","type","fetchUISpecificReport","userId","queryParams","encode","filters","col","opr","value","fetchUISpecificReportThunk","dispatch","get","endpoint","then","json","catch","structureFetchAction","getState","state","user","dashboardInfo","charts","explore","_isEmpty","id","_explore$user","chartArr","Object","keys","ADD_REPORT","addReport","post","jsonPayload","EDIT_REPORT","editReport","put","toggleActive","isActive","toggleActiveThunk","encodeURI","headers","body","JSON","stringify","active","finally","DELETE_REPORT","deleteActiveReport","deleteActiveReportThunk","delete","name","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/src/features/reports/ReportModal/actions.js"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint camelcase: 0 */\nimport { t, SupersetClient } from '@superset-ui/core';\nimport rison from 'rison';\nimport {\n  addDangerToast,\n  addSuccessToast,\n} from 'src/components/MessageToasts/actions';\nimport { isEmpty } from 'lodash';\n\nexport const SET_REPORT = 'SET_REPORT';\nexport function setReport(report, resourceId, creationMethod, filterField) {\n  return { type: SET_REPORT, report, resourceId, creationMethod, filterField };\n}\n\nexport function fetchUISpecificReport({\n  userId,\n  filterField,\n  creationMethod,\n  resourceId,\n}) {\n  const queryParams = rison.encode({\n    filters: [\n      {\n        col: filterField,\n        opr: 'eq',\n        value: resourceId,\n      },\n      {\n        col: 'creation_method',\n        opr: 'eq',\n        value: creationMethod,\n      },\n      {\n        col: 'created_by',\n        opr: 'rel_o_m',\n        value: userId,\n      },\n    ],\n  });\n  return function fetchUISpecificReportThunk(dispatch) {\n    return SupersetClient.get({\n      endpoint: `/api/v1/report/?q=${queryParams}`,\n    })\n      .then(({ json }) => {\n        dispatch(setReport(json, resourceId, creationMethod, filterField));\n      })\n      .catch(() =>\n        dispatch(\n          addDangerToast(\n            t(\n              'There was an issue fetching reports attached to this dashboard.',\n            ),\n          ),\n        ),\n      );\n  };\n}\n\nconst structureFetchAction = (dispatch, getState) => {\n  const state = getState();\n  const { user, dashboardInfo, charts, explore } = state;\n  if (!isEmpty(dashboardInfo)) {\n    dispatch(\n      fetchUISpecificReport({\n        userId: user.userId,\n        filterField: 'dashboard_id',\n        creationMethod: 'dashboards',\n        resourceId: dashboardInfo.id,\n      }),\n    );\n  } else {\n    const [chartArr] = Object.keys(charts);\n    dispatch(\n      fetchUISpecificReport({\n        userId: explore.user?.userId || user?.userId,\n        filterField: 'chart_id',\n        creationMethod: 'charts',\n        resourceId: charts[chartArr].id,\n      }),\n    );\n  }\n};\n\nexport const ADD_REPORT = 'ADD_REPORT';\n\nexport const addReport = report => dispatch =>\n  SupersetClient.post({\n    endpoint: `/api/v1/report/`,\n    jsonPayload: report,\n  }).then(({ json }) => {\n    dispatch({ type: ADD_REPORT, json });\n    dispatch(addSuccessToast(t('The report has been created')));\n  });\n\nexport const EDIT_REPORT = 'EDIT_REPORT';\n\nexport const editReport = (id, report) => dispatch =>\n  SupersetClient.put({\n    endpoint: `/api/v1/report/${id}`,\n    jsonPayload: report,\n  }).then(({ json }) => {\n    dispatch({ type: EDIT_REPORT, json });\n    dispatch(addSuccessToast(t('Report updated')));\n  });\n\nexport function toggleActive(report, isActive) {\n  return function toggleActiveThunk(dispatch) {\n    return SupersetClient.put({\n      endpoint: encodeURI(`/api/v1/report/${report.id}`),\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        active: isActive,\n      }),\n    })\n      .catch(() => {\n        dispatch(\n          addDangerToast(\n            t('We were unable to active or deactivate this report.'),\n          ),\n        );\n      })\n      .finally(() => {\n        dispatch(structureFetchAction);\n      });\n  };\n}\n\nexport const DELETE_REPORT = 'DELETE_REPORT';\n\nexport function deleteActiveReport(report) {\n  return function deleteActiveReportThunk(dispatch) {\n    return SupersetClient.delete({\n      endpoint: encodeURI(`/api/v1/report/${report.id}`),\n    })\n      .catch(() => {\n        dispatch(addDangerToast(t('Your report could not be deleted')));\n      })\n      .finally(() => {\n        dispatch({ type: DELETE_REPORT, report });\n        dispatch(addSuccessToast(t('Deleted: %s', report.name)));\n      });\n  };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}