{"ast":null,"code":"import { css as _css } from \"@emotion/react\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint camelcase: 0 */\nimport React from 'react';\nimport rison from 'rison';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\nimport { InfoTooltipWithTrigger } from '@superset-ui/chart-controls';\nimport { css, DatasourceType, isDefined, styled, SupersetClient, t } from '@superset-ui/core';\nimport { Input } from 'src/components/Input';\nimport { Form, FormItem } from 'src/components/Form';\nimport Alert from 'src/components/Alert';\nimport Modal from 'src/components/Modal';\nimport { Radio } from 'src/components/Radio';\nimport Button from 'src/components/Button';\nimport { AsyncSelect } from 'src/components';\nimport Loading from 'src/components/Loading';\nimport { canUserEditDashboard } from 'src/dashboard/util/permissionUtils';\nimport { setSaveChartModalVisibility } from 'src/explore/actions/saveModalActions';\n// Session storage key for recent dashboard\nimport { jsx as ___EmotionJSX } from \"@emotion/react\";const SK_DASHBOARD_ID = 'save_chart_recent_dashboard';\nexport const StyledModal = styled(Modal)`\n  .ant-modal-body {\n    overflow: visible;\n  }\n  i {\n    position: absolute;\n    top: -${({ theme }) => theme.gridUnit * 5.25}px;\n    left: ${({ theme }) => theme.gridUnit * 26.75}px;\n  }\n`;\nclass SaveModal extends React.Component {\n  constructor(props) {var _props$datasource;\n    super(props);this.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    handleDatasetNameChange = (e) => {\n      // @ts-expect-error\n      this.setState({ datasetName: e.target.value });\n    };this.\n\n\n\n\n\n\n\n\n\n\n\n\n    handleRedirect = (windowLocationSearch, chart) => {\n      const searchParams = new URLSearchParams(windowLocationSearch);\n      searchParams.set('save_action', this.state.action);\n      if (this.state.action !== 'overwrite') {\n        searchParams.delete('form_data_key');\n      }\n      searchParams.set('slice_id', chart.id.toString());\n      return searchParams;\n    };this.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    loadDashboard = async (id) => {\n      const response = await SupersetClient.get({\n        endpoint: `/api/v1/dashboard/${id}`\n      });\n      return response.json.result;\n    };this.\n    loadDashboards = async (search, page, pageSize) => {\n      const queryParams = rison.encode({\n        columns: ['id', 'dashboard_title'],\n        filters: [\n        {\n          col: 'dashboard_title',\n          opr: 'ct',\n          value: search\n        },\n        {\n          col: 'owners',\n          opr: 'rel_m_m',\n          value: this.props.user.userId\n        }],\n\n        page,\n        page_size: pageSize,\n        order_column: 'dashboard_title'\n      });\n      const { json } = await SupersetClient.get({\n        endpoint: `/api/v1/dashboard/?q=${queryParams}`\n      });\n      const { result, count } = json;\n      return {\n        data: result.map((dashboard) => ({\n          value: dashboard.id,\n          label: dashboard.dashboard_title\n        })),\n        totalCount: count\n      };\n    };this.\n    renderSaveChartModal = () => {var _this$props$datasourc;\n      const info = this.info();\n      return ___EmotionJSX(Form, { \"data-test\": \"save-modal-body\", layout: \"vertical\" },\n      ___EmotionJSX(FormItem, { \"data-test\": \"radio-group\" },\n      ___EmotionJSX(Radio, { id: \"overwrite-radio\", disabled: !this.canOverwriteSlice(), checked: this.state.action === 'overwrite', onChange: () => this.changeAction('overwrite'), \"data-test\": \"save-overwrite-radio\" },\n      t('Save (Overwrite)')\n      ),\n      ___EmotionJSX(Radio, { id: \"saveas-radio\", \"data-test\": \"saveas-radio\", checked: this.state.action === 'saveas', onChange: () => this.changeAction('saveas') },\n      t('Save as...')\n      )\n      ),\n      ___EmotionJSX(\"hr\", null),\n      ___EmotionJSX(FormItem, { label: t('Chart name'), required: true },\n      ___EmotionJSX(Input, { name: \"new_slice_name\", type: \"text\", placeholder: \"Name\", value: this.state.newSliceName, onChange: this.onSliceNameChange, \"data-test\": \"new-chart-name\" })\n      ),\n      ((_this$props$datasourc = this.props.datasource) == null ? void 0 : _this$props$datasourc.type) === 'query' && ___EmotionJSX(FormItem, { label: t('Dataset Name'), required: true },\n      ___EmotionJSX(InfoTooltipWithTrigger, { tooltip: t('A reusable dataset will be saved with your chart.'), placement: \"right\" }),\n      ___EmotionJSX(Input, { name: \"dataset_name\", type: \"text\", placeholder: \"Dataset Name\", value: this.state.datasetName, onChange: this.handleDatasetNameChange, \"data-test\": \"new-dataset-name\" })\n      ),\n      ___EmotionJSX(FormItem, { label: t('Add to dashboard'), \"data-test\": \"save-chart-modal-select-dashboard-form\" },\n      ___EmotionJSX(AsyncSelect, { allowClear: true, allowNewOptions: true, ariaLabel: t('Select a dashboard'), options: this.loadDashboards, onChange: this.onDashboardChange, value: this.state.dashboard, placeholder: ___EmotionJSX(\"div\", null,\n        ___EmotionJSX(\"b\", null, t('Select')),\n        t(' a dashboard OR '),\n        ___EmotionJSX(\"b\", null, t('create')),\n        t(' a new one')\n        ) })\n      ),\n      info && ___EmotionJSX(Alert, { type: \"info\", message: info, closable: false }),\n      this.props.alert && ___EmotionJSX(Alert, { css: /*#__PURE__*/_css({ marginTop: info ? 16 : undefined }, process.env.NODE_ENV === \"production\" ? \"\" : \";label:SaveModal;\", process.env.NODE_ENV === \"production\" ? \"\" : \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3Bhd2Fuay9Eb2N1bWVudHMvZGNpbS9zdXBlcnNldC9zdXBlcnNldC1mcm9udGVuZC9zcmMvZXhwbG9yZS9jb21wb25lbnRzL1NhdmVNb2RhbC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBbVJxQyIsImZpbGUiOiIvaG9tZS9wYXdhbmsvRG9jdW1lbnRzL2RjaW0vc3VwZXJzZXQvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL2V4cGxvcmUvY29tcG9uZW50cy9TYXZlTW9kYWwudHN4Iiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lXG4gKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGVcbiAqIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uXG4gKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlXG4gKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlXG4gKiBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2VcbiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZyxcbiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuXG4gKiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxuICogS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlXG4gKiBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zXG4gKiB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyogZXNsaW50IGNhbWVsY2FzZTogMCAqL1xuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCByaXNvbiBmcm9tICdyaXNvbic7XG5pbXBvcnQgeyBjb25uZWN0IH0gZnJvbSAncmVhY3QtcmVkdXgnO1xuaW1wb3J0IHsgd2l0aFJvdXRlciB9IGZyb20gJ3JlYWN0LXJvdXRlci1kb20nO1xuaW1wb3J0IHsgSW5mb1Rvb2x0aXBXaXRoVHJpZ2dlciB9IGZyb20gJ0BzdXBlcnNldC11aS9jaGFydC1jb250cm9scyc7XG5pbXBvcnQgeyBjc3MsIERhdGFzb3VyY2VUeXBlLCBpc0RlZmluZWQsIHN0eWxlZCwgU3VwZXJzZXRDbGllbnQsIHQsIH0gZnJvbSAnQHN1cGVyc2V0LXVpL2NvcmUnO1xuaW1wb3J0IHsgSW5wdXQgfSBmcm9tICdzcmMvY29tcG9uZW50cy9JbnB1dCc7XG5pbXBvcnQgeyBGb3JtLCBGb3JtSXRlbSB9IGZyb20gJ3NyYy9jb21wb25lbnRzL0Zvcm0nO1xuaW1wb3J0IEFsZXJ0IGZyb20gJ3NyYy9jb21wb25lbnRzL0FsZXJ0JztcbmltcG9ydCBNb2RhbCBmcm9tICdzcmMvY29tcG9uZW50cy9Nb2RhbCc7XG5pbXBvcnQgeyBSYWRpbyB9IGZyb20gJ3NyYy9jb21wb25lbnRzL1JhZGlvJztcbmltcG9ydCBCdXR0b24gZnJvbSAnc3JjL2NvbXBvbmVudHMvQnV0dG9uJztcbmltcG9ydCB7IEFzeW5jU2VsZWN0IH0gZnJvbSAnc3JjL2NvbXBvbmVudHMnO1xuaW1wb3J0IExvYWRpbmcgZnJvbSAnc3JjL2NvbXBvbmVudHMvTG9hZGluZyc7XG5pbXBvcnQgeyBjYW5Vc2VyRWRpdERhc2hib2FyZCB9IGZyb20gJ3NyYy9kYXNoYm9hcmQvdXRpbC9wZXJtaXNzaW9uVXRpbHMnO1xuaW1wb3J0IHsgc2V0U2F2ZUNoYXJ0TW9kYWxWaXNpYmlsaXR5IH0gZnJvbSAnc3JjL2V4cGxvcmUvYWN0aW9ucy9zYXZlTW9kYWxBY3Rpb25zJztcbi8vIFNlc3Npb24gc3RvcmFnZSBrZXkgZm9yIHJlY2VudCBkYXNoYm9hcmRcbmNvbnN0IFNLX0RBU0hCT0FSRF9JRCA9ICdzYXZlX2NoYXJ0X3JlY2VudF9kYXNoYm9hcmQnO1xuZXhwb3J0IGNvbnN0IFN0eWxlZE1vZGFsID0gc3R5bGVkKE1vZGFsKSBgXG4gIC5hbnQtbW9kYWwtYm9keSB7XG4gICAgb3ZlcmZsb3c6IHZpc2libGU7XG4gIH1cbiAgaSB7XG4gICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgIHRvcDogLSR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiA1LjI1fXB4O1xuICAgIGxlZnQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiAyNi43NX1weDtcbiAgfVxuYDtcbmNsYXNzIFNhdmVNb2RhbCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgbmV3U2xpY2VOYW1lOiBwcm9wcy5zbGljZU5hbWUsXG4gICAgICAgICAgICBkYXRhc2V0TmFtZTogcHJvcHMuZGF0YXNvdXJjZT8ubmFtZSxcbiAgICAgICAgICAgIGFjdGlvbjogdGhpcy5jYW5PdmVyd3JpdGVTbGljZSgpID8gJ292ZXJ3cml0ZScgOiAnc2F2ZWFzJyxcbiAgICAgICAgICAgIGlzTG9hZGluZzogZmFsc2UsXG4gICAgICAgICAgICBkYXNoYm9hcmQ6IHVuZGVmaW5lZCxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5vbkRhc2hib2FyZENoYW5nZSA9IHRoaXMub25EYXNoYm9hcmRDaGFuZ2UuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5vblNsaWNlTmFtZUNoYW5nZSA9IHRoaXMub25TbGljZU5hbWVDaGFuZ2UuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5jaGFuZ2VBY3Rpb24gPSB0aGlzLmNoYW5nZUFjdGlvbi5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLnNhdmVPck92ZXJ3cml0ZSA9IHRoaXMuc2F2ZU9yT3ZlcndyaXRlLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuaXNOZXdEYXNoYm9hcmQgPSB0aGlzLmlzTmV3RGFzaGJvYXJkLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMub25IaWRlID0gdGhpcy5vbkhpZGUuYmluZCh0aGlzKTtcbiAgICB9XG4gICAgaXNOZXdEYXNoYm9hcmQoKSB7XG4gICAgICAgIGNvbnN0IHsgZGFzaGJvYXJkIH0gPSB0aGlzLnN0YXRlO1xuICAgICAgICByZXR1cm4gdHlwZW9mIGRhc2hib2FyZD8udmFsdWUgPT09ICdzdHJpbmcnO1xuICAgIH1cbiAgICBjYW5PdmVyd3JpdGVTbGljZSgpIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLnByb3BzLnNsaWNlPy5vd25lcnM/LmluY2x1ZGVzKHRoaXMucHJvcHMudXNlci51c2VySWQpICYmXG4gICAgICAgICAgICAhdGhpcy5wcm9wcy5zbGljZT8uaXNfbWFuYWdlZF9leHRlcm5hbGx5KTtcbiAgICB9XG4gICAgYXN5bmMgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICAgIGxldCB7IGRhc2hib2FyZElkIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBpZiAoIWRhc2hib2FyZElkKSB7XG4gICAgICAgICAgICBsZXQgbGFzdERhc2hib2FyZCA9IG51bGw7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGxhc3REYXNoYm9hcmQgPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKFNLX0RBU0hCT0FSRF9JRCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAvLyBjb250aW51ZSByZWdhcmRsZXNzIG9mIGVycm9yXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkYXNoYm9hcmRJZCA9IGxhc3REYXNoYm9hcmQgJiYgcGFyc2VJbnQobGFzdERhc2hib2FyZCwgMTApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkYXNoYm9hcmRJZCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSAoYXdhaXQgdGhpcy5sb2FkRGFzaGJvYXJkKGRhc2hib2FyZElkKSk7XG4gICAgICAgICAgICAgICAgaWYgKGNhblVzZXJFZGl0RGFzaGJvYXJkKHJlc3VsdCwgdGhpcy5wcm9wcy51c2VyKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhc2hib2FyZDogeyBsYWJlbDogcmVzdWx0LmRhc2hib2FyZF90aXRsZSwgdmFsdWU6IHJlc3VsdC5pZCB9LFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmFjdGlvbnMuYWRkRGFuZ2VyVG9hc3QodCgnQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgbG9hZGluZyBkYXNoYm9hcmQgaW5mb3JtYXRpb24uJykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGhhbmRsZURhdGFzZXROYW1lQ2hhbmdlID0gKGUpID0+IHtcbiAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvclxuICAgICAgICB0aGlzLnNldFN0YXRlKHsgZGF0YXNldE5hbWU6IGUudGFyZ2V0LnZhbHVlIH0pO1xuICAgIH07XG4gICAgb25TbGljZU5hbWVDaGFuZ2UoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IG5ld1NsaWNlTmFtZTogZXZlbnQudGFyZ2V0LnZhbHVlIH0pO1xuICAgIH1cbiAgICBvbkRhc2hib2FyZENoYW5nZShkYXNoYm9hcmQpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGRhc2hib2FyZCB9KTtcbiAgICB9XG4gICAgY2hhbmdlQWN0aW9uKGFjdGlvbikge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgYWN0aW9uIH0pO1xuICAgIH1cbiAgICBvbkhpZGUoKSB7XG4gICAgICAgIHRoaXMucHJvcHMuZGlzcGF0Y2goc2V0U2F2ZUNoYXJ0TW9kYWxWaXNpYmlsaXR5KGZhbHNlKSk7XG4gICAgfVxuICAgIGhhbmRsZVJlZGlyZWN0ID0gKHdpbmRvd0xvY2F0aW9uU2VhcmNoLCBjaGFydCkgPT4ge1xuICAgICAgICBjb25zdCBzZWFyY2hQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvd0xvY2F0aW9uU2VhcmNoKTtcbiAgICAgICAgc2VhcmNoUGFyYW1zLnNldCgnc2F2ZV9hY3Rpb24nLCB0aGlzLnN0YXRlLmFjdGlvbik7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmFjdGlvbiAhPT0gJ292ZXJ3cml0ZScpIHtcbiAgICAgICAgICAgIHNlYXJjaFBhcmFtcy5kZWxldGUoJ2Zvcm1fZGF0YV9rZXknKTtcbiAgICAgICAgfVxuICAgICAgICBzZWFyY2hQYXJhbXMuc2V0KCdzbGljZV9pZCcsIGNoYXJ0LmlkLnRvU3RyaW5nKCkpO1xuICAgICAgICByZXR1cm4gc2VhcmNoUGFyYW1zO1xuICAgIH07XG4gICAgYXN5bmMgc2F2ZU9yT3ZlcndyaXRlKGdvdG9kYXNoKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBpc0xvYWRpbmc6IHRydWUgfSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcm9wcy5kYXRhc291cmNlPy50eXBlID09PSBEYXRhc291cmNlVHlwZS5RdWVyeSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgc2NoZW1hLCBzcWwsIGRhdGFiYXNlIH0gPSB0aGlzLnByb3BzLmRhdGFzb3VyY2U7XG4gICAgICAgICAgICAgICAgY29uc3QgeyB0ZW1wbGF0ZVBhcmFtcyB9ID0gdGhpcy5wcm9wcy5kYXRhc291cmNlO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucHJvcHMuYWN0aW9ucy5zYXZlRGF0YXNldCh7XG4gICAgICAgICAgICAgICAgICAgIHNjaGVtYSxcbiAgICAgICAgICAgICAgICAgICAgc3FsLFxuICAgICAgICAgICAgICAgICAgICBkYXRhYmFzZSxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVQYXJhbXMsXG4gICAgICAgICAgICAgICAgICAgIGRhdGFzb3VyY2VOYW1lOiB0aGlzLnN0YXRlLmRhdGFzZXROYW1lLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gIEdldCBjaGFydCBkYXNoYm9hcmRzXG4gICAgICAgICAgICBsZXQgc2xpY2VEYXNoYm9hcmRzID0gW107XG4gICAgICAgICAgICBpZiAodGhpcy5wcm9wcy5zbGljZSAmJiB0aGlzLnN0YXRlLmFjdGlvbiA9PT0gJ292ZXJ3cml0ZScpIHtcbiAgICAgICAgICAgICAgICBzbGljZURhc2hib2FyZHMgPSBhd2FpdCB0aGlzLnByb3BzLmFjdGlvbnMuZ2V0U2xpY2VEYXNoYm9hcmRzKHRoaXMucHJvcHMuc2xpY2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgZm9ybURhdGEgPSB0aGlzLnByb3BzLmZvcm1fZGF0YSB8fCB7fTtcbiAgICAgICAgICAgIGRlbGV0ZSBmb3JtRGF0YS51cmxfcGFyYW1zO1xuICAgICAgICAgICAgbGV0IGRhc2hib2FyZCA9IG51bGw7XG4gICAgICAgICAgICBpZiAodGhpcy5zdGF0ZS5kYXNoYm9hcmQpIHtcbiAgICAgICAgICAgICAgICBsZXQgdmFsaWRJZCA9IHRoaXMuc3RhdGUuZGFzaGJvYXJkLnZhbHVlO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzTmV3RGFzaGJvYXJkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnByb3BzLmFjdGlvbnMuY3JlYXRlRGFzaGJvYXJkKHRoaXMuc3RhdGUuZGFzaGJvYXJkLmxhYmVsKTtcbiAgICAgICAgICAgICAgICAgICAgdmFsaWRJZCA9IHJlc3BvbnNlLmlkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBkYXNoYm9hcmQgPSBhd2FpdCB0aGlzLmxvYWREYXNoYm9hcmQodmFsaWRJZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmFjdGlvbnMuc2F2ZVNsaWNlRmFpbGVkKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGlzRGVmaW5lZChkYXNoYm9hcmQpICYmIGlzRGVmaW5lZChkYXNoYm9hcmQ/LmlkKSkge1xuICAgICAgICAgICAgICAgICAgICBzbGljZURhc2hib2FyZHMgPSBzbGljZURhc2hib2FyZHMuaW5jbHVkZXMoZGFzaGJvYXJkLmlkKVxuICAgICAgICAgICAgICAgICAgICAgICAgPyBzbGljZURhc2hib2FyZHNcbiAgICAgICAgICAgICAgICAgICAgICAgIDogWy4uLnNsaWNlRGFzaGJvYXJkcywgZGFzaGJvYXJkLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgZm9ybURhdGEuZGFzaGJvYXJkcyA9IHNsaWNlRGFzaGJvYXJkcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBTZXRzIHRoZSBmb3JtIGRhdGFcbiAgICAgICAgICAgIHRoaXMucHJvcHMuYWN0aW9ucy5zZXRGb3JtRGF0YSh7IC4uLmZvcm1EYXRhIH0pO1xuICAgICAgICAgICAgLy8gIFVwZGF0ZSBvciBjcmVhdGUgc2xpY2VcbiAgICAgICAgICAgIGxldCB2YWx1ZTtcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlLmFjdGlvbiA9PT0gJ292ZXJ3cml0ZScpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IGF3YWl0IHRoaXMucHJvcHMuYWN0aW9ucy51cGRhdGVTbGljZSh0aGlzLnByb3BzLnNsaWNlLCB0aGlzLnN0YXRlLm5ld1NsaWNlTmFtZSwgc2xpY2VEYXNoYm9hcmRzLCBkYXNoYm9hcmRcbiAgICAgICAgICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogZGFzaGJvYXJkLmRhc2hib2FyZF90aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldzogdGhpcy5pc05ld0Rhc2hib2FyZCgpLFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIDogbnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IGF3YWl0IHRoaXMucHJvcHMuYWN0aW9ucy5jcmVhdGVTbGljZSh0aGlzLnN0YXRlLm5ld1NsaWNlTmFtZSwgc2xpY2VEYXNoYm9hcmRzLCBkYXNoYm9hcmRcbiAgICAgICAgICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogZGFzaGJvYXJkLmRhc2hib2FyZF90aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldzogdGhpcy5pc05ld0Rhc2hib2FyZCgpLFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIDogbnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmIChkYXNoYm9hcmQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShTS19EQVNIQk9BUkRfSUQsIGAke2Rhc2hib2FyZC5pZH1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oU0tfREFTSEJPQVJEX0lEKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAvLyBjb250aW51ZSByZWdhcmRsZXNzIG9mIGVycm9yXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBHbyB0byBuZXcgZGFzaGJvYXJkIHVybFxuICAgICAgICAgICAgaWYgKGdvdG9kYXNoICYmIGRhc2hib2FyZCkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuaGlzdG9yeS5wdXNoKGRhc2hib2FyZC51cmwpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHNlYXJjaFBhcmFtcyA9IHRoaXMuaGFuZGxlUmVkaXJlY3Qod2luZG93LmxvY2F0aW9uLnNlYXJjaCwgdmFsdWUpO1xuICAgICAgICAgICAgdGhpcy5wcm9wcy5oaXN0b3J5LnJlcGxhY2UoYC9leHBsb3JlLz8ke3NlYXJjaFBhcmFtcy50b1N0cmluZygpfWApO1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGlzTG9hZGluZzogZmFsc2UgfSk7XG4gICAgICAgICAgICB0aGlzLm9uSGlkZSgpO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGlzTG9hZGluZzogZmFsc2UgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbG9hZERhc2hib2FyZCA9IGFzeW5jIChpZCkgPT4ge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IFN1cGVyc2V0Q2xpZW50LmdldCh7XG4gICAgICAgICAgICBlbmRwb2ludDogYC9hcGkvdjEvZGFzaGJvYXJkLyR7aWR9YCxcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByZXNwb25zZS5qc29uLnJlc3VsdDtcbiAgICB9O1xuICAgIGxvYWREYXNoYm9hcmRzID0gYXN5bmMgKHNlYXJjaCwgcGFnZSwgcGFnZVNpemUpID0+IHtcbiAgICAgICAgY29uc3QgcXVlcnlQYXJhbXMgPSByaXNvbi5lbmNvZGUoe1xuICAgICAgICAgICAgY29sdW1uczogWydpZCcsICdkYXNoYm9hcmRfdGl0bGUnXSxcbiAgICAgICAgICAgIGZpbHRlcnM6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbDogJ2Rhc2hib2FyZF90aXRsZScsXG4gICAgICAgICAgICAgICAgICAgIG9wcjogJ2N0JyxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHNlYXJjaCxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sOiAnb3duZXJzJyxcbiAgICAgICAgICAgICAgICAgICAgb3ByOiAncmVsX21fbScsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLnByb3BzLnVzZXIudXNlcklkLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgcGFnZSxcbiAgICAgICAgICAgIHBhZ2Vfc2l6ZTogcGFnZVNpemUsXG4gICAgICAgICAgICBvcmRlcl9jb2x1bW46ICdkYXNoYm9hcmRfdGl0bGUnLFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgeyBqc29uIH0gPSBhd2FpdCBTdXBlcnNldENsaWVudC5nZXQoe1xuICAgICAgICAgICAgZW5kcG9pbnQ6IGAvYXBpL3YxL2Rhc2hib2FyZC8/cT0ke3F1ZXJ5UGFyYW1zfWAsXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCB7IHJlc3VsdCwgY291bnQgfSA9IGpzb247XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBkYXRhOiByZXN1bHQubWFwKChkYXNoYm9hcmQpID0+ICh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IGRhc2hib2FyZC5pZCxcbiAgICAgICAgICAgICAgICBsYWJlbDogZGFzaGJvYXJkLmRhc2hib2FyZF90aXRsZSxcbiAgICAgICAgICAgIH0pKSxcbiAgICAgICAgICAgIHRvdGFsQ291bnQ6IGNvdW50LFxuICAgICAgICB9O1xuICAgIH07XG4gICAgcmVuZGVyU2F2ZUNoYXJ0TW9kYWwgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGluZm8gPSB0aGlzLmluZm8oKTtcbiAgICAgICAgcmV0dXJuICg8Rm9ybSBkYXRhLXRlc3Q9XCJzYXZlLW1vZGFsLWJvZHlcIiBsYXlvdXQ9XCJ2ZXJ0aWNhbFwiPlxuICAgICAgICA8Rm9ybUl0ZW0gZGF0YS10ZXN0PVwicmFkaW8tZ3JvdXBcIj5cbiAgICAgICAgICA8UmFkaW8gaWQ9XCJvdmVyd3JpdGUtcmFkaW9cIiBkaXNhYmxlZD17IXRoaXMuY2FuT3ZlcndyaXRlU2xpY2UoKX0gY2hlY2tlZD17dGhpcy5zdGF0ZS5hY3Rpb24gPT09ICdvdmVyd3JpdGUnfSBvbkNoYW5nZT17KCkgPT4gdGhpcy5jaGFuZ2VBY3Rpb24oJ292ZXJ3cml0ZScpfSBkYXRhLXRlc3Q9XCJzYXZlLW92ZXJ3cml0ZS1yYWRpb1wiPlxuICAgICAgICAgICAge3QoJ1NhdmUgKE92ZXJ3cml0ZSknKX1cbiAgICAgICAgICA8L1JhZGlvPlxuICAgICAgICAgIDxSYWRpbyBpZD1cInNhdmVhcy1yYWRpb1wiIGRhdGEtdGVzdD1cInNhdmVhcy1yYWRpb1wiIGNoZWNrZWQ9e3RoaXMuc3RhdGUuYWN0aW9uID09PSAnc2F2ZWFzJ30gb25DaGFuZ2U9eygpID0+IHRoaXMuY2hhbmdlQWN0aW9uKCdzYXZlYXMnKX0+XG4gICAgICAgICAgICB7dCgnU2F2ZSBhcy4uLicpfVxuICAgICAgICAgIDwvUmFkaW8+XG4gICAgICAgIDwvRm9ybUl0ZW0+XG4gICAgICAgIDxociAvPlxuICAgICAgICA8Rm9ybUl0ZW0gbGFiZWw9e3QoJ0NoYXJ0IG5hbWUnKX0gcmVxdWlyZWQ+XG4gICAgICAgICAgPElucHV0IG5hbWU9XCJuZXdfc2xpY2VfbmFtZVwiIHR5cGU9XCJ0ZXh0XCIgcGxhY2Vob2xkZXI9XCJOYW1lXCIgdmFsdWU9e3RoaXMuc3RhdGUubmV3U2xpY2VOYW1lfSBvbkNoYW5nZT17dGhpcy5vblNsaWNlTmFtZUNoYW5nZX0gZGF0YS10ZXN0PVwibmV3LWNoYXJ0LW5hbWVcIi8+XG4gICAgICAgIDwvRm9ybUl0ZW0+XG4gICAgICAgIHt0aGlzLnByb3BzLmRhdGFzb3VyY2U/LnR5cGUgPT09ICdxdWVyeScgJiYgKDxGb3JtSXRlbSBsYWJlbD17dCgnRGF0YXNldCBOYW1lJyl9IHJlcXVpcmVkPlxuICAgICAgICAgICAgPEluZm9Ub29sdGlwV2l0aFRyaWdnZXIgdG9vbHRpcD17dCgnQSByZXVzYWJsZSBkYXRhc2V0IHdpbGwgYmUgc2F2ZWQgd2l0aCB5b3VyIGNoYXJ0LicpfSBwbGFjZW1lbnQ9XCJyaWdodFwiLz5cbiAgICAgICAgICAgIDxJbnB1dCBuYW1lPVwiZGF0YXNldF9uYW1lXCIgdHlwZT1cInRleHRcIiBwbGFjZWhvbGRlcj1cIkRhdGFzZXQgTmFtZVwiIHZhbHVlPXt0aGlzLnN0YXRlLmRhdGFzZXROYW1lfSBvbkNoYW5nZT17dGhpcy5oYW5kbGVEYXRhc2V0TmFtZUNoYW5nZX0gZGF0YS10ZXN0PVwibmV3LWRhdGFzZXQtbmFtZVwiLz5cbiAgICAgICAgICA8L0Zvcm1JdGVtPil9XG4gICAgICAgIDxGb3JtSXRlbSBsYWJlbD17dCgnQWRkIHRvIGRhc2hib2FyZCcpfSBkYXRhLXRlc3Q9XCJzYXZlLWNoYXJ0LW1vZGFsLXNlbGVjdC1kYXNoYm9hcmQtZm9ybVwiPlxuICAgICAgICAgIDxBc3luY1NlbGVjdCBhbGxvd0NsZWFyIGFsbG93TmV3T3B0aW9ucyBhcmlhTGFiZWw9e3QoJ1NlbGVjdCBhIGRhc2hib2FyZCcpfSBvcHRpb25zPXt0aGlzLmxvYWREYXNoYm9hcmRzfSBvbkNoYW5nZT17dGhpcy5vbkRhc2hib2FyZENoYW5nZX0gdmFsdWU9e3RoaXMuc3RhdGUuZGFzaGJvYXJkfSBwbGFjZWhvbGRlcj17PGRpdj5cbiAgICAgICAgICAgICAgICA8Yj57dCgnU2VsZWN0Jyl9PC9iPlxuICAgICAgICAgICAgICAgIHt0KCcgYSBkYXNoYm9hcmQgT1IgJyl9XG4gICAgICAgICAgICAgICAgPGI+e3QoJ2NyZWF0ZScpfTwvYj5cbiAgICAgICAgICAgICAgICB7dCgnIGEgbmV3IG9uZScpfVxuICAgICAgICAgICAgICA8L2Rpdj59Lz5cbiAgICAgICAgPC9Gb3JtSXRlbT5cbiAgICAgICAge2luZm8gJiYgPEFsZXJ0IHR5cGU9XCJpbmZvXCIgbWVzc2FnZT17aW5mb30gY2xvc2FibGU9e2ZhbHNlfS8+fVxuICAgICAgICB7dGhpcy5wcm9wcy5hbGVydCAmJiAoPEFsZXJ0IGNzcz17eyBtYXJnaW5Ub3A6IGluZm8gPyAxNiA6IHVuZGVmaW5lZCB9fSB0eXBlPVwid2FybmluZ1wiIG1lc3NhZ2U9e3RoaXMucHJvcHMuYWxlcnR9IGNsb3NhYmxlPXtmYWxzZX0vPil9XG4gICAgICA8L0Zvcm0+KTtcbiAgICB9O1xuICAgIGluZm8gPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGlzTmV3RGFzaGJvYXJkID0gdGhpcy5pc05ld0Rhc2hib2FyZCgpO1xuICAgICAgICBsZXQgY2hhcnRXaWxsQmVDcmVhdGVkID0gZmFsc2U7XG4gICAgICAgIGlmICh0aGlzLnByb3BzLnNsaWNlICYmXG4gICAgICAgICAgICAodGhpcy5zdGF0ZS5hY3Rpb24gIT09ICdvdmVyd3JpdGUnIHx8ICF0aGlzLmNhbk92ZXJ3cml0ZVNsaWNlKCkpKSB7XG4gICAgICAgICAgICBjaGFydFdpbGxCZUNyZWF0ZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjaGFydFdpbGxCZUNyZWF0ZWQgJiYgaXNOZXdEYXNoYm9hcmQpIHtcbiAgICAgICAgICAgIHJldHVybiB0KCdBIG5ldyBjaGFydCBhbmQgZGFzaGJvYXJkIHdpbGwgYmUgY3JlYXRlZC4nKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2hhcnRXaWxsQmVDcmVhdGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdCgnQSBuZXcgY2hhcnQgd2lsbCBiZSBjcmVhdGVkLicpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc05ld0Rhc2hib2FyZCkge1xuICAgICAgICAgICAgcmV0dXJuIHQoJ0EgbmV3IGRhc2hib2FyZCB3aWxsIGJlIGNyZWF0ZWQuJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICByZW5kZXJGb290ZXIgPSAoKSA9PiAoPGRpdiBkYXRhLXRlc3Q9XCJzYXZlLW1vZGFsLWZvb3RlclwiPlxuICAgICAgPEJ1dHRvbiBpZD1cImJ0bl9jYW5jZWxcIiBidXR0b25TaXplPVwic21hbGxcIiBvbkNsaWNrPXt0aGlzLm9uSGlkZX0+XG4gICAgICAgIHt0KCdDYW5jZWwnKX1cbiAgICAgIDwvQnV0dG9uPlxuICAgICAgPEJ1dHRvbiBpZD1cImJ0bl9tb2RhbF9zYXZlX2dvdG9fZGFzaFwiIGJ1dHRvblNpemU9XCJzbWFsbFwiIGRpc2FibGVkPXshdGhpcy5zdGF0ZS5uZXdTbGljZU5hbWUgfHxcbiAgICAgICAgICAgICF0aGlzLnN0YXRlLmRhc2hib2FyZCB8fFxuICAgICAgICAgICAgKHRoaXMucHJvcHMuZGF0YXNvdXJjZT8udHlwZSAhPT0gRGF0YXNvdXJjZVR5cGUuVGFibGUgJiZcbiAgICAgICAgICAgICAgICAhdGhpcy5zdGF0ZS5kYXRhc2V0TmFtZSl9IG9uQ2xpY2s9eygpID0+IHRoaXMuc2F2ZU9yT3ZlcndyaXRlKHRydWUpfT5cbiAgICAgICAge3QoJ1NhdmUgJiBnbyB0byBkYXNoYm9hcmQnKX1cbiAgICAgIDwvQnV0dG9uPlxuICAgICAgPEJ1dHRvbiBpZD1cImJ0bl9tb2RhbF9zYXZlXCIgYnV0dG9uU2l6ZT1cInNtYWxsXCIgYnV0dG9uU3R5bGU9XCJwcmltYXJ5XCIgb25DbGljaz17KCkgPT4gdGhpcy5zYXZlT3JPdmVyd3JpdGUoZmFsc2UpfSBkaXNhYmxlZD17dGhpcy5zdGF0ZS5pc0xvYWRpbmcgfHxcbiAgICAgICAgICAgICF0aGlzLnN0YXRlLm5ld1NsaWNlTmFtZSB8fFxuICAgICAgICAgICAgKHRoaXMucHJvcHMuZGF0YXNvdXJjZT8udHlwZSAhPT0gRGF0YXNvdXJjZVR5cGUuVGFibGUgJiZcbiAgICAgICAgICAgICAgICAhdGhpcy5zdGF0ZS5kYXRhc2V0TmFtZSl9IGRhdGEtdGVzdD1cImJ0bi1tb2RhbC1zYXZlXCI+XG4gICAgICAgIHt0KCdTYXZlJyl9XG4gICAgICA8L0J1dHRvbj5cbiAgICA8L2Rpdj4pO1xuICAgIHJlbmRlcigpIHtcbiAgICAgICAgcmV0dXJuICg8U3R5bGVkTW9kYWwgc2hvdz17dGhpcy5wcm9wcy5pc1Zpc2libGV9IG9uSGlkZT17dGhpcy5vbkhpZGV9IHRpdGxlPXt0KCdTYXZlIGNoYXJ0Jyl9IGZvb3Rlcj17dGhpcy5yZW5kZXJGb290ZXIoKX0+XG4gICAgICAgIHt0aGlzLnN0YXRlLmlzTG9hZGluZyA/ICg8ZGl2IGNzcz17Y3NzIGBcbiAgICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgICAgICAgICBgfT5cbiAgICAgICAgICAgIDxMb2FkaW5nIHBvc2l0aW9uPVwibm9ybWFsXCIvPlxuICAgICAgICAgIDwvZGl2PikgOiAodGhpcy5yZW5kZXJTYXZlQ2hhcnRNb2RhbCgpKX1cbiAgICAgIDwvU3R5bGVkTW9kYWw+KTtcbiAgICB9XG59XG5mdW5jdGlvbiBtYXBTdGF0ZVRvUHJvcHMoeyBleHBsb3JlLCBzYXZlTW9kYWwsIHVzZXIsIH0pIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBkYXRhc291cmNlOiBleHBsb3JlLmRhdGFzb3VyY2UsXG4gICAgICAgIHNsaWNlOiBleHBsb3JlLnNsaWNlLFxuICAgICAgICB1c2VyLFxuICAgICAgICBkYXNoYm9hcmRzOiBzYXZlTW9kYWwuZGFzaGJvYXJkcyxcbiAgICAgICAgYWxlcnQ6IHNhdmVNb2RhbC5zYXZlTW9kYWxBbGVydCxcbiAgICAgICAgaXNWaXNpYmxlOiBzYXZlTW9kYWwuaXNWaXNpYmxlLFxuICAgIH07XG59XG5leHBvcnQgZGVmYXVsdCB3aXRoUm91dGVyKGNvbm5lY3QobWFwU3RhdGVUb1Byb3BzKShTYXZlTW9kYWwpKTtcbi8vIFVzZXIgZm9yIHRlc3RpbmcgcHVycG9zZXMgbmVlZCB0byByZXZpc2l0IG9uY2Ugd2UgY29udmVydCB0aGlzIHRvIGZ1bmN0aW9uYWwgY29tcG9uZW50XG5leHBvcnQgeyBTYXZlTW9kYWwgYXMgUHVyZVNhdmVNb2RhbCB9O1xuIl19 */\"), type: \"warning\", message: this.props.alert, closable: false })\n      );\n    };this.\n    info = () => {\n      const isNewDashboard = this.isNewDashboard();\n      let chartWillBeCreated = false;\n      if (this.props.slice && (\n      this.state.action !== 'overwrite' || !this.canOverwriteSlice())) {\n        chartWillBeCreated = true;\n      }\n      if (chartWillBeCreated && isNewDashboard) {\n        return t('A new chart and dashboard will be created.');\n      }\n      if (chartWillBeCreated) {\n        return t('A new chart will be created.');\n      }\n      if (isNewDashboard) {\n        return t('A new dashboard will be created.');\n      }\n      return null;\n    };this.\n    renderFooter = () => {var _this$props$datasourc2, _this$props$datasourc3;return ___EmotionJSX(\"div\", { \"data-test\": \"save-modal-footer\" },\n      ___EmotionJSX(Button, { id: \"btn_cancel\", buttonSize: \"small\", onClick: this.onHide },\n      t('Cancel')\n      ),\n      ___EmotionJSX(Button, { id: \"btn_modal_save_goto_dash\", buttonSize: \"small\", disabled: !this.state.newSliceName ||\n        !this.state.dashboard ||\n        ((_this$props$datasourc2 = this.props.datasource) == null ? void 0 : _this$props$datasourc2.type) !== DatasourceType.Table &&\n        !this.state.datasetName, onClick: () => this.saveOrOverwrite(true) },\n      t('Save & go to dashboard')\n      ),\n      ___EmotionJSX(Button, { id: \"btn_modal_save\", buttonSize: \"small\", buttonStyle: \"primary\", onClick: () => this.saveOrOverwrite(false), disabled: this.state.isLoading ||\n        !this.state.newSliceName ||\n        ((_this$props$datasourc3 = this.props.datasource) == null ? void 0 : _this$props$datasourc3.type) !== DatasourceType.Table &&\n        !this.state.datasetName, \"data-test\": \"btn-modal-save\" },\n      t('Save')\n      )\n      );};this.state = { newSliceName: props.sliceName, datasetName: (_props$datasource = props.datasource) == null ? void 0 : _props$datasource.name, action: this.canOverwriteSlice() ? 'overwrite' : 'saveas', isLoading: false, dashboard: undefined };this.onDashboardChange = this.onDashboardChange.bind(this);this.onSliceNameChange = this.onSliceNameChange.bind(this);this.changeAction = this.changeAction.bind(this);this.saveOrOverwrite = this.saveOrOverwrite.bind(this);this.isNewDashboard = this.isNewDashboard.bind(this);this.onHide = this.onHide.bind(this);}isNewDashboard() {const { dashboard } = this.state;return typeof (dashboard == null ? void 0 : dashboard.value) === 'string';}canOverwriteSlice() {var _this$props$slice, _this$props$slice$own, _this$props$slice2;return ((_this$props$slice = this.props.slice) == null ? void 0 : (_this$props$slice$own = _this$props$slice.owners) == null ? void 0 : _this$props$slice$own.includes(this.props.user.userId)) && !((_this$props$slice2 = this.props.slice) != null && _this$props$slice2.is_managed_externally);}async componentDidMount() {let { dashboardId } = this.props;if (!dashboardId) {let lastDashboard = null;try {lastDashboard = sessionStorage.getItem(SK_DASHBOARD_ID);} catch (error) {// continue regardless of error\n      }dashboardId = lastDashboard && parseInt(lastDashboard, 10);}if (dashboardId) {try {const result = await this.loadDashboard(dashboardId);if (canUserEditDashboard(result, this.props.user)) {this.setState({ dashboard: { label: result.dashboard_title, value: result.id } });}} catch (error) {this.props.actions.addDangerToast(t('An error occurred while loading dashboard information.'));}}}onSliceNameChange(event) {this.setState({ newSliceName: event.target.value });}onDashboardChange(dashboard) {this.setState({ dashboard });}changeAction(action) {this.setState({ action });}onHide() {this.props.dispatch(setSaveChartModalVisibility(false));}async saveOrOverwrite(gotodash) {this.setState({ isLoading: true });try {var _this$props$datasourc4;if (((_this$props$datasourc4 = this.props.datasource) == null ? void 0 : _this$props$datasourc4.type) === DatasourceType.Query) {const { schema, sql, database } = this.props.datasource;const { templateParams } = this.props.datasource;await this.props.actions.saveDataset({ schema, sql, database, templateParams, datasourceName: this.state.datasetName });} //  Get chart dashboards\n      let sliceDashboards = [];if (this.props.slice && this.state.action === 'overwrite') {sliceDashboards = await this.props.actions.getSliceDashboards(this.props.slice);}const formData = this.props.form_data || {};delete formData.url_params;let dashboard = null;if (this.state.dashboard) {var _dashboard;let validId = this.state.dashboard.value;if (this.isNewDashboard()) {const response = await this.props.actions.createDashboard(this.state.dashboard.label);validId = response.id;}try {dashboard = await this.loadDashboard(validId);} catch (error) {this.props.actions.saveSliceFailed();return;}if (isDefined(dashboard) && isDefined((_dashboard = dashboard) == null ? void 0 : _dashboard.id)) {sliceDashboards = sliceDashboards.includes(dashboard.id) ? sliceDashboards : [...sliceDashboards, dashboard.id];formData.dashboards = sliceDashboards;}} // Sets the form data\n      this.props.actions.setFormData({ ...formData }); //  Update or create slice\n      let value;if (this.state.action === 'overwrite') {value = await this.props.actions.updateSlice(this.props.slice, this.state.newSliceName, sliceDashboards, dashboard ? { title: dashboard.dashboard_title, new: this.isNewDashboard() } : null);} else {value = await this.props.actions.createSlice(this.state.newSliceName, sliceDashboards, dashboard ? { title: dashboard.dashboard_title, new: this.isNewDashboard() } : null);}try {if (dashboard) {sessionStorage.setItem(SK_DASHBOARD_ID, `${dashboard.id}`);} else {sessionStorage.removeItem(SK_DASHBOARD_ID);}} catch (error) {// continue regardless of error\n      } // Go to new dashboard url\n      if (gotodash && dashboard) {this.props.history.push(dashboard.url);return;}const searchParams = this.handleRedirect(window.location.search, value);this.props.history.replace(`/explore/?${searchParams.toString()}`);this.setState({ isLoading: false });this.onHide();} finally {this.setState({ isLoading: false });}}render() {return ___EmotionJSX(StyledModal, { show: this.props.isVisible, onHide: this.onHide, title: t('Save chart'), footer: this.renderFooter() }, this.state.isLoading ? ___EmotionJSX(\"div\", { css: css`\n              display: flex;\n              justify-content: center;\n            ` }, ___EmotionJSX(Loading, { position: \"normal\" })) : this.renderSaveChartModal());\n  } // @ts-ignore\n  __reactstandin__regenerateByEval(key, code) {// @ts-ignore\n    this[key] = eval(code);}}function mapStateToProps({ explore, saveModal, user }) {\n  return {\n    datasource: explore.datasource,\n    slice: explore.slice,\n    user,\n    dashboards: saveModal.dashboards,\n    alert: saveModal.saveModalAlert,\n    isVisible: saveModal.isVisible\n  };\n}const _default =\nwithRouter(connect(mapStateToProps)(SaveModal));export default _default;\n// User for testing purposes need to revisit once we convert this to functional component\nexport { SaveModal as PureSaveModal };;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(SK_DASHBOARD_ID, \"SK_DASHBOARD_ID\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/explore/components/SaveModal.tsx\");reactHotLoader.register(StyledModal, \"StyledModal\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/explore/components/SaveModal.tsx\");reactHotLoader.register(SaveModal, \"SaveModal\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/explore/components/SaveModal.tsx\");reactHotLoader.register(mapStateToProps, \"mapStateToProps\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/explore/components/SaveModal.tsx\");reactHotLoader.register(_default, \"default\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/explore/components/SaveModal.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["React","rison","connect","withRouter","InfoTooltipWithTrigger","css","DatasourceType","isDefined","styled","SupersetClient","t","Input","Form","FormItem","Alert","Modal","Radio","Button","AsyncSelect","Loading","canUserEditDashboard","setSaveChartModalVisibility","jsx","___EmotionJSX","SK_DASHBOARD_ID","StyledModal","theme","gridUnit","SaveModal","Component","constructor","props","_props$datasource","handleDatasetNameChange","e","setState","datasetName","target","value","handleRedirect","windowLocationSearch","chart","searchParams","URLSearchParams","set","state","action","delete","id","toString","loadDashboard","response","get","endpoint","json","result","loadDashboards","search","page","pageSize","queryParams","encode","columns","filters","col","opr","user","userId","page_size","order_column","count","data","map","dashboard","label","dashboard_title","totalCount","renderSaveChartModal","_this$props$datasourc","info","layout","disabled","canOverwriteSlice","checked","onChange","changeAction","required","name","type","placeholder","newSliceName","onSliceNameChange","datasource","tooltip","placement","allowClear","allowNewOptions","ariaLabel","options","onDashboardChange","message","closable","alert","_css","marginTop","undefined","process","env","NODE_ENV","isNewDashboard","chartWillBeCreated","slice","renderFooter","_this$props$datasourc2","_this$props$datasourc3","buttonSize","onClick","onHide","Table","saveOrOverwrite","buttonStyle","isLoading","sliceName","bind","_this$props$slice","_this$props$slice$own","_this$props$slice2","owners","includes","is_managed_externally","componentDidMount","dashboardId","lastDashboard","sessionStorage","getItem","error","parseInt","actions","addDangerToast","event","dispatch","gotodash","_this$props$datasourc4","Query","schema","sql","database","templateParams","saveDataset","datasourceName","sliceDashboards","getSliceDashboards","formData","form_data","url_params","_dashboard","validId","createDashboard","saveSliceFailed","dashboards","setFormData","updateSlice","title","new","createSlice","setItem","removeItem","history","push","url","window","location","replace","render","show","isVisible","footer","position","__reactstandin__regenerateByEval","key","code","eval","mapStateToProps","explore","saveModal","saveModalAlert","_default","PureSaveModal","reactHotLoader","reactHotLoaderGlobal","default","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/src/explore/components/SaveModal.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint camelcase: 0 */\nimport React from 'react';\nimport { Dispatch } from 'redux';\nimport rison from 'rison';\nimport { connect } from 'react-redux';\nimport { withRouter, RouteComponentProps } from 'react-router-dom';\nimport { InfoTooltipWithTrigger } from '@superset-ui/chart-controls';\nimport {\n  css,\n  DatasourceType,\n  isDefined,\n  styled,\n  SupersetClient,\n  t,\n} from '@superset-ui/core';\nimport { Input } from 'src/components/Input';\nimport { Form, FormItem } from 'src/components/Form';\nimport Alert from 'src/components/Alert';\nimport Modal from 'src/components/Modal';\nimport { Radio } from 'src/components/Radio';\nimport Button from 'src/components/Button';\nimport { AsyncSelect } from 'src/components';\nimport Loading from 'src/components/Loading';\nimport { canUserEditDashboard } from 'src/dashboard/util/permissionUtils';\nimport { setSaveChartModalVisibility } from 'src/explore/actions/saveModalActions';\nimport { SaveActionType } from 'src/explore/types';\nimport { UserWithPermissionsAndRoles } from 'src/types/bootstrapTypes';\nimport { Dashboard } from 'src/types/Dashboard';\n\n// Session storage key for recent dashboard\nconst SK_DASHBOARD_ID = 'save_chart_recent_dashboard';\n\ninterface SaveModalProps extends RouteComponentProps {\n  addDangerToast: (msg: string) => void;\n  actions: Record<string, any>;\n  form_data?: Record<string, any>;\n  user: UserWithPermissionsAndRoles;\n  alert?: string;\n  sliceName?: string;\n  slice?: Record<string, any>;\n  datasource?: Record<string, any>;\n  dashboardId: '' | number | null;\n  isVisible: boolean;\n  dispatch: Dispatch;\n}\n\ntype SaveModalState = {\n  newSliceName?: string;\n  datasetName: string;\n  action: SaveActionType;\n  isLoading: boolean;\n  saveStatus?: string | null;\n  dashboard?: { label: string; value: string | number };\n};\n\nexport const StyledModal = styled(Modal)`\n  .ant-modal-body {\n    overflow: visible;\n  }\n  i {\n    position: absolute;\n    top: -${({ theme }) => theme.gridUnit * 5.25}px;\n    left: ${({ theme }) => theme.gridUnit * 26.75}px;\n  }\n`;\n\nclass SaveModal extends React.Component<SaveModalProps, SaveModalState> {\n  constructor(props: SaveModalProps) {\n    super(props);\n    this.state = {\n      newSliceName: props.sliceName,\n      datasetName: props.datasource?.name,\n      action: this.canOverwriteSlice() ? 'overwrite' : 'saveas',\n      isLoading: false,\n      dashboard: undefined,\n    };\n    this.onDashboardChange = this.onDashboardChange.bind(this);\n    this.onSliceNameChange = this.onSliceNameChange.bind(this);\n    this.changeAction = this.changeAction.bind(this);\n    this.saveOrOverwrite = this.saveOrOverwrite.bind(this);\n    this.isNewDashboard = this.isNewDashboard.bind(this);\n    this.onHide = this.onHide.bind(this);\n  }\n\n  isNewDashboard(): boolean {\n    const { dashboard } = this.state;\n    return typeof dashboard?.value === 'string';\n  }\n\n  canOverwriteSlice(): boolean {\n    return (\n      this.props.slice?.owners?.includes(this.props.user.userId) &&\n      !this.props.slice?.is_managed_externally\n    );\n  }\n\n  async componentDidMount() {\n    let { dashboardId } = this.props;\n    if (!dashboardId) {\n      let lastDashboard = null;\n      try {\n        lastDashboard = sessionStorage.getItem(SK_DASHBOARD_ID);\n      } catch (error) {\n        // continue regardless of error\n      }\n      dashboardId = lastDashboard && parseInt(lastDashboard, 10);\n    }\n    if (dashboardId) {\n      try {\n        const result = (await this.loadDashboard(dashboardId)) as Dashboard;\n        if (canUserEditDashboard(result, this.props.user)) {\n          this.setState({\n            dashboard: { label: result.dashboard_title, value: result.id },\n          });\n        }\n      } catch (error) {\n        this.props.actions.addDangerToast(\n          t('An error occurred while loading dashboard information.'),\n        );\n      }\n    }\n  }\n\n  handleDatasetNameChange = (e: React.FormEvent<HTMLInputElement>) => {\n    // @ts-expect-error\n    this.setState({ datasetName: e.target.value });\n  };\n\n  onSliceNameChange(event: React.ChangeEvent<HTMLInputElement>) {\n    this.setState({ newSliceName: event.target.value });\n  }\n\n  onDashboardChange(dashboard: { label: string; value: string | number }) {\n    this.setState({ dashboard });\n  }\n\n  changeAction(action: SaveActionType) {\n    this.setState({ action });\n  }\n\n  onHide() {\n    this.props.dispatch(setSaveChartModalVisibility(false));\n  }\n\n  handleRedirect = (windowLocationSearch: string, chart: any) => {\n    const searchParams = new URLSearchParams(windowLocationSearch);\n    searchParams.set('save_action', this.state.action);\n    if (this.state.action !== 'overwrite') {\n      searchParams.delete('form_data_key');\n    }\n\n    searchParams.set('slice_id', chart.id.toString());\n    return searchParams;\n  };\n\n  async saveOrOverwrite(gotodash: boolean) {\n    this.setState({ isLoading: true });\n\n    //  Create or retrieve dashboard\n    type DashboardGetResponse = {\n      id: number;\n      url: string;\n      dashboard_title: string;\n    };\n\n    try {\n      if (this.props.datasource?.type === DatasourceType.Query) {\n        const { schema, sql, database } = this.props.datasource;\n        const { templateParams } = this.props.datasource;\n\n        await this.props.actions.saveDataset({\n          schema,\n          sql,\n          database,\n          templateParams,\n          datasourceName: this.state.datasetName,\n        });\n      }\n\n      //  Get chart dashboards\n      let sliceDashboards: number[] = [];\n      if (this.props.slice && this.state.action === 'overwrite') {\n        sliceDashboards = await this.props.actions.getSliceDashboards(\n          this.props.slice,\n        );\n      }\n\n      const formData = this.props.form_data || {};\n      delete formData.url_params;\n\n      let dashboard: DashboardGetResponse | null = null;\n      if (this.state.dashboard) {\n        let validId = this.state.dashboard.value;\n        if (this.isNewDashboard()) {\n          const response = await this.props.actions.createDashboard(\n            this.state.dashboard.label,\n          );\n          validId = response.id;\n        }\n\n        try {\n          dashboard = await this.loadDashboard(validId as number);\n        } catch (error) {\n          this.props.actions.saveSliceFailed();\n          return;\n        }\n\n        if (isDefined(dashboard) && isDefined(dashboard?.id)) {\n          sliceDashboards = sliceDashboards.includes(dashboard.id)\n            ? sliceDashboards\n            : [...sliceDashboards, dashboard.id];\n          formData.dashboards = sliceDashboards;\n        }\n      }\n\n      // Sets the form data\n      this.props.actions.setFormData({ ...formData });\n\n      //  Update or create slice\n      let value: { id: number };\n      if (this.state.action === 'overwrite') {\n        value = await this.props.actions.updateSlice(\n          this.props.slice,\n          this.state.newSliceName,\n          sliceDashboards,\n          dashboard\n            ? {\n                title: dashboard.dashboard_title,\n                new: this.isNewDashboard(),\n              }\n            : null,\n        );\n      } else {\n        value = await this.props.actions.createSlice(\n          this.state.newSliceName,\n          sliceDashboards,\n          dashboard\n            ? {\n                title: dashboard.dashboard_title,\n                new: this.isNewDashboard(),\n              }\n            : null,\n        );\n      }\n\n      try {\n        if (dashboard) {\n          sessionStorage.setItem(SK_DASHBOARD_ID, `${dashboard.id}`);\n        } else {\n          sessionStorage.removeItem(SK_DASHBOARD_ID);\n        }\n      } catch (error) {\n        // continue regardless of error\n      }\n\n      // Go to new dashboard url\n      if (gotodash && dashboard) {\n        this.props.history.push(dashboard.url);\n        return;\n      }\n\n      const searchParams = this.handleRedirect(window.location.search, value);\n      this.props.history.replace(`/explore/?${searchParams.toString()}`);\n\n      this.setState({ isLoading: false });\n      this.onHide();\n    } finally {\n      this.setState({ isLoading: false });\n    }\n  }\n\n  loadDashboard = async (id: number) => {\n    const response = await SupersetClient.get({\n      endpoint: `/api/v1/dashboard/${id}`,\n    });\n    return response.json.result;\n  };\n\n  loadDashboards = async (search: string, page: number, pageSize: number) => {\n    const queryParams = rison.encode({\n      columns: ['id', 'dashboard_title'],\n      filters: [\n        {\n          col: 'dashboard_title',\n          opr: 'ct',\n          value: search,\n        },\n        {\n          col: 'owners',\n          opr: 'rel_m_m',\n          value: this.props.user.userId,\n        },\n      ],\n      page,\n      page_size: pageSize,\n      order_column: 'dashboard_title',\n    });\n\n    const { json } = await SupersetClient.get({\n      endpoint: `/api/v1/dashboard/?q=${queryParams}`,\n    });\n    const { result, count } = json;\n    return {\n      data: result.map(\n        (dashboard: { id: number; dashboard_title: string }) => ({\n          value: dashboard.id,\n          label: dashboard.dashboard_title,\n        }),\n      ),\n      totalCount: count,\n    };\n  };\n\n  renderSaveChartModal = () => {\n    const info = this.info();\n    return (\n      <Form data-test=\"save-modal-body\" layout=\"vertical\">\n        <FormItem data-test=\"radio-group\">\n          <Radio\n            id=\"overwrite-radio\"\n            disabled={!this.canOverwriteSlice()}\n            checked={this.state.action === 'overwrite'}\n            onChange={() => this.changeAction('overwrite')}\n            data-test=\"save-overwrite-radio\"\n          >\n            {t('Save (Overwrite)')}\n          </Radio>\n          <Radio\n            id=\"saveas-radio\"\n            data-test=\"saveas-radio\"\n            checked={this.state.action === 'saveas'}\n            onChange={() => this.changeAction('saveas')}\n          >\n            {t('Save as...')}\n          </Radio>\n        </FormItem>\n        <hr />\n        <FormItem label={t('Chart name')} required>\n          <Input\n            name=\"new_slice_name\"\n            type=\"text\"\n            placeholder=\"Name\"\n            value={this.state.newSliceName}\n            onChange={this.onSliceNameChange}\n            data-test=\"new-chart-name\"\n          />\n        </FormItem>\n        {this.props.datasource?.type === 'query' && (\n          <FormItem label={t('Dataset Name')} required>\n            <InfoTooltipWithTrigger\n              tooltip={t('A reusable dataset will be saved with your chart.')}\n              placement=\"right\"\n            />\n            <Input\n              name=\"dataset_name\"\n              type=\"text\"\n              placeholder=\"Dataset Name\"\n              value={this.state.datasetName}\n              onChange={this.handleDatasetNameChange}\n              data-test=\"new-dataset-name\"\n            />\n          </FormItem>\n        )}\n        <FormItem\n          label={t('Add to dashboard')}\n          data-test=\"save-chart-modal-select-dashboard-form\"\n        >\n          <AsyncSelect\n            allowClear\n            allowNewOptions\n            ariaLabel={t('Select a dashboard')}\n            options={this.loadDashboards}\n            onChange={this.onDashboardChange}\n            value={this.state.dashboard}\n            placeholder={\n              <div>\n                <b>{t('Select')}</b>\n                {t(' a dashboard OR ')}\n                <b>{t('create')}</b>\n                {t(' a new one')}\n              </div>\n            }\n          />\n        </FormItem>\n        {info && <Alert type=\"info\" message={info} closable={false} />}\n        {this.props.alert && (\n          <Alert\n            css={{ marginTop: info ? 16 : undefined }}\n            type=\"warning\"\n            message={this.props.alert}\n            closable={false}\n          />\n        )}\n      </Form>\n    );\n  };\n\n  info = () => {\n    const isNewDashboard = this.isNewDashboard();\n    let chartWillBeCreated = false;\n    if (\n      this.props.slice &&\n      (this.state.action !== 'overwrite' || !this.canOverwriteSlice())\n    ) {\n      chartWillBeCreated = true;\n    }\n    if (chartWillBeCreated && isNewDashboard) {\n      return t('A new chart and dashboard will be created.');\n    }\n    if (chartWillBeCreated) {\n      return t('A new chart will be created.');\n    }\n    if (isNewDashboard) {\n      return t('A new dashboard will be created.');\n    }\n    return null;\n  };\n\n  renderFooter = () => (\n    <div data-test=\"save-modal-footer\">\n      <Button id=\"btn_cancel\" buttonSize=\"small\" onClick={this.onHide}>\n        {t('Cancel')}\n      </Button>\n      <Button\n        id=\"btn_modal_save_goto_dash\"\n        buttonSize=\"small\"\n        disabled={\n          !this.state.newSliceName ||\n          !this.state.dashboard ||\n          (this.props.datasource?.type !== DatasourceType.Table &&\n            !this.state.datasetName)\n        }\n        onClick={() => this.saveOrOverwrite(true)}\n      >\n        {t('Save & go to dashboard')}\n      </Button>\n      <Button\n        id=\"btn_modal_save\"\n        buttonSize=\"small\"\n        buttonStyle=\"primary\"\n        onClick={() => this.saveOrOverwrite(false)}\n        disabled={\n          this.state.isLoading ||\n          !this.state.newSliceName ||\n          (this.props.datasource?.type !== DatasourceType.Table &&\n            !this.state.datasetName)\n        }\n        data-test=\"btn-modal-save\"\n      >\n        {t('Save')}\n      </Button>\n    </div>\n  );\n\n  render() {\n    return (\n      <StyledModal\n        show={this.props.isVisible}\n        onHide={this.onHide}\n        title={t('Save chart')}\n        footer={this.renderFooter()}\n      >\n        {this.state.isLoading ? (\n          <div\n            css={css`\n              display: flex;\n              justify-content: center;\n            `}\n          >\n            <Loading position=\"normal\" />\n          </div>\n        ) : (\n          this.renderSaveChartModal()\n        )}\n      </StyledModal>\n    );\n  }\n}\n\ninterface StateProps {\n  datasource: any;\n  slice: any;\n  user: UserWithPermissionsAndRoles;\n  dashboards: any;\n  alert: any;\n  isVisible: boolean;\n}\n\nfunction mapStateToProps({\n  explore,\n  saveModal,\n  user,\n}: Record<string, any>): StateProps {\n  return {\n    datasource: explore.datasource,\n    slice: explore.slice,\n    user,\n    dashboards: saveModal.dashboards,\n    alert: saveModal.saveModalAlert,\n    isVisible: saveModal.isVisible,\n  };\n}\n\nexport default withRouter(connect(mapStateToProps)(SaveModal));\n\n// User for testing purposes need to revisit once we convert this to functional component\nexport { SaveModal as PureSaveModal };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}