{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nconst modulePromises = {};\nconst withNamespace = (name) => `__superset__/${name}`;\n/**\n * Dependency management using global variables, because for the life of me\n * I can't figure out how to hook into UMD from a dynamically imported package.\n *\n * This defines a dynamically imported js module that can be used to import from\n * multiple different plugins.\n *\n * When importing a common module (such as react or lodash or superset-ui)\n * from a plugin, the plugin's build config will be able to\n * reference these globals instead of rebuilding them.\n *\n * @param name the module's name (should match name in package.json)\n * @param promise the promise resulting from a call to `import(name)`\n */\nexport async function defineSharedModule(name, fetchModule) {\n  // this field on window is used by dynamic plugins to reference the module\n  const moduleKey = withNamespace(name);\n  if (!window[moduleKey] && !modulePromises[name]) {\n    // if the module has not been loaded, load it\n    const modulePromise = fetchModule();\n    modulePromises[name] = modulePromise;\n    // wait for the module to load, and attach the result to window\n    // so that it can be referenced by plugins\n    window[moduleKey] = await modulePromise;\n  }\n  // we always return a reference to the promise.\n  // Multiple consumers can `.then()` or `await` the same promise,\n  // even long after it has completed,\n  // and it will always call back with the same reference.\n  return modulePromises[name];\n}\n/**\n * Define multiple shared modules at once, using a map of name -> `import(name)`\n *\n * @see defineSharedModule\n * @param moduleMap\n */\nexport async function defineSharedModules(moduleMap) {\n  return Promise.all(Object.entries(moduleMap).map(([name, fetchModule]) => defineSharedModule(name, fetchModule)));\n}\n// only exposed for tests\nexport function reset() {\n  Object.keys(modulePromises).forEach((key) => {\n    delete window[withNamespace(key)];\n    delete modulePromises[key];\n  });\n};(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(modulePromises, \"modulePromises\", \"/home/pawank/Documents/dcim/superset/superset-frontend/packages/superset-ui-core/src/dynamic-plugins/shared-modules.ts\");reactHotLoader.register(withNamespace, \"withNamespace\", \"/home/pawank/Documents/dcim/superset/superset-frontend/packages/superset-ui-core/src/dynamic-plugins/shared-modules.ts\");reactHotLoader.register(defineSharedModule, \"defineSharedModule\", \"/home/pawank/Documents/dcim/superset/superset-frontend/packages/superset-ui-core/src/dynamic-plugins/shared-modules.ts\");reactHotLoader.register(defineSharedModules, \"defineSharedModules\", \"/home/pawank/Documents/dcim/superset/superset-frontend/packages/superset-ui-core/src/dynamic-plugins/shared-modules.ts\");reactHotLoader.register(reset, \"reset\", \"/home/pawank/Documents/dcim/superset/superset-frontend/packages/superset-ui-core/src/dynamic-plugins/shared-modules.ts\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["modulePromises","withNamespace","name","defineSharedModule","fetchModule","moduleKey","window","modulePromise","defineSharedModules","moduleMap","Promise","all","Object","entries","map","reset","keys","forEach","key","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/packages/superset-ui-core/src/dynamic-plugins/shared-modules.ts"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n/** The type of an imported module. Don't fully understand this, yet. */\nexport type Module = any;\n\n/**\n * This is where packages are stored. We use window, because it plays well with Webpack.\n * To avoid\n * Have to amend the type of window, because window's usual type doesn't describe these fields.\n */\ninterface ModuleReferencer {\n  [packageKey: string]: Promise<Module>;\n}\n\ndeclare const window: Window & typeof globalThis & ModuleReferencer;\n\nconst modulePromises: { [key: string]: Promise<Module> } = {};\n\nconst withNamespace = (name: string) => `__superset__/${name}`;\n\n/**\n * Dependency management using global variables, because for the life of me\n * I can't figure out how to hook into UMD from a dynamically imported package.\n *\n * This defines a dynamically imported js module that can be used to import from\n * multiple different plugins.\n *\n * When importing a common module (such as react or lodash or superset-ui)\n * from a plugin, the plugin's build config will be able to\n * reference these globals instead of rebuilding them.\n *\n * @param name the module's name (should match name in package.json)\n * @param promise the promise resulting from a call to `import(name)`\n */\nexport async function defineSharedModule(\n  name: string,\n  fetchModule: () => Promise<Module>,\n) {\n  // this field on window is used by dynamic plugins to reference the module\n  const moduleKey = withNamespace(name);\n\n  if (!window[moduleKey] && !modulePromises[name]) {\n    // if the module has not been loaded, load it\n    const modulePromise = fetchModule();\n    modulePromises[name] = modulePromise;\n    // wait for the module to load, and attach the result to window\n    // so that it can be referenced by plugins\n    window[moduleKey] = await modulePromise;\n  }\n\n  // we always return a reference to the promise.\n  // Multiple consumers can `.then()` or `await` the same promise,\n  // even long after it has completed,\n  // and it will always call back with the same reference.\n  return modulePromises[name];\n}\n\n/**\n * Define multiple shared modules at once, using a map of name -> `import(name)`\n *\n * @see defineSharedModule\n * @param moduleMap\n */\nexport async function defineSharedModules(moduleMap: {\n  [key: string]: () => Promise<Module>;\n}) {\n  return Promise.all(\n    Object.entries(moduleMap).map(([name, fetchModule]) =>\n      defineSharedModule(name, fetchModule),\n    ),\n  );\n}\n\n// only exposed for tests\nexport function reset() {\n  Object.keys(modulePromises).forEach(key => {\n    delete window[withNamespace(key)];\n    delete modulePromises[key];\n  });\n}\n"],"mappings":"wSAAA;;;;;;;;;;;;;;;;;;AAiCA,MAAMA,cAAc,GAAuC,EAAE;AAE7D,MAAMC,aAAa,GAAGA,CAACC,IAAY,KAAK,gBAAgBA,IAAI,EAAE;AAE9D;;;;;;;;;;;;;;AAcA,OAAO,eAAeC,kBAAkBA,CACtCD,IAAY,EACZE,WAAkC;EAElC;EACA,MAAMC,SAAS,GAAGJ,aAAa,CAACC,IAAI,CAAC;EAErC,IAAI,CAACI,MAAM,CAACD,SAAS,CAAC,IAAI,CAACL,cAAc,CAACE,IAAI,CAAC,EAAE;IAC/C;IACA,MAAMK,aAAa,GAAGH,WAAW,EAAE;IACnCJ,cAAc,CAACE,IAAI,CAAC,GAAGK,aAAa;IACpC;IACA;IACAD,MAAM,CAACD,SAAS,CAAC,GAAG,MAAME,aAAa;;EAGzC;EACA;EACA;EACA;EACA,OAAOP,cAAc,CAACE,IAAI,CAAC;AAC7B;AAEA;;;;;;AAMA,OAAO,eAAeM,mBAAmBA,CAACC,SAEzC;EACC,OAAOC,OAAO,CAACC,GAAG,CAChBC,MAAM,CAACC,OAAO,CAACJ,SAAS,CAAC,CAACK,GAAG,CAAC,CAAC,CAACZ,IAAI,EAAEE,WAAW,CAAC,KAChDD,kBAAkB,CAACD,IAAI,EAAEE,WAAW,CAAC,CACtC,CACF;AACH;AAEA;AACA,OAAM,SAAUW,KAAKA,CAAA;EACnBH,MAAM,CAACI,IAAI,CAAChB,cAAc,CAAC,CAACiB,OAAO,CAAC,CAAAC,GAAG,KAAG;IACxC,OAAOZ,MAAM,CAACL,aAAa,CAACiB,GAAG,CAAC,CAAC;IACjC,OAAOlB,cAAc,CAACkB,GAAG,CAAC;EAC5B,CAAC,CAAC;AACJ,CAAC,mBAAAC,cAAA,UAAAC,oBAAA,mBAAAA,oBAAA,CAAAC,OAAA,GAAAC,SAAA,MAAAH,cAAA,WAAAA,cAAA,CAAAI,QAAA,CA/DKvB,cAAc,8IAAAmB,cAAA,CAAAI,QAAA,CAEdtB,aAAa,6IAAAkB,cAAA,CAAAI,QAAA,CAgBGpB,kBAAkB,kJAAAgB,cAAA,CAAAI,QAAA,CA6BlBf,mBAAmB,mJAAAW,cAAA,CAAAI,QAAA,CAWzBR,KAAK,6JAAAS,WAAA,UAAAJ,oBAAA,mBAAAA,oBAAA,CAAAI,WAAA,GAAAF,SAAA,CAAAE,WAAA,IAAAA,WAAA,CAAAC,MAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}