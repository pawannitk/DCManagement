{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState, useEffect, useMemo, useCallback } from 'react';\nimport { css, isFeatureEnabled, FeatureFlag, styled, SupersetClient, t } from '@superset-ui/core';\nimport rison from 'rison';\nimport { useSingleViewResource } from 'src/views/CRUD/hooks';\nimport { InputNumber } from 'src/components/Input';\nimport { Switch } from 'src/components/Switch';\nimport Modal from 'src/components/Modal';\nimport Collapse from 'src/components/Collapse';\nimport TimezoneSelector from 'src/components/TimezoneSelector';\nimport { propertyComparator } from 'src/components/Select/utils';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport { AntdCheckbox, AsyncSelect, Select } from 'src/components';\nimport TextAreaControl from 'src/explore/components/controls/TextAreaControl';\nimport { useCommonConf } from 'src/features/databases/state';\nimport { InfoTooltipWithTrigger } from '@superset-ui/chart-controls';\nimport { Sections } from 'src/features/alerts/types';\nimport { useSelector } from 'react-redux';\nimport NumberInput from './components/NumberInput';\nimport { AlertReportCronScheduler } from './components/AlertReportCronScheduler';\nimport { NotificationMethod } from './components/NotificationMethod';\nimport ValidatedPanelHeader from './components/ValidatedPanelHeader';\nimport StyledPanel from './components/StyledPanel';\nimport { buildErrorTooltipMessage } from './buildErrorTooltipMessage';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nconst TIMEOUT_MIN = 1;\nconst TEXT_BASED_VISUALIZATION_TYPES = [\n'pivot_table_v2',\n'table',\n'paired_ttest'];\n\nconst DEFAULT_WORKING_TIMEOUT = 3600;\nconst DEFAULT_CRON_VALUE = '0 0 * * *'; // every day\nconst DEFAULT_RETENTION = 90;\nconst DEFAULT_NOTIFICATION_METHODS = ['Email'];\nconst DEFAULT_NOTIFICATION_FORMAT = 'PNG';\nconst CONDITIONS = [\n{\n  label: t('< (Smaller than)'),\n  value: '<'\n},\n{\n  label: t('> (Larger than)'),\n  value: '>'\n},\n{\n  label: t('<= (Smaller or equal)'),\n  value: '<='\n},\n{\n  label: t('>= (Larger or equal)'),\n  value: '>='\n},\n{\n  label: t('== (Is equal)'),\n  value: '=='\n},\n{\n  label: t('!= (Is not equal)'),\n  value: '!='\n},\n{\n  label: t('Not null'),\n  value: 'not null'\n}];\n\nconst RETENTION_OPTIONS = [\n{\n  label: t('None'),\n  value: 0\n},\n{\n  label: t('30 days'),\n  value: 30\n},\n{\n  label: t('60 days'),\n  value: 60\n},\n{\n  label: t('90 days'),\n  value: 90\n}];\n\nconst CONTENT_TYPE_OPTIONS = [\n{\n  label: t('Dashboard'),\n  value: 'dashboard'\n},\n{\n  label: t('Chart'),\n  value: 'chart'\n}];\n\nconst FORMAT_OPTIONS = {\n  pdf: {\n    label: t('Send as PDF'),\n    value: 'PDF'\n  },\n  png: {\n    label: t('Send as PNG'),\n    value: 'PNG'\n  },\n  csv: {\n    label: t('Send as CSV'),\n    value: 'CSV'\n  },\n  txt: {\n    label: t('Send as text'),\n    value: 'TEXT'\n  }\n};\n// Apply to final text input components of each collapse panel\nconst noMarginBottom = css`\n  margin-bottom: 0;\n`;\n/*\nHeight of modal body defined here, total width defined at component invocation as antd prop.\n */\nconst StyledModal = styled(Modal)`\n  .ant-modal-body {\n    height: 720px;\n  }\n\n  .control-label {\n    margin-top: ${({ theme }) => theme.gridUnit}px;\n  }\n\n  .ant-collapse > .ant-collapse-item {\n    border-bottom: none;\n  }\n\n  .inline-container {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    &.wrap {\n      flex-wrap: wrap;\n    }\n\n    > div {\n      flex: 1 1 auto;\n    }\n  }\n`;\nconst StyledSwitchContainer = styled.div`\n  display: flex;\n  align-items: center;\n  margin-top: 10px;\n\n  .switch-label {\n    margin-left: 10px;\n  }\n`;\nexport const StyledInputContainer = styled.div`\n  ${({ theme }) => css`\n    flex: 1;\n    margin-top: 0px;\n    margin-bottom: ${theme.gridUnit * 4}px;\n\n    input::-webkit-outer-spin-button,\n    input::-webkit-inner-spin-button {\n      -webkit-appearance: none;\n      margin: 0;\n    }\n    input[type='number'] {\n      -moz-appearance: textfield;\n    }\n\n    .helper {\n      display: block;\n      color: ${theme.colors.grayscale.base};\n      font-size: ${theme.typography.sizes.s}px;\n      padding: ${theme.gridUnit}px 0;\n      text-align: left;\n    }\n\n    .required {\n      margin-left: ${theme.gridUnit / 2}px;\n      color: ${theme.colors.error.base};\n    }\n\n    .input-container {\n      display: flex;\n      align-items: center;\n\n      > div {\n        width: 100%;\n      }\n\n      label {\n        display: flex;\n        margin-right: ${theme.gridUnit * 2}px;\n      }\n\n      i {\n        margin: 0 ${theme.gridUnit}px;\n      }\n    }\n\n    input,\n    textarea {\n      flex: 1 1 auto;\n    }\n\n    input[disabled] {\n      color: ${theme.colors.grayscale.base};\n    }\n\n    textarea {\n      height: 300px;\n      resize: none;\n    }\n\n    input::placeholder,\n    textarea::placeholder {\n      color: ${theme.colors.grayscale.light1};\n    }\n\n    textarea,\n    input[type='text'],\n    input[type='number'] {\n      padding: ${theme.gridUnit}px ${theme.gridUnit * 2}px;\n      border-style: none;\n      border: 1px solid ${theme.colors.grayscale.light2};\n      border-radius: ${theme.gridUnit}px;\n\n      &[name='description'] {\n        flex: 1 1 auto;\n      }\n    }\n\n    .input-label {\n      margin-left: 10px;\n    }\n  `}\n`;\nconst StyledCheckbox = styled(AntdCheckbox)`\n  margin-top: ${({ theme }) => theme.gridUnit * 0}px;\n`;\nconst StyledTooltip = styled(InfoTooltipWithTrigger)`\n  margin-left: ${({ theme }) => theme.gridUnit}px;\n`;\n// Notification Method components\nconst StyledNotificationAddButton = styled.div`\n  ${({ theme }) => css`\n    color: ${theme.colors.primary.dark1};\n    cursor: pointer;\n\n    i {\n      margin-right: ${theme.gridUnit * 2}px;\n    }\n\n    &.disabled {\n      color: ${theme.colors.grayscale.light1};\n      cursor: default;\n    }\n  `}\n`;\nconst StyledNotificationMethodWrapper = styled.div`\n  .inline-container .input-container {\n    margin-left: 0;\n  }\n`;\nconst inputSpacer = (theme) => css`\n  margin-right: ${theme.gridUnit * 3}px;\n`;\nexport const TRANSLATIONS = {\n  // Panel titles\n  GENERAL_TITLE: t('General information'),\n  ALERT_CONDITION_TITLE: t('Alert condition'),\n  ALERT_CONTENTS_TITLE: t('Alert contents'),\n  REPORT_CONTENTS_TITLE: t('Report contents'),\n  SCHEDULE_TITLE: t('Schedule'),\n  NOTIFICATION_TITLE: t('Notification method'),\n  // Error text\n  NAME_ERROR_TEXT: t('name'),\n  OWNERS_ERROR_TEXT: t('owners'),\n  CONTENT_ERROR_TEXT: t('content type'),\n  DATABASE_ERROR_TEXT: t('database'),\n  SQL_ERROR_TEXT: t('sql'),\n  ALERT_CONDITION_ERROR_TEXT: t('alert condition'),\n  CRONTAB_ERROR_TEXT: t('crontab'),\n  WORKING_TIMEOUT_ERROR_TEXT: t('working timeout'),\n  RECIPIENTS_ERROR_TEXT: t('recipients'),\n  EMAIL_SUBJECT_ERROR_TEXT: t('email subject'),\n  ERROR_TOOLTIP_MESSAGE: t('Not all required fields are complete. Please provide the following:')\n};\nconst NotificationMethodAdd = ({ status = 'active', onClick }) => {\n  if (status === 'hidden') {\n    return null;\n  }\n  const checkStatus = () => {\n    if (status !== 'disabled') {\n      onClick();\n    }\n  };\n  return ___EmotionJSX(StyledNotificationAddButton, { className: status, onClick: checkStatus },\n  ___EmotionJSX(\"i\", { className: \"fa fa-plus\" }), ' ',\n  status === 'active' ?\n  t('Add another notification method') :\n  t('Add delivery method')\n  );\n};\nconst AlertReportModal = ({ addDangerToast, onAdd, onHide, show, alert = null, isReport = false, addSuccessToast }) => {var _currentAlert$databas2, _currentAlert$databas3, _currentAlert$validat5, _currentAlert$validat6, _currentAlert$chart4, _currentAlert$chart5, _currentAlert$dashboa4, _currentAlert$dashboa5;\n  const currentUser = useSelector((state) => state.user);\n  // Check config for alternate notification methods setting\n  const conf = useCommonConf();\n  const allowedNotificationMethods = (conf == null ? void 0 : conf.ALERT_REPORTS_NOTIFICATION_METHODS) || DEFAULT_NOTIFICATION_METHODS;\n  const [disableSave, setDisableSave] = useState(true);\n  const [currentAlert, setCurrentAlert] = useState();\n  const [isHidden, setIsHidden] = useState(true);\n  const [contentType, setContentType] = useState('dashboard');\n  const [reportFormat, setReportFormat] = useState(DEFAULT_NOTIFICATION_FORMAT);\n  const [forceScreenshot, setForceScreenshot] = useState(false);\n  const [isScreenshot, setIsScreenshot] = useState(false);\n  useEffect(() => {\n    setIsScreenshot(reportFormat === 'PNG');\n  }, [reportFormat]);\n  // Dropdown options\n  const [conditionNotNull, setConditionNotNull] = useState(false);\n  const [sourceOptions, setSourceOptions] = useState([]);\n  const [dashboardOptions, setDashboardOptions] = useState([]);\n  const [chartOptions, setChartOptions] = useState([]);\n  // Validation\n  const [validationStatus, setValidationStatus] = useState({\n    [Sections.General]: {\n      hasErrors: false,\n      name: TRANSLATIONS.GENERAL_TITLE,\n      errors: []\n    },\n    [Sections.Content]: {\n      hasErrors: false,\n      name: isReport ?\n      TRANSLATIONS.REPORT_CONTENTS_TITLE :\n      TRANSLATIONS.ALERT_CONTENTS_TITLE,\n      errors: []\n    },\n    [Sections.Alert]: {\n      hasErrors: false,\n      name: TRANSLATIONS.ALERT_CONDITION_TITLE,\n      errors: []\n    },\n    [Sections.Schedule]: {\n      hasErrors: false,\n      name: TRANSLATIONS.SCHEDULE_TITLE,\n      errors: []\n    },\n    [Sections.Notification]: {\n      hasErrors: false,\n      name: TRANSLATIONS.NOTIFICATION_TITLE,\n      errors: []\n    }\n  });\n  const [errorTooltipMessage, setErrorTooltipMessage] = useState('');\n  const updateValidationStatus = (section, errors) => {\n    setValidationStatus((currentValidationData) => ({\n      ...currentValidationData,\n      [section]: {\n        hasErrors: errors.length > 0,\n        name: currentValidationData[section].name,\n        errors\n      }\n    }));\n  };\n  // Chart metadata\n  const [chartVizType, setChartVizType] = useState('');\n  const reportOrAlert = isReport ? 'report' : 'alert';\n  const isEditMode = alert !== null;\n  const formatOptionEnabled = isFeatureEnabled(FeatureFlag.AlertsAttachReports) || isReport;\n  const [notificationAddState, setNotificationAddState] = useState('active');\n  const [notificationSettings, setNotificationSettings] = useState([]);\n  const [emailSubject, setEmailSubject] = useState('');\n  const [emailError, setEmailError] = useState(false);\n  const onNotificationAdd = () => {\n    setNotificationSettings([\n    ...notificationSettings,\n    {\n      recipients: '',\n      // options shown in the newly added notification method\n      options: allowedNotificationMethods.filter(\n        // are filtered such that\n        (option) =>\n        // options are not included\n        !notificationSettings.reduce(\n          // when it exists in previous notificationSettings\n          (accum, setting) => accum || option === setting.method, false))\n    }]\n    );\n    setNotificationAddState(notificationSettings.length === allowedNotificationMethods.length ?\n    'hidden' :\n    'disabled');\n  };\n  const { ALERT_REPORTS_DEFAULT_WORKING_TIMEOUT, ALERT_REPORTS_DEFAULT_CRON_VALUE, ALERT_REPORTS_DEFAULT_RETENTION } = useSelector((state) => {var _state$common, _conf$ALERT_REPORTS_D, _conf$ALERT_REPORTS_D2, _conf$ALERT_REPORTS_D3;\n    const conf = (_state$common = state.common) == null ? void 0 : _state$common.conf;\n    return {\n      ALERT_REPORTS_DEFAULT_WORKING_TIMEOUT: (_conf$ALERT_REPORTS_D = conf == null ? void 0 : conf.ALERT_REPORTS_DEFAULT_WORKING_TIMEOUT) != null ? _conf$ALERT_REPORTS_D : DEFAULT_WORKING_TIMEOUT,\n      ALERT_REPORTS_DEFAULT_CRON_VALUE: (_conf$ALERT_REPORTS_D2 = conf == null ? void 0 : conf.ALERT_REPORTS_DEFAULT_CRON_VALUE) != null ? _conf$ALERT_REPORTS_D2 : DEFAULT_CRON_VALUE,\n      ALERT_REPORTS_DEFAULT_RETENTION: (_conf$ALERT_REPORTS_D3 = conf == null ? void 0 : conf.ALERT_REPORTS_DEFAULT_RETENTION) != null ? _conf$ALERT_REPORTS_D3 : DEFAULT_RETENTION\n    };\n  });\n  const defaultAlert = {\n    active: true,\n    creation_method: 'alerts_reports',\n    crontab: ALERT_REPORTS_DEFAULT_CRON_VALUE,\n    log_retention: ALERT_REPORTS_DEFAULT_RETENTION,\n    working_timeout: ALERT_REPORTS_DEFAULT_WORKING_TIMEOUT,\n    name: '',\n    owners: [],\n    recipients: [],\n    sql: '',\n    email_subject: '',\n    validator_config_json: {},\n    validator_type: '',\n    force_screenshot: false,\n    grace_period: undefined\n  };\n  const updateNotificationSetting = (index, setting) => {\n    const settings = [...notificationSettings];\n    settings[index] = setting;\n    // if you've changed notification method -> remove trailing methods\n    if (notificationSettings[index].method !== setting.method) {\n      notificationSettings[index] = setting;\n      setNotificationSettings(notificationSettings.filter((_, idx) => idx <= index));\n      if (notificationSettings.length - 1 > index) {\n        setNotificationAddState('active');\n      }\n      if (setting.method !== undefined && notificationAddState !== 'hidden') {\n        setNotificationAddState('active');\n      }\n    } else\n    {\n      setNotificationSettings(settings);\n    }\n  };\n  const removeNotificationSetting = (index) => {\n    const settings = notificationSettings.slice();\n    settings.splice(index, 1);\n    setNotificationSettings(settings);\n    setNotificationAddState('active');\n  };\n  // Alert fetch logic\n  const { state: { loading, resource, error: fetchError }, fetchResource, createResource, updateResource, clearError } = useSingleViewResource('report', t('report'), addDangerToast);\n  // Functions\n  const hide = () => {\n    clearError();\n    setIsHidden(true);\n    onHide();\n    setNotificationSettings([]);\n    setCurrentAlert({ ...defaultAlert });\n    setNotificationAddState('active');\n  };\n  const onSave = () => {var _currentAlert$chart, _currentAlert$dashboa, _currentAlert$databas;\n    // Notification Settings\n    const recipients = [];\n    notificationSettings.forEach((setting) => {\n      if (setting.method && setting.recipients.length) {\n        recipients.push({\n          recipient_config_json: {\n            target: setting.recipients\n          },\n          type: setting.method\n        });\n      }\n    });\n    const shouldEnableForceScreenshot = contentType === 'chart' && !isReport;\n    const data = {\n      ...currentAlert,\n      type: isReport ? 'Report' : 'Alert',\n      force_screenshot: shouldEnableForceScreenshot || forceScreenshot,\n      validator_type: conditionNotNull ? 'not null' : 'operator',\n      validator_config_json: conditionNotNull ?\n      {} :\n      currentAlert == null ? void 0 : currentAlert.validator_config_json,\n      chart: contentType === 'chart' ? currentAlert == null ? void 0 : (_currentAlert$chart = currentAlert.chart) == null ? void 0 : _currentAlert$chart.value : null,\n      dashboard: contentType === 'dashboard' ? currentAlert == null ? void 0 : (_currentAlert$dashboa = currentAlert.dashboard) == null ? void 0 : _currentAlert$dashboa.value : null,\n      custom_width: isScreenshot ? currentAlert == null ? void 0 : currentAlert.custom_width : undefined,\n      database: currentAlert == null ? void 0 : (_currentAlert$databas = currentAlert.database) == null ? void 0 : _currentAlert$databas.value,\n      owners: ((currentAlert == null ? void 0 : currentAlert.owners) || []).map((owner) => owner.value || owner.id),\n      recipients,\n      report_format: reportFormat || DEFAULT_NOTIFICATION_FORMAT\n    };\n    if (data.recipients && !data.recipients.length) {\n      delete data.recipients;\n    }\n    data.context_markdown = 'string';\n    if (isEditMode) {\n      // Edit\n      if (currentAlert != null && currentAlert.id) {\n        const update_id = currentAlert.id;\n        delete data.id;\n        delete data.created_by;\n        delete data.last_eval_dttm;\n        delete data.last_state;\n        delete data.last_value;\n        delete data.last_value_row_json;\n        updateResource(update_id, data).then((response) => {\n          if (!response) {\n            return;\n          }\n          addSuccessToast(t('%s updated', data.type));\n          if (onAdd) {\n            onAdd();\n          }\n          hide();\n        });\n      }\n    } else\n    if (currentAlert) {\n      // Create\n      createResource(data).then((response) => {\n        if (!response) {\n          return;\n        }\n        addSuccessToast(t('%s updated', data.type));\n        if (onAdd) {\n          onAdd(response);\n        }\n        hide();\n      });\n    }\n  };\n  // Fetch data to populate form dropdowns\n  const loadOwnerOptions = useMemo(() => (input = '', page, pageSize) => {\n    const query = rison.encode({\n      filter: input,\n      page,\n      page_size: pageSize\n    });\n    return SupersetClient.get({\n      endpoint: `/api/v1/report/related/created_by?q=${query}`\n    }).then((response) => ({\n      data: response.json.result.map((item) => ({\n        value: item.value,\n        label: item.text\n      })),\n      totalCount: response.json.count\n    }));\n  }, []);\n  const getSourceData = useCallback((db) => {\n    const database = db || (currentAlert == null ? void 0 : currentAlert.database);\n    if (!database || database.label) {\n      return null;\n    }\n    let result;\n    // Cycle through source options to find the selected option\n    sourceOptions.forEach((source) => {\n      if (source.value === database.value || source.value === database.id) {\n        result = source;\n      }\n    });\n    return result;\n  }, [currentAlert == null ? void 0 : currentAlert.database, sourceOptions]);\n  // Updating alert/report state\n  const updateAlertState = (name, value) => {\n    setCurrentAlert((currentAlertData) => ({\n      ...currentAlertData,\n      [name]: value\n    }));\n  };\n  const loadSourceOptions = useMemo(() => (input = '', page, pageSize) => {\n    const query = rison.encode({\n      filter: input,\n      page,\n      page_size: pageSize\n    });\n    return SupersetClient.get({\n      endpoint: `/api/v1/report/related/database?q=${query}`\n    }).then((response) => {\n      const list = response.json.result.map((item) => ({\n        value: item.value,\n        label: item.text\n      }));\n      setSourceOptions(list);\n      return { data: list, totalCount: response.json.count };\n    });\n  }, []);\n  const databaseLabel = (currentAlert == null ? void 0 : currentAlert.database) && !currentAlert.database.label;\n  useEffect(() => {\n    // Find source if current alert has one set\n    if (databaseLabel) {\n      updateAlertState('database', getSourceData());\n    }\n  }, [databaseLabel, getSourceData]);\n  const loadDashboardOptions = useMemo(() => (input = '', page, pageSize) => {\n    const query = rison.encode_uri({\n      filter: input,\n      page,\n      page_size: pageSize\n    });\n    return SupersetClient.get({\n      endpoint: `/api/v1/report/related/dashboard?q=${query}`\n    }).then((response) => {\n      const list = response.json.result.map((item) => ({\n        value: item.value,\n        label: item.text\n      }));\n      setDashboardOptions(list);\n      return { data: list, totalCount: response.json.count };\n    });\n  }, []);\n  const getDashboardData = (db) => {\n    const dashboard = db || (currentAlert == null ? void 0 : currentAlert.dashboard);\n    if (!dashboard || dashboard.label) {\n      return null;\n    }\n    let result;\n    // Cycle through dashboard options to find the selected option\n    dashboardOptions.forEach((dash) => {\n      if (dash.value === dashboard.value || dash.value === dashboard.id) {\n        result = dash;\n      }\n    });\n    return result;\n  };\n  const getChartData = useCallback((chartData) => {\n    const chart = chartData || (currentAlert == null ? void 0 : currentAlert.chart);\n    if (!chart || chart.label) {\n      return null;\n    }\n    let result;\n    // Cycle through chart options to find the selected option\n    chartOptions.forEach((slice) => {\n      if (slice.value === chart.value || slice.value === chart.id) {\n        result = slice;\n      }\n    });\n    return result;\n  }, [chartOptions, currentAlert == null ? void 0 : currentAlert.chart]);\n  const noChartLabel = (currentAlert == null ? void 0 : currentAlert.chart) && !(currentAlert != null && currentAlert.chart.label);\n  useEffect(() => {\n    // Find source if current alert has one set\n    if (noChartLabel) {\n      updateAlertState('chart', getChartData());\n    }\n  }, [getChartData, noChartLabel]);\n  const loadChartOptions = useMemo(() => (input = '', page, pageSize) => {\n    const query = rison.encode_uri({\n      filter: input,\n      page,\n      page_size: pageSize\n    });\n    return SupersetClient.get({\n      endpoint: `/api/v1/report/related/chart?q=${query}`\n    }).then((response) => {\n      const list = response.json.result.map((item) => ({\n        value: item.value,\n        label: item.text\n      }));\n      setChartOptions(list);\n      return { data: list, totalCount: response.json.count };\n    });\n  }, []);\n  const getChartVisualizationType = (chart) => SupersetClient.get({\n    endpoint: `/api/v1/chart/${chart.value}`\n  }).then((response) => setChartVizType(response.json.result.viz_type));\n  // Handle input/textarea updates\n  const onInputChange = (event) => {\n    const { target: { type, value, name } } = event;\n    const parsedValue = type === 'number' ? parseInt(value, 10) || null : value;\n    updateAlertState(name, parsedValue);\n    if (name === 'name') {\n      updateEmailSubject();\n    }\n  };\n  const onCustomWidthChange = (value) => {\n    updateAlertState('custom_width', value);\n  };\n  const onTimeoutVerifyChange = (event) => {\n    const { target } = event;\n    const value = +target.value;\n    // Need to make sure grace period is not lower than TIMEOUT_MIN\n    if (value === 0) {\n      updateAlertState(target.name, undefined);\n    } else\n    {\n      updateAlertState(target.name, value ? Math.max(value, TIMEOUT_MIN) : value);\n    }\n  };\n  const onSQLChange = (value) => {\n    updateAlertState('sql', value || '');\n  };\n  const onOwnersChange = (value) => {\n    updateAlertState('owners', value || []);\n  };\n  const onSourceChange = (value) => {\n    updateAlertState('database', value || []);\n  };\n  const onDashboardChange = (dashboard) => {\n    updateAlertState('dashboard', dashboard || undefined);\n    updateAlertState('chart', null);\n  };\n  const onChartChange = (chart) => {\n    getChartVisualizationType(chart);\n    updateAlertState('chart', chart || undefined);\n    updateAlertState('dashboard', null);\n  };\n  const onActiveSwitch = (checked) => {\n    updateAlertState('active', checked);\n  };\n  const onConditionChange = (op) => {var _currentAlert$validat;\n    setConditionNotNull(op === 'not null');\n    const config = {\n      op,\n      threshold: currentAlert ? (_currentAlert$validat =\n      currentAlert.validator_config_json) == null ? void 0 : _currentAlert$validat.threshold :\n      undefined\n    };\n    updateAlertState('validator_config_json', config);\n  };\n  const onThresholdChange = (event) => {var _currentAlert$validat2;\n    const { target } = event;\n    const config = {\n      op: currentAlert ? (_currentAlert$validat2 = currentAlert.validator_config_json) == null ? void 0 : _currentAlert$validat2.op : undefined,\n      threshold: target.value\n    };\n    updateAlertState('validator_config_json', config);\n  };\n  const onLogRetentionChange = (retention) => {\n    updateAlertState('log_retention', retention);\n  };\n  const onTimezoneChange = (timezone) => {\n    updateAlertState('timezone', timezone);\n  };\n  const onContentTypeChange = (value) => {\n    // When switch content type, reset force_screenshot to false\n    setForceScreenshot(false);\n    setContentType(value);\n  };\n  const onFormatChange = (value) => {\n    setReportFormat(value);\n  };\n  const onForceScreenshotChange = (event) => {\n    setForceScreenshot(event.target.checked);\n  };\n  // Make sure notification settings has the required info\n  const checkNotificationSettings = () => {\n    if (!notificationSettings.length) {\n      return false;\n    }\n    let hasInfo = false;\n    notificationSettings.forEach((setting) => {var _setting$recipients;\n      if (!!setting.method && (_setting$recipients = setting.recipients) != null && _setting$recipients.length) {\n        hasInfo = true;\n      }\n    });\n    return hasInfo;\n  };\n  const validateGeneralSection = () => {var _currentAlert$name, _currentAlert$owners;\n    const errors = [];\n    if (!(currentAlert != null && (_currentAlert$name = currentAlert.name) != null && _currentAlert$name.length)) {\n      errors.push(TRANSLATIONS.NAME_ERROR_TEXT);\n    }\n    if (!(currentAlert != null && (_currentAlert$owners = currentAlert.owners) != null && _currentAlert$owners.length)) {\n      errors.push(TRANSLATIONS.OWNERS_ERROR_TEXT);\n    }\n    updateValidationStatus(Sections.General, errors);\n  };\n  const validateContentSection = () => {\n    const errors = [];\n    if (!(contentType === 'dashboard' && !!(currentAlert != null && currentAlert.dashboard) ||\n    contentType === 'chart' && !!(currentAlert != null && currentAlert.chart))) {\n      errors.push(TRANSLATIONS.CONTENT_ERROR_TEXT);\n    }\n    updateValidationStatus(Sections.Content, errors);\n  };\n  const validateAlertSection = () => {var _currentAlert$sql, _currentAlert$validat3, _currentAlert$validat4;\n    const errors = [];\n    if (!(currentAlert != null && currentAlert.database)) {\n      errors.push(TRANSLATIONS.DATABASE_ERROR_TEXT);\n    }\n    if (!(currentAlert != null && (_currentAlert$sql = currentAlert.sql) != null && _currentAlert$sql.length)) {\n      errors.push(TRANSLATIONS.SQL_ERROR_TEXT);\n    }\n    if (!((conditionNotNull || !!(currentAlert != null && (_currentAlert$validat3 = currentAlert.validator_config_json) != null && _currentAlert$validat3.op)) && (\n    conditionNotNull ||\n    (currentAlert == null ? void 0 : (_currentAlert$validat4 = currentAlert.validator_config_json) == null ? void 0 : _currentAlert$validat4.threshold) !== undefined))) {\n      errors.push(TRANSLATIONS.ALERT_CONDITION_ERROR_TEXT);\n    }\n    updateValidationStatus(Sections.Alert, errors);\n  };\n  const validateScheduleSection = () => {var _currentAlert$crontab;\n    const errors = [];\n    if (!(currentAlert != null && (_currentAlert$crontab = currentAlert.crontab) != null && _currentAlert$crontab.length)) {\n      errors.push(TRANSLATIONS.CRONTAB_ERROR_TEXT);\n    }\n    if (!(currentAlert != null && currentAlert.working_timeout)) {\n      errors.push(TRANSLATIONS.WORKING_TIMEOUT_ERROR_TEXT);\n    }\n    updateValidationStatus(Sections.Schedule, errors);\n  };\n  const validateNotificationSection = () => {\n    const hasErrors = !checkNotificationSettings();\n    const errors = hasErrors ? [TRANSLATIONS.RECIPIENTS_ERROR_TEXT] : [];\n    if (emailError) {\n      errors.push(TRANSLATIONS.EMAIL_SUBJECT_ERROR_TEXT);\n    }\n    updateValidationStatus(Sections.Notification, errors);\n  };\n  const validateAll = () => {\n    validateGeneralSection();\n    validateContentSection();\n    if (!isReport)\n    validateAlertSection();\n    validateScheduleSection();\n    validateNotificationSection();\n  };\n  const enforceValidation = () => {\n    const sections = [\n    Sections.General,\n    Sections.Content,\n    isReport ? undefined : Sections.Alert,\n    Sections.Schedule,\n    Sections.Notification];\n\n    const hasErrors = sections.some((section) => section && validationStatus[section].hasErrors);\n    const tooltip = hasErrors ? buildErrorTooltipMessage(validationStatus) : '';\n    setErrorTooltipMessage(tooltip);\n    setDisableSave(hasErrors);\n  };\n  // Initialize\n  useEffect(() => {\n    if (isEditMode && (\n    !(currentAlert != null && currentAlert.id) || (alert == null ? void 0 : alert.id) !== currentAlert.id || isHidden && show)) {\n      if ((alert == null ? void 0 : alert.id) !== null && !loading && !fetchError) {\n        const id = alert.id || 0;\n        fetchResource(id);\n      }\n    } else\n    if (!isEditMode && (\n    !currentAlert || currentAlert.id || isHidden && show)) {\n      setCurrentAlert({\n        ...defaultAlert,\n        owners: currentUser ?\n        [\n        {\n          value: currentUser.userId,\n          label: `${currentUser.firstName} ${currentUser.lastName}`\n        }] :\n\n        []\n      });\n      setNotificationSettings([\n      {\n        recipients: '',\n        options: allowedNotificationMethods,\n        method: 'Email'\n      }]\n      );\n      setNotificationAddState('active');\n    }\n  }, [alert]);\n  useEffect(() => {\n    if (resource) {\n      // Add notification settings\n      const settings = (resource.recipients || []).map((setting) => {\n        const config = typeof setting.recipient_config_json === 'string' ?\n        JSON.parse(setting.recipient_config_json) :\n        {};\n        return {\n          method: setting.type,\n          // @ts-ignore: Type not assignable\n          recipients: config.target || setting.recipient_config_json,\n          options: allowedNotificationMethods\n        };\n      });\n      setNotificationSettings(settings);\n      setNotificationAddState(settings.length === allowedNotificationMethods.length ?\n      'hidden' :\n      'active');\n      setContentType(resource.chart ? 'chart' : 'dashboard');\n      setReportFormat(resource.report_format || DEFAULT_NOTIFICATION_FORMAT);\n      const validatorConfig = typeof resource.validator_config_json === 'string' ?\n      JSON.parse(resource.validator_config_json) :\n      resource.validator_config_json;\n      setConditionNotNull(resource.validator_type === 'not null');\n      if (resource.chart) {\n        setChartVizType(resource.chart.viz_type);\n      }\n      setForceScreenshot(resource.force_screenshot);\n      setCurrentAlert({\n        ...resource,\n        chart: resource.chart ?\n        getChartData(resource.chart) || {\n          value: resource.chart.id,\n          label: resource.chart.slice_name\n        } :\n        undefined,\n        dashboard: resource.dashboard ?\n        getDashboardData(resource.dashboard) || {\n          value: resource.dashboard.id,\n          label: resource.dashboard.dashboard_title\n        } :\n        undefined,\n        database: resource.database ?\n        getSourceData(resource.database) || {\n          value: resource.database.id,\n          label: resource.database.database_name\n        } :\n        undefined,\n        owners: ((alert == null ? void 0 : alert.owners) || []).map((owner) => ({\n          value: owner.value || owner.id,\n          label: owner.label ||\n          `${owner.first_name} ${owner.last_name}`\n        })),\n        // @ts-ignore: Type not assignable\n        validator_config_json: resource.validator_type === 'not null' ?\n        {\n          op: 'not null'\n        } :\n        validatorConfig\n      });\n    }\n  }, [resource]);\n  // Validation\n  const currentAlertSafe = currentAlert || {};\n  useEffect(() => {\n    validateAll();\n    updateEmailSubject();\n  }, [\n  currentAlertSafe.name,\n  currentAlertSafe.owners,\n  currentAlertSafe.database,\n  currentAlertSafe.sql,\n  currentAlertSafe.validator_config_json,\n  currentAlertSafe.crontab,\n  currentAlertSafe.working_timeout,\n  currentAlertSafe.dashboard,\n  currentAlertSafe.chart,\n  contentType,\n  notificationSettings,\n  conditionNotNull,\n  emailError]\n  );\n  useEffect(() => {\n    enforceValidation();\n  }, [validationStatus]);\n  // Show/hide\n  if (isHidden && show) {\n    setIsHidden(false);\n  }\n  const getTitleText = () => {\n    let titleText;\n    switch (true) {\n      case isEditMode && isReport:\n        titleText = t('Edit Report');\n        break;\n      case isEditMode:\n        titleText = t('Edit Alert');\n        break;\n      case isReport:\n        titleText = t('Add Report');\n        break;\n      default:\n        titleText = t('Add Alert');\n        break;\n    }\n    return titleText;\n  };\n  const updateEmailSubject = () => {\n    if (contentType === 'chart') {var _currentAlert$chart2;\n      if (currentAlert != null && currentAlert.name || currentAlert != null && (_currentAlert$chart2 = currentAlert.chart) != null && _currentAlert$chart2.label) {var _currentAlert$chart3;\n        setEmailSubject(`${currentAlert == null ? void 0 : currentAlert.name}: ${(currentAlert == null ? void 0 : (_currentAlert$chart3 = currentAlert.chart) == null ? void 0 : _currentAlert$chart3.label) || ''}`);\n      } else\n      {\n        setEmailSubject('');\n      }\n    } else\n    if (contentType === 'dashboard') {var _currentAlert$dashboa2;\n      if (currentAlert != null && currentAlert.name || currentAlert != null && (_currentAlert$dashboa2 = currentAlert.dashboard) != null && _currentAlert$dashboa2.label) {var _currentAlert$dashboa3;\n        setEmailSubject(`${currentAlert == null ? void 0 : currentAlert.name}: ${(currentAlert == null ? void 0 : (_currentAlert$dashboa3 = currentAlert.dashboard) == null ? void 0 : _currentAlert$dashboa3.label) || ''}`);\n      } else\n      {\n        setEmailSubject('');\n      }\n    } else\n    {\n      setEmailSubject('');\n    }\n  };\n  const handleErrorUpdate = (hasError) => {\n    setEmailError(hasError);\n  };\n  return ___EmotionJSX(StyledModal, { className: \"no-content-padding\", responsive: true, disablePrimaryButton: disableSave, primaryTooltipMessage: errorTooltipMessage, onHandledPrimaryAction: onSave, onHide: hide, primaryButtonName: isEditMode ? t('Save') : t('Add'), show: show, width: \"500px\", centered: true, title: ___EmotionJSX(\"h4\", { \"data-test\": \"alert-report-modal-title\" }, getTitleText()) },\n  ___EmotionJSX(Collapse, { expandIconPosition: \"right\", defaultActiveKey: \"general\", accordion: true, css: css`\n          border: 'none';\n        ` },\n  ___EmotionJSX(StyledPanel, { header: ___EmotionJSX(ValidatedPanelHeader, { title: TRANSLATIONS.GENERAL_TITLE, subtitle: t('Set up basic details, such as name and description.'), validateCheckStatus: !validationStatus[Sections.General].hasErrors, testId: \"general-information-panel\" }), key: \"general\" },\n  ___EmotionJSX(\"div\", { className: \"header-section\" },\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  isReport ? t('Report name') : t('Alert name'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")\n  ),\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(\"input\", { type: \"text\", name: \"name\", value: currentAlert ? currentAlert.name : '', placeholder: isReport ? t('Enter report name') : t('Enter alert name'), onChange: onInputChange })\n  )\n  ),\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('Owners'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")\n  ),\n  ___EmotionJSX(\"div\", { \"data-test\": \"owners-select\", className: \"input-container\" },\n  ___EmotionJSX(AsyncSelect, { ariaLabel: t('Owners'), allowClear: true, name: \"owners\", mode: \"multiple\", placeholder: t('Select owners'), value: (currentAlert == null ? void 0 : currentAlert.owners) || [], options: loadOwnerOptions, onChange: onOwnersChange })\n  )\n  ),\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" }, t('Description')),\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(\"input\", { type: \"text\", name: \"description\", value: currentAlert ? currentAlert.description || '' : '', placeholder: t('Include description to be sent with %s', reportOrAlert), onChange: onInputChange })\n  )\n  ),\n  ___EmotionJSX(StyledSwitchContainer, null,\n  ___EmotionJSX(Switch, { checked: currentAlert ? currentAlert.active : false, defaultChecked: true, onChange: onActiveSwitch }),\n  ___EmotionJSX(\"div\", { className: \"switch-label\" },\n  isReport ? t('Report is active') : t('Alert is active')\n  )\n  )\n  )\n  ),\n  !isReport && ___EmotionJSX(StyledPanel, { header: ___EmotionJSX(ValidatedPanelHeader, { title: TRANSLATIONS.ALERT_CONDITION_TITLE, subtitle: t('Define the database, SQL query, and triggering conditions for alert.'), validateCheckStatus: !validationStatus[Sections.Alert].hasErrors, testId: \"alert-condition-panel\" }), key: \"condition\" },\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('Database'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")\n  ),\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(AsyncSelect, { ariaLabel: t('Database'), name: \"source\", placeholder: t('Select database'), value: currentAlert != null && (_currentAlert$databas2 = currentAlert.database) != null && _currentAlert$databas2.label &&\n    currentAlert != null && (_currentAlert$databas3 = currentAlert.database) != null && _currentAlert$databas3.value ?\n    {\n      value: currentAlert.database.value,\n      label: currentAlert.database.label\n    } :\n    undefined, options: loadSourceOptions, onChange: onSourceChange })\n  )\n  ),\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('SQL Query'),\n  ___EmotionJSX(StyledTooltip, { tooltip: t('The result of this query must be a value capable of numeric interpretation e.g. 1, 1.0, or \"1\" (compatible with Python\\'s float() function).') }),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")\n  ),\n  ___EmotionJSX(TextAreaControl, { name: \"sql\", language: \"sql\", offerEditInModal: false, minLines: 15, maxLines: 15, onChange: onSQLChange, readOnly: false, initialValue: resource == null ? void 0 : resource.sql, key: currentAlert == null ? void 0 : currentAlert.id })\n  ),\n  ___EmotionJSX(\"div\", { className: \"inline-container wrap\" },\n  ___EmotionJSX(StyledInputContainer, { css: noMarginBottom },\n  ___EmotionJSX(\"div\", { className: \"control-label\", css: inputSpacer },\n  t('Trigger Alert If...'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")\n  ),\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(Select, { ariaLabel: t('Condition'), onChange: onConditionChange, placeholder: t('Condition'), value: (currentAlert == null ? void 0 : (_currentAlert$validat5 = currentAlert.validator_config_json) == null ? void 0 : _currentAlert$validat5.op) || undefined, options: CONDITIONS, css: inputSpacer })\n  )\n  ),\n  ___EmotionJSX(StyledInputContainer, { css: noMarginBottom },\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('Value'), ' ',\n  !conditionNotNull && ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")\n  ),\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(\"input\", { type: \"number\", name: \"threshold\", disabled: conditionNotNull, value: (currentAlert == null ? void 0 : (_currentAlert$validat6 = currentAlert.validator_config_json) == null ? void 0 : _currentAlert$validat6.threshold) !==\n    undefined && !conditionNotNull ?\n    currentAlert.validator_config_json.threshold :\n    '', placeholder: t('Value'), onChange: onThresholdChange })\n  )\n  )\n  )\n  ),\n  ___EmotionJSX(StyledPanel, { header: ___EmotionJSX(ValidatedPanelHeader, { title: isReport ?\n      TRANSLATIONS.REPORT_CONTENTS_TITLE :\n      TRANSLATIONS.ALERT_CONTENTS_TITLE, subtitle: t('Customize data source, filters, and layout.'), validateCheckStatus: !validationStatus[Sections.Content].hasErrors, testId: \"contents-panel\" }), key: \"contents\" },\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('Content type'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")\n  ),\n  ___EmotionJSX(Select, { ariaLabel: t('Select content type'), onChange: onContentTypeChange, value: contentType, options: CONTENT_TYPE_OPTIONS, placeholder: t('Select content type') })\n  ),\n  ___EmotionJSX(StyledInputContainer, null,\n  contentType === 'chart' ? ___EmotionJSX(React.Fragment, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('Select chart'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")\n  ),\n  ___EmotionJSX(AsyncSelect, { ariaLabel: t('Chart'), name: \"chart\", value: currentAlert != null && (_currentAlert$chart4 = currentAlert.chart) != null && _currentAlert$chart4.label && currentAlert != null && (_currentAlert$chart5 = currentAlert.chart) != null && _currentAlert$chart5.value ?\n    {\n      value: currentAlert.chart.value,\n      label: currentAlert.chart.label\n    } :\n    undefined, options: loadChartOptions, onChange: onChartChange, placeholder: t('Select chart to use') })\n  ) : ___EmotionJSX(React.Fragment, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('Select dashboard'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")\n  ),\n  ___EmotionJSX(AsyncSelect, { ariaLabel: t('Dashboard'), name: \"dashboard\", value: currentAlert != null && (_currentAlert$dashboa4 = currentAlert.dashboard) != null && _currentAlert$dashboa4.label &&\n    currentAlert != null && (_currentAlert$dashboa5 = currentAlert.dashboard) != null && _currentAlert$dashboa5.value ?\n    {\n      value: currentAlert.dashboard.value,\n      label: currentAlert.dashboard.label\n    } :\n    undefined, options: loadDashboardOptions, onChange: onDashboardChange, placeholder: t('Select dashboard to use') })\n  )\n  ),\n  ___EmotionJSX(StyledInputContainer, { css: ['PDF', 'TEXT', 'CSV'].includes(reportFormat) && noMarginBottom },\n  formatOptionEnabled && ___EmotionJSX(React.Fragment, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('Content format'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")\n  ),\n  ___EmotionJSX(Select, { ariaLabel: t('Select format'), onChange: onFormatChange, value: reportFormat, options: contentType === 'dashboard' ?\n    ['pdf', 'png'].map((key) => FORMAT_OPTIONS[key]) :\n    /* If chart is of text based viz type: show text\n    format option */\n    TEXT_BASED_VISUALIZATION_TYPES.includes(chartVizType) ?\n    Object.values(FORMAT_OPTIONS) :\n    ['pdf', 'png', 'csv'].map((key) => FORMAT_OPTIONS[key]), placeholder: t('Select format') })\n  )\n  ),\n  isScreenshot && ___EmotionJSX(StyledInputContainer, { css: !isReport && contentType === 'chart' && noMarginBottom },\n  ___EmotionJSX(\"div\", { className: \"control-label\" }, t('Screenshot width')),\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(InputNumber, { type: \"number\", name: \"custom_width\", value: (currentAlert == null ? void 0 : currentAlert.custom_width) || undefined, min: 600, max: 2400, placeholder: t('Input custom width in pixels'), onChange: onCustomWidthChange })\n  )\n  ),\n  (isReport || contentType === 'dashboard') && ___EmotionJSX(\"div\", { className: \"inline-container\" },\n  ___EmotionJSX(StyledCheckbox, { \"data-test\": \"bypass-cache\", className: \"checkbox\", checked: forceScreenshot, onChange: onForceScreenshotChange },\n  t('Ignore cache when generating report')\n  )\n  )\n  ),\n  ___EmotionJSX(StyledPanel, { header: ___EmotionJSX(ValidatedPanelHeader, { title: TRANSLATIONS.SCHEDULE_TITLE, subtitle: t('Define delivery schedule, timezone, and frequency settings.'), validateCheckStatus: !validationStatus[Sections.Schedule].hasErrors, testId: \"schedule-panel\" }), key: \"schedule\" },\n  ___EmotionJSX(AlertReportCronScheduler, { value: (currentAlert == null ? void 0 : currentAlert.crontab) || '', onChange: (newVal) => updateAlertState('crontab', newVal) }),\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('Timezone'), \" \", ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")\n  ),\n  ___EmotionJSX(TimezoneSelector, { onTimezoneChange: onTimezoneChange, timezone: currentAlert == null ? void 0 : currentAlert.timezone, minWidth: \"100%\" })\n  ),\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('Log retention'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")\n  ),\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(Select, { ariaLabel: t('Log retention'), placeholder: t('Log retention'), onChange: onLogRetentionChange, value: currentAlert == null ? void 0 : currentAlert.log_retention, options: RETENTION_OPTIONS, sortComparator: propertyComparator('value') })\n  )\n  ),\n  ___EmotionJSX(StyledInputContainer, { css: noMarginBottom },\n  isReport ? ___EmotionJSX(React.Fragment, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('Working timeout'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")\n  ),\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(NumberInput, { min: 1, name: \"working_timeout\", value: (currentAlert == null ? void 0 : currentAlert.working_timeout) || '', placeholder: t('Time in seconds'), onChange: onTimeoutVerifyChange, timeUnit: t('seconds') })\n  )\n  ) : ___EmotionJSX(React.Fragment, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" }, t('Grace period')),\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(NumberInput, { min: 1, name: \"grace_period\", value: (currentAlert == null ? void 0 : currentAlert.grace_period) || '', placeholder: t('Time in seconds'), onChange: onTimeoutVerifyChange, timeUnit: t('seconds') })\n  )\n  )\n  )\n  ),\n  ___EmotionJSX(StyledPanel, { header: ___EmotionJSX(ValidatedPanelHeader, { title: TRANSLATIONS.NOTIFICATION_TITLE, subtitle: t('Choose notification method and recipients.'), validateCheckStatus: !validationStatus[Sections.Notification].hasErrors, testId: \"notification-method-panel\" }), key: \"notification\" },\n  notificationSettings.map((notificationSetting, i) => ___EmotionJSX(StyledNotificationMethodWrapper, null,\n  ___EmotionJSX(NotificationMethod, { setting: notificationSetting, index: i, key: `NotificationMethod-${i}`, onUpdate: updateNotificationSetting, onRemove: removeNotificationSetting, onInputChange: onInputChange, email_subject: (currentAlert == null ? void 0 : currentAlert.email_subject) || '', defaultSubject: emailSubject || '', setErrorSubject: handleErrorUpdate })\n  )),\n\n  // Prohibit 'add notification method' button if only one present\n  allowedNotificationMethods.length > notificationSettings.length && ___EmotionJSX(NotificationMethodAdd, { \"data-test\": \"notification-add\", status: notificationAddState, onClick: onNotificationAdd })\n  )\n  )\n  );\n};__signature__(AlertReportModal, \"useSelector{currentUser}\\nuseCommonConf{conf}\\nuseState{[disableSave, setDisableSave](true)}\\nuseState{[currentAlert, setCurrentAlert]}\\nuseState{[isHidden, setIsHidden](true)}\\nuseState{[contentType, setContentType]('dashboard')}\\nuseState{[reportFormat, setReportFormat](DEFAULT_NOTIFICATION_FORMAT)}\\nuseState{[forceScreenshot, setForceScreenshot](false)}\\nuseState{[isScreenshot, setIsScreenshot](false)}\\nuseEffect{}\\nuseState{[conditionNotNull, setConditionNotNull](false)}\\nuseState{[sourceOptions, setSourceOptions]([])}\\nuseState{[dashboardOptions, setDashboardOptions]([])}\\nuseState{[chartOptions, setChartOptions]([])}\\nuseState{[validationStatus, setValidationStatus]({\\n        [Sections.General]: {\\n            hasErrors: false,\\n            name: TRANSLATIONS.GENERAL_TITLE,\\n            errors: [],\\n        },\\n        [Sections.Content]: {\\n            hasErrors: false,\\n            name: isReport\\n                ? TRANSLATIONS.REPORT_CONTENTS_TITLE\\n                : TRANSLATIONS.ALERT_CONTENTS_TITLE,\\n            errors: [],\\n        },\\n        [Sections.Alert]: {\\n            hasErrors: false,\\n            name: TRANSLATIONS.ALERT_CONDITION_TITLE,\\n            errors: [],\\n        },\\n        [Sections.Schedule]: {\\n            hasErrors: false,\\n            name: TRANSLATIONS.SCHEDULE_TITLE,\\n            errors: [],\\n        },\\n        [Sections.Notification]: {\\n            hasErrors: false,\\n            name: TRANSLATIONS.NOTIFICATION_TITLE,\\n            errors: [],\\n        },\\n    })}\\nuseState{[errorTooltipMessage, setErrorTooltipMessage]('')}\\nuseState{[chartVizType, setChartVizType]('')}\\nuseState{[notificationAddState, setNotificationAddState]('active')}\\nuseState{[notificationSettings, setNotificationSettings]([])}\\nuseState{[emailSubject, setEmailSubject]('')}\\nuseState{[emailError, setEmailError](false)}\\nuseSelector{{ ALERT_REPORTS_DEFAULT_WORKING_TIMEOUT, ALERT_REPORTS_DEFAULT_CRON_VALUE, ALERT_REPORTS_DEFAULT_RETENTION, }}\\nuseSingleViewResource{{ state: { loading, resource, error: fetchError }, fetchResource, createResource, updateResource, clearError, }}\\nuseMemo{loadOwnerOptions}\\nuseCallback{getSourceData}\\nuseMemo{loadSourceOptions}\\nuseEffect{}\\nuseMemo{loadDashboardOptions}\\nuseCallback{getChartData}\\nuseEffect{}\\nuseMemo{loadChartOptions}\\nuseEffect{}\\nuseEffect{}\\nuseEffect{}\\nuseEffect{}\", () => [useSelector, useCommonConf, useSelector, useSingleViewResource]);const _default =\nwithToasts(AlertReportModal);export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(TIMEOUT_MIN, \"TIMEOUT_MIN\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");reactHotLoader.register(TEXT_BASED_VISUALIZATION_TYPES, \"TEXT_BASED_VISUALIZATION_TYPES\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");reactHotLoader.register(DEFAULT_WORKING_TIMEOUT, \"DEFAULT_WORKING_TIMEOUT\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");reactHotLoader.register(DEFAULT_CRON_VALUE, \"DEFAULT_CRON_VALUE\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");reactHotLoader.register(DEFAULT_RETENTION, \"DEFAULT_RETENTION\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");reactHotLoader.register(DEFAULT_NOTIFICATION_METHODS, \"DEFAULT_NOTIFICATION_METHODS\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");reactHotLoader.register(DEFAULT_NOTIFICATION_FORMAT, \"DEFAULT_NOTIFICATION_FORMAT\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");reactHotLoader.register(CONDITIONS, \"CONDITIONS\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");reactHotLoader.register(RETENTION_OPTIONS, \"RETENTION_OPTIONS\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");reactHotLoader.register(CONTENT_TYPE_OPTIONS, \"CONTENT_TYPE_OPTIONS\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");reactHotLoader.register(FORMAT_OPTIONS, \"FORMAT_OPTIONS\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");reactHotLoader.register(noMarginBottom, \"noMarginBottom\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");reactHotLoader.register(StyledModal, \"StyledModal\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");reactHotLoader.register(StyledSwitchContainer, \"StyledSwitchContainer\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");reactHotLoader.register(StyledInputContainer, \"StyledInputContainer\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");reactHotLoader.register(StyledCheckbox, \"StyledCheckbox\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");reactHotLoader.register(StyledTooltip, \"StyledTooltip\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");reactHotLoader.register(StyledNotificationAddButton, \"StyledNotificationAddButton\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");reactHotLoader.register(StyledNotificationMethodWrapper, \"StyledNotificationMethodWrapper\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");reactHotLoader.register(inputSpacer, \"inputSpacer\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");reactHotLoader.register(TRANSLATIONS, \"TRANSLATIONS\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");reactHotLoader.register(NotificationMethodAdd, \"NotificationMethodAdd\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");reactHotLoader.register(AlertReportModal, \"AlertReportModal\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");reactHotLoader.register(_default, \"default\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["React","useState","useEffect","useMemo","useCallback","css","isFeatureEnabled","FeatureFlag","styled","SupersetClient","t","rison","useSingleViewResource","InputNumber","Switch","Modal","Collapse","TimezoneSelector","propertyComparator","withToasts","AntdCheckbox","AsyncSelect","Select","TextAreaControl","useCommonConf","InfoTooltipWithTrigger","Sections","useSelector","NumberInput","AlertReportCronScheduler","NotificationMethod","ValidatedPanelHeader","StyledPanel","buildErrorTooltipMessage","jsx","___EmotionJSX","TIMEOUT_MIN","TEXT_BASED_VISUALIZATION_TYPES","DEFAULT_WORKING_TIMEOUT","DEFAULT_CRON_VALUE","DEFAULT_RETENTION","DEFAULT_NOTIFICATION_METHODS","DEFAULT_NOTIFICATION_FORMAT","CONDITIONS","label","value","RETENTION_OPTIONS","CONTENT_TYPE_OPTIONS","FORMAT_OPTIONS","pdf","png","csv","txt","noMarginBottom","StyledModal","theme","gridUnit","StyledSwitchContainer","div","StyledInputContainer","colors","grayscale","base","typography","sizes","s","error","light1","light2","StyledCheckbox","StyledTooltip","StyledNotificationAddButton","primary","dark1","StyledNotificationMethodWrapper","inputSpacer","TRANSLATIONS","GENERAL_TITLE","ALERT_CONDITION_TITLE","ALERT_CONTENTS_TITLE","REPORT_CONTENTS_TITLE","SCHEDULE_TITLE","NOTIFICATION_TITLE","NAME_ERROR_TEXT","OWNERS_ERROR_TEXT","CONTENT_ERROR_TEXT","DATABASE_ERROR_TEXT","SQL_ERROR_TEXT","ALERT_CONDITION_ERROR_TEXT","CRONTAB_ERROR_TEXT","WORKING_TIMEOUT_ERROR_TEXT","RECIPIENTS_ERROR_TEXT","EMAIL_SUBJECT_ERROR_TEXT","ERROR_TOOLTIP_MESSAGE","NotificationMethodAdd","status","onClick","checkStatus","className","AlertReportModal","addDangerToast","onAdd","onHide","show","alert","isReport","addSuccessToast","_currentAlert$databas2","_currentAlert$databas3","_currentAlert$validat5","_currentAlert$validat6","_currentAlert$chart4","_currentAlert$chart5","_currentAlert$dashboa4","_currentAlert$dashboa5","currentUser","state","user","conf","allowedNotificationMethods","ALERT_REPORTS_NOTIFICATION_METHODS","disableSave","setDisableSave","currentAlert","setCurrentAlert","isHidden","setIsHidden","contentType","setContentType","reportFormat","setReportFormat","forceScreenshot","setForceScreenshot","isScreenshot","setIsScreenshot","conditionNotNull","setConditionNotNull","sourceOptions","setSourceOptions","dashboardOptions","setDashboardOptions","chartOptions","setChartOptions","validationStatus","setValidationStatus","General","hasErrors","name","errors","Content","Alert","Schedule","Notification","errorTooltipMessage","setErrorTooltipMessage","updateValidationStatus","section","currentValidationData","length","chartVizType","setChartVizType","reportOrAlert","isEditMode","formatOptionEnabled","AlertsAttachReports","notificationAddState","setNotificationAddState","notificationSettings","setNotificationSettings","emailSubject","setEmailSubject","emailError","setEmailError","onNotificationAdd","recipients","options","filter","option","reduce","accum","setting","method","ALERT_REPORTS_DEFAULT_WORKING_TIMEOUT","ALERT_REPORTS_DEFAULT_CRON_VALUE","ALERT_REPORTS_DEFAULT_RETENTION","_state$common","_conf$ALERT_REPORTS_D","_conf$ALERT_REPORTS_D2","_conf$ALERT_REPORTS_D3","common","defaultAlert","active","creation_method","crontab","log_retention","working_timeout","owners","sql","email_subject","validator_config_json","validator_type","force_screenshot","grace_period","undefined","updateNotificationSetting","index","settings","_","idx","removeNotificationSetting","slice","splice","loading","resource","fetchError","fetchResource","createResource","updateResource","clearError","hide","onSave","_currentAlert$chart","_currentAlert$dashboa","_currentAlert$databas","forEach","push","recipient_config_json","target","type","shouldEnableForceScreenshot","data","chart","dashboard","custom_width","database","map","owner","id","report_format","context_markdown","update_id","created_by","last_eval_dttm","last_state","last_value","last_value_row_json","then","response","loadOwnerOptions","input","page","pageSize","query","encode","page_size","get","endpoint","json","result","item","text","totalCount","count","getSourceData","db","source","updateAlertState","currentAlertData","loadSourceOptions","list","databaseLabel","loadDashboardOptions","encode_uri","getDashboardData","dash","getChartData","chartData","noChartLabel","loadChartOptions","getChartVisualizationType","viz_type","onInputChange","event","parsedValue","parseInt","updateEmailSubject","onCustomWidthChange","onTimeoutVerifyChange","Math","max","onSQLChange","onOwnersChange","onSourceChange","onDashboardChange","onChartChange","onActiveSwitch","checked","onConditionChange","op","_currentAlert$validat","config","threshold","onThresholdChange","_currentAlert$validat2","onLogRetentionChange","retention","onTimezoneChange","timezone","onContentTypeChange","onFormatChange","onForceScreenshotChange","checkNotificationSettings","hasInfo","_setting$recipients","validateGeneralSection","_currentAlert$name","_currentAlert$owners","validateContentSection","validateAlertSection","_currentAlert$sql","_currentAlert$validat3","_currentAlert$validat4","validateScheduleSection","_currentAlert$crontab","validateNotificationSection","validateAll","enforceValidation","sections","some","tooltip","userId","firstName","lastName","JSON","parse","validatorConfig","slice_name","dashboard_title","database_name","first_name","last_name","currentAlertSafe","getTitleText","titleText","_currentAlert$chart2","_currentAlert$chart3","_currentAlert$dashboa2","_currentAlert$dashboa3","handleErrorUpdate","hasError","responsive","disablePrimaryButton","primaryTooltipMessage","onHandledPrimaryAction","primaryButtonName","width","centered","title","expandIconPosition","defaultActiveKey","accordion","header","subtitle","validateCheckStatus","testId","key","placeholder","onChange","ariaLabel","allowClear","mode","description","defaultChecked","language","offerEditInModal","minLines","maxLines","readOnly","initialValue","disabled","Fragment","includes","Object","values","min","newVal","minWidth","sortComparator","timeUnit","notificationSetting","i","onUpdate","onRemove","defaultSubject","setErrorSubject","__signature__","_default","reactHotLoader","reactHotLoaderGlobal","default","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/src/features/alerts/AlertReportModal.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, {\n  FunctionComponent,\n  useState,\n  useEffect,\n  useMemo,\n  useCallback,\n  ReactNode,\n} from 'react';\nimport {\n  css,\n  isFeatureEnabled,\n  FeatureFlag,\n  styled,\n  SupersetClient,\n  SupersetTheme,\n  t,\n} from '@superset-ui/core';\nimport rison from 'rison';\nimport { useSingleViewResource } from 'src/views/CRUD/hooks';\n\nimport { InputNumber } from 'src/components/Input';\nimport { Switch } from 'src/components/Switch';\nimport Modal from 'src/components/Modal';\nimport Collapse from 'src/components/Collapse';\nimport TimezoneSelector from 'src/components/TimezoneSelector';\nimport { propertyComparator } from 'src/components/Select/utils';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport Owner from 'src/types/Owner';\nimport { AntdCheckbox, AsyncSelect, Select } from 'src/components';\nimport TextAreaControl from 'src/explore/components/controls/TextAreaControl';\nimport { useCommonConf } from 'src/features/databases/state';\nimport { InfoTooltipWithTrigger } from '@superset-ui/chart-controls';\nimport {\n  NotificationMethodOption,\n  NotificationSetting,\n  AlertObject,\n  ChartObject,\n  DashboardObject,\n  DatabaseObject,\n  MetaObject,\n  Operator,\n  Recipient,\n  AlertsReportsConfig,\n  ValidationObject,\n  Sections,\n} from 'src/features/alerts/types';\nimport { useSelector } from 'react-redux';\nimport { UserWithPermissionsAndRoles } from 'src/types/bootstrapTypes';\nimport NumberInput from './components/NumberInput';\nimport { AlertReportCronScheduler } from './components/AlertReportCronScheduler';\nimport { NotificationMethod } from './components/NotificationMethod';\nimport ValidatedPanelHeader from './components/ValidatedPanelHeader';\nimport StyledPanel from './components/StyledPanel';\nimport { buildErrorTooltipMessage } from './buildErrorTooltipMessage';\n\nconst TIMEOUT_MIN = 1;\nconst TEXT_BASED_VISUALIZATION_TYPES = [\n  'pivot_table_v2',\n  'table',\n  'paired_ttest',\n];\n\ntype SelectValue = {\n  value: string;\n  label: string;\n};\n\nexport interface AlertReportModalProps {\n  addSuccessToast: (msg: string) => void;\n  addDangerToast: (msg: string) => void;\n  alert?: AlertObject | null;\n  isReport?: boolean;\n  onAdd?: (alert?: AlertObject) => void;\n  onHide: () => void;\n  show: boolean;\n}\n\nconst DEFAULT_WORKING_TIMEOUT = 3600;\nconst DEFAULT_CRON_VALUE = '0 0 * * *'; // every day\nconst DEFAULT_RETENTION = 90;\n\nconst DEFAULT_NOTIFICATION_METHODS: NotificationMethodOption[] = ['Email'];\nconst DEFAULT_NOTIFICATION_FORMAT = 'PNG';\nconst CONDITIONS = [\n  {\n    label: t('< (Smaller than)'),\n    value: '<',\n  },\n  {\n    label: t('> (Larger than)'),\n    value: '>',\n  },\n  {\n    label: t('<= (Smaller or equal)'),\n    value: '<=',\n  },\n  {\n    label: t('>= (Larger or equal)'),\n    value: '>=',\n  },\n  {\n    label: t('== (Is equal)'),\n    value: '==',\n  },\n  {\n    label: t('!= (Is not equal)'),\n    value: '!=',\n  },\n  {\n    label: t('Not null'),\n    value: 'not null',\n  },\n];\n\nconst RETENTION_OPTIONS = [\n  {\n    label: t('None'),\n    value: 0,\n  },\n  {\n    label: t('30 days'),\n    value: 30,\n  },\n  {\n    label: t('60 days'),\n    value: 60,\n  },\n  {\n    label: t('90 days'),\n    value: 90,\n  },\n];\n\nconst CONTENT_TYPE_OPTIONS = [\n  {\n    label: t('Dashboard'),\n    value: 'dashboard',\n  },\n  {\n    label: t('Chart'),\n    value: 'chart',\n  },\n];\nconst FORMAT_OPTIONS = {\n  pdf: {\n    label: t('Send as PDF'),\n    value: 'PDF',\n  },\n  png: {\n    label: t('Send as PNG'),\n    value: 'PNG',\n  },\n  csv: {\n    label: t('Send as CSV'),\n    value: 'CSV',\n  },\n  txt: {\n    label: t('Send as text'),\n    value: 'TEXT',\n  },\n};\n\n// Apply to final text input components of each collapse panel\nconst noMarginBottom = css`\n  margin-bottom: 0;\n`;\n\n/*\nHeight of modal body defined here, total width defined at component invocation as antd prop.\n */\nconst StyledModal = styled(Modal)`\n  .ant-modal-body {\n    height: 720px;\n  }\n\n  .control-label {\n    margin-top: ${({ theme }) => theme.gridUnit}px;\n  }\n\n  .ant-collapse > .ant-collapse-item {\n    border-bottom: none;\n  }\n\n  .inline-container {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    &.wrap {\n      flex-wrap: wrap;\n    }\n\n    > div {\n      flex: 1 1 auto;\n    }\n  }\n`;\n\nconst StyledSwitchContainer = styled.div`\n  display: flex;\n  align-items: center;\n  margin-top: 10px;\n\n  .switch-label {\n    margin-left: 10px;\n  }\n`;\n\nexport const StyledInputContainer = styled.div`\n  ${({ theme }) => css`\n    flex: 1;\n    margin-top: 0px;\n    margin-bottom: ${theme.gridUnit * 4}px;\n\n    input::-webkit-outer-spin-button,\n    input::-webkit-inner-spin-button {\n      -webkit-appearance: none;\n      margin: 0;\n    }\n    input[type='number'] {\n      -moz-appearance: textfield;\n    }\n\n    .helper {\n      display: block;\n      color: ${theme.colors.grayscale.base};\n      font-size: ${theme.typography.sizes.s}px;\n      padding: ${theme.gridUnit}px 0;\n      text-align: left;\n    }\n\n    .required {\n      margin-left: ${theme.gridUnit / 2}px;\n      color: ${theme.colors.error.base};\n    }\n\n    .input-container {\n      display: flex;\n      align-items: center;\n\n      > div {\n        width: 100%;\n      }\n\n      label {\n        display: flex;\n        margin-right: ${theme.gridUnit * 2}px;\n      }\n\n      i {\n        margin: 0 ${theme.gridUnit}px;\n      }\n    }\n\n    input,\n    textarea {\n      flex: 1 1 auto;\n    }\n\n    input[disabled] {\n      color: ${theme.colors.grayscale.base};\n    }\n\n    textarea {\n      height: 300px;\n      resize: none;\n    }\n\n    input::placeholder,\n    textarea::placeholder {\n      color: ${theme.colors.grayscale.light1};\n    }\n\n    textarea,\n    input[type='text'],\n    input[type='number'] {\n      padding: ${theme.gridUnit}px ${theme.gridUnit * 2}px;\n      border-style: none;\n      border: 1px solid ${theme.colors.grayscale.light2};\n      border-radius: ${theme.gridUnit}px;\n\n      &[name='description'] {\n        flex: 1 1 auto;\n      }\n    }\n\n    .input-label {\n      margin-left: 10px;\n    }\n  `}\n`;\n\nconst StyledCheckbox = styled(AntdCheckbox)`\n  margin-top: ${({ theme }) => theme.gridUnit * 0}px;\n`;\n\nconst StyledTooltip = styled(InfoTooltipWithTrigger)`\n  margin-left: ${({ theme }) => theme.gridUnit}px;\n`;\n\n// Notification Method components\nconst StyledNotificationAddButton = styled.div`\n  ${({ theme }) => css`\n    color: ${theme.colors.primary.dark1};\n    cursor: pointer;\n\n    i {\n      margin-right: ${theme.gridUnit * 2}px;\n    }\n\n    &.disabled {\n      color: ${theme.colors.grayscale.light1};\n      cursor: default;\n    }\n  `}\n`;\n\nconst StyledNotificationMethodWrapper = styled.div`\n  .inline-container .input-container {\n    margin-left: 0;\n  }\n`;\n\nconst inputSpacer = (theme: SupersetTheme) => css`\n  margin-right: ${theme.gridUnit * 3}px;\n`;\n\ntype NotificationAddStatus = 'active' | 'disabled' | 'hidden';\n\ninterface NotificationMethodAddProps {\n  status: NotificationAddStatus;\n  onClick: () => void;\n}\n\nexport const TRANSLATIONS = {\n  // Panel titles\n  GENERAL_TITLE: t('General information'),\n  ALERT_CONDITION_TITLE: t('Alert condition'),\n  ALERT_CONTENTS_TITLE: t('Alert contents'),\n  REPORT_CONTENTS_TITLE: t('Report contents'),\n  SCHEDULE_TITLE: t('Schedule'),\n  NOTIFICATION_TITLE: t('Notification method'),\n  // Error text\n  NAME_ERROR_TEXT: t('name'),\n  OWNERS_ERROR_TEXT: t('owners'),\n  CONTENT_ERROR_TEXT: t('content type'),\n  DATABASE_ERROR_TEXT: t('database'),\n  SQL_ERROR_TEXT: t('sql'),\n  ALERT_CONDITION_ERROR_TEXT: t('alert condition'),\n  CRONTAB_ERROR_TEXT: t('crontab'),\n  WORKING_TIMEOUT_ERROR_TEXT: t('working timeout'),\n  RECIPIENTS_ERROR_TEXT: t('recipients'),\n  EMAIL_SUBJECT_ERROR_TEXT: t('email subject'),\n  ERROR_TOOLTIP_MESSAGE: t(\n    'Not all required fields are complete. Please provide the following:',\n  ),\n};\n\nconst NotificationMethodAdd: FunctionComponent<NotificationMethodAddProps> = ({\n  status = 'active',\n  onClick,\n}) => {\n  if (status === 'hidden') {\n    return null;\n  }\n\n  const checkStatus = () => {\n    if (status !== 'disabled') {\n      onClick();\n    }\n  };\n\n  return (\n    <StyledNotificationAddButton className={status} onClick={checkStatus}>\n      <i className=\"fa fa-plus\" />{' '}\n      {status === 'active'\n        ? t('Add another notification method')\n        : t('Add delivery method')}\n    </StyledNotificationAddButton>\n  );\n};\n\nconst AlertReportModal: FunctionComponent<AlertReportModalProps> = ({\n  addDangerToast,\n  onAdd,\n  onHide,\n  show,\n  alert = null,\n  isReport = false,\n  addSuccessToast,\n}) => {\n  const currentUser = useSelector<any, UserWithPermissionsAndRoles>(\n    state => state.user,\n  );\n  // Check config for alternate notification methods setting\n  const conf = useCommonConf();\n  const allowedNotificationMethods: NotificationMethodOption[] =\n    conf?.ALERT_REPORTS_NOTIFICATION_METHODS || DEFAULT_NOTIFICATION_METHODS;\n\n  const [disableSave, setDisableSave] = useState<boolean>(true);\n\n  const [currentAlert, setCurrentAlert] =\n    useState<Partial<AlertObject> | null>();\n  const [isHidden, setIsHidden] = useState<boolean>(true);\n  const [contentType, setContentType] = useState<string>('dashboard');\n  const [reportFormat, setReportFormat] = useState<string>(\n    DEFAULT_NOTIFICATION_FORMAT,\n  );\n  const [forceScreenshot, setForceScreenshot] = useState<boolean>(false);\n\n  const [isScreenshot, setIsScreenshot] = useState<boolean>(false);\n  useEffect(() => {\n    setIsScreenshot(reportFormat === 'PNG');\n  }, [reportFormat]);\n\n  // Dropdown options\n  const [conditionNotNull, setConditionNotNull] = useState<boolean>(false);\n  const [sourceOptions, setSourceOptions] = useState<MetaObject[]>([]);\n  const [dashboardOptions, setDashboardOptions] = useState<MetaObject[]>([]);\n  const [chartOptions, setChartOptions] = useState<MetaObject[]>([]);\n  // Validation\n  const [validationStatus, setValidationStatus] = useState<ValidationObject>({\n    [Sections.General]: {\n      hasErrors: false,\n      name: TRANSLATIONS.GENERAL_TITLE,\n      errors: [],\n    },\n    [Sections.Content]: {\n      hasErrors: false,\n      name: isReport\n        ? TRANSLATIONS.REPORT_CONTENTS_TITLE\n        : TRANSLATIONS.ALERT_CONTENTS_TITLE,\n      errors: [],\n    },\n    [Sections.Alert]: {\n      hasErrors: false,\n      name: TRANSLATIONS.ALERT_CONDITION_TITLE,\n      errors: [],\n    },\n    [Sections.Schedule]: {\n      hasErrors: false,\n      name: TRANSLATIONS.SCHEDULE_TITLE,\n      errors: [],\n    },\n    [Sections.Notification]: {\n      hasErrors: false,\n      name: TRANSLATIONS.NOTIFICATION_TITLE,\n      errors: [],\n    },\n  });\n  const [errorTooltipMessage, setErrorTooltipMessage] = useState<ReactNode>('');\n\n  const updateValidationStatus = (section: Sections, errors: string[]) => {\n    setValidationStatus(currentValidationData => ({\n      ...currentValidationData,\n      [section]: {\n        hasErrors: errors.length > 0,\n        name: currentValidationData[section].name,\n        errors,\n      },\n    }));\n  };\n\n  // Chart metadata\n  const [chartVizType, setChartVizType] = useState<string>('');\n\n  const reportOrAlert = isReport ? 'report' : 'alert';\n  const isEditMode = alert !== null;\n  const formatOptionEnabled =\n    isFeatureEnabled(FeatureFlag.AlertsAttachReports) || isReport;\n\n  const [notificationAddState, setNotificationAddState] =\n    useState<NotificationAddStatus>('active');\n\n  const [notificationSettings, setNotificationSettings] = useState<\n    NotificationSetting[]\n  >([]);\n  const [emailSubject, setEmailSubject] = useState<string>('');\n  const [emailError, setEmailError] = useState(false);\n\n  const onNotificationAdd = () => {\n    setNotificationSettings([\n      ...notificationSettings,\n      {\n        recipients: '',\n        // options shown in the newly added notification method\n        options: allowedNotificationMethods.filter(\n          // are filtered such that\n          option =>\n            // options are not included\n            !notificationSettings.reduce(\n              // when it exists in previous notificationSettings\n              (accum, setting) => accum || option === setting.method,\n              false,\n            ),\n        ),\n      },\n    ]);\n\n    setNotificationAddState(\n      notificationSettings.length === allowedNotificationMethods.length\n        ? 'hidden'\n        : 'disabled',\n    );\n  };\n\n  const {\n    ALERT_REPORTS_DEFAULT_WORKING_TIMEOUT,\n    ALERT_REPORTS_DEFAULT_CRON_VALUE,\n    ALERT_REPORTS_DEFAULT_RETENTION,\n  } = useSelector<any, AlertsReportsConfig>(state => {\n    const conf = state.common?.conf;\n    return {\n      ALERT_REPORTS_DEFAULT_WORKING_TIMEOUT:\n        conf?.ALERT_REPORTS_DEFAULT_WORKING_TIMEOUT ?? DEFAULT_WORKING_TIMEOUT,\n      ALERT_REPORTS_DEFAULT_CRON_VALUE:\n        conf?.ALERT_REPORTS_DEFAULT_CRON_VALUE ?? DEFAULT_CRON_VALUE,\n      ALERT_REPORTS_DEFAULT_RETENTION:\n        conf?.ALERT_REPORTS_DEFAULT_RETENTION ?? DEFAULT_RETENTION,\n    };\n  });\n\n  const defaultAlert = {\n    active: true,\n    creation_method: 'alerts_reports',\n    crontab: ALERT_REPORTS_DEFAULT_CRON_VALUE,\n    log_retention: ALERT_REPORTS_DEFAULT_RETENTION,\n    working_timeout: ALERT_REPORTS_DEFAULT_WORKING_TIMEOUT,\n    name: '',\n    owners: [],\n    recipients: [],\n    sql: '',\n    email_subject: '',\n    validator_config_json: {},\n    validator_type: '',\n    force_screenshot: false,\n    grace_period: undefined,\n  };\n\n  const updateNotificationSetting = (\n    index: number,\n    setting: NotificationSetting,\n  ) => {\n    const settings: NotificationSetting[] = [...notificationSettings];\n    settings[index] = setting;\n\n    // if you've changed notification method -> remove trailing methods\n    if (notificationSettings[index].method !== setting.method) {\n      notificationSettings[index] = setting;\n\n      setNotificationSettings(\n        notificationSettings.filter((_, idx) => idx <= index),\n      );\n\n      if (notificationSettings.length - 1 > index) {\n        setNotificationAddState('active');\n      }\n\n      if (setting.method !== undefined && notificationAddState !== 'hidden') {\n        setNotificationAddState('active');\n      }\n    } else {\n      setNotificationSettings(settings);\n    }\n  };\n\n  const removeNotificationSetting = (index: number) => {\n    const settings = notificationSettings.slice();\n\n    settings.splice(index, 1);\n    setNotificationSettings(settings);\n    setNotificationAddState('active');\n  };\n\n  // Alert fetch logic\n  const {\n    state: { loading, resource, error: fetchError },\n    fetchResource,\n    createResource,\n    updateResource,\n    clearError,\n  } = useSingleViewResource<AlertObject>('report', t('report'), addDangerToast);\n\n  // Functions\n  const hide = () => {\n    clearError();\n    setIsHidden(true);\n    onHide();\n    setNotificationSettings([]);\n    setCurrentAlert({ ...defaultAlert });\n    setNotificationAddState('active');\n  };\n\n  const onSave = () => {\n    // Notification Settings\n    const recipients: Recipient[] = [];\n\n    notificationSettings.forEach(setting => {\n      if (setting.method && setting.recipients.length) {\n        recipients.push({\n          recipient_config_json: {\n            target: setting.recipients,\n          },\n          type: setting.method,\n        });\n      }\n    });\n\n    const shouldEnableForceScreenshot = contentType === 'chart' && !isReport;\n    const data: any = {\n      ...currentAlert,\n      type: isReport ? 'Report' : 'Alert',\n      force_screenshot: shouldEnableForceScreenshot || forceScreenshot,\n      validator_type: conditionNotNull ? 'not null' : 'operator',\n      validator_config_json: conditionNotNull\n        ? {}\n        : currentAlert?.validator_config_json,\n      chart: contentType === 'chart' ? currentAlert?.chart?.value : null,\n      dashboard:\n        contentType === 'dashboard' ? currentAlert?.dashboard?.value : null,\n      custom_width: isScreenshot ? currentAlert?.custom_width : undefined,\n      database: currentAlert?.database?.value,\n      owners: (currentAlert?.owners || []).map(\n        owner => (owner as MetaObject).value || owner.id,\n      ),\n      recipients,\n      report_format: reportFormat || DEFAULT_NOTIFICATION_FORMAT,\n    };\n\n    if (data.recipients && !data.recipients.length) {\n      delete data.recipients;\n    }\n\n    data.context_markdown = 'string';\n\n    if (isEditMode) {\n      // Edit\n      if (currentAlert?.id) {\n        const update_id = currentAlert.id;\n\n        delete data.id;\n        delete data.created_by;\n        delete data.last_eval_dttm;\n        delete data.last_state;\n        delete data.last_value;\n        delete data.last_value_row_json;\n\n        updateResource(update_id, data).then(response => {\n          if (!response) {\n            return;\n          }\n\n          addSuccessToast(t('%s updated', data.type));\n\n          if (onAdd) {\n            onAdd();\n          }\n\n          hide();\n        });\n      }\n    } else if (currentAlert) {\n      // Create\n      createResource(data).then(response => {\n        if (!response) {\n          return;\n        }\n\n        addSuccessToast(t('%s updated', data.type));\n\n        if (onAdd) {\n          onAdd(response);\n        }\n\n        hide();\n      });\n    }\n  };\n\n  // Fetch data to populate form dropdowns\n  const loadOwnerOptions = useMemo(\n    () =>\n      (input = '', page: number, pageSize: number) => {\n        const query = rison.encode({\n          filter: input,\n          page,\n          page_size: pageSize,\n        });\n        return SupersetClient.get({\n          endpoint: `/api/v1/report/related/created_by?q=${query}`,\n        }).then(response => ({\n          data: response.json.result.map(\n            (item: { value: number; text: string }) => ({\n              value: item.value,\n              label: item.text,\n            }),\n          ),\n          totalCount: response.json.count,\n        }));\n      },\n    [],\n  );\n\n  const getSourceData = useCallback(\n    (db?: MetaObject) => {\n      const database = db || currentAlert?.database;\n\n      if (!database || database.label) {\n        return null;\n      }\n\n      let result;\n\n      // Cycle through source options to find the selected option\n      sourceOptions.forEach(source => {\n        if (source.value === database.value || source.value === database.id) {\n          result = source;\n        }\n      });\n\n      return result;\n    },\n    [currentAlert?.database, sourceOptions],\n  );\n\n  // Updating alert/report state\n  const updateAlertState = (name: string, value: any) => {\n    setCurrentAlert(currentAlertData => ({\n      ...currentAlertData,\n      [name]: value,\n    }));\n  };\n\n  const loadSourceOptions = useMemo(\n    () =>\n      (input = '', page: number, pageSize: number) => {\n        const query = rison.encode({\n          filter: input,\n          page,\n          page_size: pageSize,\n        });\n        return SupersetClient.get({\n          endpoint: `/api/v1/report/related/database?q=${query}`,\n        }).then(response => {\n          const list = response.json.result.map(\n            (item: { value: number; text: string }) => ({\n              value: item.value,\n              label: item.text,\n            }),\n          );\n          setSourceOptions(list);\n          return { data: list, totalCount: response.json.count };\n        });\n      },\n    [],\n  );\n\n  const databaseLabel = currentAlert?.database && !currentAlert.database.label;\n  useEffect(() => {\n    // Find source if current alert has one set\n    if (databaseLabel) {\n      updateAlertState('database', getSourceData());\n    }\n  }, [databaseLabel, getSourceData]);\n\n  const loadDashboardOptions = useMemo(\n    () =>\n      (input = '', page: number, pageSize: number) => {\n        const query = rison.encode_uri({\n          filter: input,\n          page,\n          page_size: pageSize,\n        });\n        return SupersetClient.get({\n          endpoint: `/api/v1/report/related/dashboard?q=${query}`,\n        }).then(response => {\n          const list = response.json.result.map(\n            (item: { value: number; text: string }) => ({\n              value: item.value,\n              label: item.text,\n            }),\n          );\n          setDashboardOptions(list);\n          return { data: list, totalCount: response.json.count };\n        });\n      },\n    [],\n  );\n\n  const getDashboardData = (db?: MetaObject) => {\n    const dashboard = db || currentAlert?.dashboard;\n\n    if (!dashboard || dashboard.label) {\n      return null;\n    }\n\n    let result;\n\n    // Cycle through dashboard options to find the selected option\n    dashboardOptions.forEach(dash => {\n      if (dash.value === dashboard.value || dash.value === dashboard.id) {\n        result = dash;\n      }\n    });\n\n    return result;\n  };\n\n  const getChartData = useCallback(\n    (chartData?: MetaObject) => {\n      const chart = chartData || currentAlert?.chart;\n\n      if (!chart || chart.label) {\n        return null;\n      }\n\n      let result;\n\n      // Cycle through chart options to find the selected option\n      chartOptions.forEach(slice => {\n        if (slice.value === chart.value || slice.value === chart.id) {\n          result = slice;\n        }\n      });\n\n      return result;\n    },\n    [chartOptions, currentAlert?.chart],\n  );\n\n  const noChartLabel = currentAlert?.chart && !currentAlert?.chart.label;\n  useEffect(() => {\n    // Find source if current alert has one set\n    if (noChartLabel) {\n      updateAlertState('chart', getChartData());\n    }\n  }, [getChartData, noChartLabel]);\n\n  const loadChartOptions = useMemo(\n    () =>\n      (input = '', page: number, pageSize: number) => {\n        const query = rison.encode_uri({\n          filter: input,\n          page,\n          page_size: pageSize,\n        });\n        return SupersetClient.get({\n          endpoint: `/api/v1/report/related/chart?q=${query}`,\n        }).then(response => {\n          const list = response.json.result.map(\n            (item: { value: number; text: string }) => ({\n              value: item.value,\n              label: item.text,\n            }),\n          );\n\n          setChartOptions(list);\n          return { data: list, totalCount: response.json.count };\n        });\n      },\n    [],\n  );\n\n  const getChartVisualizationType = (chart: SelectValue) =>\n    SupersetClient.get({\n      endpoint: `/api/v1/chart/${chart.value}`,\n    }).then(response => setChartVizType(response.json.result.viz_type));\n\n  // Handle input/textarea updates\n  const onInputChange = (\n    event: React.ChangeEvent<HTMLTextAreaElement | HTMLInputElement>,\n  ) => {\n    const {\n      target: { type, value, name },\n    } = event;\n    const parsedValue = type === 'number' ? parseInt(value, 10) || null : value;\n\n    updateAlertState(name, parsedValue);\n\n    if (name === 'name') {\n      updateEmailSubject();\n    }\n  };\n\n  const onCustomWidthChange = (value: number | null | undefined) => {\n    updateAlertState('custom_width', value);\n  };\n\n  const onTimeoutVerifyChange = (\n    event: React.ChangeEvent<HTMLTextAreaElement | HTMLInputElement>,\n  ) => {\n    const { target } = event;\n    const value = +target.value;\n\n    // Need to make sure grace period is not lower than TIMEOUT_MIN\n    if (value === 0) {\n      updateAlertState(target.name, undefined);\n    } else {\n      updateAlertState(\n        target.name,\n        value ? Math.max(value, TIMEOUT_MIN) : value,\n      );\n    }\n  };\n\n  const onSQLChange = (value: string) => {\n    updateAlertState('sql', value || '');\n  };\n\n  const onOwnersChange = (value: Array<SelectValue>) => {\n    updateAlertState('owners', value || []);\n  };\n\n  const onSourceChange = (value: Array<SelectValue>) => {\n    updateAlertState('database', value || []);\n  };\n\n  const onDashboardChange = (dashboard: SelectValue) => {\n    updateAlertState('dashboard', dashboard || undefined);\n    updateAlertState('chart', null);\n  };\n\n  const onChartChange = (chart: SelectValue) => {\n    getChartVisualizationType(chart);\n    updateAlertState('chart', chart || undefined);\n    updateAlertState('dashboard', null);\n  };\n\n  const onActiveSwitch = (checked: boolean) => {\n    updateAlertState('active', checked);\n  };\n\n  const onConditionChange = (op: Operator) => {\n    setConditionNotNull(op === 'not null');\n\n    const config = {\n      op,\n      threshold: currentAlert\n        ? currentAlert.validator_config_json?.threshold\n        : undefined,\n    };\n\n    updateAlertState('validator_config_json', config);\n  };\n\n  const onThresholdChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const { target } = event;\n\n    const config = {\n      op: currentAlert ? currentAlert.validator_config_json?.op : undefined,\n      threshold: target.value,\n    };\n\n    updateAlertState('validator_config_json', config);\n  };\n\n  const onLogRetentionChange = (retention: number) => {\n    updateAlertState('log_retention', retention);\n  };\n\n  const onTimezoneChange = (timezone: string) => {\n    updateAlertState('timezone', timezone);\n  };\n\n  const onContentTypeChange = (value: string) => {\n    // When switch content type, reset force_screenshot to false\n    setForceScreenshot(false);\n    setContentType(value);\n  };\n\n  const onFormatChange = (value: string) => {\n    setReportFormat(value);\n  };\n\n  const onForceScreenshotChange = (event: any) => {\n    setForceScreenshot(event.target.checked);\n  };\n\n  // Make sure notification settings has the required info\n  const checkNotificationSettings = () => {\n    if (!notificationSettings.length) {\n      return false;\n    }\n\n    let hasInfo = false;\n\n    notificationSettings.forEach(setting => {\n      if (!!setting.method && setting.recipients?.length) {\n        hasInfo = true;\n      }\n    });\n\n    return hasInfo;\n  };\n\n  const validateGeneralSection = () => {\n    const errors = [];\n    if (!currentAlert?.name?.length) {\n      errors.push(TRANSLATIONS.NAME_ERROR_TEXT);\n    }\n    if (!currentAlert?.owners?.length) {\n      errors.push(TRANSLATIONS.OWNERS_ERROR_TEXT);\n    }\n    updateValidationStatus(Sections.General, errors);\n  };\n  const validateContentSection = () => {\n    const errors = [];\n    if (\n      !(\n        (contentType === 'dashboard' && !!currentAlert?.dashboard) ||\n        (contentType === 'chart' && !!currentAlert?.chart)\n      )\n    ) {\n      errors.push(TRANSLATIONS.CONTENT_ERROR_TEXT);\n    }\n    updateValidationStatus(Sections.Content, errors);\n  };\n  const validateAlertSection = () => {\n    const errors = [];\n    if (!currentAlert?.database) {\n      errors.push(TRANSLATIONS.DATABASE_ERROR_TEXT);\n    }\n    if (!currentAlert?.sql?.length) {\n      errors.push(TRANSLATIONS.SQL_ERROR_TEXT);\n    }\n    if (\n      !(\n        (conditionNotNull || !!currentAlert?.validator_config_json?.op) &&\n        (conditionNotNull ||\n          currentAlert?.validator_config_json?.threshold !== undefined)\n      )\n    ) {\n      errors.push(TRANSLATIONS.ALERT_CONDITION_ERROR_TEXT);\n    }\n    updateValidationStatus(Sections.Alert, errors);\n  };\n\n  const validateScheduleSection = () => {\n    const errors = [];\n    if (!currentAlert?.crontab?.length) {\n      errors.push(TRANSLATIONS.CRONTAB_ERROR_TEXT);\n    }\n    if (!currentAlert?.working_timeout) {\n      errors.push(TRANSLATIONS.WORKING_TIMEOUT_ERROR_TEXT);\n    }\n\n    updateValidationStatus(Sections.Schedule, errors);\n  };\n\n  const validateNotificationSection = () => {\n    const hasErrors = !checkNotificationSettings();\n    const errors = hasErrors ? [TRANSLATIONS.RECIPIENTS_ERROR_TEXT] : [];\n\n    if (emailError) {\n      errors.push(TRANSLATIONS.EMAIL_SUBJECT_ERROR_TEXT);\n    }\n\n    updateValidationStatus(Sections.Notification, errors);\n  };\n\n  const validateAll = () => {\n    validateGeneralSection();\n    validateContentSection();\n    if (!isReport) validateAlertSection();\n    validateScheduleSection();\n    validateNotificationSection();\n  };\n\n  const enforceValidation = () => {\n    const sections = [\n      Sections.General,\n      Sections.Content,\n      isReport ? undefined : Sections.Alert,\n      Sections.Schedule,\n      Sections.Notification,\n    ];\n\n    const hasErrors = sections.some(\n      section => section && validationStatus[section].hasErrors,\n    );\n    const tooltip = hasErrors ? buildErrorTooltipMessage(validationStatus) : '';\n    setErrorTooltipMessage(tooltip);\n    setDisableSave(hasErrors);\n  };\n\n  // Initialize\n  useEffect(() => {\n    if (\n      isEditMode &&\n      (!currentAlert?.id || alert?.id !== currentAlert.id || (isHidden && show))\n    ) {\n      if (alert?.id !== null && !loading && !fetchError) {\n        const id = alert.id || 0;\n        fetchResource(id);\n      }\n    } else if (\n      !isEditMode &&\n      (!currentAlert || currentAlert.id || (isHidden && show))\n    ) {\n      setCurrentAlert({\n        ...defaultAlert,\n        owners: currentUser\n          ? [\n              {\n                value: currentUser.userId,\n                label: `${currentUser.firstName} ${currentUser.lastName}`,\n              },\n            ]\n          : [],\n      });\n      setNotificationSettings([\n        {\n          recipients: '',\n          options: allowedNotificationMethods,\n          method: 'Email',\n        },\n      ]);\n      setNotificationAddState('active');\n    }\n  }, [alert]);\n\n  useEffect(() => {\n    if (resource) {\n      // Add notification settings\n      const settings = (resource.recipients || []).map(setting => {\n        const config =\n          typeof setting.recipient_config_json === 'string'\n            ? JSON.parse(setting.recipient_config_json)\n            : {};\n        return {\n          method: setting.type,\n          // @ts-ignore: Type not assignable\n          recipients: config.target || setting.recipient_config_json,\n          options: allowedNotificationMethods,\n        };\n      });\n\n      setNotificationSettings(settings);\n      setNotificationAddState(\n        settings.length === allowedNotificationMethods.length\n          ? 'hidden'\n          : 'active',\n      );\n      setContentType(resource.chart ? 'chart' : 'dashboard');\n      setReportFormat(resource.report_format || DEFAULT_NOTIFICATION_FORMAT);\n      const validatorConfig =\n        typeof resource.validator_config_json === 'string'\n          ? JSON.parse(resource.validator_config_json)\n          : resource.validator_config_json;\n\n      setConditionNotNull(resource.validator_type === 'not null');\n\n      if (resource.chart) {\n        setChartVizType((resource.chart as ChartObject).viz_type);\n      }\n      setForceScreenshot(resource.force_screenshot);\n\n      setCurrentAlert({\n        ...resource,\n        chart: resource.chart\n          ? getChartData(resource.chart) || {\n              value: (resource.chart as ChartObject).id,\n              label: (resource.chart as ChartObject).slice_name,\n            }\n          : undefined,\n        dashboard: resource.dashboard\n          ? getDashboardData(resource.dashboard) || {\n              value: (resource.dashboard as DashboardObject).id,\n              label: (resource.dashboard as DashboardObject).dashboard_title,\n            }\n          : undefined,\n        database: resource.database\n          ? getSourceData(resource.database) || {\n              value: (resource.database as DatabaseObject).id,\n              label: (resource.database as DatabaseObject).database_name,\n            }\n          : undefined,\n        owners: (alert?.owners || []).map(owner => ({\n          value: (owner as MetaObject).value || owner.id,\n          label:\n            (owner as MetaObject).label ||\n            `${(owner as Owner).first_name} ${(owner as Owner).last_name}`,\n        })),\n        // @ts-ignore: Type not assignable\n        validator_config_json:\n          resource.validator_type === 'not null'\n            ? {\n                op: 'not null',\n              }\n            : validatorConfig,\n      });\n    }\n  }, [resource]);\n\n  // Validation\n  const currentAlertSafe = currentAlert || {};\n  useEffect(() => {\n    validateAll();\n    updateEmailSubject();\n  }, [\n    currentAlertSafe.name,\n    currentAlertSafe.owners,\n    currentAlertSafe.database,\n    currentAlertSafe.sql,\n    currentAlertSafe.validator_config_json,\n    currentAlertSafe.crontab,\n    currentAlertSafe.working_timeout,\n    currentAlertSafe.dashboard,\n    currentAlertSafe.chart,\n    contentType,\n    notificationSettings,\n    conditionNotNull,\n    emailError,\n  ]);\n  useEffect(() => {\n    enforceValidation();\n  }, [validationStatus]);\n\n  // Show/hide\n  if (isHidden && show) {\n    setIsHidden(false);\n  }\n\n  const getTitleText = () => {\n    let titleText;\n\n    switch (true) {\n      case isEditMode && isReport:\n        titleText = t('Edit Report');\n        break;\n      case isEditMode:\n        titleText = t('Edit Alert');\n        break;\n      case isReport:\n        titleText = t('Add Report');\n        break;\n      default:\n        titleText = t('Add Alert');\n        break;\n    }\n\n    return titleText;\n  };\n\n  const updateEmailSubject = () => {\n    if (contentType === 'chart') {\n      if (currentAlert?.name || currentAlert?.chart?.label) {\n        setEmailSubject(\n          `${currentAlert?.name}: ${currentAlert?.chart?.label || ''}`,\n        );\n      } else {\n        setEmailSubject('');\n      }\n    } else if (contentType === 'dashboard') {\n      if (currentAlert?.name || currentAlert?.dashboard?.label) {\n        setEmailSubject(\n          `${currentAlert?.name}: ${currentAlert?.dashboard?.label || ''}`,\n        );\n      } else {\n        setEmailSubject('');\n      }\n    } else {\n      setEmailSubject('');\n    }\n  };\n\n  const handleErrorUpdate = (hasError: boolean) => {\n    setEmailError(hasError);\n  };\n\n  return (\n    <StyledModal\n      className=\"no-content-padding\"\n      responsive\n      disablePrimaryButton={disableSave}\n      primaryTooltipMessage={errorTooltipMessage}\n      onHandledPrimaryAction={onSave}\n      onHide={hide}\n      primaryButtonName={isEditMode ? t('Save') : t('Add')}\n      show={show}\n      width=\"500px\"\n      centered\n      title={<h4 data-test=\"alert-report-modal-title\">{getTitleText()}</h4>}\n    >\n      <Collapse\n        expandIconPosition=\"right\"\n        defaultActiveKey=\"general\"\n        accordion\n        css={css`\n          border: 'none';\n        `}\n      >\n        <StyledPanel\n          header={\n            <ValidatedPanelHeader\n              title={TRANSLATIONS.GENERAL_TITLE}\n              subtitle={t(\n                'Set up basic details, such as name and description.',\n              )}\n              validateCheckStatus={\n                !validationStatus[Sections.General].hasErrors\n              }\n              testId=\"general-information-panel\"\n            />\n          }\n          key=\"general\"\n        >\n          <div className=\"header-section\">\n            <StyledInputContainer>\n              <div className=\"control-label\">\n                {isReport ? t('Report name') : t('Alert name')}\n                <span className=\"required\">*</span>\n              </div>\n              <div className=\"input-container\">\n                <input\n                  type=\"text\"\n                  name=\"name\"\n                  value={currentAlert ? currentAlert.name : ''}\n                  placeholder={\n                    isReport ? t('Enter report name') : t('Enter alert name')\n                  }\n                  onChange={onInputChange}\n                />\n              </div>\n            </StyledInputContainer>\n            <StyledInputContainer>\n              <div className=\"control-label\">\n                {t('Owners')}\n                <span className=\"required\">*</span>\n              </div>\n              <div data-test=\"owners-select\" className=\"input-container\">\n                <AsyncSelect\n                  ariaLabel={t('Owners')}\n                  allowClear\n                  name=\"owners\"\n                  mode=\"multiple\"\n                  placeholder={t('Select owners')}\n                  value={\n                    (currentAlert?.owners as {\n                      label: string;\n                      value: number;\n                    }[]) || []\n                  }\n                  options={loadOwnerOptions}\n                  onChange={onOwnersChange}\n                />\n              </div>\n            </StyledInputContainer>\n            <StyledInputContainer>\n              <div className=\"control-label\">{t('Description')}</div>\n              <div className=\"input-container\">\n                <input\n                  type=\"text\"\n                  name=\"description\"\n                  value={currentAlert ? currentAlert.description || '' : ''}\n                  placeholder={t(\n                    'Include description to be sent with %s',\n                    reportOrAlert,\n                  )}\n                  onChange={onInputChange}\n                />\n              </div>\n            </StyledInputContainer>\n            <StyledSwitchContainer>\n              <Switch\n                checked={currentAlert ? currentAlert.active : false}\n                defaultChecked\n                onChange={onActiveSwitch}\n              />\n              <div className=\"switch-label\">\n                {isReport ? t('Report is active') : t('Alert is active')}\n              </div>\n            </StyledSwitchContainer>\n          </div>\n        </StyledPanel>\n        {!isReport && (\n          <StyledPanel\n            header={\n              <ValidatedPanelHeader\n                title={TRANSLATIONS.ALERT_CONDITION_TITLE}\n                subtitle={t(\n                  'Define the database, SQL query, and triggering conditions for alert.',\n                )}\n                validateCheckStatus={\n                  !validationStatus[Sections.Alert].hasErrors\n                }\n                testId=\"alert-condition-panel\"\n              />\n            }\n            key=\"condition\"\n          >\n            <StyledInputContainer>\n              <div className=\"control-label\">\n                {t('Database')}\n                <span className=\"required\">*</span>\n              </div>\n              <div className=\"input-container\">\n                <AsyncSelect\n                  ariaLabel={t('Database')}\n                  name=\"source\"\n                  placeholder={t('Select database')}\n                  value={\n                    currentAlert?.database?.label &&\n                    currentAlert?.database?.value\n                      ? {\n                          value: currentAlert.database.value,\n                          label: currentAlert.database.label,\n                        }\n                      : undefined\n                  }\n                  options={loadSourceOptions}\n                  onChange={onSourceChange}\n                />\n              </div>\n            </StyledInputContainer>\n            <StyledInputContainer>\n              <div className=\"control-label\">\n                {t('SQL Query')}\n                <StyledTooltip\n                  tooltip={t(\n                    'The result of this query must be a value capable of numeric interpretation e.g. 1, 1.0, or \"1\" (compatible with Python\\'s float() function).',\n                  )}\n                />\n                <span className=\"required\">*</span>\n              </div>\n              <TextAreaControl\n                name=\"sql\"\n                language=\"sql\"\n                offerEditInModal={false}\n                minLines={15}\n                maxLines={15}\n                onChange={onSQLChange}\n                readOnly={false}\n                initialValue={resource?.sql}\n                key={currentAlert?.id}\n              />\n            </StyledInputContainer>\n            <div className=\"inline-container wrap\">\n              <StyledInputContainer css={noMarginBottom}>\n                <div className=\"control-label\" css={inputSpacer}>\n                  {t('Trigger Alert If...')}\n                  <span className=\"required\">*</span>\n                </div>\n                <div className=\"input-container\">\n                  <Select\n                    ariaLabel={t('Condition')}\n                    onChange={onConditionChange}\n                    placeholder={t('Condition')}\n                    value={currentAlert?.validator_config_json?.op || undefined}\n                    options={CONDITIONS}\n                    css={inputSpacer}\n                  />\n                </div>\n              </StyledInputContainer>\n              <StyledInputContainer css={noMarginBottom}>\n                <div className=\"control-label\">\n                  {t('Value')}{' '}\n                  {!conditionNotNull && <span className=\"required\">*</span>}\n                </div>\n                <div className=\"input-container\">\n                  <input\n                    type=\"number\"\n                    name=\"threshold\"\n                    disabled={conditionNotNull}\n                    value={\n                      currentAlert?.validator_config_json?.threshold !==\n                        undefined && !conditionNotNull\n                        ? currentAlert.validator_config_json.threshold\n                        : ''\n                    }\n                    placeholder={t('Value')}\n                    onChange={onThresholdChange}\n                  />\n                </div>\n              </StyledInputContainer>\n            </div>\n          </StyledPanel>\n        )}\n        <StyledPanel\n          header={\n            <ValidatedPanelHeader\n              title={\n                isReport\n                  ? TRANSLATIONS.REPORT_CONTENTS_TITLE\n                  : TRANSLATIONS.ALERT_CONTENTS_TITLE\n              }\n              subtitle={t('Customize data source, filters, and layout.')}\n              validateCheckStatus={\n                !validationStatus[Sections.Content].hasErrors\n              }\n              testId=\"contents-panel\"\n            />\n          }\n          key=\"contents\"\n        >\n          <StyledInputContainer>\n            <div className=\"control-label\">\n              {t('Content type')}\n              <span className=\"required\">*</span>\n            </div>\n            <Select\n              ariaLabel={t('Select content type')}\n              onChange={onContentTypeChange}\n              value={contentType}\n              options={CONTENT_TYPE_OPTIONS}\n              placeholder={t('Select content type')}\n            />\n          </StyledInputContainer>\n          <StyledInputContainer>\n            {contentType === 'chart' ? (\n              <>\n                <div className=\"control-label\">\n                  {t('Select chart')}\n                  <span className=\"required\">*</span>\n                </div>\n                <AsyncSelect\n                  ariaLabel={t('Chart')}\n                  name=\"chart\"\n                  value={\n                    currentAlert?.chart?.label && currentAlert?.chart?.value\n                      ? {\n                          value: currentAlert.chart.value,\n                          label: currentAlert.chart.label,\n                        }\n                      : undefined\n                  }\n                  options={loadChartOptions}\n                  onChange={onChartChange}\n                  placeholder={t('Select chart to use')}\n                />\n              </>\n            ) : (\n              <>\n                <div className=\"control-label\">\n                  {t('Select dashboard')}\n                  <span className=\"required\">*</span>\n                </div>\n                <AsyncSelect\n                  ariaLabel={t('Dashboard')}\n                  name=\"dashboard\"\n                  value={\n                    currentAlert?.dashboard?.label &&\n                    currentAlert?.dashboard?.value\n                      ? {\n                          value: currentAlert.dashboard.value,\n                          label: currentAlert.dashboard.label,\n                        }\n                      : undefined\n                  }\n                  options={loadDashboardOptions}\n                  onChange={onDashboardChange}\n                  placeholder={t('Select dashboard to use')}\n                />\n              </>\n            )}\n          </StyledInputContainer>\n          <StyledInputContainer\n            css={\n              ['PDF', 'TEXT', 'CSV'].includes(reportFormat) && noMarginBottom\n            }\n          >\n            {formatOptionEnabled && (\n              <>\n                <div className=\"control-label\">\n                  {t('Content format')}\n                  <span className=\"required\">*</span>\n                </div>\n                <Select\n                  ariaLabel={t('Select format')}\n                  onChange={onFormatChange}\n                  value={reportFormat}\n                  options={\n                    contentType === 'dashboard'\n                      ? ['pdf', 'png'].map(key => FORMAT_OPTIONS[key])\n                      : /* If chart is of text based viz type: show text\n                  format option */\n                        TEXT_BASED_VISUALIZATION_TYPES.includes(chartVizType)\n                        ? Object.values(FORMAT_OPTIONS)\n                        : ['pdf', 'png', 'csv'].map(key => FORMAT_OPTIONS[key])\n                  }\n                  placeholder={t('Select format')}\n                />\n              </>\n            )}\n          </StyledInputContainer>\n          {isScreenshot && (\n            <StyledInputContainer\n              css={!isReport && contentType === 'chart' && noMarginBottom}\n            >\n              <div className=\"control-label\">{t('Screenshot width')}</div>\n              <div className=\"input-container\">\n                <InputNumber\n                  type=\"number\"\n                  name=\"custom_width\"\n                  value={currentAlert?.custom_width || undefined}\n                  min={600}\n                  max={2400}\n                  placeholder={t('Input custom width in pixels')}\n                  onChange={onCustomWidthChange}\n                />\n              </div>\n            </StyledInputContainer>\n          )}\n          {(isReport || contentType === 'dashboard') && (\n            <div className=\"inline-container\">\n              <StyledCheckbox\n                data-test=\"bypass-cache\"\n                className=\"checkbox\"\n                checked={forceScreenshot}\n                onChange={onForceScreenshotChange}\n              >\n                {t('Ignore cache when generating report')}\n              </StyledCheckbox>\n            </div>\n          )}\n        </StyledPanel>\n        <StyledPanel\n          header={\n            <ValidatedPanelHeader\n              title={TRANSLATIONS.SCHEDULE_TITLE}\n              subtitle={t(\n                'Define delivery schedule, timezone, and frequency settings.',\n              )}\n              validateCheckStatus={\n                !validationStatus[Sections.Schedule].hasErrors\n              }\n              testId=\"schedule-panel\"\n            />\n          }\n          key=\"schedule\"\n        >\n          <AlertReportCronScheduler\n            value={currentAlert?.crontab || ''}\n            onChange={newVal => updateAlertState('crontab', newVal)}\n          />\n          <StyledInputContainer>\n            <div className=\"control-label\">\n              {t('Timezone')} <span className=\"required\">*</span>\n            </div>\n            <TimezoneSelector\n              onTimezoneChange={onTimezoneChange}\n              timezone={currentAlert?.timezone}\n              minWidth=\"100%\"\n            />\n          </StyledInputContainer>\n          <StyledInputContainer>\n            <div className=\"control-label\">\n              {t('Log retention')}\n              <span className=\"required\">*</span>\n            </div>\n            <div className=\"input-container\">\n              <Select\n                ariaLabel={t('Log retention')}\n                placeholder={t('Log retention')}\n                onChange={onLogRetentionChange}\n                value={currentAlert?.log_retention}\n                options={RETENTION_OPTIONS}\n                sortComparator={propertyComparator('value')}\n              />\n            </div>\n          </StyledInputContainer>\n          <StyledInputContainer css={noMarginBottom}>\n            {isReport ? (\n              <>\n                <div className=\"control-label\">\n                  {t('Working timeout')}\n                  <span className=\"required\">*</span>\n                </div>\n                <div className=\"input-container\">\n                  <NumberInput\n                    min={1}\n                    name=\"working_timeout\"\n                    value={currentAlert?.working_timeout || ''}\n                    placeholder={t('Time in seconds')}\n                    onChange={onTimeoutVerifyChange}\n                    timeUnit={t('seconds')}\n                  />\n                </div>\n              </>\n            ) : (\n              <>\n                <div className=\"control-label\">{t('Grace period')}</div>\n                <div className=\"input-container\">\n                  <NumberInput\n                    min={1}\n                    name=\"grace_period\"\n                    value={currentAlert?.grace_period || ''}\n                    placeholder={t('Time in seconds')}\n                    onChange={onTimeoutVerifyChange}\n                    timeUnit={t('seconds')}\n                  />\n                </div>\n              </>\n            )}\n          </StyledInputContainer>\n        </StyledPanel>\n        <StyledPanel\n          header={\n            <ValidatedPanelHeader\n              title={TRANSLATIONS.NOTIFICATION_TITLE}\n              subtitle={t('Choose notification method and recipients.')}\n              validateCheckStatus={\n                !validationStatus[Sections.Notification].hasErrors\n              }\n              testId=\"notification-method-panel\"\n            />\n          }\n          key=\"notification\"\n        >\n          {notificationSettings.map((notificationSetting, i) => (\n            <StyledNotificationMethodWrapper>\n              <NotificationMethod\n                setting={notificationSetting}\n                index={i}\n                key={`NotificationMethod-${i}`}\n                onUpdate={updateNotificationSetting}\n                onRemove={removeNotificationSetting}\n                onInputChange={onInputChange}\n                email_subject={currentAlert?.email_subject || ''}\n                defaultSubject={emailSubject || ''}\n                setErrorSubject={handleErrorUpdate}\n              />\n            </StyledNotificationMethodWrapper>\n          ))}\n          {\n            // Prohibit 'add notification method' button if only one present\n            allowedNotificationMethods.length > notificationSettings.length && (\n              <NotificationMethodAdd\n                data-test=\"notification-add\"\n                status={notificationAddState}\n                onClick={onNotificationAdd}\n              />\n            )\n          }\n        </StyledPanel>\n      </Collapse>\n    </StyledModal>\n  );\n};\n\nexport default withToasts(AlertReportModal);\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}