{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState, useEffect, useMemo } from 'react';\nimport { ensureIsArray, styled, t } from '@superset-ui/core';\nimport Loading from 'src/components/Loading';\nimport { EmptyStateMedium } from 'src/components/EmptyState';\nimport TableView, { EmptyWrapperType } from 'src/components/TableView';\nimport { useFilteredTableData, useTableColumns } from 'src/explore/components/DataTableControl';\nimport { getDatasourceSamples } from 'src/components/Chart/chartAction';\nimport { TableControls } from './DataTableControls';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nconst Error = styled.pre`\n  margin-top: ${({ theme }) => `${theme.gridUnit * 4}px`};\n`;\nconst cache = new WeakSet();\nexport const SamplesPane = ({ isRequest, datasource, queryForce, actions, dataSize = 50, isVisible }) => {\n  const [filterText, setFilterText] = useState('');\n  const [data, setData] = useState([]);\n  const [colnames, setColnames] = useState([]);\n  const [coltypes, setColtypes] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [rowcount, setRowCount] = useState(0);\n  const [responseError, setResponseError] = useState('');\n  const datasourceId = useMemo(() => `${datasource.id}__${datasource.type}`, [datasource]);\n  useEffect(() => {\n    if (isRequest && queryForce) {\n      cache.delete(datasource);\n    }\n    if (isRequest && !cache.has(datasource)) {\n      setIsLoading(true);\n      getDatasourceSamples(datasource.type, datasource.id, queryForce, {}).\n      then((response) => {\n        setData(ensureIsArray(response.data));\n        setColnames(ensureIsArray(response.colnames));\n        setColtypes(ensureIsArray(response.coltypes));\n        setRowCount(response.rowcount);\n        setResponseError('');\n        cache.add(datasource);\n        if (queryForce && actions) {\n          actions.setForceQuery(false);\n        }\n      }).\n      catch((error) => {\n        setData([]);\n        setColnames([]);\n        setColtypes([]);\n        setResponseError(`${error.name}: ${error.message}`);\n      }).\n      finally(() => {\n        setIsLoading(false);\n      });\n    }\n  }, [datasource, isRequest, queryForce]);\n  // this is to preserve the order of the columns, even if there are integer values,\n  // while also only grabbing the first column's keys\n  const columns = useTableColumns(colnames, coltypes, data, datasourceId, isVisible, {}, // moreConfig\n  true);\n  const filteredData = useFilteredTableData(filterText, data);\n  if (isLoading) {\n    return ___EmotionJSX(Loading, null);\n  }\n  if (responseError) {\n    return ___EmotionJSX(React.Fragment, null,\n    ___EmotionJSX(TableControls, { data: filteredData, columnNames: colnames, columnTypes: coltypes, rowcount: rowcount, datasourceId: datasourceId, onInputChange: (input) => setFilterText(input), isLoading: isLoading }),\n    ___EmotionJSX(Error, null, responseError)\n    );\n  }\n  if (data.length === 0) {\n    const title = t('No samples were returned for this dataset');\n    return ___EmotionJSX(EmptyStateMedium, { image: \"document.svg\", title: title });\n  }\n  return ___EmotionJSX(React.Fragment, null,\n  ___EmotionJSX(TableControls, { data: filteredData, columnNames: colnames, columnTypes: coltypes, rowcount: rowcount, datasourceId: datasourceId, onInputChange: (input) => setFilterText(input), isLoading: isLoading }),\n  ___EmotionJSX(TableView, { columns: columns, data: filteredData, pageSize: dataSize, noDataText: t('No results'), emptyWrapperType: EmptyWrapperType.Small, className: \"table-condensed\", isPaginationSticky: true, showRowCount: false, small: true })\n  );\n};__signature__(SamplesPane, \"useState{[filterText, setFilterText]('')}\\nuseState{[data, setData]([])}\\nuseState{[colnames, setColnames]([])}\\nuseState{[coltypes, setColtypes]([])}\\nuseState{[isLoading, setIsLoading](false)}\\nuseState{[rowcount, setRowCount](0)}\\nuseState{[responseError, setResponseError]('')}\\nuseMemo{datasourceId}\\nuseEffect{}\\nuseTableColumns{columns}\\nuseFilteredTableData{filteredData}\", () => [useTableColumns, useFilteredTableData]);;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(Error, \"Error\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/explore/components/DataTablesPane/components/SamplesPane.tsx\");reactHotLoader.register(cache, \"cache\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/explore/components/DataTablesPane/components/SamplesPane.tsx\");reactHotLoader.register(SamplesPane, \"SamplesPane\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/explore/components/DataTablesPane/components/SamplesPane.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["React","useState","useEffect","useMemo","ensureIsArray","styled","t","Loading","EmptyStateMedium","TableView","EmptyWrapperType","useFilteredTableData","useTableColumns","getDatasourceSamples","TableControls","jsx","___EmotionJSX","Error","pre","theme","gridUnit","cache","WeakSet","SamplesPane","isRequest","datasource","queryForce","actions","dataSize","isVisible","filterText","setFilterText","data","setData","colnames","setColnames","coltypes","setColtypes","isLoading","setIsLoading","rowcount","setRowCount","responseError","setResponseError","datasourceId","id","type","delete","has","then","response","add","setForceQuery","catch","error","name","message","finally","columns","filteredData","Fragment","columnNames","columnTypes","onInputChange","input","length","title","image","pageSize","noDataText","emptyWrapperType","Small","className","isPaginationSticky","showRowCount","small","__signature__","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/src/explore/components/DataTablesPane/components/SamplesPane.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState, useEffect, useMemo } from 'react';\nimport { ensureIsArray, GenericDataType, styled, t } from '@superset-ui/core';\nimport Loading from 'src/components/Loading';\nimport { EmptyStateMedium } from 'src/components/EmptyState';\nimport TableView, { EmptyWrapperType } from 'src/components/TableView';\nimport {\n  useFilteredTableData,\n  useTableColumns,\n} from 'src/explore/components/DataTableControl';\nimport { getDatasourceSamples } from 'src/components/Chart/chartAction';\nimport { TableControls } from './DataTableControls';\nimport { SamplesPaneProps } from '../types';\n\nconst Error = styled.pre`\n  margin-top: ${({ theme }) => `${theme.gridUnit * 4}px`};\n`;\n\nconst cache = new WeakSet();\n\nexport const SamplesPane = ({\n  isRequest,\n  datasource,\n  queryForce,\n  actions,\n  dataSize = 50,\n  isVisible,\n}: SamplesPaneProps) => {\n  const [filterText, setFilterText] = useState('');\n  const [data, setData] = useState<Record<string, any>[][]>([]);\n  const [colnames, setColnames] = useState<string[]>([]);\n  const [coltypes, setColtypes] = useState<GenericDataType[]>([]);\n  const [isLoading, setIsLoading] = useState<boolean>(false);\n  const [rowcount, setRowCount] = useState<number>(0);\n  const [responseError, setResponseError] = useState<string>('');\n  const datasourceId = useMemo(\n    () => `${datasource.id}__${datasource.type}`,\n    [datasource],\n  );\n\n  useEffect(() => {\n    if (isRequest && queryForce) {\n      cache.delete(datasource);\n    }\n\n    if (isRequest && !cache.has(datasource)) {\n      setIsLoading(true);\n      getDatasourceSamples(datasource.type, datasource.id, queryForce, {})\n        .then(response => {\n          setData(ensureIsArray(response.data));\n          setColnames(ensureIsArray(response.colnames));\n          setColtypes(ensureIsArray(response.coltypes));\n          setRowCount(response.rowcount);\n          setResponseError('');\n          cache.add(datasource);\n          if (queryForce && actions) {\n            actions.setForceQuery(false);\n          }\n        })\n        .catch(error => {\n          setData([]);\n          setColnames([]);\n          setColtypes([]);\n          setResponseError(`${error.name}: ${error.message}`);\n        })\n        .finally(() => {\n          setIsLoading(false);\n        });\n    }\n  }, [datasource, isRequest, queryForce]);\n\n  // this is to preserve the order of the columns, even if there are integer values,\n  // while also only grabbing the first column's keys\n  const columns = useTableColumns(\n    colnames,\n    coltypes,\n    data,\n    datasourceId,\n    isVisible,\n    {}, // moreConfig\n    true, // allowHTML\n  );\n  const filteredData = useFilteredTableData(filterText, data);\n\n  if (isLoading) {\n    return <Loading />;\n  }\n\n  if (responseError) {\n    return (\n      <>\n        <TableControls\n          data={filteredData}\n          columnNames={colnames}\n          columnTypes={coltypes}\n          rowcount={rowcount}\n          datasourceId={datasourceId}\n          onInputChange={input => setFilterText(input)}\n          isLoading={isLoading}\n        />\n        <Error>{responseError}</Error>\n      </>\n    );\n  }\n\n  if (data.length === 0) {\n    const title = t('No samples were returned for this dataset');\n    return <EmptyStateMedium image=\"document.svg\" title={title} />;\n  }\n\n  return (\n    <>\n      <TableControls\n        data={filteredData}\n        columnNames={colnames}\n        columnTypes={coltypes}\n        rowcount={rowcount}\n        datasourceId={datasourceId}\n        onInputChange={input => setFilterText(input)}\n        isLoading={isLoading}\n      />\n      <TableView\n        columns={columns}\n        data={filteredData}\n        pageSize={dataSize}\n        noDataText={t('No results')}\n        emptyWrapperType={EmptyWrapperType.Small}\n        className=\"table-condensed\"\n        isPaginationSticky\n        showRowCount={false}\n        small\n      />\n    </>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}