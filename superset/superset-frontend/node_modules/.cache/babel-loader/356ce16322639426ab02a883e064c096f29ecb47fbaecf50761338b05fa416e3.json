{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { GenericDataType } from '@superset-ui/core';\nimport { FALSE_STRING, NULL_STRING, TRUE_STRING } from 'src/utils/common';\nimport { Clauses, ExpressionTypes } from '../explore/components/controls/FilterControl/types';\nexport const getSelectExtraFormData = (col, value, emptyFilter = false, inverseSelection = false) => {\n  const extra = {};\n  if (emptyFilter) {\n    extra.adhoc_filters = [\n    {\n      expressionType: ExpressionTypes.Sql,\n      clause: Clauses.Where,\n      sqlExpression: '1 = 0'\n    }];\n\n  } else\n  if (value !== undefined && value !== null && value.length !== 0) {\n    extra.filters = [\n    {\n      col,\n      op: inverseSelection ? 'NOT IN' : 'IN',\n      // @ts-ignore\n      val: value\n    }];\n\n  }\n  return extra;\n};\nexport const getRangeExtraFormData = (col, lower, upper) => {\n  const filters = [];\n  if (lower !== undefined && lower !== null && lower !== upper) {\n    filters.push({ col, op: '>=', val: lower });\n  }\n  if (upper !== undefined && upper !== null && upper !== lower) {\n    filters.push({ col, op: '<=', val: upper });\n  }\n  if (upper !== undefined &&\n  upper !== null &&\n  lower !== undefined &&\n  lower !== null &&\n  upper === lower) {\n    filters.push({ col, op: '==', val: upper });\n  }\n  return filters.length ?\n  {\n    filters\n  } :\n  {};\n};\nexport function getDataRecordFormatter({ timeFormatter, numberFormatter } = {}) {\n  return (value, dtype) => {\n    if (value === null || value === undefined) {\n      return NULL_STRING;\n    }\n    if (typeof value === 'boolean') {\n      return value ? TRUE_STRING : FALSE_STRING;\n    }\n    if (dtype === GenericDataType.Boolean) {\n      try {\n        return JSON.parse(String(value).toLowerCase()) ?\n        TRUE_STRING :\n        FALSE_STRING;\n      }\n      catch {\n        return FALSE_STRING;\n      }\n    }\n    if (typeof value === 'string') {\n      return value;\n    }\n    if (timeFormatter && dtype === GenericDataType.Temporal) {\n      return timeFormatter(value);\n    }\n    if (numberFormatter &&\n    typeof value === 'number' &&\n    dtype === GenericDataType.Numeric) {\n      return numberFormatter(value);\n    }\n    return String(value);\n  };\n};(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(getSelectExtraFormData, \"getSelectExtraFormData\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/filters/utils.ts\");reactHotLoader.register(getRangeExtraFormData, \"getRangeExtraFormData\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/filters/utils.ts\");reactHotLoader.register(getDataRecordFormatter, \"getDataRecordFormatter\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/filters/utils.ts\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["GenericDataType","FALSE_STRING","NULL_STRING","TRUE_STRING","Clauses","ExpressionTypes","getSelectExtraFormData","col","value","emptyFilter","inverseSelection","extra","adhoc_filters","expressionType","Sql","clause","Where","sqlExpression","undefined","length","filters","op","val","getRangeExtraFormData","lower","upper","push","getDataRecordFormatter","timeFormatter","numberFormatter","dtype","Boolean","JSON","parse","String","toLowerCase","Temporal","Numeric","reactHotLoader","reactHotLoaderGlobal","default","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/src/filters/utils.ts"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  DataRecordValue,\n  GenericDataType,\n  NumberFormatter,\n  QueryObjectFilterClause,\n  TimeFormatter,\n  ExtraFormData,\n} from '@superset-ui/core';\nimport { FALSE_STRING, NULL_STRING, TRUE_STRING } from 'src/utils/common';\nimport {\n  Clauses,\n  ExpressionTypes,\n} from '../explore/components/controls/FilterControl/types';\n\nexport const getSelectExtraFormData = (\n  col: string,\n  value?: null | (string | number | boolean | null)[],\n  emptyFilter = false,\n  inverseSelection = false,\n): ExtraFormData => {\n  const extra: ExtraFormData = {};\n  if (emptyFilter) {\n    extra.adhoc_filters = [\n      {\n        expressionType: ExpressionTypes.Sql,\n        clause: Clauses.Where,\n        sqlExpression: '1 = 0',\n      },\n    ];\n  } else if (value !== undefined && value !== null && value.length !== 0) {\n    extra.filters = [\n      {\n        col,\n        op: inverseSelection ? ('NOT IN' as const) : ('IN' as const),\n        // @ts-ignore\n        val: value,\n      },\n    ];\n  }\n  return extra;\n};\n\nexport const getRangeExtraFormData = (\n  col: string,\n  lower?: number | null,\n  upper?: number | null,\n) => {\n  const filters: QueryObjectFilterClause[] = [];\n  if (lower !== undefined && lower !== null && lower !== upper) {\n    filters.push({ col, op: '>=', val: lower });\n  }\n  if (upper !== undefined && upper !== null && upper !== lower) {\n    filters.push({ col, op: '<=', val: upper });\n  }\n  if (\n    upper !== undefined &&\n    upper !== null &&\n    lower !== undefined &&\n    lower !== null &&\n    upper === lower\n  ) {\n    filters.push({ col, op: '==', val: upper });\n  }\n\n  return filters.length\n    ? {\n        filters,\n      }\n    : {};\n};\n\nexport interface DataRecordValueFormatter {\n  (value: DataRecordValue, dtype: GenericDataType): string;\n}\n\nexport function getDataRecordFormatter({\n  timeFormatter,\n  numberFormatter,\n}: {\n  timeFormatter?: TimeFormatter;\n  numberFormatter?: NumberFormatter;\n} = {}): DataRecordValueFormatter {\n  return (value, dtype) => {\n    if (value === null || value === undefined) {\n      return NULL_STRING;\n    }\n    if (typeof value === 'boolean') {\n      return value ? TRUE_STRING : FALSE_STRING;\n    }\n    if (dtype === GenericDataType.Boolean) {\n      try {\n        return JSON.parse(String(value).toLowerCase())\n          ? TRUE_STRING\n          : FALSE_STRING;\n      } catch {\n        return FALSE_STRING;\n      }\n    }\n    if (typeof value === 'string') {\n      return value;\n    }\n    if (timeFormatter && dtype === GenericDataType.Temporal) {\n      return timeFormatter(value);\n    }\n    if (\n      numberFormatter &&\n      typeof value === 'number' &&\n      dtype === GenericDataType.Numeric\n    ) {\n      return numberFormatter(value);\n    }\n    return String(value);\n  };\n}\n"],"mappings":"wSAAA;;;;;;;;;;;;;;;;;;AAkBA,SAEEA,eAAe,QAKV,mBAAmB;AAC1B,SAASC,YAAY,EAAEC,WAAW,EAAEC,WAAW,QAAQ,kBAAkB;AACzE,SACEC,OAAO,EACPC,eAAe,QACV,oDAAoD;AAE3D,OAAO,MAAMC,sBAAsB,GAAGA,CACpCC,GAAW,EACXC,KAAmD,EACnDC,WAAW,GAAG,KAAK,EACnBC,gBAAgB,GAAG,KAAK,KACP;EACjB,MAAMC,KAAK,GAAkB,EAAE;EAC/B,IAAIF,WAAW,EAAE;IACfE,KAAK,CAACC,aAAa,GAAG;IACpB;MACEC,cAAc,EAAER,eAAe,CAACS,GAAG;MACnCC,MAAM,EAAEX,OAAO,CAACY,KAAK;MACrBC,aAAa,EAAE;KAChB,CACF;;GACF;EAAM,IAAIT,KAAK,KAAKU,SAAS,IAAIV,KAAK,KAAK,IAAI,IAAIA,KAAK,CAACW,MAAM,KAAK,CAAC,EAAE;IACtER,KAAK,CAACS,OAAO,GAAG;IACd;MACEb,GAAG;MACHc,EAAE,EAAEX,gBAAgB,GAAI,QAAkB,GAAI,IAAc;MAC5D;MACAY,GAAG,EAAEd;KACN,CACF;;;EAEH,OAAOG,KAAK;AACd,CAAC;AAED,OAAO,MAAMY,qBAAqB,GAAGA,CACnChB,GAAW,EACXiB,KAAqB,EACrBC,KAAqB,KACnB;EACF,MAAML,OAAO,GAA8B,EAAE;EAC7C,IAAII,KAAK,KAAKN,SAAS,IAAIM,KAAK,KAAK,IAAI,IAAIA,KAAK,KAAKC,KAAK,EAAE;IAC5DL,OAAO,CAACM,IAAI,CAAC,EAAEnB,GAAG,EAAEc,EAAE,EAAE,IAAI,EAAEC,GAAG,EAAEE,KAAK,EAAE,CAAC;;EAE7C,IAAIC,KAAK,KAAKP,SAAS,IAAIO,KAAK,KAAK,IAAI,IAAIA,KAAK,KAAKD,KAAK,EAAE;IAC5DJ,OAAO,CAACM,IAAI,CAAC,EAAEnB,GAAG,EAAEc,EAAE,EAAE,IAAI,EAAEC,GAAG,EAAEG,KAAK,EAAE,CAAC;;EAE7C,IACEA,KAAK,KAAKP,SAAS;EACnBO,KAAK,KAAK,IAAI;EACdD,KAAK,KAAKN,SAAS;EACnBM,KAAK,KAAK,IAAI;EACdC,KAAK,KAAKD,KAAK,EACf;IACAJ,OAAO,CAACM,IAAI,CAAC,EAAEnB,GAAG,EAAEc,EAAE,EAAE,IAAI,EAAEC,GAAG,EAAEG,KAAK,EAAE,CAAC;;EAG7C,OAAOL,OAAO,CAACD,MAAM;EACjB;IACEC;GACD;EACD,EAAE;AACR,CAAC;AAMD,OAAM,SAAUO,sBAAsBA,CAAC,EACrCC,aAAa,EACbC,eAAe,KAIb,EAAE;EACJ,OAAO,CAACrB,KAAK,EAAEsB,KAAK,KAAI;IACtB,IAAItB,KAAK,KAAK,IAAI,IAAIA,KAAK,KAAKU,SAAS,EAAE;MACzC,OAAOhB,WAAW;;IAEpB,IAAI,OAAOM,KAAK,KAAK,SAAS,EAAE;MAC9B,OAAOA,KAAK,GAAGL,WAAW,GAAGF,YAAY;;IAE3C,IAAI6B,KAAK,KAAK9B,eAAe,CAAC+B,OAAO,EAAE;MACrC,IAAI;QACF,OAAOC,IAAI,CAACC,KAAK,CAACC,MAAM,CAAC1B,KAAK,CAAC,CAAC2B,WAAW,EAAE,CAAC;QAC1ChC,WAAW;QACXF,YAAY;;MAChB,MAAM;QACN,OAAOA,YAAY;;;IAGvB,IAAI,OAAOO,KAAK,KAAK,QAAQ,EAAE;MAC7B,OAAOA,KAAK;;IAEd,IAAIoB,aAAa,IAAIE,KAAK,KAAK9B,eAAe,CAACoC,QAAQ,EAAE;MACvD,OAAOR,aAAa,CAACpB,KAAK,CAAC;;IAE7B,IACEqB,eAAe;IACf,OAAOrB,KAAK,KAAK,QAAQ;IACzBsB,KAAK,KAAK9B,eAAe,CAACqC,OAAO,EACjC;MACA,OAAOR,eAAe,CAACrB,KAAK,CAAC;;IAE/B,OAAO0B,MAAM,CAAC1B,KAAK,CAAC;EACtB,CAAC;AACH,CAAC,mBAAA8B,cAAA,UAAAC,oBAAA,mBAAAA,oBAAA,CAAAC,OAAA,GAAAtB,SAAA,MAAAoB,cAAA,WAAAA,cAAA,CAAAG,QAAA,CAnGYnC,sBAAsB,2GAAAgC,cAAA,CAAAG,QAAA,CA4BtBlB,qBAAqB,0GAAAe,cAAA,CAAAG,QAAA,CAiClBd,sBAAsB,mIAAAe,WAAA,UAAAH,oBAAA,mBAAAA,oBAAA,CAAAG,WAAA,GAAAxB,SAAA,CAAAwB,WAAA,IAAAA,WAAA,CAAAC,MAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}