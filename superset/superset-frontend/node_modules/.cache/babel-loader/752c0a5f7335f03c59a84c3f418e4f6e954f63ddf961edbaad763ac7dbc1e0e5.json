{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState, useMemo, useEffect, useRef, useCallback } from 'react';\nimport { styled, SupersetClient, t } from '@superset-ui/core';\nimport rison from 'rison';\nimport { AsyncSelect, Select } from 'src/components';\nimport Label from 'src/components/Label';\nimport { FormLabel } from 'src/components/Form';\nimport RefreshLabel from 'src/components/RefreshLabel';\nimport { useToasts } from 'src/components/MessageToasts/withToasts';\nimport { useCatalogs, useSchemas } from 'src/hooks/apiResources';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nconst DatabaseSelectorWrapper = styled.div`\n  ${({ theme }) => `\n    .refresh {\n      display: flex;\n      align-items: center;\n      width: 30px;\n      margin-left: ${theme.gridUnit}px;\n      margin-top: ${theme.gridUnit * 5}px;\n    }\n\n    .section {\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n    }\n\n    .select {\n      width: calc(100% - 30px - ${theme.gridUnit}px);\n      flex: 1;\n    }\n\n    & > div {\n      margin-bottom: ${theme.gridUnit * 4}px;\n    }\n  `}\n`;\nconst LabelStyle = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  margin-left: ${({ theme }) => theme.gridUnit - 2}px;\n\n  .backend {\n    overflow: visible;\n  }\n\n  .name {\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n`;\nconst SelectLabel = ({ backend, databaseName }) => ___EmotionJSX(LabelStyle, null,\n___EmotionJSX(Label, { className: \"backend\" }, backend || ''),\n___EmotionJSX(\"span\", { className: \"name\", title: databaseName },\ndatabaseName\n)\n);\nconst EMPTY_CATALOG_OPTIONS = [];\nconst EMPTY_SCHEMA_OPTIONS = [];\nexport default function DatabaseSelector({ db, formMode = false, emptyState, getDbList, handleError, isDatabaseSelectEnabled = true, onDbChange, onEmptyResults, onCatalogChange, catalog, onSchemaChange, schema, readOnly = false, sqlLabMode = false }) {\n  const showCatalogSelector = !!(db != null && db.allow_multi_catalog);\n  const [currentDb, setCurrentDb] = useState();\n  const [currentCatalog, setCurrentCatalog] = useState(catalog ? { label: catalog, value: catalog, title: catalog } : undefined);\n  const catalogRef = useRef(catalog);\n  catalogRef.current = catalog;\n  const [currentSchema, setCurrentSchema] = useState(schema ? { label: schema, value: schema, title: schema } : undefined);\n  const schemaRef = useRef(schema);\n  schemaRef.current = schema;\n  const { addSuccessToast } = useToasts();\n  const sortComparator = useCallback((itemA, itemB) => itemA.order - itemB.order, []);\n  const loadDatabases = useMemo(() => async (search, page, pageSize) => {\n    const queryParams = rison.encode({\n      order_column: 'database_name',\n      order_direction: 'asc',\n      page,\n      page_size: pageSize,\n      ...(formMode || !sqlLabMode ?\n      { filters: [{ col: 'database_name', opr: 'ct', value: search }] } :\n      {\n        filters: [\n        { col: 'database_name', opr: 'ct', value: search },\n        {\n          col: 'expose_in_sqllab',\n          opr: 'eq',\n          value: true\n        }]\n\n      })\n    });\n    const endpoint = `/api/v1/database/?q=${queryParams}`;\n    return SupersetClient.get({ endpoint }).then(({ json }) => {\n      const { result, count } = json;\n      if (getDbList) {\n        getDbList(result);\n      }\n      if (result.length === 0) {\n        if (onEmptyResults)\n        onEmptyResults(search);\n      }\n      const options = result.map((row, order) => ({\n        label: ___EmotionJSX(SelectLabel, { backend: row.backend, databaseName: row.database_name }),\n        value: row.id,\n        id: row.id,\n        database_name: row.database_name,\n        backend: row.backend,\n        allow_multi_catalog: row.allow_multi_catalog,\n        order\n      }));\n      return {\n        data: options,\n        totalCount: count != null ? count : options.length\n      };\n    });\n  }, [formMode, getDbList, sqlLabMode, onEmptyResults]);\n  useEffect(() => {\n    setCurrentDb((current) => (current == null ? void 0 : current.id) !== (db == null ? void 0 : db.id) ?\n    db ?\n    {\n      label: ___EmotionJSX(SelectLabel, { backend: db.backend, databaseName: db.database_name }),\n      value: db.id,\n      ...db\n    } :\n    undefined :\n    current);\n  }, [db]);\n  function changeSchema(schema) {\n    setCurrentSchema(schema);\n    if (onSchemaChange && (schema == null ? void 0 : schema.value) !== schemaRef.current) {\n      onSchemaChange(schema == null ? void 0 : schema.value);\n    }\n  }\n  const { data: schemaData, isFetching: loadingSchemas, refetch: refetchSchemas } = useSchemas({\n    dbId: currentDb == null ? void 0 : currentDb.value,\n    catalog: currentCatalog == null ? void 0 : currentCatalog.value,\n    onSuccess: (schemas, isFetched) => {\n      if (schemas.length === 1) {\n        changeSchema(schemas[0]);\n      } else\n      if (!schemas.find((schemaOption) => schemaRef.current === schemaOption.value)) {\n        changeSchema(undefined);\n      }\n      if (isFetched) {\n        addSuccessToast('List refreshed');\n      }\n    },\n    onError: () => handleError(t('There was an error loading the schemas'))\n  });\n  const schemaOptions = schemaData || EMPTY_SCHEMA_OPTIONS;\n  function changeCatalog(catalog) {\n    setCurrentCatalog(catalog);\n    setCurrentSchema(undefined);\n    if (onCatalogChange && (catalog == null ? void 0 : catalog.value) !== catalogRef.current) {\n      onCatalogChange(catalog == null ? void 0 : catalog.value);\n    }\n  }\n  const { data: catalogData, isFetching: loadingCatalogs, refetch: refetchCatalogs } = useCatalogs({\n    dbId: showCatalogSelector ? currentDb == null ? void 0 : currentDb.value : undefined,\n    onSuccess: (catalogs, isFetched) => {\n      if (!showCatalogSelector) {\n        changeCatalog(null);\n      } else\n      if (catalogs.length === 1) {\n        changeCatalog(catalogs[0]);\n      } else\n      if (!catalogs.find((catalogOption) => catalogRef.current === catalogOption.value)) {\n        changeCatalog(undefined);\n      }\n      if (showCatalogSelector && isFetched) {\n        addSuccessToast('List refreshed');\n      }\n    },\n    onError: () => {\n      if (showCatalogSelector) {\n        handleError(t('There was an error loading the catalogs'));\n      }\n    }\n  });\n  const catalogOptions = catalogData || EMPTY_CATALOG_OPTIONS;\n  function changeDatabase(value, database) {\n    setCurrentDb(database);\n    setCurrentCatalog(undefined);\n    setCurrentSchema(undefined);\n    if (onDbChange) {\n      onDbChange(database);\n    }\n    if (onCatalogChange) {\n      onCatalogChange(undefined);\n    }\n    if (onSchemaChange) {\n      onSchemaChange(undefined);\n    }\n  }\n  function renderSelectRow(select, refreshBtn) {\n    return ___EmotionJSX(\"div\", { className: \"section\" },\n    ___EmotionJSX(\"span\", { className: \"select\" }, select),\n    ___EmotionJSX(\"span\", { className: \"refresh\" }, refreshBtn)\n    );\n  }\n  function renderDatabaseSelect() {\n    return renderSelectRow(___EmotionJSX(AsyncSelect, { ariaLabel: t('Select database or type to search databases'), optionFilterProps: ['database_name', 'value'], \"data-test\": \"select-database\", header: ___EmotionJSX(FormLabel, null, t('Database')), lazyLoading: false, notFoundContent: emptyState, onChange: changeDatabase, value: currentDb, placeholder: t('Select database or type to search databases'), disabled: !isDatabaseSelectEnabled || readOnly, options: loadDatabases, sortComparator: sortComparator }), null);\n  }\n  function renderCatalogSelect() {\n    const refreshIcon = !readOnly && ___EmotionJSX(RefreshLabel, { onClick: refetchCatalogs, tooltipContent: t('Force refresh catalog list') });\n    return renderSelectRow(___EmotionJSX(Select, { ariaLabel: t('Select catalog or type to search catalogs'), disabled: !currentDb || readOnly, header: ___EmotionJSX(FormLabel, null, t('Catalog')), labelInValue: true, loading: loadingCatalogs, name: \"select-catalog\", notFoundContent: t('No compatible catalog found'), placeholder: t('Select catalog or type to search catalogs'), onChange: (item) => changeCatalog(item), options: catalogOptions, showSearch: true, value: currentCatalog || undefined }), refreshIcon);\n  }\n  function renderSchemaSelect() {\n    const refreshIcon = !readOnly && ___EmotionJSX(RefreshLabel, { onClick: refetchSchemas, tooltipContent: t('Force refresh schema list') });\n    return renderSelectRow(___EmotionJSX(Select, { ariaLabel: t('Select schema or type to search schemas'), disabled: !currentDb || readOnly, header: ___EmotionJSX(FormLabel, null, t('Schema')), labelInValue: true, loading: loadingSchemas, name: \"select-schema\", notFoundContent: t('No compatible schema found'), placeholder: t('Select schema or type to search schemas'), onChange: (item) => changeSchema(item), options: schemaOptions, showSearch: true, value: currentSchema }), refreshIcon);\n  }\n  return ___EmotionJSX(DatabaseSelectorWrapper, { \"data-test\": \"DatabaseSelector\" },\n  renderDatabaseSelect(),\n  showCatalogSelector && renderCatalogSelect(),\n  renderSchemaSelect()\n  );\n}__signature__(DatabaseSelector, \"useState{[currentDb, setCurrentDb]}\\nuseState{[currentCatalog, setCurrentCatalog](catalog ? { label: catalog, value: catalog, title: catalog } : undefined)}\\nuseRef{catalogRef}\\nuseState{[currentSchema, setCurrentSchema](schema ? { label: schema, value: schema, title: schema } : undefined)}\\nuseRef{schemaRef}\\nuseToasts{{ addSuccessToast }}\\nuseCallback{sortComparator}\\nuseMemo{loadDatabases}\\nuseEffect{}\\nuseSchemas{{ data: schemaData, isFetching: loadingSchemas, refetch: refetchSchemas, }}\\nuseCatalogs{{ data: catalogData, isFetching: loadingCatalogs, refetch: refetchCatalogs, }}\", () => [useToasts, useSchemas, useCatalogs]);;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(DatabaseSelectorWrapper, \"DatabaseSelectorWrapper\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/components/DatabaseSelector/index.tsx\");reactHotLoader.register(LabelStyle, \"LabelStyle\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/components/DatabaseSelector/index.tsx\");reactHotLoader.register(SelectLabel, \"SelectLabel\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/components/DatabaseSelector/index.tsx\");reactHotLoader.register(EMPTY_CATALOG_OPTIONS, \"EMPTY_CATALOG_OPTIONS\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/components/DatabaseSelector/index.tsx\");reactHotLoader.register(EMPTY_SCHEMA_OPTIONS, \"EMPTY_SCHEMA_OPTIONS\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/components/DatabaseSelector/index.tsx\");reactHotLoader.register(DatabaseSelector, \"DatabaseSelector\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/components/DatabaseSelector/index.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["React","useState","useMemo","useEffect","useRef","useCallback","styled","SupersetClient","t","rison","AsyncSelect","Select","Label","FormLabel","RefreshLabel","useToasts","useCatalogs","useSchemas","jsx","___EmotionJSX","DatabaseSelectorWrapper","div","theme","gridUnit","LabelStyle","SelectLabel","backend","databaseName","className","title","EMPTY_CATALOG_OPTIONS","EMPTY_SCHEMA_OPTIONS","DatabaseSelector","db","formMode","emptyState","getDbList","handleError","isDatabaseSelectEnabled","onDbChange","onEmptyResults","onCatalogChange","catalog","onSchemaChange","schema","readOnly","sqlLabMode","showCatalogSelector","allow_multi_catalog","currentDb","setCurrentDb","currentCatalog","setCurrentCatalog","label","value","undefined","catalogRef","current","currentSchema","setCurrentSchema","schemaRef","addSuccessToast","sortComparator","itemA","itemB","order","loadDatabases","search","page","pageSize","queryParams","encode","order_column","order_direction","page_size","filters","col","opr","endpoint","get","then","json","result","count","length","options","map","row","database_name","id","data","totalCount","changeSchema","schemaData","isFetching","loadingSchemas","refetch","refetchSchemas","dbId","onSuccess","schemas","isFetched","find","schemaOption","onError","schemaOptions","changeCatalog","catalogData","loadingCatalogs","refetchCatalogs","catalogs","catalogOption","catalogOptions","changeDatabase","database","renderSelectRow","select","refreshBtn","renderDatabaseSelect","ariaLabel","optionFilterProps","header","lazyLoading","notFoundContent","onChange","placeholder","disabled","renderCatalogSelect","refreshIcon","onClick","tooltipContent","labelInValue","loading","name","item","showSearch","renderSchemaSelect","__signature__","reactHotLoader","reactHotLoaderGlobal","default","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/src/components/DatabaseSelector/index.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, {\n  ReactNode,\n  useState,\n  useMemo,\n  useEffect,\n  useRef,\n  useCallback,\n} from 'react';\nimport { styled, SupersetClient, t } from '@superset-ui/core';\nimport type { LabeledValue as AntdLabeledValue } from 'antd/lib/select';\nimport rison from 'rison';\nimport { AsyncSelect, Select } from 'src/components';\nimport Label from 'src/components/Label';\nimport { FormLabel } from 'src/components/Form';\nimport RefreshLabel from 'src/components/RefreshLabel';\nimport { useToasts } from 'src/components/MessageToasts/withToasts';\nimport {\n  useCatalogs,\n  CatalogOption,\n  useSchemas,\n  SchemaOption,\n} from 'src/hooks/apiResources';\n\nconst DatabaseSelectorWrapper = styled.div`\n  ${({ theme }) => `\n    .refresh {\n      display: flex;\n      align-items: center;\n      width: 30px;\n      margin-left: ${theme.gridUnit}px;\n      margin-top: ${theme.gridUnit * 5}px;\n    }\n\n    .section {\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n    }\n\n    .select {\n      width: calc(100% - 30px - ${theme.gridUnit}px);\n      flex: 1;\n    }\n\n    & > div {\n      margin-bottom: ${theme.gridUnit * 4}px;\n    }\n  `}\n`;\n\nconst LabelStyle = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  margin-left: ${({ theme }) => theme.gridUnit - 2}px;\n\n  .backend {\n    overflow: visible;\n  }\n\n  .name {\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n`;\n\ntype DatabaseValue = {\n  label: React.ReactNode;\n  value: number;\n  id: number;\n  database_name: string;\n  backend?: string;\n};\n\nexport type DatabaseObject = {\n  id: number;\n  database_name: string;\n  backend?: string;\n  allow_multi_catalog?: boolean;\n};\n\nexport interface DatabaseSelectorProps {\n  db?: DatabaseObject | null;\n  emptyState?: ReactNode;\n  formMode?: boolean;\n  getDbList?: (arg0: any) => void;\n  handleError: (msg: string) => void;\n  isDatabaseSelectEnabled?: boolean;\n  onDbChange?: (db: DatabaseObject) => void;\n  onEmptyResults?: (searchText?: string) => void;\n  onCatalogChange?: (catalog?: string) => void;\n  catalog?: string | null;\n  onSchemaChange?: (schema?: string) => void;\n  schema?: string;\n  readOnly?: boolean;\n  sqlLabMode?: boolean;\n}\n\nconst SelectLabel = ({\n  backend,\n  databaseName,\n}: {\n  backend?: string;\n  databaseName: string;\n}) => (\n  <LabelStyle>\n    <Label className=\"backend\">{backend || ''}</Label>\n    <span className=\"name\" title={databaseName}>\n      {databaseName}\n    </span>\n  </LabelStyle>\n);\n\nconst EMPTY_CATALOG_OPTIONS: CatalogOption[] = [];\nconst EMPTY_SCHEMA_OPTIONS: SchemaOption[] = [];\n\ninterface AntdLabeledValueWithOrder extends AntdLabeledValue {\n  order: number;\n}\n\nexport default function DatabaseSelector({\n  db,\n  formMode = false,\n  emptyState,\n  getDbList,\n  handleError,\n  isDatabaseSelectEnabled = true,\n  onDbChange,\n  onEmptyResults,\n  onCatalogChange,\n  catalog,\n  onSchemaChange,\n  schema,\n  readOnly = false,\n  sqlLabMode = false,\n}: DatabaseSelectorProps) {\n  const showCatalogSelector = !!db?.allow_multi_catalog;\n  const [currentDb, setCurrentDb] = useState<DatabaseValue | undefined>();\n  const [currentCatalog, setCurrentCatalog] = useState<\n    CatalogOption | null | undefined\n  >(catalog ? { label: catalog, value: catalog, title: catalog } : undefined);\n  const catalogRef = useRef(catalog);\n  catalogRef.current = catalog;\n  const [currentSchema, setCurrentSchema] = useState<SchemaOption | undefined>(\n    schema ? { label: schema, value: schema, title: schema } : undefined,\n  );\n  const schemaRef = useRef(schema);\n  schemaRef.current = schema;\n  const { addSuccessToast } = useToasts();\n  const sortComparator = useCallback(\n    (itemA: AntdLabeledValueWithOrder, itemB: AntdLabeledValueWithOrder) =>\n      itemA.order - itemB.order,\n    [],\n  );\n\n  const loadDatabases = useMemo(\n    () =>\n      async (\n        search: string,\n        page: number,\n        pageSize: number,\n      ): Promise<{\n        data: DatabaseValue[];\n        totalCount: number;\n      }> => {\n        const queryParams = rison.encode({\n          order_column: 'database_name',\n          order_direction: 'asc',\n          page,\n          page_size: pageSize,\n          ...(formMode || !sqlLabMode\n            ? { filters: [{ col: 'database_name', opr: 'ct', value: search }] }\n            : {\n                filters: [\n                  { col: 'database_name', opr: 'ct', value: search },\n                  {\n                    col: 'expose_in_sqllab',\n                    opr: 'eq',\n                    value: true,\n                  },\n                ],\n              }),\n        });\n        const endpoint = `/api/v1/database/?q=${queryParams}`;\n        return SupersetClient.get({ endpoint }).then(({ json }) => {\n          const { result, count } = json;\n          if (getDbList) {\n            getDbList(result);\n          }\n          if (result.length === 0) {\n            if (onEmptyResults) onEmptyResults(search);\n          }\n\n          const options = result.map((row: DatabaseObject, order: number) => ({\n            label: (\n              <SelectLabel\n                backend={row.backend}\n                databaseName={row.database_name}\n              />\n            ),\n            value: row.id,\n            id: row.id,\n            database_name: row.database_name,\n            backend: row.backend,\n            allow_multi_catalog: row.allow_multi_catalog,\n            order,\n          }));\n\n          return {\n            data: options,\n            totalCount: count ?? options.length,\n          };\n        });\n      },\n    [formMode, getDbList, sqlLabMode, onEmptyResults],\n  );\n\n  useEffect(() => {\n    setCurrentDb(current =>\n      current?.id !== db?.id\n        ? db\n          ? {\n              label: (\n                <SelectLabel\n                  backend={db.backend}\n                  databaseName={db.database_name}\n                />\n              ),\n              value: db.id,\n              ...db,\n            }\n          : undefined\n        : current,\n    );\n  }, [db]);\n\n  function changeSchema(schema: SchemaOption | undefined) {\n    setCurrentSchema(schema);\n    if (onSchemaChange && schema?.value !== schemaRef.current) {\n      onSchemaChange(schema?.value);\n    }\n  }\n\n  const {\n    data: schemaData,\n    isFetching: loadingSchemas,\n    refetch: refetchSchemas,\n  } = useSchemas({\n    dbId: currentDb?.value,\n    catalog: currentCatalog?.value,\n    onSuccess: (schemas, isFetched) => {\n      if (schemas.length === 1) {\n        changeSchema(schemas[0]);\n      } else if (\n        !schemas.find(schemaOption => schemaRef.current === schemaOption.value)\n      ) {\n        changeSchema(undefined);\n      }\n\n      if (isFetched) {\n        addSuccessToast('List refreshed');\n      }\n    },\n    onError: () => handleError(t('There was an error loading the schemas')),\n  });\n\n  const schemaOptions = schemaData || EMPTY_SCHEMA_OPTIONS;\n\n  function changeCatalog(catalog: CatalogOption | null | undefined) {\n    setCurrentCatalog(catalog);\n    setCurrentSchema(undefined);\n    if (onCatalogChange && catalog?.value !== catalogRef.current) {\n      onCatalogChange(catalog?.value);\n    }\n  }\n\n  const {\n    data: catalogData,\n    isFetching: loadingCatalogs,\n    refetch: refetchCatalogs,\n  } = useCatalogs({\n    dbId: showCatalogSelector ? currentDb?.value : undefined,\n    onSuccess: (catalogs, isFetched) => {\n      if (!showCatalogSelector) {\n        changeCatalog(null);\n      } else if (catalogs.length === 1) {\n        changeCatalog(catalogs[0]);\n      } else if (\n        !catalogs.find(\n          catalogOption => catalogRef.current === catalogOption.value,\n        )\n      ) {\n        changeCatalog(undefined);\n      }\n\n      if (showCatalogSelector && isFetched) {\n        addSuccessToast('List refreshed');\n      }\n    },\n    onError: () => {\n      if (showCatalogSelector) {\n        handleError(t('There was an error loading the catalogs'));\n      }\n    },\n  });\n\n  const catalogOptions = catalogData || EMPTY_CATALOG_OPTIONS;\n\n  function changeDatabase(\n    value: { label: string; value: number },\n    database: DatabaseValue,\n  ) {\n    setCurrentDb(database);\n    setCurrentCatalog(undefined);\n    setCurrentSchema(undefined);\n    if (onDbChange) {\n      onDbChange(database);\n    }\n    if (onCatalogChange) {\n      onCatalogChange(undefined);\n    }\n    if (onSchemaChange) {\n      onSchemaChange(undefined);\n    }\n  }\n\n  function renderSelectRow(select: ReactNode, refreshBtn: ReactNode) {\n    return (\n      <div className=\"section\">\n        <span className=\"select\">{select}</span>\n        <span className=\"refresh\">{refreshBtn}</span>\n      </div>\n    );\n  }\n\n  function renderDatabaseSelect() {\n    return renderSelectRow(\n      <AsyncSelect\n        ariaLabel={t('Select database or type to search databases')}\n        optionFilterProps={['database_name', 'value']}\n        data-test=\"select-database\"\n        header={<FormLabel>{t('Database')}</FormLabel>}\n        lazyLoading={false}\n        notFoundContent={emptyState}\n        onChange={changeDatabase}\n        value={currentDb}\n        placeholder={t('Select database or type to search databases')}\n        disabled={!isDatabaseSelectEnabled || readOnly}\n        options={loadDatabases}\n        sortComparator={sortComparator}\n      />,\n      null,\n    );\n  }\n\n  function renderCatalogSelect() {\n    const refreshIcon = !readOnly && (\n      <RefreshLabel\n        onClick={refetchCatalogs}\n        tooltipContent={t('Force refresh catalog list')}\n      />\n    );\n    return renderSelectRow(\n      <Select\n        ariaLabel={t('Select catalog or type to search catalogs')}\n        disabled={!currentDb || readOnly}\n        header={<FormLabel>{t('Catalog')}</FormLabel>}\n        labelInValue\n        loading={loadingCatalogs}\n        name=\"select-catalog\"\n        notFoundContent={t('No compatible catalog found')}\n        placeholder={t('Select catalog or type to search catalogs')}\n        onChange={item => changeCatalog(item as CatalogOption)}\n        options={catalogOptions}\n        showSearch\n        value={currentCatalog || undefined}\n      />,\n      refreshIcon,\n    );\n  }\n\n  function renderSchemaSelect() {\n    const refreshIcon = !readOnly && (\n      <RefreshLabel\n        onClick={refetchSchemas}\n        tooltipContent={t('Force refresh schema list')}\n      />\n    );\n    return renderSelectRow(\n      <Select\n        ariaLabel={t('Select schema or type to search schemas')}\n        disabled={!currentDb || readOnly}\n        header={<FormLabel>{t('Schema')}</FormLabel>}\n        labelInValue\n        loading={loadingSchemas}\n        name=\"select-schema\"\n        notFoundContent={t('No compatible schema found')}\n        placeholder={t('Select schema or type to search schemas')}\n        onChange={item => changeSchema(item as SchemaOption)}\n        options={schemaOptions}\n        showSearch\n        value={currentSchema}\n      />,\n      refreshIcon,\n    );\n  }\n\n  return (\n    <DatabaseSelectorWrapper data-test=\"DatabaseSelector\">\n      {renderDatabaseSelect()}\n      {showCatalogSelector && renderCatalogSelect()}\n      {renderSchemaSelect()}\n    </DatabaseSelectorWrapper>\n  );\n}\n"],"mappings":"wSAAA;;;;;;;;;;;;;;;;;;AAkBA,OAAOA,KAAK,IAEVC,QAAQ,EACRC,OAAO,EACPC,SAAS,EACTC,MAAM,EACNC,WAAW,QACN,OAAO;AACd,SAASC,MAAM,EAAEC,cAAc,EAAEC,CAAC,QAAQ,mBAAmB;AAE7D,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,WAAW,EAAEC,MAAM,QAAQ,gBAAgB;AACpD,OAAOC,KAAK,MAAM,sBAAsB;AACxC,SAASC,SAAS,QAAQ,qBAAqB;AAC/C,OAAOC,YAAY,MAAM,6BAA6B;AACtD,SAASC,SAAS,QAAQ,yCAAyC;AACnE,SACEC,WAAW,EAEXC,UAAU,QAEL,wBAAwB,CAAC,SAAAC,GAAA,IAAAC,aAAA;AAEhC,MAAMC,uBAAuB,GAAGd,MAAM,CAACe,GAAG;IACtC,CAAC,EAAEC,KAAK,EAAE,KAAK;;;;;qBAKEA,KAAK,CAACC,QAAQ;oBACfD,KAAK,CAACC,QAAQ,GAAG,CAAC;;;;;;;;;;kCAUJD,KAAK,CAACC,QAAQ;;;;;uBAKzBD,KAAK,CAACC,QAAQ,GAAG,CAAC;;GAEtC;CACF;AAED,MAAMC,UAAU,GAAGlB,MAAM,CAACe,GAAG;;;;iBAIZ,CAAC,EAAEC,KAAK,EAAE,KAAKA,KAAK,CAACC,QAAQ,GAAG,CAAC;;;;;;;;;;CAUjD;AAkCD,MAAME,WAAW,GAAGA,CAAC,EACnBC,OAAO,EACPC,YAAY,EAIb,KACCR,aAAA,CAACK,UAAU;AACTL,aAAA,CAACP,KAAK,IAACgB,SAAS,EAAC,SAAS,IAAEF,OAAO,IAAI,EAAU,CACjD;AAAAP,aAAA,WAAMS,SAAS,EAAC,MAAM,EAACC,KAAK,EAAEF,YAAa;AACxCA;AACG;AACI,CACb;AAED,MAAMG,qBAAqB,GAAoB,EAAE;AACjD,MAAMC,oBAAoB,GAAmB,EAAE;AAM/C,eAAc,SAAUC,gBAAgBA,CAAC,EACvCC,EAAE,EACFC,QAAQ,GAAG,KAAK,EAChBC,UAAU,EACVC,SAAS,EACTC,WAAW,EACXC,uBAAuB,GAAG,IAAI,EAC9BC,UAAU,EACVC,cAAc,EACdC,eAAe,EACfC,OAAO,EACPC,cAAc,EACdC,MAAM,EACNC,QAAQ,GAAG,KAAK,EAChBC,UAAU,GAAG,KAAK,EACI;EACtB,MAAMC,mBAAmB,GAAG,CAAC,EAACd,EAAE,YAAFA,EAAE,CAAEe,mBAAmB;EACrD,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGjD,QAAQ,EAA6B;EACvE,MAAM,CAACkD,cAAc,EAAEC,iBAAiB,CAAC,GAAGnD,QAAQ,CAElDyC,OAAO,GAAG,EAAEW,KAAK,EAAEX,OAAO,EAAEY,KAAK,EAAEZ,OAAO,EAAEb,KAAK,EAAEa,OAAO,EAAE,GAAGa,SAAS,CAAC;EAC3E,MAAMC,UAAU,GAAGpD,MAAM,CAACsC,OAAO,CAAC;EAClCc,UAAU,CAACC,OAAO,GAAGf,OAAO;EAC5B,MAAM,CAACgB,aAAa,EAAEC,gBAAgB,CAAC,GAAG1D,QAAQ,CAChD2C,MAAM,GAAG,EAAES,KAAK,EAAET,MAAM,EAAEU,KAAK,EAAEV,MAAM,EAAEf,KAAK,EAAEe,MAAM,EAAE,GAAGW,SAAS,CACrE;EACD,MAAMK,SAAS,GAAGxD,MAAM,CAACwC,MAAM,CAAC;EAChCgB,SAAS,CAACH,OAAO,GAAGb,MAAM;EAC1B,MAAM,EAAEiB,eAAe,EAAE,GAAG9C,SAAS,EAAE;EACvC,MAAM+C,cAAc,GAAGzD,WAAW,CAChC,CAAC0D,KAAgC,EAAEC,KAAgC,KACjED,KAAK,CAACE,KAAK,GAAGD,KAAK,CAACC,KAAK,EAC3B,EAAE,CACH;EAED,MAAMC,aAAa,GAAGhE,OAAO,CAC3B,MACE,OACEiE,MAAc,EACdC,IAAY,EACZC,QAAgB,KAIb;IACH,MAAMC,WAAW,GAAG7D,KAAK,CAAC8D,MAAM,CAAC;MAC/BC,YAAY,EAAE,eAAe;MAC7BC,eAAe,EAAE,KAAK;MACtBL,IAAI;MACJM,SAAS,EAAEL,QAAQ;MACnB,IAAInC,QAAQ,IAAI,CAACY,UAAU;MACvB,EAAE6B,OAAO,EAAE,CAAC,EAAEC,GAAG,EAAE,eAAe,EAAEC,GAAG,EAAE,IAAI,EAAEvB,KAAK,EAAEa,MAAM,EAAE,CAAC,EAAE;MACjE;QACEQ,OAAO,EAAE;QACP,EAAEC,GAAG,EAAE,eAAe,EAAEC,GAAG,EAAE,IAAI,EAAEvB,KAAK,EAAEa,MAAM,EAAE;QAClD;UACES,GAAG,EAAE,kBAAkB;UACvBC,GAAG,EAAE,IAAI;UACTvB,KAAK,EAAE;SACR;;OAEJ;KACN,CAAC;IACF,MAAMwB,QAAQ,GAAG,uBAAuBR,WAAW,EAAE;IACrD,OAAO/D,cAAc,CAACwE,GAAG,CAAC,EAAED,QAAQ,EAAE,CAAC,CAACE,IAAI,CAAC,CAAC,EAAEC,IAAI,EAAE,KAAI;MACxD,MAAM,EAAEC,MAAM,EAAEC,KAAK,EAAE,GAAGF,IAAI;MAC9B,IAAI7C,SAAS,EAAE;QACbA,SAAS,CAAC8C,MAAM,CAAC;;MAEnB,IAAIA,MAAM,CAACE,MAAM,KAAK,CAAC,EAAE;QACvB,IAAI5C,cAAc;QAAEA,cAAc,CAAC2B,MAAM,CAAC;;MAG5C,MAAMkB,OAAO,GAAGH,MAAM,CAACI,GAAG,CAAC,CAACC,GAAmB,EAAEtB,KAAa,MAAM;QAClEZ,KAAK,EACHlC,aAAA,CAACM,WAAW,IACVC,OAAO,EAAE6D,GAAG,CAAC7D,OAAQ,EACrBC,YAAY,EAAE4D,GAAG,CAACC,aAAc,GAEnC;QACDlC,KAAK,EAAEiC,GAAG,CAACE,EAAE;QACbA,EAAE,EAAEF,GAAG,CAACE,EAAE;QACVD,aAAa,EAAED,GAAG,CAACC,aAAa;QAChC9D,OAAO,EAAE6D,GAAG,CAAC7D,OAAO;QACpBsB,mBAAmB,EAAEuC,GAAG,CAACvC,mBAAmB;QAC5CiB;OACD,CAAC,CAAC;MAEH,OAAO;QACLyB,IAAI,EAAEL,OAAO;QACbM,UAAU,EAAER,KAAK,WAALA,KAAK,GAAIE,OAAO,CAACD;OAC9B;IACH,CAAC,CAAC;EACJ,CAAC,EACH,CAAClD,QAAQ,EAAEE,SAAS,EAAEU,UAAU,EAAEN,cAAc,CAAC,CAClD;EAEDrC,SAAS,CAAC,MAAK;IACb+C,YAAY,CAAC,CAAAO,OAAO,KAClB,CAAAA,OAAO,oBAAPA,OAAO,CAAEgC,EAAE,OAAKxD,EAAE,oBAAFA,EAAE,CAAEwD,EAAE;IAClBxD,EAAE;IACA;MACEoB,KAAK,EACHlC,aAAA,CAACM,WAAW,IACVC,OAAO,EAAEO,EAAE,CAACP,OAAQ,EACpBC,YAAY,EAAEM,EAAE,CAACuD,aAAc,GAElC;MACDlC,KAAK,EAAErB,EAAE,CAACwD,EAAE;MACZ,GAAGxD;KACJ;IACDsB,SAAS;IACXE,OAAO,CACZ;EACH,CAAC,EAAE,CAACxB,EAAE,CAAC,CAAC;EAER,SAAS2D,YAAYA,CAAChD,MAAgC;IACpDe,gBAAgB,CAACf,MAAM,CAAC;IACxB,IAAID,cAAc,IAAI,CAAAC,MAAM,oBAANA,MAAM,CAAEU,KAAK,MAAKM,SAAS,CAACH,OAAO,EAAE;MACzDd,cAAc,CAACC,MAAM,oBAANA,MAAM,CAAEU,KAAK,CAAC;;EAEjC;EAEA,MAAM,EACJoC,IAAI,EAAEG,UAAU,EAChBC,UAAU,EAAEC,cAAc,EAC1BC,OAAO,EAAEC,cAAc,EACxB,GAAGhF,UAAU,CAAC;IACbiF,IAAI,EAAEjD,SAAS,oBAATA,SAAS,CAAEK,KAAK;IACtBZ,OAAO,EAAES,cAAc,oBAAdA,cAAc,CAAEG,KAAK;IAC9B6C,SAAS,EAAEA,CAACC,OAAO,EAAEC,SAAS,KAAI;MAChC,IAAID,OAAO,CAAChB,MAAM,KAAK,CAAC,EAAE;QACxBQ,YAAY,CAACQ,OAAO,CAAC,CAAC,CAAC,CAAC;OACzB;MAAM,IACL,CAACA,OAAO,CAACE,IAAI,CAAC,CAAAC,YAAY,KAAI3C,SAAS,CAACH,OAAO,KAAK8C,YAAY,CAACjD,KAAK,CAAC,EACvE;QACAsC,YAAY,CAACrC,SAAS,CAAC;;MAGzB,IAAI8C,SAAS,EAAE;QACbxC,eAAe,CAAC,gBAAgB,CAAC;;IAErC,CAAC;IACD2C,OAAO,EAAEA,CAAA,KAAMnE,WAAW,CAAC7B,CAAC,CAAC,wCAAwC,CAAC;GACvE,CAAC;EAEF,MAAMiG,aAAa,GAAGZ,UAAU,IAAI9D,oBAAoB;EAExD,SAAS2E,aAAaA,CAAChE,OAAyC;IAC9DU,iBAAiB,CAACV,OAAO,CAAC;IAC1BiB,gBAAgB,CAACJ,SAAS,CAAC;IAC3B,IAAId,eAAe,IAAI,CAAAC,OAAO,oBAAPA,OAAO,CAAEY,KAAK,MAAKE,UAAU,CAACC,OAAO,EAAE;MAC5DhB,eAAe,CAACC,OAAO,oBAAPA,OAAO,CAAEY,KAAK,CAAC;;EAEnC;EAEA,MAAM,EACJoC,IAAI,EAAEiB,WAAW,EACjBb,UAAU,EAAEc,eAAe,EAC3BZ,OAAO,EAAEa,eAAe,EACzB,GAAG7F,WAAW,CAAC;IACdkF,IAAI,EAAEnD,mBAAmB,GAAGE,SAAS,oBAATA,SAAS,CAAEK,KAAK,GAAGC,SAAS;IACxD4C,SAAS,EAAEA,CAACW,QAAQ,EAAET,SAAS,KAAI;MACjC,IAAI,CAACtD,mBAAmB,EAAE;QACxB2D,aAAa,CAAC,IAAI,CAAC;OACpB;MAAM,IAAII,QAAQ,CAAC1B,MAAM,KAAK,CAAC,EAAE;QAChCsB,aAAa,CAACI,QAAQ,CAAC,CAAC,CAAC,CAAC;OAC3B;MAAM,IACL,CAACA,QAAQ,CAACR,IAAI,CACZ,CAAAS,aAAa,KAAIvD,UAAU,CAACC,OAAO,KAAKsD,aAAa,CAACzD,KAAK,CAC5D,EACD;QACAoD,aAAa,CAACnD,SAAS,CAAC;;MAG1B,IAAIR,mBAAmB,IAAIsD,SAAS,EAAE;QACpCxC,eAAe,CAAC,gBAAgB,CAAC;;IAErC,CAAC;IACD2C,OAAO,EAAEA,CAAA,KAAK;MACZ,IAAIzD,mBAAmB,EAAE;QACvBV,WAAW,CAAC7B,CAAC,CAAC,yCAAyC,CAAC,CAAC;;IAE7D;GACD,CAAC;EAEF,MAAMwG,cAAc,GAAGL,WAAW,IAAI7E,qBAAqB;EAE3D,SAASmF,cAAcA,CACrB3D,KAAuC,EACvC4D,QAAuB;IAEvBhE,YAAY,CAACgE,QAAQ,CAAC;IACtB9D,iBAAiB,CAACG,SAAS,CAAC;IAC5BI,gBAAgB,CAACJ,SAAS,CAAC;IAC3B,IAAIhB,UAAU,EAAE;MACdA,UAAU,CAAC2E,QAAQ,CAAC;;IAEtB,IAAIzE,eAAe,EAAE;MACnBA,eAAe,CAACc,SAAS,CAAC;;IAE5B,IAAIZ,cAAc,EAAE;MAClBA,cAAc,CAACY,SAAS,CAAC;;EAE7B;EAEA,SAAS4D,eAAeA,CAACC,MAAiB,EAAEC,UAAqB;IAC/D,OACElG,aAAA,UAAKS,SAAS,EAAC,SAAS;IACtBT,aAAA,WAAMS,SAAS,EAAC,QAAQ,IAAEwF,MAAa,CACvC;IAAAjG,aAAA,WAAMS,SAAS,EAAC,SAAS,IAAEyF,UAAiB;IACzC,CAAC;EAEV;EAEA,SAASC,oBAAoBA,CAAA;IAC3B,OAAOH,eAAe,CACpBhG,aAAA,CAACT,WAAW,IACV6G,SAAS,EAAE/G,CAAC,CAAC,6CAA6C,CAAE,EAC5DgH,iBAAiB,EAAE,CAAC,eAAe,EAAE,OAAO,CAAE,EAC9C,aAAU,iBAAiB,EAC3BC,MAAM,EAAEtG,aAAA,CAACN,SAAS,QAAEL,CAAC,CAAC,UAAU,CAAa,CAAE,EAC/CkH,WAAW,EAAE,KAAM,EACnBC,eAAe,EAAExF,UAAW,EAC5ByF,QAAQ,EAAEX,cAAe,EACzB3D,KAAK,EAAEL,SAAU,EACjB4E,WAAW,EAAErH,CAAC,CAAC,6CAA6C,CAAE,EAC9DsH,QAAQ,EAAE,CAACxF,uBAAuB,IAAIO,QAAS,EAC/CwC,OAAO,EAAEnB,aAAc,EACvBJ,cAAc,EAAEA,cAAe,GAC/B,EACF,IAAI,CACL;EACH;EAEA,SAASiE,mBAAmBA,CAAA;IAC1B,MAAMC,WAAW,GAAG,CAACnF,QAAQ,IAC3B1B,aAAA,CAACL,YAAY,IACXmH,OAAO,EAAEpB,eAAgB,EACzBqB,cAAc,EAAE1H,CAAC,CAAC,4BAA4B,CAAE,GAEnD;IACD,OAAO2G,eAAe,CACpBhG,aAAA,CAACR,MAAM,IACL4G,SAAS,EAAE/G,CAAC,CAAC,2CAA2C,CAAE,EAC1DsH,QAAQ,EAAE,CAAC7E,SAAS,IAAIJ,QAAS,EACjC4E,MAAM,EAAEtG,aAAA,CAACN,SAAS,QAAEL,CAAC,CAAC,SAAS,CAAa,CAAE,EAC9C2H,YAAY,QACZC,OAAO,EAAExB,eAAgB,EACzByB,IAAI,EAAC,gBAAgB,EACrBV,eAAe,EAAEnH,CAAC,CAAC,6BAA6B,CAAE,EAClDqH,WAAW,EAAErH,CAAC,CAAC,2CAA2C,CAAE,EAC5DoH,QAAQ,EAAEA,CAAAU,IAAI,KAAI5B,aAAa,CAAC4B,IAAqB,CAAE,EACvDjD,OAAO,EAAE2B,cAAe,EACxBuB,UAAU,QACVjF,KAAK,EAAEH,cAAc,IAAII,SAAU,GACnC,EACFyE,WAAW,CACZ;EACH;EAEA,SAASQ,kBAAkBA,CAAA;IACzB,MAAMR,WAAW,GAAG,CAACnF,QAAQ,IAC3B1B,aAAA,CAACL,YAAY,IACXmH,OAAO,EAAEhC,cAAe,EACxBiC,cAAc,EAAE1H,CAAC,CAAC,2BAA2B,CAAE,GAElD;IACD,OAAO2G,eAAe,CACpBhG,aAAA,CAACR,MAAM,IACL4G,SAAS,EAAE/G,CAAC,CAAC,yCAAyC,CAAE,EACxDsH,QAAQ,EAAE,CAAC7E,SAAS,IAAIJ,QAAS,EACjC4E,MAAM,EAAEtG,aAAA,CAACN,SAAS,QAAEL,CAAC,CAAC,QAAQ,CAAa,CAAE,EAC7C2H,YAAY,QACZC,OAAO,EAAErC,cAAe,EACxBsC,IAAI,EAAC,eAAe,EACpBV,eAAe,EAAEnH,CAAC,CAAC,4BAA4B,CAAE,EACjDqH,WAAW,EAAErH,CAAC,CAAC,yCAAyC,CAAE,EAC1DoH,QAAQ,EAAEA,CAAAU,IAAI,KAAI1C,YAAY,CAAC0C,IAAoB,CAAE,EACrDjD,OAAO,EAAEoB,aAAc,EACvB8B,UAAU,QACVjF,KAAK,EAAEI,aAAc,GACrB,EACFsE,WAAW,CACZ;EACH;EAEA,OACE7G,aAAA,CAACC,uBAAuB,IAAC,aAAU,kBAAkB;EAClDkG,oBAAoB,EAAE;EACtBvE,mBAAmB,IAAIgF,mBAAmB,EAAE;EAC5CS,kBAAkB;EACI,CAAC;AAE9B,CAACC,aAAA,CAtSuBzG,gBAAgB,ylBA4BVjB,SAAS,EAmGjCE,UAAU,EAiCVD,WAAW,sBAAA0H,cAAA,UAAAC,oBAAA,mBAAAA,oBAAA,CAAAC,OAAA,GAAArF,SAAA,MAAAmF,cAAA,WAAAA,cAAA,CAAAG,QAAA,CAjQXzH,uBAAuB,iIAAAsH,cAAA,CAAAG,QAAA,CA2BvBrH,UAAU,oHAAAkH,cAAA,CAAAG,QAAA,CAgDVpH,WAAW,qHAAAiH,cAAA,CAAAG,QAAA,CAeX/G,qBAAqB,+HAAA4G,cAAA,CAAAG,QAAA,CACrB9G,oBAAoB,8HAAA2G,cAAA,CAAAG,QAAA,CAMF7G,gBAAgB,kJAAA8G,WAAA,UAAAH,oBAAA,mBAAAA,oBAAA,CAAAG,WAAA,GAAAvF,SAAA,CAAAuF,WAAA,IAAAA,WAAA,CAAAC,MAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}