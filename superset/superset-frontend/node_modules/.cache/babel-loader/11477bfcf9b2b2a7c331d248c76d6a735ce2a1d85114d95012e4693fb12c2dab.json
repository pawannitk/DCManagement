{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useMemo } from 'react';\nimport rison from 'rison';\nimport { t, getClientErrorObject } from '@superset-ui/core';\nimport { AsyncSelect } from 'src/components';\nimport { cachedSupersetGet } from 'src/utils/cachedSupersetGet';\nimport { DatasetSelectLabel } from 'src/features/datasets/DatasetSelectLabel';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nconst DatasetSelect = ({ onChange, value }) => {\n  const getErrorMessage = useCallback(({ error, message }) => {\n    let errorText = message || error || t('An error has occurred');\n    if (message === 'Forbidden') {\n      errorText = t('You do not have permission to edit this dashboard');\n    }\n    return errorText;\n  }, []);\n  const loadDatasetOptions = async (search, page, pageSize) => {\n    const query = rison.encode({\n      columns: ['id', 'table_name', 'database.database_name', 'schema'],\n      filters: [{ col: 'table_name', opr: 'ct', value: search }],\n      page,\n      page_size: pageSize,\n      order_column: 'table_name',\n      order_direction: 'asc'\n    });\n    return cachedSupersetGet({\n      endpoint: `/api/v1/dataset/?q=${query}`\n    }).\n    then((response) => {\n      const list = response.json.result.map((item) => ({\n        customLabel: DatasetSelectLabel(item),\n        label: item.table_name,\n        value: item.id\n      }));\n      return {\n        data: list,\n        totalCount: response.json.count\n      };\n    }).\n    catch(async (error) => {\n      const errorMessage = getErrorMessage(await getClientErrorObject(error));\n      throw new Error(errorMessage);\n    });\n  };\n  return ___EmotionJSX(AsyncSelect, { ariaLabel: t('Dataset'), value: value, options: loadDatasetOptions, onChange: onChange, notFoundContent: t('No compatible datasets found'), placeholder: t('Select a dataset') });\n};__signature__(DatasetSelect, \"useCallback{getErrorMessage}\");\nconst MemoizedSelect = (props) =>\n// eslint-disable-next-line react-hooks/exhaustive-deps\nuseMemo(() => ___EmotionJSX(DatasetSelect, props), []);__signature__(MemoizedSelect, \"useMemo{}\");const _default =\nMemoizedSelect;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(DatasetSelect, \"DatasetSelect\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/DatasetSelect.tsx\");reactHotLoader.register(MemoizedSelect, \"MemoizedSelect\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/DatasetSelect.tsx\");reactHotLoader.register(_default, \"default\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/DatasetSelect.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["React","useCallback","useMemo","rison","t","getClientErrorObject","AsyncSelect","cachedSupersetGet","DatasetSelectLabel","jsx","___EmotionJSX","DatasetSelect","onChange","value","getErrorMessage","error","message","errorText","loadDatasetOptions","search","page","pageSize","query","encode","columns","filters","col","opr","page_size","order_column","order_direction","endpoint","then","response","list","json","result","map","item","customLabel","label","table_name","id","data","totalCount","count","catch","errorMessage","Error","ariaLabel","options","notFoundContent","placeholder","__signature__","MemoizedSelect","props","_default","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/DatasetSelect.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useMemo, ReactNode } from 'react';\nimport rison from 'rison';\nimport {\n  t,\n  JsonResponse,\n  ClientErrorObject,\n  getClientErrorObject,\n} from '@superset-ui/core';\nimport { AsyncSelect } from 'src/components';\nimport { cachedSupersetGet } from 'src/utils/cachedSupersetGet';\nimport {\n  Dataset,\n  DatasetSelectLabel,\n} from 'src/features/datasets/DatasetSelectLabel';\n\ninterface DatasetSelectProps {\n  onChange: (value: { label: string; value: number }) => void;\n  value?: { label: string; value: number };\n}\n\nconst DatasetSelect = ({ onChange, value }: DatasetSelectProps) => {\n  const getErrorMessage = useCallback(\n    ({ error, message }: ClientErrorObject) => {\n      let errorText = message || error || t('An error has occurred');\n      if (message === 'Forbidden') {\n        errorText = t('You do not have permission to edit this dashboard');\n      }\n      return errorText;\n    },\n    [],\n  );\n\n  const loadDatasetOptions = async (\n    search: string,\n    page: number,\n    pageSize: number,\n  ) => {\n    const query = rison.encode({\n      columns: ['id', 'table_name', 'database.database_name', 'schema'],\n      filters: [{ col: 'table_name', opr: 'ct', value: search }],\n      page,\n      page_size: pageSize,\n      order_column: 'table_name',\n      order_direction: 'asc',\n    });\n    return cachedSupersetGet({\n      endpoint: `/api/v1/dataset/?q=${query}`,\n    })\n      .then((response: JsonResponse) => {\n        const list: {\n          customLabel: ReactNode;\n          label: string;\n          value: string | number;\n        }[] = response.json.result.map((item: Dataset) => ({\n          customLabel: DatasetSelectLabel(item),\n          label: item.table_name,\n          value: item.id,\n        }));\n        return {\n          data: list,\n          totalCount: response.json.count,\n        };\n      })\n      .catch(async error => {\n        const errorMessage = getErrorMessage(await getClientErrorObject(error));\n        throw new Error(errorMessage);\n      });\n  };\n\n  return (\n    <AsyncSelect\n      ariaLabel={t('Dataset')}\n      value={value}\n      options={loadDatasetOptions}\n      onChange={onChange}\n      notFoundContent={t('No compatible datasets found')}\n      placeholder={t('Select a dataset')}\n    />\n  );\n};\n\nconst MemoizedSelect = (props: DatasetSelectProps) =>\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  useMemo(() => <DatasetSelect {...props} />, []);\n\nexport default MemoizedSelect;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}