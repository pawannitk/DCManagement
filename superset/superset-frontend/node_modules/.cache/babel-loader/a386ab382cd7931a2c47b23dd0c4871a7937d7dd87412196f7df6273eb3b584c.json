{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport isTruthy from './utils/isTruthy';\nimport {\n  tokenizeToNumericArray,\n  tokenizeToStringArray } from\n'./utils/tokenize';\nimport { formatLabel } from './utils';\n\nconst NOOP = () => {};\n\nconst grabD3Format = (datasource, targetMetric) => {\n  let foundFormatter;\n  const { metrics = [] } = datasource || {};\n  metrics.forEach((metric) => {\n    if (metric.d3format && metric.metric_name === targetMetric) {\n      foundFormatter = metric.d3format;\n    }\n  });\n\n  return foundFormatter;\n};\n\nexport default function transformProps(chartProps) {\n  const {\n    width,\n    height,\n    annotationData,\n    datasource,\n    formData,\n    hooks,\n    queriesData\n  } = chartProps;\n\n  const { onAddFilter = NOOP, onError = NOOP } = hooks;\n\n  const {\n    annotationLayers,\n    barStacked,\n    bottomMargin,\n    colorPicker,\n    colorScheme,\n    comparisonType,\n    contribution,\n    donut,\n    entity,\n    labelsOutside,\n    leftMargin,\n    lineInterpolation,\n    maxBubbleSize,\n    metric,\n    metrics = [],\n    orderBars,\n    pieLabelType,\n    reduceXTicks,\n    richTooltip,\n    sendTimeRange,\n    showBarValue,\n    showBrush,\n    showControls,\n    showLabels,\n    showLegend,\n    showMarkers,\n    size,\n    stackedStyle,\n    vizType,\n    x,\n    xAxisFormat,\n    xAxisLabel,\n    xAxisShowminmax,\n    xLogScale,\n    xTicksLayout,\n    y,\n    yAxisBounds,\n    yAxis2Bounds,\n    yAxisLabel,\n    yAxisShowminmax,\n    yAxis2Showminmax,\n    yLogScale,\n    sliceId\n  } = formData;\n\n  let {\n    markerLabels,\n    markerLines,\n    markerLineLabels,\n    markers,\n    numberFormat,\n    rangeLabels,\n    ranges,\n    yAxisFormat\n  } = formData;\n\n  const rawData = queriesData[0].data || [];\n  const data = Array.isArray(rawData) ?\n  rawData.map((row) => ({\n    ...row,\n    values: row.values.map((value) => ({ ...value })),\n    key: formatLabel(row.key, datasource.verboseMap)\n  })) :\n  rawData;\n\n  if (vizType === 'pie') {\n    numberFormat = numberFormat || grabD3Format(datasource, metric);\n  } else if (\n  ['line', 'dist_bar', 'bar', 'area'].includes(chartProps.formData.vizType))\n  {\n    yAxisFormat =\n    yAxisFormat ||\n    grabD3Format(datasource, metrics.length > 0 ? metrics[0] : undefined);\n  } else if (vizType === 'bullet') {\n    ranges = tokenizeToNumericArray(ranges) || [0, data.measures * 1.1];\n    rangeLabels = tokenizeToStringArray(rangeLabels);\n    markerLabels = tokenizeToStringArray(markerLabels);\n    markerLines = tokenizeToNumericArray(markerLines);\n    markerLineLabels = tokenizeToStringArray(markerLineLabels);\n    markers = tokenizeToNumericArray(markers);\n  }\n\n  return {\n    width,\n    height,\n    data,\n    annotationData,\n    annotationLayers,\n    areaStackedStyle: stackedStyle,\n    baseColor: colorPicker,\n    bottomMargin,\n    colorScheme,\n    comparisonType,\n    contribution,\n    entity,\n    isBarStacked: barStacked,\n    isDonut: donut,\n    isPieLabelOutside: labelsOutside,\n    leftMargin,\n    lineInterpolation,\n    markerLabels,\n    markerLines,\n    markerLineLabels,\n    markers,\n    maxBubbleSize: parseInt(maxBubbleSize, 10),\n    numberFormat,\n    onBrushEnd: isTruthy(sendTimeRange) ?\n    (timeRange) => {\n      onAddFilter('__time_range', timeRange, false, true);\n    } :\n    undefined,\n    onError,\n    orderBars,\n    pieLabelType,\n    rangeLabels,\n    ranges,\n    reduceXTicks,\n    showBarValue,\n    showBrush,\n    showControls,\n    showLabels,\n    showLegend,\n    showMarkers,\n    sizeField: size,\n    useRichTooltip: richTooltip,\n    vizType,\n    xAxisFormat,\n    xAxisLabel,\n    xAxisShowMinMax: xAxisShowminmax,\n    xField: x,\n    xIsLogScale: xLogScale,\n    xTicksLayout,\n    yAxisFormat,\n    yAxisBounds,\n    yAxis2Bounds,\n    yAxisLabel,\n    yAxisShowMinMax: yAxisShowminmax,\n    yAxis2ShowMinMax: yAxis2Showminmax,\n    yField: y,\n    yIsLogScale: yLogScale,\n    sliceId\n  };\n};(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(NOOP, \"NOOP\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-nvd3/src/transformProps.js\");reactHotLoader.register(grabD3Format, \"grabD3Format\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-nvd3/src/transformProps.js\");reactHotLoader.register(transformProps, \"transformProps\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-nvd3/src/transformProps.js\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["isTruthy","tokenizeToNumericArray","tokenizeToStringArray","formatLabel","NOOP","grabD3Format","datasource","targetMetric","foundFormatter","metrics","forEach","metric","d3format","metric_name","transformProps","chartProps","width","height","annotationData","formData","hooks","queriesData","onAddFilter","onError","annotationLayers","barStacked","bottomMargin","colorPicker","colorScheme","comparisonType","contribution","donut","entity","labelsOutside","leftMargin","lineInterpolation","maxBubbleSize","orderBars","pieLabelType","reduceXTicks","richTooltip","sendTimeRange","showBarValue","showBrush","showControls","showLabels","showLegend","showMarkers","size","stackedStyle","vizType","x","xAxisFormat","xAxisLabel","xAxisShowminmax","xLogScale","xTicksLayout","y","yAxisBounds","yAxis2Bounds","yAxisLabel","yAxisShowminmax","yAxis2Showminmax","yLogScale","sliceId","markerLabels","markerLines","markerLineLabels","markers","numberFormat","rangeLabels","ranges","yAxisFormat","rawData","data","Array","isArray","map","row","values","value","key","verboseMap","includes","length","undefined","measures","areaStackedStyle","baseColor","isBarStacked","isDonut","isPieLabelOutside","parseInt","onBrushEnd","timeRange","sizeField","useRichTooltip","xAxisShowMinMax","xField","xIsLogScale","yAxisShowMinMax","yAxis2ShowMinMax","yField","yIsLogScale","reactHotLoader","reactHotLoaderGlobal","default","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-nvd3/src/transformProps.js"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport isTruthy from './utils/isTruthy';\nimport {\n  tokenizeToNumericArray,\n  tokenizeToStringArray,\n} from './utils/tokenize';\nimport { formatLabel } from './utils';\n\nconst NOOP = () => {};\n\nconst grabD3Format = (datasource, targetMetric) => {\n  let foundFormatter;\n  const { metrics = [] } = datasource || {};\n  metrics.forEach(metric => {\n    if (metric.d3format && metric.metric_name === targetMetric) {\n      foundFormatter = metric.d3format;\n    }\n  });\n\n  return foundFormatter;\n};\n\nexport default function transformProps(chartProps) {\n  const {\n    width,\n    height,\n    annotationData,\n    datasource,\n    formData,\n    hooks,\n    queriesData,\n  } = chartProps;\n\n  const { onAddFilter = NOOP, onError = NOOP } = hooks;\n\n  const {\n    annotationLayers,\n    barStacked,\n    bottomMargin,\n    colorPicker,\n    colorScheme,\n    comparisonType,\n    contribution,\n    donut,\n    entity,\n    labelsOutside,\n    leftMargin,\n    lineInterpolation,\n    maxBubbleSize,\n    metric,\n    metrics = [],\n    orderBars,\n    pieLabelType,\n    reduceXTicks,\n    richTooltip,\n    sendTimeRange,\n    showBarValue,\n    showBrush,\n    showControls,\n    showLabels,\n    showLegend,\n    showMarkers,\n    size,\n    stackedStyle,\n    vizType,\n    x,\n    xAxisFormat,\n    xAxisLabel,\n    xAxisShowminmax,\n    xLogScale,\n    xTicksLayout,\n    y,\n    yAxisBounds,\n    yAxis2Bounds,\n    yAxisLabel,\n    yAxisShowminmax,\n    yAxis2Showminmax,\n    yLogScale,\n    sliceId,\n  } = formData;\n\n  let {\n    markerLabels,\n    markerLines,\n    markerLineLabels,\n    markers,\n    numberFormat,\n    rangeLabels,\n    ranges,\n    yAxisFormat,\n  } = formData;\n\n  const rawData = queriesData[0].data || [];\n  const data = Array.isArray(rawData)\n    ? rawData.map(row => ({\n        ...row,\n        values: row.values.map(value => ({ ...value })),\n        key: formatLabel(row.key, datasource.verboseMap),\n      }))\n    : rawData;\n\n  if (vizType === 'pie') {\n    numberFormat = numberFormat || grabD3Format(datasource, metric);\n  } else if (\n    ['line', 'dist_bar', 'bar', 'area'].includes(chartProps.formData.vizType)\n  ) {\n    yAxisFormat =\n      yAxisFormat ||\n      grabD3Format(datasource, metrics.length > 0 ? metrics[0] : undefined);\n  } else if (vizType === 'bullet') {\n    ranges = tokenizeToNumericArray(ranges) || [0, data.measures * 1.1];\n    rangeLabels = tokenizeToStringArray(rangeLabels);\n    markerLabels = tokenizeToStringArray(markerLabels);\n    markerLines = tokenizeToNumericArray(markerLines);\n    markerLineLabels = tokenizeToStringArray(markerLineLabels);\n    markers = tokenizeToNumericArray(markers);\n  }\n\n  return {\n    width,\n    height,\n    data,\n    annotationData,\n    annotationLayers,\n    areaStackedStyle: stackedStyle,\n    baseColor: colorPicker,\n    bottomMargin,\n    colorScheme,\n    comparisonType,\n    contribution,\n    entity,\n    isBarStacked: barStacked,\n    isDonut: donut,\n    isPieLabelOutside: labelsOutside,\n    leftMargin,\n    lineInterpolation,\n    markerLabels,\n    markerLines,\n    markerLineLabels,\n    markers,\n    maxBubbleSize: parseInt(maxBubbleSize, 10),\n    numberFormat,\n    onBrushEnd: isTruthy(sendTimeRange)\n      ? timeRange => {\n          onAddFilter('__time_range', timeRange, false, true);\n        }\n      : undefined,\n    onError,\n    orderBars,\n    pieLabelType,\n    rangeLabels,\n    ranges,\n    reduceXTicks,\n    showBarValue,\n    showBrush,\n    showControls,\n    showLabels,\n    showLegend,\n    showMarkers,\n    sizeField: size,\n    useRichTooltip: richTooltip,\n    vizType,\n    xAxisFormat,\n    xAxisLabel,\n    xAxisShowMinMax: xAxisShowminmax,\n    xField: x,\n    xIsLogScale: xLogScale,\n    xTicksLayout,\n    yAxisFormat,\n    yAxisBounds,\n    yAxis2Bounds,\n    yAxisLabel,\n    yAxisShowMinMax: yAxisShowminmax,\n    yAxis2ShowMinMax: yAxis2Showminmax,\n    yField: y,\n    yIsLogScale: yLogScale,\n    sliceId,\n  };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}