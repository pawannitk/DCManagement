{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport URI from 'urijs';\nimport { safeStringify } from './safeStringify';\nconst MAX_URL_LENGTH = 8000;\nexport function getURIDirectory(endpointType = 'base') {\n  // Building the directory part of the URI\n  let directory = '/explore/';\n  if (['json', 'csv', 'query', 'results', 'samples'].includes(endpointType)) {\n    directory = '/superset/explore_json/';\n  }\n  return directory;\n}\nexport function getExploreLongUrl(formData, endpointType, allowOverflow = true, extraSearch = {}) {\n  if (!formData.datasource) {\n    return undefined;\n  }\n  const uri = new URI('/');\n  const directory = getURIDirectory(endpointType);\n  const search = uri.search(true);\n  Object.keys(extraSearch).forEach((key) => {\n    search[key] = extraSearch[key];\n  });\n  search.form_data = safeStringify(formData);\n  if (endpointType === 'standalone') {\n    search.standalone = 'true';\n  }\n  const url = uri.directory(directory).search(search).toString();\n  if (!allowOverflow && url.length > MAX_URL_LENGTH) {\n    const minimalFormData = {\n      datasource: formData.datasource,\n      viz_type: formData.viz_type\n    };\n    return getExploreLongUrl(minimalFormData, endpointType, false, {\n      URL_IS_TOO_LONG_TO_SHARE: null\n    });\n  }\n  return url;\n};(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(MAX_URL_LENGTH, \"MAX_URL_LENGTH\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/utils/explore.ts\");reactHotLoader.register(getURIDirectory, \"getURIDirectory\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/utils/explore.ts\");reactHotLoader.register(getExploreLongUrl, \"getExploreLongUrl\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/utils/explore.ts\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["URI","safeStringify","MAX_URL_LENGTH","getURIDirectory","endpointType","directory","includes","getExploreLongUrl","formData","allowOverflow","extraSearch","datasource","undefined","uri","search","Object","keys","forEach","key","form_data","standalone","url","toString","length","minimalFormData","viz_type","URL_IS_TOO_LONG_TO_SHARE","reactHotLoader","reactHotLoaderGlobal","default","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/utils/explore.ts"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport URI from 'urijs';\nimport { JsonObject } from '@superset-ui/core';\nimport { safeStringify } from './safeStringify';\n\nconst MAX_URL_LENGTH = 8000;\n\nexport function getURIDirectory(endpointType = 'base') {\n  // Building the directory part of the URI\n  let directory = '/explore/';\n  if (['json', 'csv', 'query', 'results', 'samples'].includes(endpointType)) {\n    directory = '/superset/explore_json/';\n  }\n\n  return directory;\n}\n\nexport function getExploreLongUrl(\n  formData: JsonObject,\n  endpointType: string,\n  allowOverflow = true,\n  extraSearch = {},\n): string | undefined {\n  if (!formData.datasource) {\n    return undefined;\n  }\n\n  const uri = new URI('/');\n  const directory = getURIDirectory(endpointType);\n  const search = uri.search(true);\n  Object.keys(extraSearch).forEach(key => {\n    search[key] = extraSearch[key];\n  });\n  search.form_data = safeStringify(formData);\n  if (endpointType === 'standalone') {\n    search.standalone = 'true';\n  }\n  const url = uri.directory(directory).search(search).toString();\n  if (!allowOverflow && url.length > MAX_URL_LENGTH) {\n    const minimalFormData = {\n      datasource: formData.datasource,\n      viz_type: formData.viz_type,\n    };\n\n    return getExploreLongUrl(minimalFormData, endpointType, false, {\n      URL_IS_TOO_LONG_TO_SHARE: null,\n    });\n  }\n\n  return url;\n}\n"],"mappings":"wSAAA;;;;;;;;;;;;;;;;;;AAkBA,OAAOA,GAAG,MAAM,OAAO;AAEvB,SAASC,aAAa,QAAQ,iBAAiB;AAE/C,MAAMC,cAAc,GAAG,IAAI;AAE3B,OAAM,SAAUC,eAAeA,CAACC,YAAY,GAAG,MAAM;EACnD;EACA,IAAIC,SAAS,GAAG,WAAW;EAC3B,IAAI,CAAC,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE,SAAS,EAAE,SAAS,CAAC,CAACC,QAAQ,CAACF,YAAY,CAAC,EAAE;IACzEC,SAAS,GAAG,yBAAyB;;EAGvC,OAAOA,SAAS;AAClB;AAEA,OAAM,SAAUE,iBAAiBA,CAC/BC,QAAoB,EACpBJ,YAAoB,EACpBK,aAAa,GAAG,IAAI,EACpBC,WAAW,GAAG,EAAE;EAEhB,IAAI,CAACF,QAAQ,CAACG,UAAU,EAAE;IACxB,OAAOC,SAAS;;EAGlB,MAAMC,GAAG,GAAG,IAAIb,GAAG,CAAC,GAAG,CAAC;EACxB,MAAMK,SAAS,GAAGF,eAAe,CAACC,YAAY,CAAC;EAC/C,MAAMU,MAAM,GAAGD,GAAG,CAACC,MAAM,CAAC,IAAI,CAAC;EAC/BC,MAAM,CAACC,IAAI,CAACN,WAAW,CAAC,CAACO,OAAO,CAAC,CAAAC,GAAG,KAAG;IACrCJ,MAAM,CAACI,GAAG,CAAC,GAAGR,WAAW,CAACQ,GAAG,CAAC;EAChC,CAAC,CAAC;EACFJ,MAAM,CAACK,SAAS,GAAGlB,aAAa,CAACO,QAAQ,CAAC;EAC1C,IAAIJ,YAAY,KAAK,YAAY,EAAE;IACjCU,MAAM,CAACM,UAAU,GAAG,MAAM;;EAE5B,MAAMC,GAAG,GAAGR,GAAG,CAACR,SAAS,CAACA,SAAS,CAAC,CAACS,MAAM,CAACA,MAAM,CAAC,CAACQ,QAAQ,EAAE;EAC9D,IAAI,CAACb,aAAa,IAAIY,GAAG,CAACE,MAAM,GAAGrB,cAAc,EAAE;IACjD,MAAMsB,eAAe,GAAG;MACtBb,UAAU,EAAEH,QAAQ,CAACG,UAAU;MAC/Bc,QAAQ,EAAEjB,QAAQ,CAACiB;KACpB;IAED,OAAOlB,iBAAiB,CAACiB,eAAe,EAAEpB,YAAY,EAAE,KAAK,EAAE;MAC7DsB,wBAAwB,EAAE;KAC3B,CAAC;;EAGJ,OAAOL,GAAG;AACZ,CAAC,mBAAAM,cAAA,UAAAC,oBAAA,mBAAAA,oBAAA,CAAAC,OAAA,GAAAjB,SAAA,MAAAe,cAAA,WAAAA,cAAA,CAAAG,QAAA,CA7CK5B,cAAc,sIAAAyB,cAAA,CAAAG,QAAA,CAEJ3B,eAAe,uIAAAwB,cAAA,CAAAG,QAAA,CAUfvB,iBAAiB,iKAAAwB,WAAA,UAAAH,oBAAA,mBAAAA,oBAAA,CAAAG,WAAA,GAAAnB,SAAA,CAAAmB,WAAA,IAAAA,WAAA,CAAAC,MAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}