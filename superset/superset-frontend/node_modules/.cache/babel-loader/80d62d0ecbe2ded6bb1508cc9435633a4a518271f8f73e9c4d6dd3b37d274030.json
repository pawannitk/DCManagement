{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { HeatmapLayer } from 'deck.gl/typed';\nimport React from 'react';\nimport { t, getSequentialSchemeRegistry } from '@superset-ui/core';\nimport { commonLayerProps } from '../common';\nimport sandboxedEval from '../../utils/sandbox';\nimport { hexToRGB } from '../../utils/colors';\nimport { createDeckGLComponent } from '../../factory';\nimport TooltipRow from '../../TooltipRow';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nfunction setTooltipContent(o) {\n  return ___EmotionJSX(\"div\", { className: \"deckgl-tooltip\" },\n  ___EmotionJSX(TooltipRow, { label: t('Centroid (Longitude and Latitude): '), value: `(${o == null ? void 0 : o.coordinate[0]}, ${o == null ? void 0 : o.coordinate[1]})` })\n  );\n}\nexport const getLayer = (formData, payload, onAddFilter, setTooltip) => {var _getSequentialSchemeR, _getSequentialSchemeR2, _colorScale$range, _colorScale$range$map;\n  const fd = formData;\n  const { intensity = 1, radius_pixels: radiusPixels = 30, aggregation = 'SUM', js_data_mutator: jsFnMutator, linear_color_scheme: colorScheme } = fd;\n  let data = payload.data.features;\n  if (jsFnMutator) {\n    // Applying user defined data mutator if defined\n    const jsFnMutatorFunction = sandboxedEval(fd.js_data_mutator);\n    data = jsFnMutatorFunction(data);\n  }\n  const colorScale = (_getSequentialSchemeR = getSequentialSchemeRegistry()) == null ? void 0 : (_getSequentialSchemeR2 = _getSequentialSchemeR.\n  get(colorScheme)) == null ? void 0 : _getSequentialSchemeR2.\n  createLinearScale([0, 6]);\n  const colorRange = colorScale == null ? void 0 : (_colorScale$range = colorScale.\n  range()) == null ? void 0 : (_colorScale$range$map = _colorScale$range.\n  map((color) => hexToRGB(color))) == null ? void 0 : _colorScale$range$map.\n  reverse();\n  return new HeatmapLayer({\n    id: `heatmp-layer-${fd.slice_id}`,\n    data,\n    intensity,\n    radiusPixels,\n    colorRange,\n    aggregation: aggregation.toUpperCase(),\n    getPosition: (d) => d.position,\n    getWeight: (d) => d.weight ? d.weight : 1,\n    ...commonLayerProps(fd, setTooltip, setTooltipContent)\n  });\n};\nfunction getPoints(data) {\n  return data.map((d) => d.position);\n}const _default =\ncreateDeckGLComponent(getLayer, getPoints);export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(setTooltipContent, \"setTooltipContent\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/layers/Heatmap/Heatmap.tsx\");reactHotLoader.register(getLayer, \"getLayer\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/layers/Heatmap/Heatmap.tsx\");reactHotLoader.register(getPoints, \"getPoints\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/layers/Heatmap/Heatmap.tsx\");reactHotLoader.register(_default, \"default\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/layers/Heatmap/Heatmap.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["HeatmapLayer","React","t","getSequentialSchemeRegistry","commonLayerProps","sandboxedEval","hexToRGB","createDeckGLComponent","TooltipRow","jsx","___EmotionJSX","setTooltipContent","o","className","label","value","coordinate","getLayer","formData","payload","onAddFilter","setTooltip","_getSequentialSchemeR","_getSequentialSchemeR2","_colorScale$range","_colorScale$range$map","fd","intensity","radius_pixels","radiusPixels","aggregation","js_data_mutator","jsFnMutator","linear_color_scheme","colorScheme","data","features","jsFnMutatorFunction","colorScale","get","createLinearScale","colorRange","range","map","color","reverse","id","slice_id","toUpperCase","getPosition","d","position","getWeight","weight","getPoints","_default","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/layers/Heatmap/Heatmap.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { HeatmapLayer, Position, Color } from 'deck.gl/typed';\nimport React from 'react';\nimport { t, getSequentialSchemeRegistry, JsonObject } from '@superset-ui/core';\nimport { commonLayerProps } from '../common';\nimport sandboxedEval from '../../utils/sandbox';\nimport { hexToRGB } from '../../utils/colors';\nimport { createDeckGLComponent, getLayerType } from '../../factory';\nimport TooltipRow from '../../TooltipRow';\n\nfunction setTooltipContent(o: JsonObject) {\n  return (\n    <div className=\"deckgl-tooltip\">\n      <TooltipRow\n        label={t('Centroid (Longitude and Latitude): ')}\n        value={`(${o?.coordinate[0]}, ${o?.coordinate[1]})`}\n      />\n    </div>\n  );\n}\nexport const getLayer: getLayerType<unknown> = (\n  formData,\n  payload,\n  onAddFilter,\n  setTooltip,\n) => {\n  const fd = formData;\n  const {\n    intensity = 1,\n    radius_pixels: radiusPixels = 30,\n    aggregation = 'SUM',\n    js_data_mutator: jsFnMutator,\n    linear_color_scheme: colorScheme,\n  } = fd;\n  let data = payload.data.features;\n\n  if (jsFnMutator) {\n    // Applying user defined data mutator if defined\n    const jsFnMutatorFunction = sandboxedEval(fd.js_data_mutator);\n    data = jsFnMutatorFunction(data);\n  }\n\n  const colorScale = getSequentialSchemeRegistry()\n    ?.get(colorScheme)\n    ?.createLinearScale([0, 6]);\n  const colorRange = colorScale\n    ?.range()\n    ?.map(color => hexToRGB(color))\n    ?.reverse() as Color[];\n\n  return new HeatmapLayer({\n    id: `heatmp-layer-${fd.slice_id}` as const,\n    data,\n    intensity,\n    radiusPixels,\n    colorRange,\n    aggregation: aggregation.toUpperCase(),\n    getPosition: (d: { position: Position; weight: number }) => d.position,\n    getWeight: (d: { position: number[]; weight: number }) =>\n      d.weight ? d.weight : 1,\n    ...commonLayerProps(fd, setTooltip, setTooltipContent),\n  });\n};\n\nfunction getPoints(data: any[]) {\n  return data.map(d => d.position);\n}\n\nexport default createDeckGLComponent(getLayer, getPoints);\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}