{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ScatterplotLayer } from 'deck.gl/typed';\nimport React from 'react';\nimport { getMetricLabel, t } from '@superset-ui/core';\nimport { commonLayerProps } from '../common';\nimport { createCategoricalDeckGLComponent } from '../../factory';\nimport TooltipRow from '../../TooltipRow';\nimport { unitToRadius } from '../../utils/geo';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nfunction getPoints(data) {\n  return data.map((d) => d.position);\n}\nfunction setTooltipContent(formData, verboseMap) {\n  return (o) => {var _formData$point_radiu, _o$object, _o$object$position, _o$object2, _o$object2$position, _o$object3, _o$object4, _o$object5, _o$object6;\n    const label = (verboseMap == null ? void 0 : verboseMap[formData.point_radius_fixed.value]) ||\n    getMetricLabel((_formData$point_radiu = formData.point_radius_fixed) == null ? void 0 : _formData$point_radiu.value);\n    return ___EmotionJSX(\"div\", { className: \"deckgl-tooltip\" },\n    ___EmotionJSX(TooltipRow\n    // eslint-disable-next-line prefer-template\n    , { label: t('Longitude and Latitude') + ': ', value: `${(_o$object = o.object) == null ? void 0 : (_o$object$position = _o$object.position) == null ? void 0 : _o$object$position[0]}, ${(_o$object2 = o.object) == null ? void 0 : (_o$object2$position = _o$object2.position) == null ? void 0 : _o$object2$position[1]}` }),\n    ((_o$object3 = o.object) == null ? void 0 : _o$object3.cat_color) && ___EmotionJSX(TooltipRow\n    // eslint-disable-next-line prefer-template\n    , { label: t('Category') + ': ', value: `${(_o$object4 = o.object) == null ? void 0 : _o$object4.cat_color}` }),\n    ((_o$object5 = o.object) == null ? void 0 : _o$object5.metric) && ___EmotionJSX(TooltipRow, { label: `${label}: `, value: `${(_o$object6 = o.object) == null ? void 0 : _o$object6.metric}` })\n    );\n  };\n}\nexport function getLayer(formData, payload, onAddFilter, setTooltip, datasource) {\n  const fd = formData;\n  const dataWithRadius = payload.data.features.map((d) => {\n    let radius = unitToRadius(fd.point_unit, d.radius) || 10;\n    if (fd.multiplier) {\n      radius *= fd.multiplier;\n    }\n    if (d.color) {\n      return { ...d, radius };\n    }\n    const c = fd.color_picker || { r: 0, g: 0, b: 0, a: 1 };\n    const color = [c.r, c.g, c.b, c.a * 255];\n    return { ...d, radius, color };\n  });\n  return new ScatterplotLayer({\n    id: `scatter-layer-${fd.slice_id}`,\n    data: dataWithRadius,\n    fp64: true,\n    getFillColor: (d) => d.color,\n    getRadius: (d) => d.radius,\n    radiusMinPixels: Number(fd.min_radius) || undefined,\n    radiusMaxPixels: Number(fd.max_radius) || undefined,\n    stroked: false,\n    ...commonLayerProps(fd, setTooltip, setTooltipContent(fd, datasource == null ? void 0 : datasource.verboseMap))\n  });\n}const _default =\ncreateCategoricalDeckGLComponent(getLayer, getPoints);export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(getPoints, \"getPoints\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/layers/Scatter/Scatter.tsx\");reactHotLoader.register(setTooltipContent, \"setTooltipContent\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/layers/Scatter/Scatter.tsx\");reactHotLoader.register(getLayer, \"getLayer\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/layers/Scatter/Scatter.tsx\");reactHotLoader.register(_default, \"default\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/layers/Scatter/Scatter.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["ScatterplotLayer","React","getMetricLabel","t","commonLayerProps","createCategoricalDeckGLComponent","TooltipRow","unitToRadius","jsx","___EmotionJSX","getPoints","data","map","d","position","setTooltipContent","formData","verboseMap","o","_formData$point_radiu","_o$object","_o$object$position","_o$object2","_o$object2$position","_o$object3","_o$object4","_o$object5","_o$object6","label","point_radius_fixed","value","className","object","cat_color","metric","getLayer","payload","onAddFilter","setTooltip","datasource","fd","dataWithRadius","features","radius","point_unit","multiplier","color","c","color_picker","r","g","b","a","id","slice_id","fp64","getFillColor","getRadius","radiusMinPixels","Number","min_radius","undefined","radiusMaxPixels","max_radius","stroked","_default","reactHotLoader","reactHotLoaderGlobal","default","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-preset-chart-deckgl/src/layers/Scatter/Scatter.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ScatterplotLayer } from 'deck.gl/typed';\nimport React from 'react';\nimport {\n  Datasource,\n  getMetricLabel,\n  JsonObject,\n  QueryFormData,\n  t,\n} from '@superset-ui/core';\nimport { commonLayerProps } from '../common';\nimport { createCategoricalDeckGLComponent } from '../../factory';\nimport TooltipRow from '../../TooltipRow';\nimport { unitToRadius } from '../../utils/geo';\nimport { TooltipProps } from '../../components/Tooltip';\n\nfunction getPoints(data: JsonObject[]) {\n  return data.map(d => d.position);\n}\n\nfunction setTooltipContent(\n  formData: QueryFormData,\n  verboseMap?: Record<string, string>,\n) {\n  return (o: JsonObject) => {\n    const label =\n      verboseMap?.[formData.point_radius_fixed.value] ||\n      getMetricLabel(formData.point_radius_fixed?.value);\n    return (\n      <div className=\"deckgl-tooltip\">\n        <TooltipRow\n          // eslint-disable-next-line prefer-template\n          label={t('Longitude and Latitude') + ': '}\n          value={`${o.object?.position?.[0]}, ${o.object?.position?.[1]}`}\n        />\n        {o.object?.cat_color && (\n          <TooltipRow\n            // eslint-disable-next-line prefer-template\n            label={t('Category') + ': '}\n            value={`${o.object?.cat_color}`}\n          />\n        )}\n        {o.object?.metric && (\n          <TooltipRow label={`${label}: `} value={`${o.object?.metric}`} />\n        )}\n      </div>\n    );\n  };\n}\n\nexport function getLayer(\n  formData: QueryFormData,\n  payload: JsonObject,\n  onAddFilter: () => void,\n  setTooltip: (tooltip: TooltipProps['tooltip']) => void,\n  datasource: Datasource,\n) {\n  const fd = formData;\n  const dataWithRadius = payload.data.features.map((d: JsonObject) => {\n    let radius = unitToRadius(fd.point_unit, d.radius) || 10;\n    if (fd.multiplier) {\n      radius *= fd.multiplier;\n    }\n    if (d.color) {\n      return { ...d, radius };\n    }\n    const c = fd.color_picker || { r: 0, g: 0, b: 0, a: 1 };\n    const color = [c.r, c.g, c.b, c.a * 255];\n\n    return { ...d, radius, color };\n  });\n\n  return new ScatterplotLayer({\n    id: `scatter-layer-${fd.slice_id}` as const,\n    data: dataWithRadius,\n    fp64: true,\n    getFillColor: d => d.color,\n    getRadius: d => d.radius,\n    radiusMinPixels: Number(fd.min_radius) || undefined,\n    radiusMaxPixels: Number(fd.max_radius) || undefined,\n    stroked: false,\n    ...commonLayerProps(\n      fd,\n      setTooltip,\n      setTooltipContent(fd, datasource?.verboseMap),\n    ),\n  });\n}\n\nexport default createCategoricalDeckGLComponent(getLayer, getPoints);\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}