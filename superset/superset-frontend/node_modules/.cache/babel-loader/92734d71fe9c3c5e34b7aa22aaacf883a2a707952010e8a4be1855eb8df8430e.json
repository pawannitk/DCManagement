{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable no-param-reassign, react/sort-prop-types */\nimport d3 from 'd3';\nimport PropTypes from 'prop-types';\nimport {\n  getNumberFormatter,\n  CategoricalColorNamespace } from\n'@superset-ui/core';\n\nconst propTypes = {\n  data: PropTypes.shape({\n    matrix: PropTypes.arrayOf(PropTypes.arrayOf(PropTypes.number)),\n    nodes: PropTypes.arrayOf(PropTypes.string)\n  }),\n  width: PropTypes.number,\n  height: PropTypes.number,\n  colorScheme: PropTypes.string,\n  numberFormat: PropTypes.string\n};\n\nfunction Chord(element, props) {\n  const { data, width, height, numberFormat, colorScheme, sliceId } = props;\n\n  element.innerHTML = '';\n\n  const div = d3.select(element);\n  div.classed('superset-legacy-chart-chord', true);\n  const { nodes, matrix } = data;\n  const f = getNumberFormatter(numberFormat);\n  const colorFn = CategoricalColorNamespace.getScale(colorScheme);\n\n  const outerRadius = Math.min(width, height) / 2 - 10;\n  const innerRadius = outerRadius - 24;\n\n  let chord;\n\n  const arc = d3.svg.arc().innerRadius(innerRadius).outerRadius(outerRadius);\n\n  const layout = d3.layout.\n  chord().\n  padding(0.04).\n  sortSubgroups(d3.descending).\n  sortChords(d3.descending);\n\n  const path = d3.svg.chord().radius(innerRadius);\n\n  const svg = div.\n  append('svg').\n  attr('width', width).\n  attr('height', height).\n  on('mouseout', () => chord.classed('fade', false)).\n  append('g').\n  attr('id', 'circle').\n  attr('transform', `translate(${width / 2}, ${height / 2})`);\n\n  svg.append('circle').attr('r', outerRadius);\n\n  // Compute the chord layout.\n  layout.matrix(matrix);\n\n  const group = svg.\n  selectAll('.group').\n  data(layout.groups).\n  enter().\n  append('g').\n  attr('class', 'group').\n  on('mouseover', (d, i) => {\n    chord.classed('fade', (p) => p.source.index !== i && p.target.index !== i);\n  });\n\n  // Add a mouseover title.\n  group.append('title').text((d, i) => `${nodes[i]}: ${f(d.value)}`);\n\n  // Add the group arc.\n  const groupPath = group.\n  append('path').\n  attr('id', (d, i) => `group${i}`).\n  attr('d', arc).\n  style('fill', (d, i) => colorFn(nodes[i], sliceId));\n\n  // Add a text label.\n  const groupText = group.append('text').attr('x', 6).attr('dy', 15);\n\n  groupText.\n  append('textPath').\n  attr('xlink:href', (d, i) => `#group${i}`).\n  text((d, i) => nodes[i]);\n  // Remove the labels that don't fit. :(\n  groupText.\n  filter(function filter(d, i) {\n    return (\n      groupPath[0][i].getTotalLength() / 2 - 16 < this.getComputedTextLength());\n\n  }).\n  remove();\n\n  // Add the chords.\n  chord = svg.\n  selectAll('.chord').\n  data(layout.chords).\n  enter().\n  append('path').\n  attr('class', 'chord').\n  on('mouseover', (d) => {\n    chord.classed('fade', (p) => p !== d);\n  }).\n  style('fill', (d) => colorFn(nodes[d.source.index], sliceId)).\n  attr('d', path);\n\n  // Add an elaborate mouseover title for each chord.\n  chord.\n  append('title').\n  text(\n    (d) =>\n    `${nodes[d.source.index]} → ${nodes[d.target.index]}: ${f(\n      d.source.value\n    )}\\n${nodes[d.target.index]} → ${nodes[d.source.index]}: ${f(\n      d.target.value\n    )}`\n  );\n}\n\nChord.displayName = 'Chord';\nChord.propTypes = propTypes;const _default =\n\nChord;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(propTypes, \"propTypes\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-plugin-chart-chord/src/Chord.js\");reactHotLoader.register(Chord, \"Chord\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-plugin-chart-chord/src/Chord.js\");reactHotLoader.register(_default, \"default\", \"/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-plugin-chart-chord/src/Chord.js\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["d3","PropTypes","getNumberFormatter","CategoricalColorNamespace","propTypes","data","shape","matrix","arrayOf","number","nodes","string","width","height","colorScheme","numberFormat","Chord","element","props","sliceId","innerHTML","div","select","classed","f","colorFn","getScale","outerRadius","Math","min","innerRadius","chord","arc","svg","layout","padding","sortSubgroups","descending","sortChords","path","radius","append","attr","on","group","selectAll","groups","enter","d","i","p","source","index","target","text","value","groupPath","style","groupText","filter","getTotalLength","getComputedTextLength","remove","chords","displayName","_default","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/plugins/legacy-plugin-chart-chord/src/Chord.js"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable no-param-reassign, react/sort-prop-types */\nimport d3 from 'd3';\nimport PropTypes from 'prop-types';\nimport {\n  getNumberFormatter,\n  CategoricalColorNamespace,\n} from '@superset-ui/core';\n\nconst propTypes = {\n  data: PropTypes.shape({\n    matrix: PropTypes.arrayOf(PropTypes.arrayOf(PropTypes.number)),\n    nodes: PropTypes.arrayOf(PropTypes.string),\n  }),\n  width: PropTypes.number,\n  height: PropTypes.number,\n  colorScheme: PropTypes.string,\n  numberFormat: PropTypes.string,\n};\n\nfunction Chord(element, props) {\n  const { data, width, height, numberFormat, colorScheme, sliceId } = props;\n\n  element.innerHTML = '';\n\n  const div = d3.select(element);\n  div.classed('superset-legacy-chart-chord', true);\n  const { nodes, matrix } = data;\n  const f = getNumberFormatter(numberFormat);\n  const colorFn = CategoricalColorNamespace.getScale(colorScheme);\n\n  const outerRadius = Math.min(width, height) / 2 - 10;\n  const innerRadius = outerRadius - 24;\n\n  let chord;\n\n  const arc = d3.svg.arc().innerRadius(innerRadius).outerRadius(outerRadius);\n\n  const layout = d3.layout\n    .chord()\n    .padding(0.04)\n    .sortSubgroups(d3.descending)\n    .sortChords(d3.descending);\n\n  const path = d3.svg.chord().radius(innerRadius);\n\n  const svg = div\n    .append('svg')\n    .attr('width', width)\n    .attr('height', height)\n    .on('mouseout', () => chord.classed('fade', false))\n    .append('g')\n    .attr('id', 'circle')\n    .attr('transform', `translate(${width / 2}, ${height / 2})`);\n\n  svg.append('circle').attr('r', outerRadius);\n\n  // Compute the chord layout.\n  layout.matrix(matrix);\n\n  const group = svg\n    .selectAll('.group')\n    .data(layout.groups)\n    .enter()\n    .append('g')\n    .attr('class', 'group')\n    .on('mouseover', (d, i) => {\n      chord.classed('fade', p => p.source.index !== i && p.target.index !== i);\n    });\n\n  // Add a mouseover title.\n  group.append('title').text((d, i) => `${nodes[i]}: ${f(d.value)}`);\n\n  // Add the group arc.\n  const groupPath = group\n    .append('path')\n    .attr('id', (d, i) => `group${i}`)\n    .attr('d', arc)\n    .style('fill', (d, i) => colorFn(nodes[i], sliceId));\n\n  // Add a text label.\n  const groupText = group.append('text').attr('x', 6).attr('dy', 15);\n\n  groupText\n    .append('textPath')\n    .attr('xlink:href', (d, i) => `#group${i}`)\n    .text((d, i) => nodes[i]);\n  // Remove the labels that don't fit. :(\n  groupText\n    .filter(function filter(d, i) {\n      return (\n        groupPath[0][i].getTotalLength() / 2 - 16 < this.getComputedTextLength()\n      );\n    })\n    .remove();\n\n  // Add the chords.\n  chord = svg\n    .selectAll('.chord')\n    .data(layout.chords)\n    .enter()\n    .append('path')\n    .attr('class', 'chord')\n    .on('mouseover', d => {\n      chord.classed('fade', p => p !== d);\n    })\n    .style('fill', d => colorFn(nodes[d.source.index], sliceId))\n    .attr('d', path);\n\n  // Add an elaborate mouseover title for each chord.\n  chord\n    .append('title')\n    .text(\n      d =>\n        `${nodes[d.source.index]} → ${nodes[d.target.index]}: ${f(\n          d.source.value,\n        )}\\n${nodes[d.target.index]} → ${nodes[d.source.index]}: ${f(\n          d.target.value,\n        )}`,\n    );\n}\n\nChord.displayName = 'Chord';\nChord.propTypes = propTypes;\n\nexport default Chord;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}