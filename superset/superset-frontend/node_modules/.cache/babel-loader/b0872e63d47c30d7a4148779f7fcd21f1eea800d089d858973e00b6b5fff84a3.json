{"ast":null,"code":"import _omit from \"lodash/omit\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();function _EMOTION_STRINGIFIED_CSS_ERROR__() {return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\";}var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\n\nimport { Input } from 'src/components/Input';\nimport { FormItem } from 'src/components/Form';\nimport jsonStringify from 'json-stringify-pretty-compact';\nimport Button from 'src/components/Button';\nimport { AntdForm, AsyncSelect, Col, Row } from 'src/components';\nimport rison from 'rison';\nimport { CategoricalColorNamespace, ensureIsArray, isFeatureEnabled, FeatureFlag, getCategoricalSchemeRegistry, getSharedLabelColor, styled, SupersetClient, t, getClientErrorObject } from '@superset-ui/core';\nimport Modal from 'src/components/Modal';\nimport { JsonEditor } from 'src/components/AsyncAceEditor';\nimport ColorSchemeControlWrapper from 'src/dashboard/components/ColorSchemeControlWrapper';\nimport FilterScopeModal from 'src/dashboard/components/filterscope/FilterScopeModal';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport { fetchTags, OBJECT_TYPES } from 'src/features/tags/tags';\nimport { loadTags } from 'src/components/Tags/utils';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nconst StyledFormItem = styled(FormItem)`\n  margin-bottom: 0;\n`;\nconst StyledJsonEditor = styled(JsonEditor)`\n  border-radius: ${({ theme }) => theme.borderRadius}px;\n  border: 1px solid ${({ theme }) => theme.colors.secondary.light2};\n`;var _ref = process.env.NODE_ENV === \"production\" ? { name: \"1blj7km\", styles: \"margin-top:1em\" } : { name: \"1gtq0eh-PropertiesModal\", styles: \"margin-top:1em;label:PropertiesModal;\", map: \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3Bhd2Fuay9Eb2N1bWVudHMvZGNpbS9zdXBlcnNldC9zdXBlcnNldC1mcm9udGVuZC9zcmMvZGFzaGJvYXJkL2NvbXBvbmVudHMvUHJvcGVydGllc01vZGFsL2luZGV4LnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUErYmtCIiwiZmlsZSI6Ii9ob21lL3Bhd2Fuay9Eb2N1bWVudHMvZGNpbS9zdXBlcnNldC9zdXBlcnNldC1mcm9udGVuZC9zcmMvZGFzaGJvYXJkL2NvbXBvbmVudHMvUHJvcGVydGllc01vZGFsL2luZGV4LnRzeCIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZVxuICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlXG4gKiBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvblxuICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZVxuICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZVxuICogXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlXG4gKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsXG4gKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhblxuICogXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcbiAqIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZVxuICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9uc1xuICogdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmltcG9ydCBSZWFjdCwgeyB1c2VDYWxsYmFjaywgdXNlRWZmZWN0LCB1c2VNZW1vLCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IG9taXQgfSBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHsgSW5wdXQgfSBmcm9tICdzcmMvY29tcG9uZW50cy9JbnB1dCc7XG5pbXBvcnQgeyBGb3JtSXRlbSB9IGZyb20gJ3NyYy9jb21wb25lbnRzL0Zvcm0nO1xuaW1wb3J0IGpzb25TdHJpbmdpZnkgZnJvbSAnanNvbi1zdHJpbmdpZnktcHJldHR5LWNvbXBhY3QnO1xuaW1wb3J0IEJ1dHRvbiBmcm9tICdzcmMvY29tcG9uZW50cy9CdXR0b24nO1xuaW1wb3J0IHsgQW50ZEZvcm0sIEFzeW5jU2VsZWN0LCBDb2wsIFJvdyB9IGZyb20gJ3NyYy9jb21wb25lbnRzJztcbmltcG9ydCByaXNvbiBmcm9tICdyaXNvbic7XG5pbXBvcnQgeyBDYXRlZ29yaWNhbENvbG9yTmFtZXNwYWNlLCBlbnN1cmVJc0FycmF5LCBpc0ZlYXR1cmVFbmFibGVkLCBGZWF0dXJlRmxhZywgZ2V0Q2F0ZWdvcmljYWxTY2hlbWVSZWdpc3RyeSwgZ2V0U2hhcmVkTGFiZWxDb2xvciwgc3R5bGVkLCBTdXBlcnNldENsaWVudCwgdCwgZ2V0Q2xpZW50RXJyb3JPYmplY3QsIH0gZnJvbSAnQHN1cGVyc2V0LXVpL2NvcmUnO1xuaW1wb3J0IE1vZGFsIGZyb20gJ3NyYy9jb21wb25lbnRzL01vZGFsJztcbmltcG9ydCB7IEpzb25FZGl0b3IgfSBmcm9tICdzcmMvY29tcG9uZW50cy9Bc3luY0FjZUVkaXRvcic7XG5pbXBvcnQgQ29sb3JTY2hlbWVDb250cm9sV3JhcHBlciBmcm9tICdzcmMvZGFzaGJvYXJkL2NvbXBvbmVudHMvQ29sb3JTY2hlbWVDb250cm9sV3JhcHBlcic7XG5pbXBvcnQgRmlsdGVyU2NvcGVNb2RhbCBmcm9tICdzcmMvZGFzaGJvYXJkL2NvbXBvbmVudHMvZmlsdGVyc2NvcGUvRmlsdGVyU2NvcGVNb2RhbCc7XG5pbXBvcnQgd2l0aFRvYXN0cyBmcm9tICdzcmMvY29tcG9uZW50cy9NZXNzYWdlVG9hc3RzL3dpdGhUb2FzdHMnO1xuaW1wb3J0IHsgZmV0Y2hUYWdzLCBPQkpFQ1RfVFlQRVMgfSBmcm9tICdzcmMvZmVhdHVyZXMvdGFncy90YWdzJztcbmltcG9ydCB7IGxvYWRUYWdzIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvVGFncy91dGlscyc7XG5jb25zdCBTdHlsZWRGb3JtSXRlbSA9IHN0eWxlZChGb3JtSXRlbSkgYFxuICBtYXJnaW4tYm90dG9tOiAwO1xuYDtcbmNvbnN0IFN0eWxlZEpzb25FZGl0b3IgPSBzdHlsZWQoSnNvbkVkaXRvcikgYFxuICBib3JkZXItcmFkaXVzOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmJvcmRlclJhZGl1c31weDtcbiAgYm9yZGVyOiAxcHggc29saWQgJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5jb2xvcnMuc2Vjb25kYXJ5LmxpZ2h0Mn07XG5gO1xuY29uc3QgUHJvcGVydGllc01vZGFsID0gKHsgYWRkU3VjY2Vzc1RvYXN0LCBhZGREYW5nZXJUb2FzdCwgY29sb3JTY2hlbWU6IGN1cnJlbnRDb2xvclNjaGVtZSwgZGFzaGJvYXJkSWQsIGRhc2hib2FyZEluZm86IGN1cnJlbnREYXNoYm9hcmRJbmZvLCBkYXNoYm9hcmRUaXRsZSwgb25IaWRlID0gKCkgPT4geyB9LCBvbmx5QXBwbHkgPSBmYWxzZSwgb25TdWJtaXQgPSAoKSA9PiB7IH0sIHNob3cgPSBmYWxzZSwgfSkgPT4ge1xuICAgIGNvbnN0IFtmb3JtXSA9IEFudGRGb3JtLnVzZUZvcm0oKTtcbiAgICBjb25zdCBbaXNMb2FkaW5nLCBzZXRJc0xvYWRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuICAgIGNvbnN0IFtpc0FkdmFuY2VkT3Blbiwgc2V0SXNBZHZhbmNlZE9wZW5dID0gdXNlU3RhdGUoZmFsc2UpO1xuICAgIGNvbnN0IFtjb2xvclNjaGVtZSwgc2V0Q29sb3JTY2hlbWVdID0gdXNlU3RhdGUoY3VycmVudENvbG9yU2NoZW1lKTtcbiAgICBjb25zdCBbanNvbk1ldGFkYXRhLCBzZXRKc29uTWV0YWRhdGFdID0gdXNlU3RhdGUoJycpO1xuICAgIGNvbnN0IFtkYXNoYm9hcmRJbmZvLCBzZXREYXNoYm9hcmRJbmZvXSA9IHVzZVN0YXRlKCk7XG4gICAgY29uc3QgW293bmVycywgc2V0T3duZXJzXSA9IHVzZVN0YXRlKFtdKTtcbiAgICBjb25zdCBbcm9sZXMsIHNldFJvbGVzXSA9IHVzZVN0YXRlKFtdKTtcbiAgICBjb25zdCBzYXZlTGFiZWwgPSBvbmx5QXBwbHkgPyB0KCdBcHBseScpIDogdCgnU2F2ZScpO1xuICAgIGNvbnN0IFt0YWdzLCBzZXRUYWdzXSA9IHVzZVN0YXRlKFtdKTtcbiAgICBjb25zdCBjYXRlZ29yaWNhbFNjaGVtZVJlZ2lzdHJ5ID0gZ2V0Q2F0ZWdvcmljYWxTY2hlbWVSZWdpc3RyeSgpO1xuICAgIGNvbnN0IHRhZ3NBc1NlbGVjdFZhbHVlcyA9IHVzZU1lbW8oKCkgPT4ge1xuICAgICAgICBjb25zdCBzZWxlY3RUYWdzID0gdGFncy5tYXAoKHRhZykgPT4gKHtcbiAgICAgICAgICAgIHZhbHVlOiB0YWcuaWQsXG4gICAgICAgICAgICBsYWJlbDogdGFnLm5hbWUsXG4gICAgICAgIH0pKTtcbiAgICAgICAgcmV0dXJuIHNlbGVjdFRhZ3M7XG4gICAgfSwgW3RhZ3MubGVuZ3RoXSk7XG4gICAgY29uc3QgaGFuZGxlRXJyb3JSZXNwb25zZSA9IGFzeW5jIChyZXNwb25zZSkgPT4ge1xuICAgICAgICBjb25zdCB7IGVycm9yLCBzdGF0dXNUZXh0LCBtZXNzYWdlIH0gPSBhd2FpdCBnZXRDbGllbnRFcnJvck9iamVjdChyZXNwb25zZSk7XG4gICAgICAgIGxldCBlcnJvclRleHQgPSBlcnJvciB8fCBzdGF0dXNUZXh0IHx8IHQoJ0FuIGVycm9yIGhhcyBvY2N1cnJlZCcpO1xuICAgICAgICBpZiAodHlwZW9mIG1lc3NhZ2UgPT09ICdvYmplY3QnICYmICdqc29uX21ldGFkYXRhJyBpbiBtZXNzYWdlKSB7XG4gICAgICAgICAgICBlcnJvclRleHQgPSBtZXNzYWdlLmpzb25fbWV0YWRhdGE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIG1lc3NhZ2UgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBlcnJvclRleHQgPSBtZXNzYWdlO1xuICAgICAgICAgICAgaWYgKG1lc3NhZ2UgPT09ICdGb3JiaWRkZW4nKSB7XG4gICAgICAgICAgICAgICAgZXJyb3JUZXh0ID0gdCgnWW91IGRvIG5vdCBoYXZlIHBlcm1pc3Npb24gdG8gZWRpdCB0aGlzIGRhc2hib2FyZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIE1vZGFsLmVycm9yKHtcbiAgICAgICAgICAgIHRpdGxlOiB0KCdFcnJvcicpLFxuICAgICAgICAgICAgY29udGVudDogZXJyb3JUZXh0LFxuICAgICAgICAgICAgb2tCdXR0b25Qcm9wczogeyBkYW5nZXI6IHRydWUsIGNsYXNzTmFtZTogJ2J0bi1kYW5nZXInIH0sXG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgY29uc3QgbG9hZEFjY2Vzc09wdGlvbnMgPSB1c2VDYWxsYmFjaygoYWNjZXNzVHlwZSA9ICdvd25lcnMnLCBpbnB1dCA9ICcnLCBwYWdlLCBwYWdlU2l6ZSkgPT4ge1xuICAgICAgICBjb25zdCBxdWVyeSA9IHJpc29uLmVuY29kZSh7XG4gICAgICAgICAgICBmaWx0ZXI6IGlucHV0LFxuICAgICAgICAgICAgcGFnZSxcbiAgICAgICAgICAgIHBhZ2Vfc2l6ZTogcGFnZVNpemUsXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gU3VwZXJzZXRDbGllbnQuZ2V0KHtcbiAgICAgICAgICAgIGVuZHBvaW50OiBgL2FwaS92MS9kYXNoYm9hcmQvcmVsYXRlZC8ke2FjY2Vzc1R5cGV9P3E9JHtxdWVyeX1gLFxuICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+ICh7XG4gICAgICAgICAgICBkYXRhOiByZXNwb25zZS5qc29uLnJlc3VsdFxuICAgICAgICAgICAgICAgIC5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0uZXh0cmEuYWN0aXZlICE9PSB1bmRlZmluZWQgPyBpdGVtLmV4dHJhLmFjdGl2ZSA6IHRydWUpXG4gICAgICAgICAgICAgICAgLm1hcCgoaXRlbSkgPT4gKHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogaXRlbS52YWx1ZSxcbiAgICAgICAgICAgICAgICBsYWJlbDogaXRlbS50ZXh0LFxuICAgICAgICAgICAgfSkpLFxuICAgICAgICAgICAgdG90YWxDb3VudDogcmVzcG9uc2UuanNvbi5jb3VudCxcbiAgICAgICAgfSkpO1xuICAgIH0sIFtdKTtcbiAgICBjb25zdCBoYW5kbGVEYXNoYm9hcmREYXRhID0gdXNlQ2FsbGJhY2soZGFzaGJvYXJkRGF0YSA9PiB7XG4gICAgICAgIGNvbnN0IHsgaWQsIGRhc2hib2FyZF90aXRsZSwgc2x1ZywgY2VydGlmaWVkX2J5LCBjZXJ0aWZpY2F0aW9uX2RldGFpbHMsIG93bmVycywgcm9sZXMsIG1ldGFkYXRhLCBpc19tYW5hZ2VkX2V4dGVybmFsbHksIH0gPSBkYXNoYm9hcmREYXRhO1xuICAgICAgICBjb25zdCBkYXNoYm9hcmRJbmZvID0ge1xuICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICB0aXRsZTogZGFzaGJvYXJkX3RpdGxlLFxuICAgICAgICAgICAgc2x1Zzogc2x1ZyB8fCAnJyxcbiAgICAgICAgICAgIGNlcnRpZmllZEJ5OiBjZXJ0aWZpZWRfYnkgfHwgJycsXG4gICAgICAgICAgICBjZXJ0aWZpY2F0aW9uRGV0YWlsczogY2VydGlmaWNhdGlvbl9kZXRhaWxzIHx8ICcnLFxuICAgICAgICAgICAgaXNNYW5hZ2VkRXh0ZXJuYWxseTogaXNfbWFuYWdlZF9leHRlcm5hbGx5IHx8IGZhbHNlLFxuICAgICAgICB9O1xuICAgICAgICBmb3JtLnNldEZpZWxkc1ZhbHVlKGRhc2hib2FyZEluZm8pO1xuICAgICAgICBzZXREYXNoYm9hcmRJbmZvKGRhc2hib2FyZEluZm8pO1xuICAgICAgICBzZXRPd25lcnMob3duZXJzKTtcbiAgICAgICAgc2V0Um9sZXMocm9sZXMpO1xuICAgICAgICBzZXRDb2xvclNjaGVtZShtZXRhZGF0YS5jb2xvcl9zY2hlbWUpO1xuICAgICAgICBjb25zdCBtZXRhRGF0YUNvcHkgPSBvbWl0KG1ldGFkYXRhLCBbXG4gICAgICAgICAgICAncG9zaXRpb25zJyxcbiAgICAgICAgICAgICdzaGFyZWRfbGFiZWxfY29sb3JzJyxcbiAgICAgICAgICAgICdjb2xvcl9zY2hlbWVfZG9tYWluJyxcbiAgICAgICAgXSk7XG4gICAgICAgIHNldEpzb25NZXRhZGF0YShtZXRhRGF0YUNvcHkgPyBqc29uU3RyaW5naWZ5KG1ldGFEYXRhQ29weSkgOiAnJyk7XG4gICAgfSwgW2Zvcm1dKTtcbiAgICBjb25zdCBmZXRjaERhc2hib2FyZERldGFpbHMgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgICAgIHNldElzTG9hZGluZyh0cnVlKTtcbiAgICAgICAgLy8gV2UgZmV0Y2ggdGhlIGRhc2hib2FyZCBkZXRhaWxzIGJlY2F1c2Ugbm90IGFsbCBjb2RlXG4gICAgICAgIC8vIHRoYXQgcmVuZGVycyB0aGlzIGNvbXBvbmVudCBoYXZlIGFsbCB0aGUgdmFsdWVzIHdlIG5lZWQuXG4gICAgICAgIC8vIEF0IHNvbWUgcG9pbnQgd2hlbiB3ZSBoYXZlIGEgbW9yZSBjb25zaXN0ZW50IGZyb250ZW5kXG4gICAgICAgIC8vIGRhdGFtb2RlbCwgdGhlIGRhc2hib2FyZCBjb3VsZCBwcm9iYWJseSBqdXN0IGJlIHBhc3NlZCBhcyBhIHByb3AuXG4gICAgICAgIFN1cGVyc2V0Q2xpZW50LmdldCh7XG4gICAgICAgICAgICBlbmRwb2ludDogYC9hcGkvdjEvZGFzaGJvYXJkLyR7ZGFzaGJvYXJkSWR9YCxcbiAgICAgICAgfSkudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBkYXNoYm9hcmQgPSByZXNwb25zZS5qc29uLnJlc3VsdDtcbiAgICAgICAgICAgIGNvbnN0IGpzb25NZXRhZGF0YU9iaiA9IGRhc2hib2FyZC5qc29uX21ldGFkYXRhPy5sZW5ndGhcbiAgICAgICAgICAgICAgICA/IEpTT04ucGFyc2UoZGFzaGJvYXJkLmpzb25fbWV0YWRhdGEpXG4gICAgICAgICAgICAgICAgOiB7fTtcbiAgICAgICAgICAgIGhhbmRsZURhc2hib2FyZERhdGEoe1xuICAgICAgICAgICAgICAgIC4uLmRhc2hib2FyZCxcbiAgICAgICAgICAgICAgICBtZXRhZGF0YToganNvbk1ldGFkYXRhT2JqLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICAgICAgICB9LCBoYW5kbGVFcnJvclJlc3BvbnNlKTtcbiAgICB9LCBbZGFzaGJvYXJkSWQsIGhhbmRsZURhc2hib2FyZERhdGFdKTtcbiAgICBjb25zdCBnZXRKc29uTWV0YWRhdGEgPSAoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBqc29uTWV0YWRhdGFPYmogPSBqc29uTWV0YWRhdGE/Lmxlbmd0aFxuICAgICAgICAgICAgICAgID8gSlNPTi5wYXJzZShqc29uTWV0YWRhdGEpXG4gICAgICAgICAgICAgICAgOiB7fTtcbiAgICAgICAgICAgIHJldHVybiBqc29uTWV0YWRhdGFPYmo7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKF8pIHtcbiAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3QgaGFuZGxlT25DaGFuZ2VPd25lcnMgPSAob3duZXJzKSA9PiB7XG4gICAgICAgIGNvbnN0IHBhcnNlZE93bmVycyA9IGVuc3VyZUlzQXJyYXkob3duZXJzKS5tYXAobyA9PiAoe1xuICAgICAgICAgICAgaWQ6IG8udmFsdWUsXG4gICAgICAgICAgICBmdWxsX25hbWU6IG8ubGFiZWwsXG4gICAgICAgIH0pKTtcbiAgICAgICAgc2V0T3duZXJzKHBhcnNlZE93bmVycyk7XG4gICAgfTtcbiAgICBjb25zdCBoYW5kbGVPbkNoYW5nZVJvbGVzID0gKHJvbGVzKSA9PiB7XG4gICAgICAgIGNvbnN0IHBhcnNlZFJvbGVzID0gZW5zdXJlSXNBcnJheShyb2xlcykubWFwKHIgPT4gKHtcbiAgICAgICAgICAgIGlkOiByLnZhbHVlLFxuICAgICAgICAgICAgbmFtZTogci5sYWJlbCxcbiAgICAgICAgfSkpO1xuICAgICAgICBzZXRSb2xlcyhwYXJzZWRSb2xlcyk7XG4gICAgfTtcbiAgICBjb25zdCBoYW5kbGVPd25lcnNTZWxlY3RWYWx1ZSA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgcGFyc2VkT3duZXJzID0gKG93bmVycyB8fCBbXSkubWFwKChvd25lcikgPT4gKHtcbiAgICAgICAgICAgIHZhbHVlOiBvd25lci5pZCxcbiAgICAgICAgICAgIGxhYmVsOiBvd25lci5mdWxsX25hbWUgfHwgYCR7b3duZXIuZmlyc3RfbmFtZX0gJHtvd25lci5sYXN0X25hbWV9YCxcbiAgICAgICAgfSkpO1xuICAgICAgICByZXR1cm4gcGFyc2VkT3duZXJzO1xuICAgIH07XG4gICAgY29uc3QgaGFuZGxlUm9sZXNTZWxlY3RWYWx1ZSA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgcGFyc2VkUm9sZXMgPSAocm9sZXMgfHwgW10pLm1hcCgocm9sZSkgPT4gKHtcbiAgICAgICAgICAgIHZhbHVlOiByb2xlLmlkLFxuICAgICAgICAgICAgbGFiZWw6IGAke3JvbGUubmFtZX1gLFxuICAgICAgICB9KSk7XG4gICAgICAgIHJldHVybiBwYXJzZWRSb2xlcztcbiAgICB9O1xuICAgIGNvbnN0IG9uQ29sb3JTY2hlbWVDaGFuZ2UgPSAoY29sb3JTY2hlbWUgPSAnJywgeyB1cGRhdGVNZXRhZGF0YSA9IHRydWUgfSA9IHt9KSA9PiB7XG4gICAgICAgIC8vIGNoZWNrIHRoYXQgY29sb3Jfc2NoZW1lIGlzIHZhbGlkXG4gICAgICAgIGNvbnN0IGNvbG9yQ2hvaWNlcyA9IGNhdGVnb3JpY2FsU2NoZW1lUmVnaXN0cnkua2V5cygpO1xuICAgICAgICBjb25zdCBqc29uTWV0YWRhdGFPYmogPSBnZXRKc29uTWV0YWRhdGEoKTtcbiAgICAgICAgLy8gb25seSBmaXJlIGlmIHRoZSBjb2xvcl9zY2hlbWUgaXMgcHJlc2VudCBhbmQgaW52YWxpZFxuICAgICAgICBpZiAoY29sb3JTY2hlbWUgJiYgIWNvbG9yQ2hvaWNlcy5pbmNsdWRlcyhjb2xvclNjaGVtZSkpIHtcbiAgICAgICAgICAgIE1vZGFsLmVycm9yKHtcbiAgICAgICAgICAgICAgICB0aXRsZTogdCgnRXJyb3InKSxcbiAgICAgICAgICAgICAgICBjb250ZW50OiB0KCdBIHZhbGlkIGNvbG9yIHNjaGVtZSBpcyByZXF1aXJlZCcpLFxuICAgICAgICAgICAgICAgIG9rQnV0dG9uUHJvcHM6IHsgZGFuZ2VyOiB0cnVlLCBjbGFzc05hbWU6ICdidG4tZGFuZ2VyJyB9LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0EgdmFsaWQgY29sb3Igc2NoZW1lIGlzIHJlcXVpcmVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gdXBkYXRlIG1ldGFkYXRhIHRvIG1hdGNoIHNlbGVjdGlvblxuICAgICAgICBpZiAodXBkYXRlTWV0YWRhdGEpIHtcbiAgICAgICAgICAgIGpzb25NZXRhZGF0YU9iai5jb2xvcl9zY2hlbWUgPSBjb2xvclNjaGVtZTtcbiAgICAgICAgICAgIGpzb25NZXRhZGF0YU9iai5sYWJlbF9jb2xvcnMgPSBqc29uTWV0YWRhdGFPYmoubGFiZWxfY29sb3JzIHx8IHt9O1xuICAgICAgICAgICAgc2V0SnNvbk1ldGFkYXRhKGpzb25TdHJpbmdpZnkoanNvbk1ldGFkYXRhT2JqKSk7XG4gICAgICAgIH1cbiAgICAgICAgc2V0Q29sb3JTY2hlbWUoY29sb3JTY2hlbWUpO1xuICAgIH07XG4gICAgY29uc3Qgb25GaW5pc2ggPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgdGl0bGUsIHNsdWcsIGNlcnRpZmllZEJ5LCBjZXJ0aWZpY2F0aW9uRGV0YWlscyB9ID0gZm9ybS5nZXRGaWVsZHNWYWx1ZSgpO1xuICAgICAgICBsZXQgY3VycmVudENvbG9yU2NoZW1lID0gY29sb3JTY2hlbWU7XG4gICAgICAgIGxldCBjb2xvck5hbWVzcGFjZSA9ICcnO1xuICAgICAgICBsZXQgY3VycmVudEpzb25NZXRhZGF0YSA9IGpzb25NZXRhZGF0YTtcbiAgICAgICAgLy8gdmFsaWRhdGUgY3VycmVudEpzb25NZXRhZGF0YVxuICAgICAgICBsZXQgbWV0YWRhdGE7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoIWN1cnJlbnRKc29uTWV0YWRhdGEuc3RhcnRzV2l0aCgneycpIHx8XG4gICAgICAgICAgICAgICAgIWN1cnJlbnRKc29uTWV0YWRhdGEuZW5kc1dpdGgoJ30nKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbWV0YWRhdGEgPSBKU09OLnBhcnNlKGN1cnJlbnRKc29uTWV0YWRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgYWRkRGFuZ2VyVG9hc3QodCgnSlNPTiBtZXRhZGF0YSBpcyBpbnZhbGlkIScpKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBjb2xvciBzY2hlbWUgaW4ganNvbiBtZXRhZGF0YSBoYXMgcHJlY2VkZW5jZSBvdmVyIHNlbGVjdGlvblxuICAgICAgICBjdXJyZW50Q29sb3JTY2hlbWUgPSBtZXRhZGF0YT8uY29sb3Jfc2NoZW1lIHx8IGNvbG9yU2NoZW1lO1xuICAgICAgICBjb2xvck5hbWVzcGFjZSA9IG1ldGFkYXRhPy5jb2xvcl9uYW1lc3BhY2U7XG4gICAgICAgIC8vIGZpbHRlciBzaGFyZWRfbGFiZWxfY29sb3IgZnJvbSB1c2VyIGlucHV0XG4gICAgICAgIGlmIChtZXRhZGF0YT8uc2hhcmVkX2xhYmVsX2NvbG9ycykge1xuICAgICAgICAgICAgZGVsZXRlIG1ldGFkYXRhLnNoYXJlZF9sYWJlbF9jb2xvcnM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1ldGFkYXRhPy5jb2xvcl9zY2hlbWVfZG9tYWluKSB7XG4gICAgICAgICAgICBkZWxldGUgbWV0YWRhdGEuY29sb3Jfc2NoZW1lX2RvbWFpbjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzaGFyZWRMYWJlbENvbG9yID0gZ2V0U2hhcmVkTGFiZWxDb2xvcigpO1xuICAgICAgICBjb25zdCBjYXRlZ29yaWNhbE5hbWVzcGFjZSA9IENhdGVnb3JpY2FsQ29sb3JOYW1lc3BhY2UuZ2V0TmFtZXNwYWNlKGNvbG9yTmFtZXNwYWNlKTtcbiAgICAgICAgY2F0ZWdvcmljYWxOYW1lc3BhY2UucmVzZXRDb2xvcnMoKTtcbiAgICAgICAgaWYgKGN1cnJlbnRDb2xvclNjaGVtZSkge1xuICAgICAgICAgICAgc2hhcmVkTGFiZWxDb2xvci51cGRhdGVDb2xvck1hcChjb2xvck5hbWVzcGFjZSwgY3VycmVudENvbG9yU2NoZW1lKTtcbiAgICAgICAgICAgIG1ldGFkYXRhLnNoYXJlZF9sYWJlbF9jb2xvcnMgPSBPYmplY3QuZnJvbUVudHJpZXMoc2hhcmVkTGFiZWxDb2xvci5nZXRDb2xvck1hcCgpKTtcbiAgICAgICAgICAgIG1ldGFkYXRhLmNvbG9yX3NjaGVtZV9kb21haW4gPVxuICAgICAgICAgICAgICAgIGNhdGVnb3JpY2FsU2NoZW1lUmVnaXN0cnkuZ2V0KGNvbG9yU2NoZW1lKT8uY29sb3JzIHx8IFtdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc2hhcmVkTGFiZWxDb2xvci5yZXNldCgpO1xuICAgICAgICAgICAgbWV0YWRhdGEuc2hhcmVkX2xhYmVsX2NvbG9ycyA9IHt9O1xuICAgICAgICAgICAgbWV0YWRhdGEuY29sb3Jfc2NoZW1lX2RvbWFpbiA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIGN1cnJlbnRKc29uTWV0YWRhdGEgPSBqc29uU3RyaW5naWZ5KG1ldGFkYXRhKTtcbiAgICAgICAgb25Db2xvclNjaGVtZUNoYW5nZShjdXJyZW50Q29sb3JTY2hlbWUsIHtcbiAgICAgICAgICAgIHVwZGF0ZU1ldGFkYXRhOiBmYWxzZSxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IG1vcmVPblN1Ym1pdFByb3BzID0ge307XG4gICAgICAgIGNvbnN0IG1vcmVQdXRQcm9wcyA9IHt9O1xuICAgICAgICBpZiAoaXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5EYXNoYm9hcmRSYmFjKSkge1xuICAgICAgICAgICAgbW9yZU9uU3VibWl0UHJvcHMucm9sZXMgPSByb2xlcztcbiAgICAgICAgICAgIG1vcmVQdXRQcm9wcy5yb2xlcyA9IChyb2xlcyB8fCBbXSkubWFwKHIgPT4gci5pZCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuVGFnZ2luZ1N5c3RlbSkpIHtcbiAgICAgICAgICAgIG1vcmVQdXRQcm9wcy50YWdzID0gdGFncy5tYXAodGFnID0+IHRhZy5pZCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgb25TdWJtaXRQcm9wcyA9IHtcbiAgICAgICAgICAgIGlkOiBkYXNoYm9hcmRJZCxcbiAgICAgICAgICAgIHRpdGxlLFxuICAgICAgICAgICAgc2x1ZyxcbiAgICAgICAgICAgIGpzb25NZXRhZGF0YTogY3VycmVudEpzb25NZXRhZGF0YSxcbiAgICAgICAgICAgIG93bmVycyxcbiAgICAgICAgICAgIGNvbG9yU2NoZW1lOiBjdXJyZW50Q29sb3JTY2hlbWUsXG4gICAgICAgICAgICBjb2xvck5hbWVzcGFjZSxcbiAgICAgICAgICAgIGNlcnRpZmllZEJ5LFxuICAgICAgICAgICAgY2VydGlmaWNhdGlvbkRldGFpbHMsXG4gICAgICAgICAgICAuLi5tb3JlT25TdWJtaXRQcm9wcyxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKG9ubHlBcHBseSkge1xuICAgICAgICAgICAgb25TdWJtaXQob25TdWJtaXRQcm9wcyk7XG4gICAgICAgICAgICBvbkhpZGUoKTtcbiAgICAgICAgICAgIGFkZFN1Y2Nlc3NUb2FzdCh0KCdEYXNoYm9hcmQgcHJvcGVydGllcyB1cGRhdGVkJykpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgU3VwZXJzZXRDbGllbnQucHV0KHtcbiAgICAgICAgICAgICAgICBlbmRwb2ludDogYC9hcGkvdjEvZGFzaGJvYXJkLyR7ZGFzaGJvYXJkSWR9YCxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgIGRhc2hib2FyZF90aXRsZTogdGl0bGUsXG4gICAgICAgICAgICAgICAgICAgIHNsdWc6IHNsdWcgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICAgICAganNvbl9tZXRhZGF0YTogY3VycmVudEpzb25NZXRhZGF0YSB8fCBudWxsLFxuICAgICAgICAgICAgICAgICAgICBvd25lcnM6IChvd25lcnMgfHwgW10pLm1hcChvID0+IG8uaWQpLFxuICAgICAgICAgICAgICAgICAgICBjZXJ0aWZpZWRfYnk6IGNlcnRpZmllZEJ5IHx8IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIGNlcnRpZmljYXRpb25fZGV0YWlsczogY2VydGlmaWVkQnkgJiYgY2VydGlmaWNhdGlvbkRldGFpbHMgPyBjZXJ0aWZpY2F0aW9uRGV0YWlscyA6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIC4uLm1vcmVQdXRQcm9wcyxcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIH0pLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIG9uU3VibWl0KG9uU3VibWl0UHJvcHMpO1xuICAgICAgICAgICAgICAgIG9uSGlkZSgpO1xuICAgICAgICAgICAgICAgIGFkZFN1Y2Nlc3NUb2FzdCh0KCdUaGUgZGFzaGJvYXJkIGhhcyBiZWVuIHNhdmVkJykpO1xuICAgICAgICAgICAgfSwgaGFuZGxlRXJyb3JSZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IGdldFJvd3NXaXRob3V0Um9sZXMgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGpzb25NZXRhZGF0YU9iaiA9IGdldEpzb25NZXRhZGF0YSgpO1xuICAgICAgICBjb25zdCBoYXNDdXN0b21MYWJlbENvbG9ycyA9ICEhT2JqZWN0LmtleXMoanNvbk1ldGFkYXRhT2JqPy5sYWJlbF9jb2xvcnMgfHwge30pLmxlbmd0aDtcbiAgICAgICAgcmV0dXJuICg8Um93IGd1dHRlcj17MTZ9PlxuICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICA8aDMgc3R5bGU9e3sgbWFyZ2luVG9wOiAnMWVtJyB9fT57dCgnQWNjZXNzJyl9PC9oMz5cbiAgICAgICAgICA8U3R5bGVkRm9ybUl0ZW0gbGFiZWw9e3QoJ093bmVycycpfT5cbiAgICAgICAgICAgIDxBc3luY1NlbGVjdCBhbGxvd0NsZWFyIGFyaWFMYWJlbD17dCgnT3duZXJzJyl9IGRpc2FibGVkPXtpc0xvYWRpbmd9IG1vZGU9XCJtdWx0aXBsZVwiIG9uQ2hhbmdlPXtoYW5kbGVPbkNoYW5nZU93bmVyc30gb3B0aW9ucz17KGlucHV0LCBwYWdlLCBwYWdlU2l6ZSkgPT4gbG9hZEFjY2Vzc09wdGlvbnMoJ293bmVycycsIGlucHV0LCBwYWdlLCBwYWdlU2l6ZSl9IHZhbHVlPXtoYW5kbGVPd25lcnNTZWxlY3RWYWx1ZSgpfS8+XG4gICAgICAgICAgPC9TdHlsZWRGb3JtSXRlbT5cbiAgICAgICAgICA8cCBjbGFzc05hbWU9XCJoZWxwLWJsb2NrXCI+XG4gICAgICAgICAgICB7dCgnT3duZXJzIGlzIGEgbGlzdCBvZiB1c2VycyB3aG8gY2FuIGFsdGVyIHRoZSBkYXNoYm9hcmQuIFNlYXJjaGFibGUgYnkgbmFtZSBvciB1c2VybmFtZS4nKX1cbiAgICAgICAgICA8L3A+XG4gICAgICAgIDwvQ29sPlxuICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICA8aDMgc3R5bGU9e3sgbWFyZ2luVG9wOiAnMWVtJyB9fT57dCgnQ29sb3JzJyl9PC9oMz5cbiAgICAgICAgICA8Q29sb3JTY2hlbWVDb250cm9sV3JhcHBlciBoYXNDdXN0b21MYWJlbENvbG9ycz17aGFzQ3VzdG9tTGFiZWxDb2xvcnN9IG9uQ2hhbmdlPXtvbkNvbG9yU2NoZW1lQ2hhbmdlfSBjb2xvclNjaGVtZT17Y29sb3JTY2hlbWV9IGxhYmVsTWFyZ2luPXs0fS8+XG4gICAgICAgIDwvQ29sPlxuICAgICAgPC9Sb3c+KTtcbiAgICB9O1xuICAgIGNvbnN0IGdldFJvd3NXaXRoUm9sZXMgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGpzb25NZXRhZGF0YU9iaiA9IGdldEpzb25NZXRhZGF0YSgpO1xuICAgICAgICBjb25zdCBoYXNDdXN0b21MYWJlbENvbG9ycyA9ICEhT2JqZWN0LmtleXMoanNvbk1ldGFkYXRhT2JqPy5sYWJlbF9jb2xvcnMgfHwge30pLmxlbmd0aDtcbiAgICAgICAgcmV0dXJuICg8PlxuICAgICAgICA8Um93PlxuICAgICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MjR9PlxuICAgICAgICAgICAgPGgzIHN0eWxlPXt7IG1hcmdpblRvcDogJzFlbScgfX0+e3QoJ0FjY2VzcycpfTwvaDM+XG4gICAgICAgICAgPC9Db2w+XG4gICAgICAgIDwvUm93PlxuICAgICAgICA8Um93IGd1dHRlcj17MTZ9PlxuICAgICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MTJ9PlxuICAgICAgICAgICAgPFN0eWxlZEZvcm1JdGVtIGxhYmVsPXt0KCdPd25lcnMnKX0+XG4gICAgICAgICAgICAgIDxBc3luY1NlbGVjdCBhbGxvd0NsZWFyIGFsbG93TmV3T3B0aW9ucyBhcmlhTGFiZWw9e3QoJ093bmVycycpfSBkaXNhYmxlZD17aXNMb2FkaW5nfSBtb2RlPVwibXVsdGlwbGVcIiBvbkNoYW5nZT17aGFuZGxlT25DaGFuZ2VPd25lcnN9IG9wdGlvbnM9eyhpbnB1dCwgcGFnZSwgcGFnZVNpemUpID0+IGxvYWRBY2Nlc3NPcHRpb25zKCdvd25lcnMnLCBpbnB1dCwgcGFnZSwgcGFnZVNpemUpfSB2YWx1ZT17aGFuZGxlT3duZXJzU2VsZWN0VmFsdWUoKX0vPlxuICAgICAgICAgICAgPC9TdHlsZWRGb3JtSXRlbT5cbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImhlbHAtYmxvY2tcIj5cbiAgICAgICAgICAgICAge3QoJ093bmVycyBpcyBhIGxpc3Qgb2YgdXNlcnMgd2hvIGNhbiBhbHRlciB0aGUgZGFzaGJvYXJkLiBTZWFyY2hhYmxlIGJ5IG5hbWUgb3IgdXNlcm5hbWUuJyl9XG4gICAgICAgICAgICA8L3A+XG4gICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICA8U3R5bGVkRm9ybUl0ZW0gbGFiZWw9e3QoJ1JvbGVzJyl9PlxuICAgICAgICAgICAgICA8QXN5bmNTZWxlY3QgYWxsb3dDbGVhciBhcmlhTGFiZWw9e3QoJ1JvbGVzJyl9IGRpc2FibGVkPXtpc0xvYWRpbmd9IG1vZGU9XCJtdWx0aXBsZVwiIG9uQ2hhbmdlPXtoYW5kbGVPbkNoYW5nZVJvbGVzfSBvcHRpb25zPXsoaW5wdXQsIHBhZ2UsIHBhZ2VTaXplKSA9PiBsb2FkQWNjZXNzT3B0aW9ucygncm9sZXMnLCBpbnB1dCwgcGFnZSwgcGFnZVNpemUpfSB2YWx1ZT17aGFuZGxlUm9sZXNTZWxlY3RWYWx1ZSgpfS8+XG4gICAgICAgICAgICA8L1N0eWxlZEZvcm1JdGVtPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwiaGVscC1ibG9ja1wiPlxuICAgICAgICAgICAgICB7dCgnUm9sZXMgaXMgYSBsaXN0IHdoaWNoIGRlZmluZXMgYWNjZXNzIHRvIHRoZSBkYXNoYm9hcmQuIEdyYW50aW5nIGEgcm9sZSBhY2Nlc3MgdG8gYSBkYXNoYm9hcmQgd2lsbCBieXBhc3MgZGF0YXNldCBsZXZlbCBjaGVja3MuIElmIG5vIHJvbGVzIGFyZSBkZWZpbmVkLCByZWd1bGFyIGFjY2VzcyBwZXJtaXNzaW9ucyBhcHBseS4nKX1cbiAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICA8L0NvbD5cbiAgICAgICAgPC9Sb3c+XG4gICAgICAgIDxSb3c+XG4gICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICA8Q29sb3JTY2hlbWVDb250cm9sV3JhcHBlciBoYXNDdXN0b21MYWJlbENvbG9ycz17aGFzQ3VzdG9tTGFiZWxDb2xvcnN9IG9uQ2hhbmdlPXtvbkNvbG9yU2NoZW1lQ2hhbmdlfSBjb2xvclNjaGVtZT17Y29sb3JTY2hlbWV9IGxhYmVsTWFyZ2luPXs0fS8+XG4gICAgICAgICAgPC9Db2w+XG4gICAgICAgIDwvUm93PlxuICAgICAgPC8+KTtcbiAgICB9O1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGlmIChzaG93KSB7XG4gICAgICAgICAgICBpZiAoIWN1cnJlbnREYXNoYm9hcmRJbmZvKSB7XG4gICAgICAgICAgICAgICAgZmV0Y2hEYXNoYm9hcmREZXRhaWxzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBoYW5kbGVEYXNoYm9hcmREYXRhKGN1cnJlbnREYXNoYm9hcmRJbmZvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBKc29uRWRpdG9yLnByZWxvYWQoKTtcbiAgICB9LCBbY3VycmVudERhc2hib2FyZEluZm8sIGZldGNoRGFzaGJvYXJkRGV0YWlscywgaGFuZGxlRGFzaGJvYXJkRGF0YSwgc2hvd10pO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIC8vIHRoZSB0aXRsZSBjYW4gYmUgY2hhbmdlZCBpbmxpbmUgaW4gdGhlIGRhc2hib2FyZCwgdGhpcyBjYXRjaGVzIGl0XG4gICAgICAgIGlmIChkYXNoYm9hcmRUaXRsZSAmJlxuICAgICAgICAgICAgZGFzaGJvYXJkSW5mbyAmJlxuICAgICAgICAgICAgZGFzaGJvYXJkSW5mby50aXRsZSAhPT0gZGFzaGJvYXJkVGl0bGUpIHtcbiAgICAgICAgICAgIGZvcm0uc2V0RmllbGRzVmFsdWUoe1xuICAgICAgICAgICAgICAgIC4uLmRhc2hib2FyZEluZm8sXG4gICAgICAgICAgICAgICAgdGl0bGU6IGRhc2hib2FyZFRpdGxlLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LCBbZGFzaGJvYXJkSW5mbywgZGFzaGJvYXJkVGl0bGUsIGZvcm1dKTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAoIWlzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuVGFnZ2luZ1N5c3RlbSkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBmZXRjaFRhZ3Moe1xuICAgICAgICAgICAgICAgIG9iamVjdFR5cGU6IE9CSkVDVF9UWVBFUy5EQVNIQk9BUkQsXG4gICAgICAgICAgICAgICAgb2JqZWN0SWQ6IGRhc2hib2FyZElkLFxuICAgICAgICAgICAgICAgIGluY2x1ZGVUeXBlczogZmFsc2UsXG4gICAgICAgICAgICB9LCAodGFncykgPT4gc2V0VGFncyh0YWdzKSwgKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgYWRkRGFuZ2VyVG9hc3QoYEVycm9yIGZldGNoaW5nIHRhZ3M6ICR7ZXJyb3IudGV4dH1gKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgaGFuZGxlRXJyb3JSZXNwb25zZShlcnJvcik7XG4gICAgICAgIH1cbiAgICB9LCBbZGFzaGJvYXJkSWRdKTtcbiAgICBjb25zdCBoYW5kbGVDaGFuZ2VUYWdzID0gKHRhZ3MpID0+IHtcbiAgICAgICAgY29uc3QgcGFyc2VkVGFncyA9IGVuc3VyZUlzQXJyYXkodGFncykubWFwKHIgPT4gKHtcbiAgICAgICAgICAgIGlkOiByLnZhbHVlLFxuICAgICAgICAgICAgbmFtZTogci5sYWJlbCxcbiAgICAgICAgfSkpO1xuICAgICAgICBzZXRUYWdzKHBhcnNlZFRhZ3MpO1xuICAgIH07XG4gICAgcmV0dXJuICg8TW9kYWwgc2hvdz17c2hvd30gb25IaWRlPXtvbkhpZGV9IHRpdGxlPXt0KCdEYXNoYm9hcmQgcHJvcGVydGllcycpfSBmb290ZXI9ezw+XG4gICAgICAgICAgPEJ1dHRvbiBodG1sVHlwZT1cImJ1dHRvblwiIGJ1dHRvblNpemU9XCJzbWFsbFwiIG9uQ2xpY2s9e29uSGlkZX0gZGF0YS10ZXN0PVwicHJvcGVydGllcy1tb2RhbC1jYW5jZWwtYnV0dG9uXCIgY3RhPlxuICAgICAgICAgICAge3QoJ0NhbmNlbCcpfVxuICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgIDxCdXR0b24gZGF0YS10ZXN0PVwicHJvcGVydGllcy1tb2RhbC1hcHBseS1idXR0b25cIiBvbkNsaWNrPXtmb3JtLnN1Ym1pdH0gYnV0dG9uU2l6ZT1cInNtYWxsXCIgYnV0dG9uU3R5bGU9XCJwcmltYXJ5XCIgY2xhc3NOYW1lPVwibS1yLTVcIiBjdGEgZGlzYWJsZWQ9e2Rhc2hib2FyZEluZm8/LmlzTWFuYWdlZEV4dGVybmFsbHl9IHRvb2x0aXA9e2Rhc2hib2FyZEluZm8/LmlzTWFuYWdlZEV4dGVybmFsbHlcbiAgICAgICAgICAgICAgICA/IHQoXCJUaGlzIGRhc2hib2FyZCBpcyBtYW5hZ2VkIGV4dGVybmFsbHksIGFuZCBjYW4ndCBiZSBlZGl0ZWQgaW4gU3VwZXJzZXRcIilcbiAgICAgICAgICAgICAgICA6ICcnfT5cbiAgICAgICAgICAgIHtzYXZlTGFiZWx9XG4gICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgIDwvPn0gcmVzcG9uc2l2ZT5cbiAgICAgIDxBbnRkRm9ybSBmb3JtPXtmb3JtfSBvbkZpbmlzaD17b25GaW5pc2h9IGRhdGEtdGVzdD1cImRhc2hib2FyZC1lZGl0LXByb3BlcnRpZXMtZm9ybVwiIGxheW91dD1cInZlcnRpY2FsXCIgaW5pdGlhbFZhbHVlcz17ZGFzaGJvYXJkSW5mb30+XG4gICAgICAgIDxSb3c+XG4gICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsyNH0+XG4gICAgICAgICAgICA8aDM+e3QoJ0Jhc2ljIGluZm9ybWF0aW9uJyl9PC9oMz5cbiAgICAgICAgICA8L0NvbD5cbiAgICAgICAgPC9Sb3c+XG4gICAgICAgIDxSb3cgZ3V0dGVyPXsxNn0+XG4gICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICA8Rm9ybUl0ZW0gbGFiZWw9e3QoJ05hbWUnKX0gbmFtZT1cInRpdGxlXCI+XG4gICAgICAgICAgICAgIDxJbnB1dCBkYXRhLXRlc3Q9XCJkYXNoYm9hcmQtdGl0bGUtaW5wdXRcIiB0eXBlPVwidGV4dFwiIGRpc2FibGVkPXtpc0xvYWRpbmd9Lz5cbiAgICAgICAgICAgIDwvRm9ybUl0ZW0+XG4gICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICA8U3R5bGVkRm9ybUl0ZW0gbGFiZWw9e3QoJ1VSTCBzbHVnJyl9IG5hbWU9XCJzbHVnXCI+XG4gICAgICAgICAgICAgIDxJbnB1dCB0eXBlPVwidGV4dFwiIGRpc2FibGVkPXtpc0xvYWRpbmd9Lz5cbiAgICAgICAgICAgIDwvU3R5bGVkRm9ybUl0ZW0+XG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJoZWxwLWJsb2NrXCI+XG4gICAgICAgICAgICAgIHt0KCdBIHJlYWRhYmxlIFVSTCBmb3IgeW91ciBkYXNoYm9hcmQnKX1cbiAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICA8L0NvbD5cbiAgICAgICAgPC9Sb3c+XG4gICAgICAgIHtpc0ZlYXR1cmVFbmFibGVkKEZlYXR1cmVGbGFnLkRhc2hib2FyZFJiYWMpXG4gICAgICAgICAgICA/IGdldFJvd3NXaXRoUm9sZXMoKVxuICAgICAgICAgICAgOiBnZXRSb3dzV2l0aG91dFJvbGVzKCl9XG4gICAgICAgIDxSb3c+XG4gICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsyNH0+XG4gICAgICAgICAgICA8aDM+e3QoJ0NlcnRpZmljYXRpb24nKX08L2gzPlxuICAgICAgICAgIDwvQ29sPlxuICAgICAgICA8L1Jvdz5cbiAgICAgICAgPFJvdyBndXR0ZXI9ezE2fT5cbiAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgIDxTdHlsZWRGb3JtSXRlbSBsYWJlbD17dCgnQ2VydGlmaWVkIGJ5Jyl9IG5hbWU9XCJjZXJ0aWZpZWRCeVwiPlxuICAgICAgICAgICAgICA8SW5wdXQgdHlwZT1cInRleHRcIiBkaXNhYmxlZD17aXNMb2FkaW5nfS8+XG4gICAgICAgICAgICA8L1N0eWxlZEZvcm1JdGVtPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwiaGVscC1ibG9ja1wiPlxuICAgICAgICAgICAgICB7dCgnUGVyc29uIG9yIGdyb3VwIHRoYXQgaGFzIGNlcnRpZmllZCB0aGlzIGRhc2hib2FyZC4nKX1cbiAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgIDxTdHlsZWRGb3JtSXRlbSBsYWJlbD17dCgnQ2VydGlmaWNhdGlvbiBkZXRhaWxzJyl9IG5hbWU9XCJjZXJ0aWZpY2F0aW9uRGV0YWlsc1wiPlxuICAgICAgICAgICAgICA8SW5wdXQgdHlwZT1cInRleHRcIiBkaXNhYmxlZD17aXNMb2FkaW5nfS8+XG4gICAgICAgICAgICA8L1N0eWxlZEZvcm1JdGVtPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwiaGVscC1ibG9ja1wiPlxuICAgICAgICAgICAgICB7dCgnQW55IGFkZGl0aW9uYWwgZGV0YWlsIHRvIHNob3cgaW4gdGhlIGNlcnRpZmljYXRpb24gdG9vbHRpcC4nKX1cbiAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICA8L0NvbD5cbiAgICAgICAgPC9Sb3c+XG4gICAgICAgIHtpc0ZlYXR1cmVFbmFibGVkKEZlYXR1cmVGbGFnLlRhZ2dpbmdTeXN0ZW0pID8gKDxSb3cgZ3V0dGVyPXsxNn0+XG4gICAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgICAgPGgzIGNzcz17eyBtYXJnaW5Ub3A6ICcxZW0nIH19Pnt0KCdUYWdzJyl9PC9oMz5cbiAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgIDwvUm93PikgOiBudWxsfVxuICAgICAgICB7aXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5UYWdnaW5nU3lzdGVtKSA/ICg8Um93IGd1dHRlcj17MTZ9PlxuICAgICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICAgIDxTdHlsZWRGb3JtSXRlbT5cbiAgICAgICAgICAgICAgICA8QXN5bmNTZWxlY3QgYXJpYUxhYmVsPVwiVGFnc1wiIG1vZGU9XCJtdWx0aXBsZVwiIHZhbHVlPXt0YWdzQXNTZWxlY3RWYWx1ZXN9IG9wdGlvbnM9e2xvYWRUYWdzfSBvbkNoYW5nZT17aGFuZGxlQ2hhbmdlVGFnc30gYWxsb3dDbGVhci8+XG4gICAgICAgICAgICAgIDwvU3R5bGVkRm9ybUl0ZW0+XG4gICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImhlbHAtYmxvY2tcIj5cbiAgICAgICAgICAgICAgICB7dCgnQSBsaXN0IG9mIHRhZ3MgdGhhdCBoYXZlIGJlZW4gYXBwbGllZCB0byB0aGlzIGNoYXJ0LicpfVxuICAgICAgICAgICAgICA8L3A+XG4gICAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICA8L1Jvdz4pIDogbnVsbH1cbiAgICAgICAgPFJvdz5cbiAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezI0fT5cbiAgICAgICAgICAgIDxoMyBzdHlsZT17eyBtYXJnaW5Ub3A6ICcxZW0nIH19PlxuICAgICAgICAgICAgICA8QnV0dG9uIGJ1dHRvblN0eWxlPVwibGlua1wiIG9uQ2xpY2s9eygpID0+IHNldElzQWR2YW5jZWRPcGVuKCFpc0FkdmFuY2VkT3Blbil9PlxuICAgICAgICAgICAgICAgIDxpIGNsYXNzTmFtZT17YGZhIGZhLWFuZ2xlLSR7aXNBZHZhbmNlZE9wZW4gPyAnZG93bicgOiAncmlnaHQnfWB9IHN0eWxlPXt7IG1pbldpZHRoOiAnMWVtJyB9fS8+XG4gICAgICAgICAgICAgICAge3QoJ0FkdmFuY2VkJyl9XG4gICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgPC9oMz5cbiAgICAgICAgICAgIHtpc0FkdmFuY2VkT3BlbiAmJiAoPD5cbiAgICAgICAgICAgICAgICA8U3R5bGVkRm9ybUl0ZW0gbGFiZWw9e3QoJ0pTT04gbWV0YWRhdGEnKX0+XG4gICAgICAgICAgICAgICAgICA8U3R5bGVkSnNvbkVkaXRvciBzaG93TG9hZGluZ0ZvckltcG9ydCBuYW1lPVwianNvbl9tZXRhZGF0YVwiIHZhbHVlPXtqc29uTWV0YWRhdGF9IG9uQ2hhbmdlPXtzZXRKc29uTWV0YWRhdGF9IHRhYlNpemU9ezJ9IHdpZHRoPVwiMTAwJVwiIGhlaWdodD1cIjIwMHB4XCIgd3JhcEVuYWJsZWQvPlxuICAgICAgICAgICAgICAgIDwvU3R5bGVkRm9ybUl0ZW0+XG4gICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwiaGVscC1ibG9ja1wiPlxuICAgICAgICAgICAgICAgICAge3QoJ1RoaXMgSlNPTiBvYmplY3QgaXMgZ2VuZXJhdGVkIGR5bmFtaWNhbGx5IHdoZW4gY2xpY2tpbmcgdGhlIHNhdmUgb3Igb3ZlcndyaXRlIGJ1dHRvbiBpbiB0aGUgZGFzaGJvYXJkIHZpZXcuIEl0IGlzIGV4cG9zZWQgaGVyZSBmb3IgcmVmZXJlbmNlIGFuZCBmb3IgcG93ZXIgdXNlcnMgd2hvIG1heSB3YW50IHRvIGFsdGVyIHNwZWNpZmljIHBhcmFtZXRlcnMuJyl9XG4gICAgICAgICAgICAgICAgICB7b25seUFwcGx5ICYmICg8PlxuICAgICAgICAgICAgICAgICAgICAgIHsnICd9XG4gICAgICAgICAgICAgICAgICAgICAge3QoJ1BsZWFzZSBETyBOT1Qgb3ZlcndyaXRlIHRoZSBcImZpbHRlcl9zY29wZXNcIiBrZXkuJyl9eycgJ31cbiAgICAgICAgICAgICAgICAgICAgICA8RmlsdGVyU2NvcGVNb2RhbCB0cmlnZ2VyTm9kZT17PHNwYW4gY2xhc3NOYW1lPVwiYWxlcnQtbGlua1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0KCdVc2UgXCIlKG1lbnVOYW1lKXNcIiBtZW51IGluc3RlYWQuJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVudU5hbWU6IHQoJ1NldCBmaWx0ZXIgbWFwcGluZycpLFxuICAgICAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPn0vPlxuICAgICAgICAgICAgICAgICAgICA8Lz4pfVxuICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgPC8+KX1cbiAgICAgICAgICA8L0NvbD5cbiAgICAgICAgPC9Sb3c+XG4gICAgICA8L0FudGRGb3JtPlxuICAgIDwvTW9kYWw+KTtcbn07XG5leHBvcnQgZGVmYXVsdCB3aXRoVG9hc3RzKFByb3BlcnRpZXNNb2RhbCk7XG4iXX0= */\", toString: _EMOTION_STRINGIFIED_CSS_ERROR__ };\nconst PropertiesModal = ({ addSuccessToast, addDangerToast, colorScheme: currentColorScheme, dashboardId, dashboardInfo: currentDashboardInfo, dashboardTitle, onHide = () => {}, onlyApply = false, onSubmit = () => {}, show = false }) => {\n  const [form] = AntdForm.useForm();\n  const [isLoading, setIsLoading] = useState(false);\n  const [isAdvancedOpen, setIsAdvancedOpen] = useState(false);\n  const [colorScheme, setColorScheme] = useState(currentColorScheme);\n  const [jsonMetadata, setJsonMetadata] = useState('');\n  const [dashboardInfo, setDashboardInfo] = useState();\n  const [owners, setOwners] = useState([]);\n  const [roles, setRoles] = useState([]);\n  const saveLabel = onlyApply ? t('Apply') : t('Save');\n  const [tags, setTags] = useState([]);\n  const categoricalSchemeRegistry = getCategoricalSchemeRegistry();\n  const tagsAsSelectValues = useMemo(() => {\n    const selectTags = tags.map((tag) => ({\n      value: tag.id,\n      label: tag.name\n    }));\n    return selectTags;\n  }, [tags.length]);\n  const handleErrorResponse = async (response) => {\n    const { error, statusText, message } = await getClientErrorObject(response);\n    let errorText = error || statusText || t('An error has occurred');\n    if (typeof message === 'object' && 'json_metadata' in message) {\n      errorText = message.json_metadata;\n    } else\n    if (typeof message === 'string') {\n      errorText = message;\n      if (message === 'Forbidden') {\n        errorText = t('You do not have permission to edit this dashboard');\n      }\n    }\n    Modal.error({\n      title: t('Error'),\n      content: errorText,\n      okButtonProps: { danger: true, className: 'btn-danger' }\n    });\n  };\n  const loadAccessOptions = useCallback((accessType = 'owners', input = '', page, pageSize) => {\n    const query = rison.encode({\n      filter: input,\n      page,\n      page_size: pageSize\n    });\n    return SupersetClient.get({\n      endpoint: `/api/v1/dashboard/related/${accessType}?q=${query}`\n    }).then((response) => ({\n      data: response.json.result.\n      filter((item) => item.extra.active !== undefined ? item.extra.active : true).\n      map((item) => ({\n        value: item.value,\n        label: item.text\n      })),\n      totalCount: response.json.count\n    }));\n  }, []);\n  const handleDashboardData = useCallback((dashboardData) => {\n    const { id, dashboard_title, slug, certified_by, certification_details, owners, roles, metadata, is_managed_externally } = dashboardData;\n    const dashboardInfo = {\n      id,\n      title: dashboard_title,\n      slug: slug || '',\n      certifiedBy: certified_by || '',\n      certificationDetails: certification_details || '',\n      isManagedExternally: is_managed_externally || false\n    };\n    form.setFieldsValue(dashboardInfo);\n    setDashboardInfo(dashboardInfo);\n    setOwners(owners);\n    setRoles(roles);\n    setColorScheme(metadata.color_scheme);\n    const metaDataCopy = _omit(metadata, [\n    'positions',\n    'shared_label_colors',\n    'color_scheme_domain']\n    );\n    setJsonMetadata(metaDataCopy ? jsonStringify(metaDataCopy) : '');\n  }, [form]);\n  const fetchDashboardDetails = useCallback(() => {\n    setIsLoading(true);\n    // We fetch the dashboard details because not all code\n    // that renders this component have all the values we need.\n    // At some point when we have a more consistent frontend\n    // datamodel, the dashboard could probably just be passed as a prop.\n    SupersetClient.get({\n      endpoint: `/api/v1/dashboard/${dashboardId}`\n    }).then((response) => {var _dashboard$json_metad;\n      const dashboard = response.json.result;\n      const jsonMetadataObj = (_dashboard$json_metad = dashboard.json_metadata) != null && _dashboard$json_metad.length ?\n      JSON.parse(dashboard.json_metadata) :\n      {};\n      handleDashboardData({\n        ...dashboard,\n        metadata: jsonMetadataObj\n      });\n      setIsLoading(false);\n    }, handleErrorResponse);\n  }, [dashboardId, handleDashboardData]);\n  const getJsonMetadata = () => {\n    try {\n      const jsonMetadataObj = jsonMetadata != null && jsonMetadata.length ?\n      JSON.parse(jsonMetadata) :\n      {};\n      return jsonMetadataObj;\n    }\n    catch (_) {\n      return {};\n    }\n  };\n  const handleOnChangeOwners = (owners) => {\n    const parsedOwners = ensureIsArray(owners).map((o) => ({\n      id: o.value,\n      full_name: o.label\n    }));\n    setOwners(parsedOwners);\n  };\n  const handleOnChangeRoles = (roles) => {\n    const parsedRoles = ensureIsArray(roles).map((r) => ({\n      id: r.value,\n      name: r.label\n    }));\n    setRoles(parsedRoles);\n  };\n  const handleOwnersSelectValue = () => {\n    const parsedOwners = (owners || []).map((owner) => ({\n      value: owner.id,\n      label: owner.full_name || `${owner.first_name} ${owner.last_name}`\n    }));\n    return parsedOwners;\n  };\n  const handleRolesSelectValue = () => {\n    const parsedRoles = (roles || []).map((role) => ({\n      value: role.id,\n      label: `${role.name}`\n    }));\n    return parsedRoles;\n  };\n  const onColorSchemeChange = (colorScheme = '', { updateMetadata = true } = {}) => {\n    // check that color_scheme is valid\n    const colorChoices = categoricalSchemeRegistry.keys();\n    const jsonMetadataObj = getJsonMetadata();\n    // only fire if the color_scheme is present and invalid\n    if (colorScheme && !colorChoices.includes(colorScheme)) {\n      Modal.error({\n        title: t('Error'),\n        content: t('A valid color scheme is required'),\n        okButtonProps: { danger: true, className: 'btn-danger' }\n      });\n      throw new Error('A valid color scheme is required');\n    }\n    // update metadata to match selection\n    if (updateMetadata) {\n      jsonMetadataObj.color_scheme = colorScheme;\n      jsonMetadataObj.label_colors = jsonMetadataObj.label_colors || {};\n      setJsonMetadata(jsonStringify(jsonMetadataObj));\n    }\n    setColorScheme(colorScheme);\n  };\n  const onFinish = () => {var _metadata, _metadata2, _metadata3, _metadata4;\n    const { title, slug, certifiedBy, certificationDetails } = form.getFieldsValue();\n    let currentColorScheme = colorScheme;\n    let colorNamespace = '';\n    let currentJsonMetadata = jsonMetadata;\n    // validate currentJsonMetadata\n    let metadata;\n    try {\n      if (!currentJsonMetadata.startsWith('{') ||\n      !currentJsonMetadata.endsWith('}')) {\n        throw new Error();\n      }\n      metadata = JSON.parse(currentJsonMetadata);\n    }\n    catch (error) {\n      addDangerToast(t('JSON metadata is invalid!'));\n      return;\n    }\n    // color scheme in json metadata has precedence over selection\n    currentColorScheme = ((_metadata = metadata) == null ? void 0 : _metadata.color_scheme) || colorScheme;\n    colorNamespace = (_metadata2 = metadata) == null ? void 0 : _metadata2.color_namespace;\n    // filter shared_label_color from user input\n    if ((_metadata3 = metadata) != null && _metadata3.shared_label_colors) {\n      delete metadata.shared_label_colors;\n    }\n    if ((_metadata4 = metadata) != null && _metadata4.color_scheme_domain) {\n      delete metadata.color_scheme_domain;\n    }\n    const sharedLabelColor = getSharedLabelColor();\n    const categoricalNamespace = CategoricalColorNamespace.getNamespace(colorNamespace);\n    categoricalNamespace.resetColors();\n    if (currentColorScheme) {var _categoricalSchemeReg;\n      sharedLabelColor.updateColorMap(colorNamespace, currentColorScheme);\n      metadata.shared_label_colors = Object.fromEntries(sharedLabelColor.getColorMap());\n      metadata.color_scheme_domain =\n      ((_categoricalSchemeReg = categoricalSchemeRegistry.get(colorScheme)) == null ? void 0 : _categoricalSchemeReg.colors) || [];\n    } else\n    {\n      sharedLabelColor.reset();\n      metadata.shared_label_colors = {};\n      metadata.color_scheme_domain = [];\n    }\n    currentJsonMetadata = jsonStringify(metadata);\n    onColorSchemeChange(currentColorScheme, {\n      updateMetadata: false\n    });\n    const moreOnSubmitProps = {};\n    const morePutProps = {};\n    if (isFeatureEnabled(FeatureFlag.DashboardRbac)) {\n      moreOnSubmitProps.roles = roles;\n      morePutProps.roles = (roles || []).map((r) => r.id);\n    }\n    if (isFeatureEnabled(FeatureFlag.TaggingSystem)) {\n      morePutProps.tags = tags.map((tag) => tag.id);\n    }\n    const onSubmitProps = {\n      id: dashboardId,\n      title,\n      slug,\n      jsonMetadata: currentJsonMetadata,\n      owners,\n      colorScheme: currentColorScheme,\n      colorNamespace,\n      certifiedBy,\n      certificationDetails,\n      ...moreOnSubmitProps\n    };\n    if (onlyApply) {\n      onSubmit(onSubmitProps);\n      onHide();\n      addSuccessToast(t('Dashboard properties updated'));\n    } else\n    {\n      SupersetClient.put({\n        endpoint: `/api/v1/dashboard/${dashboardId}`,\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          dashboard_title: title,\n          slug: slug || null,\n          json_metadata: currentJsonMetadata || null,\n          owners: (owners || []).map((o) => o.id),\n          certified_by: certifiedBy || null,\n          certification_details: certifiedBy && certificationDetails ? certificationDetails : null,\n          ...morePutProps\n        })\n      }).then(() => {\n        onSubmit(onSubmitProps);\n        onHide();\n        addSuccessToast(t('The dashboard has been saved'));\n      }, handleErrorResponse);\n    }\n  };\n  const getRowsWithoutRoles = () => {\n    const jsonMetadataObj = getJsonMetadata();\n    const hasCustomLabelColors = !!Object.keys((jsonMetadataObj == null ? void 0 : jsonMetadataObj.label_colors) || {}).length;\n    return ___EmotionJSX(Row, { gutter: 16 },\n    ___EmotionJSX(Col, { xs: 24, md: 12 },\n    ___EmotionJSX(\"h3\", { style: { marginTop: '1em' } }, t('Access')),\n    ___EmotionJSX(StyledFormItem, { label: t('Owners') },\n    ___EmotionJSX(AsyncSelect, { allowClear: true, ariaLabel: t('Owners'), disabled: isLoading, mode: \"multiple\", onChange: handleOnChangeOwners, options: (input, page, pageSize) => loadAccessOptions('owners', input, page, pageSize), value: handleOwnersSelectValue() })\n    ),\n    ___EmotionJSX(\"p\", { className: \"help-block\" },\n    t('Owners is a list of users who can alter the dashboard. Searchable by name or username.')\n    )\n    ),\n    ___EmotionJSX(Col, { xs: 24, md: 12 },\n    ___EmotionJSX(\"h3\", { style: { marginTop: '1em' } }, t('Colors')),\n    ___EmotionJSX(ColorSchemeControlWrapper, { hasCustomLabelColors: hasCustomLabelColors, onChange: onColorSchemeChange, colorScheme: colorScheme, labelMargin: 4 })\n    )\n    );\n  };\n  const getRowsWithRoles = () => {\n    const jsonMetadataObj = getJsonMetadata();\n    const hasCustomLabelColors = !!Object.keys((jsonMetadataObj == null ? void 0 : jsonMetadataObj.label_colors) || {}).length;\n    return ___EmotionJSX(React.Fragment, null,\n    ___EmotionJSX(Row, null,\n    ___EmotionJSX(Col, { xs: 24, md: 24 },\n    ___EmotionJSX(\"h3\", { style: { marginTop: '1em' } }, t('Access'))\n    )\n    ),\n    ___EmotionJSX(Row, { gutter: 16 },\n    ___EmotionJSX(Col, { xs: 24, md: 12 },\n    ___EmotionJSX(StyledFormItem, { label: t('Owners') },\n    ___EmotionJSX(AsyncSelect, { allowClear: true, allowNewOptions: true, ariaLabel: t('Owners'), disabled: isLoading, mode: \"multiple\", onChange: handleOnChangeOwners, options: (input, page, pageSize) => loadAccessOptions('owners', input, page, pageSize), value: handleOwnersSelectValue() })\n    ),\n    ___EmotionJSX(\"p\", { className: \"help-block\" },\n    t('Owners is a list of users who can alter the dashboard. Searchable by name or username.')\n    )\n    ),\n    ___EmotionJSX(Col, { xs: 24, md: 12 },\n    ___EmotionJSX(StyledFormItem, { label: t('Roles') },\n    ___EmotionJSX(AsyncSelect, { allowClear: true, ariaLabel: t('Roles'), disabled: isLoading, mode: \"multiple\", onChange: handleOnChangeRoles, options: (input, page, pageSize) => loadAccessOptions('roles', input, page, pageSize), value: handleRolesSelectValue() })\n    ),\n    ___EmotionJSX(\"p\", { className: \"help-block\" },\n    t('Roles is a list which defines access to the dashboard. Granting a role access to a dashboard will bypass dataset level checks. If no roles are defined, regular access permissions apply.')\n    )\n    )\n    ),\n    ___EmotionJSX(Row, null,\n    ___EmotionJSX(Col, { xs: 24, md: 12 },\n    ___EmotionJSX(ColorSchemeControlWrapper, { hasCustomLabelColors: hasCustomLabelColors, onChange: onColorSchemeChange, colorScheme: colorScheme, labelMargin: 4 })\n    )\n    )\n    );\n  };\n  useEffect(() => {\n    if (show) {\n      if (!currentDashboardInfo) {\n        fetchDashboardDetails();\n      } else\n      {\n        handleDashboardData(currentDashboardInfo);\n      }\n    }\n    JsonEditor.preload();\n  }, [currentDashboardInfo, fetchDashboardDetails, handleDashboardData, show]);\n  useEffect(() => {\n    // the title can be changed inline in the dashboard, this catches it\n    if (dashboardTitle &&\n    dashboardInfo &&\n    dashboardInfo.title !== dashboardTitle) {\n      form.setFieldsValue({\n        ...dashboardInfo,\n        title: dashboardTitle\n      });\n    }\n  }, [dashboardInfo, dashboardTitle, form]);\n  useEffect(() => {\n    if (!isFeatureEnabled(FeatureFlag.TaggingSystem))\n    return;\n    try {\n      fetchTags({\n        objectType: OBJECT_TYPES.DASHBOARD,\n        objectId: dashboardId,\n        includeTypes: false\n      }, (tags) => setTags(tags), (error) => {\n        addDangerToast(`Error fetching tags: ${error.text}`);\n      });\n    }\n    catch (error) {\n      handleErrorResponse(error);\n    }\n  }, [dashboardId]);\n  const handleChangeTags = (tags) => {\n    const parsedTags = ensureIsArray(tags).map((r) => ({\n      id: r.value,\n      name: r.label\n    }));\n    setTags(parsedTags);\n  };\n  return ___EmotionJSX(Modal, { show: show, onHide: onHide, title: t('Dashboard properties'), footer: ___EmotionJSX(React.Fragment, null,\n    ___EmotionJSX(Button, { htmlType: \"button\", buttonSize: \"small\", onClick: onHide, \"data-test\": \"properties-modal-cancel-button\", cta: true },\n    t('Cancel')\n    ),\n    ___EmotionJSX(Button, { \"data-test\": \"properties-modal-apply-button\", onClick: form.submit, buttonSize: \"small\", buttonStyle: \"primary\", className: \"m-r-5\", cta: true, disabled: dashboardInfo == null ? void 0 : dashboardInfo.isManagedExternally, tooltip: dashboardInfo != null && dashboardInfo.isManagedExternally ?\n      t(\"This dashboard is managed externally, and can't be edited in Superset\") :\n      '' },\n    saveLabel\n    )\n    ), responsive: true },\n  ___EmotionJSX(AntdForm, { form: form, onFinish: onFinish, \"data-test\": \"dashboard-edit-properties-form\", layout: \"vertical\", initialValues: dashboardInfo },\n  ___EmotionJSX(Row, null,\n  ___EmotionJSX(Col, { xs: 24, md: 24 },\n  ___EmotionJSX(\"h3\", null, t('Basic information'))\n  )\n  ),\n  ___EmotionJSX(Row, { gutter: 16 },\n  ___EmotionJSX(Col, { xs: 24, md: 12 },\n  ___EmotionJSX(FormItem, { label: t('Name'), name: \"title\" },\n  ___EmotionJSX(Input, { \"data-test\": \"dashboard-title-input\", type: \"text\", disabled: isLoading })\n  )\n  ),\n  ___EmotionJSX(Col, { xs: 24, md: 12 },\n  ___EmotionJSX(StyledFormItem, { label: t('URL slug'), name: \"slug\" },\n  ___EmotionJSX(Input, { type: \"text\", disabled: isLoading })\n  ),\n  ___EmotionJSX(\"p\", { className: \"help-block\" },\n  t('A readable URL for your dashboard')\n  )\n  )\n  ),\n  isFeatureEnabled(FeatureFlag.DashboardRbac) ?\n  getRowsWithRoles() :\n  getRowsWithoutRoles(),\n  ___EmotionJSX(Row, null,\n  ___EmotionJSX(Col, { xs: 24, md: 24 },\n  ___EmotionJSX(\"h3\", null, t('Certification'))\n  )\n  ),\n  ___EmotionJSX(Row, { gutter: 16 },\n  ___EmotionJSX(Col, { xs: 24, md: 12 },\n  ___EmotionJSX(StyledFormItem, { label: t('Certified by'), name: \"certifiedBy\" },\n  ___EmotionJSX(Input, { type: \"text\", disabled: isLoading })\n  ),\n  ___EmotionJSX(\"p\", { className: \"help-block\" },\n  t('Person or group that has certified this dashboard.')\n  )\n  ),\n  ___EmotionJSX(Col, { xs: 24, md: 12 },\n  ___EmotionJSX(StyledFormItem, { label: t('Certification details'), name: \"certificationDetails\" },\n  ___EmotionJSX(Input, { type: \"text\", disabled: isLoading })\n  ),\n  ___EmotionJSX(\"p\", { className: \"help-block\" },\n  t('Any additional detail to show in the certification tooltip.')\n  )\n  )\n  ),\n  isFeatureEnabled(FeatureFlag.TaggingSystem) ? ___EmotionJSX(Row, { gutter: 16 },\n  ___EmotionJSX(Col, { xs: 24, md: 12 },\n  ___EmotionJSX(\"h3\", { css: _ref }, t('Tags'))\n  )\n  ) : null,\n  isFeatureEnabled(FeatureFlag.TaggingSystem) ? ___EmotionJSX(Row, { gutter: 16 },\n  ___EmotionJSX(Col, { xs: 24, md: 12 },\n  ___EmotionJSX(StyledFormItem, null,\n  ___EmotionJSX(AsyncSelect, { ariaLabel: \"Tags\", mode: \"multiple\", value: tagsAsSelectValues, options: loadTags, onChange: handleChangeTags, allowClear: true })\n  ),\n  ___EmotionJSX(\"p\", { className: \"help-block\" },\n  t('A list of tags that have been applied to this chart.')\n  )\n  )\n  ) : null,\n  ___EmotionJSX(Row, null,\n  ___EmotionJSX(Col, { xs: 24, md: 24 },\n  ___EmotionJSX(\"h3\", { style: { marginTop: '1em' } },\n  ___EmotionJSX(Button, { buttonStyle: \"link\", onClick: () => setIsAdvancedOpen(!isAdvancedOpen) },\n  ___EmotionJSX(\"i\", { className: `fa fa-angle-${isAdvancedOpen ? 'down' : 'right'}`, style: { minWidth: '1em' } }),\n  t('Advanced')\n  )\n  ),\n  isAdvancedOpen && ___EmotionJSX(React.Fragment, null,\n  ___EmotionJSX(StyledFormItem, { label: t('JSON metadata') },\n  ___EmotionJSX(StyledJsonEditor, { showLoadingForImport: true, name: \"json_metadata\", value: jsonMetadata, onChange: setJsonMetadata, tabSize: 2, width: \"100%\", height: \"200px\", wrapEnabled: true })\n  ),\n  ___EmotionJSX(\"p\", { className: \"help-block\" },\n  t('This JSON object is generated dynamically when clicking the save or overwrite button in the dashboard view. It is exposed here for reference and for power users who may want to alter specific parameters.'),\n  onlyApply && ___EmotionJSX(React.Fragment, null,\n  ' ',\n  t('Please DO NOT overwrite the \"filter_scopes\" key.'), ' ',\n  ___EmotionJSX(FilterScopeModal, { triggerNode: ___EmotionJSX(\"span\", { className: \"alert-link\" },\n    t('Use \"%(menuName)s\" menu instead.', {\n      menuName: t('Set filter mapping')\n    })\n    ) })\n  )\n  )\n  )\n  )\n  )\n  )\n  );\n};__signature__(PropertiesModal, \"useForm{[form]}\\nuseState{[isLoading, setIsLoading](false)}\\nuseState{[isAdvancedOpen, setIsAdvancedOpen](false)}\\nuseState{[colorScheme, setColorScheme](currentColorScheme)}\\nuseState{[jsonMetadata, setJsonMetadata]('')}\\nuseState{[dashboardInfo, setDashboardInfo]}\\nuseState{[owners, setOwners]([])}\\nuseState{[roles, setRoles]([])}\\nuseState{[tags, setTags]([])}\\nuseMemo{tagsAsSelectValues}\\nuseCallback{loadAccessOptions}\\nuseCallback{handleDashboardData}\\nuseCallback{fetchDashboardDetails}\\nuseEffect{}\\nuseEffect{}\\nuseEffect{}\");const _default =\nwithToasts(PropertiesModal);export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(StyledFormItem, \"StyledFormItem\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/components/PropertiesModal/index.tsx\");reactHotLoader.register(StyledJsonEditor, \"StyledJsonEditor\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/components/PropertiesModal/index.tsx\");reactHotLoader.register(PropertiesModal, \"PropertiesModal\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/components/PropertiesModal/index.tsx\");reactHotLoader.register(_default, \"default\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/components/PropertiesModal/index.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["React","useCallback","useEffect","useMemo","useState","Input","FormItem","jsonStringify","Button","AntdForm","AsyncSelect","Col","Row","rison","CategoricalColorNamespace","ensureIsArray","isFeatureEnabled","FeatureFlag","getCategoricalSchemeRegistry","getSharedLabelColor","styled","SupersetClient","t","getClientErrorObject","Modal","JsonEditor","ColorSchemeControlWrapper","FilterScopeModal","withToasts","fetchTags","OBJECT_TYPES","loadTags","jsx","___EmotionJSX","StyledFormItem","StyledJsonEditor","theme","borderRadius","colors","secondary","light2","_ref","process","env","NODE_ENV","name","styles","map","toString","_EMOTION_STRINGIFIED_CSS_ERROR__","PropertiesModal","addSuccessToast","addDangerToast","colorScheme","currentColorScheme","dashboardId","dashboardInfo","currentDashboardInfo","dashboardTitle","onHide","onlyApply","onSubmit","show","form","useForm","isLoading","setIsLoading","isAdvancedOpen","setIsAdvancedOpen","setColorScheme","jsonMetadata","setJsonMetadata","setDashboardInfo","owners","setOwners","roles","setRoles","saveLabel","tags","setTags","categoricalSchemeRegistry","tagsAsSelectValues","selectTags","tag","value","id","label","length","handleErrorResponse","response","error","statusText","message","errorText","json_metadata","title","content","okButtonProps","danger","className","loadAccessOptions","accessType","input","page","pageSize","query","encode","filter","page_size","get","endpoint","then","data","json","result","item","extra","active","undefined","text","totalCount","count","handleDashboardData","dashboardData","dashboard_title","slug","certified_by","certification_details","metadata","is_managed_externally","certifiedBy","certificationDetails","isManagedExternally","setFieldsValue","color_scheme","metaDataCopy","_omit","fetchDashboardDetails","_dashboard$json_metad","dashboard","jsonMetadataObj","JSON","parse","getJsonMetadata","_","handleOnChangeOwners","parsedOwners","o","full_name","handleOnChangeRoles","parsedRoles","r","handleOwnersSelectValue","owner","first_name","last_name","handleRolesSelectValue","role","onColorSchemeChange","updateMetadata","colorChoices","keys","includes","Error","label_colors","onFinish","_metadata","_metadata2","_metadata3","_metadata4","getFieldsValue","colorNamespace","currentJsonMetadata","startsWith","endsWith","color_namespace","shared_label_colors","color_scheme_domain","sharedLabelColor","categoricalNamespace","getNamespace","resetColors","_categoricalSchemeReg","updateColorMap","Object","fromEntries","getColorMap","reset","moreOnSubmitProps","morePutProps","DashboardRbac","TaggingSystem","onSubmitProps","put","headers","body","stringify","getRowsWithoutRoles","hasCustomLabelColors","gutter","xs","md","style","marginTop","allowClear","ariaLabel","disabled","mode","onChange","options","labelMargin","getRowsWithRoles","Fragment","allowNewOptions","preload","objectType","DASHBOARD","objectId","includeTypes","handleChangeTags","parsedTags","footer","htmlType","buttonSize","onClick","cta","submit","buttonStyle","tooltip","responsive","layout","initialValues","type","css","minWidth","showLoadingForImport","tabSize","width","height","wrapEnabled","triggerNode","menuName","__signature__","_default","reactHotLoader","reactHotLoaderGlobal","default","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/components/PropertiesModal/index.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { omit } from 'lodash';\nimport { Input } from 'src/components/Input';\nimport { FormItem } from 'src/components/Form';\nimport jsonStringify from 'json-stringify-pretty-compact';\nimport Button from 'src/components/Button';\nimport { AntdForm, AsyncSelect, Col, Row } from 'src/components';\nimport rison from 'rison';\nimport {\n  CategoricalColorNamespace,\n  ensureIsArray,\n  isFeatureEnabled,\n  FeatureFlag,\n  getCategoricalSchemeRegistry,\n  getSharedLabelColor,\n  styled,\n  SupersetClient,\n  t,\n  getClientErrorObject,\n} from '@superset-ui/core';\n\nimport Modal from 'src/components/Modal';\nimport { JsonEditor } from 'src/components/AsyncAceEditor';\n\nimport ColorSchemeControlWrapper from 'src/dashboard/components/ColorSchemeControlWrapper';\nimport FilterScopeModal from 'src/dashboard/components/filterscope/FilterScopeModal';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport TagType from 'src/types/TagType';\nimport { fetchTags, OBJECT_TYPES } from 'src/features/tags/tags';\nimport { loadTags } from 'src/components/Tags/utils';\n\nconst StyledFormItem = styled(FormItem)`\n  margin-bottom: 0;\n`;\n\nconst StyledJsonEditor = styled(JsonEditor)`\n  border-radius: ${({ theme }) => theme.borderRadius}px;\n  border: 1px solid ${({ theme }) => theme.colors.secondary.light2};\n`;\n\ntype PropertiesModalProps = {\n  dashboardId: number;\n  dashboardTitle?: string;\n  dashboardInfo?: Record<string, any>;\n  show?: boolean;\n  onHide?: () => void;\n  colorScheme?: string;\n  onSubmit?: (params: Record<string, any>) => void;\n  addSuccessToast: (message: string) => void;\n  addDangerToast: (message: string) => void;\n  onlyApply?: boolean;\n};\n\ntype Roles = { id: number; name: string }[];\ntype Owners = {\n  id: number;\n  full_name?: string;\n  first_name?: string;\n  last_name?: string;\n}[];\ntype DashboardInfo = {\n  id: number;\n  title: string;\n  slug: string;\n  certifiedBy: string;\n  certificationDetails: string;\n  isManagedExternally: boolean;\n};\n\nconst PropertiesModal = ({\n  addSuccessToast,\n  addDangerToast,\n  colorScheme: currentColorScheme,\n  dashboardId,\n  dashboardInfo: currentDashboardInfo,\n  dashboardTitle,\n  onHide = () => {},\n  onlyApply = false,\n  onSubmit = () => {},\n  show = false,\n}: PropertiesModalProps) => {\n  const [form] = AntdForm.useForm();\n  const [isLoading, setIsLoading] = useState(false);\n  const [isAdvancedOpen, setIsAdvancedOpen] = useState(false);\n  const [colorScheme, setColorScheme] = useState(currentColorScheme);\n  const [jsonMetadata, setJsonMetadata] = useState('');\n  const [dashboardInfo, setDashboardInfo] = useState<DashboardInfo>();\n  const [owners, setOwners] = useState<Owners>([]);\n  const [roles, setRoles] = useState<Roles>([]);\n  const saveLabel = onlyApply ? t('Apply') : t('Save');\n  const [tags, setTags] = useState<TagType[]>([]);\n  const categoricalSchemeRegistry = getCategoricalSchemeRegistry();\n\n  const tagsAsSelectValues = useMemo(() => {\n    const selectTags = tags.map((tag: { id: number; name: string }) => ({\n      value: tag.id,\n      label: tag.name,\n    }));\n    return selectTags;\n  }, [tags.length]);\n\n  const handleErrorResponse = async (response: Response) => {\n    const { error, statusText, message } = await getClientErrorObject(response);\n    let errorText = error || statusText || t('An error has occurred');\n    if (typeof message === 'object' && 'json_metadata' in message) {\n      errorText = (message as { json_metadata: string }).json_metadata;\n    } else if (typeof message === 'string') {\n      errorText = message;\n\n      if (message === 'Forbidden') {\n        errorText = t('You do not have permission to edit this dashboard');\n      }\n    }\n\n    Modal.error({\n      title: t('Error'),\n      content: errorText,\n      okButtonProps: { danger: true, className: 'btn-danger' },\n    });\n  };\n\n  const loadAccessOptions = useCallback(\n    (accessType = 'owners', input = '', page: number, pageSize: number) => {\n      const query = rison.encode({\n        filter: input,\n        page,\n        page_size: pageSize,\n      });\n      return SupersetClient.get({\n        endpoint: `/api/v1/dashboard/related/${accessType}?q=${query}`,\n      }).then(response => ({\n        data: response.json.result\n          .filter((item: { extra: { active: boolean } }) =>\n            item.extra.active !== undefined ? item.extra.active : true,\n          )\n          .map((item: { value: number; text: string }) => ({\n            value: item.value,\n            label: item.text,\n          })),\n        totalCount: response.json.count,\n      }));\n    },\n    [],\n  );\n\n  const handleDashboardData = useCallback(\n    dashboardData => {\n      const {\n        id,\n        dashboard_title,\n        slug,\n        certified_by,\n        certification_details,\n        owners,\n        roles,\n        metadata,\n        is_managed_externally,\n      } = dashboardData;\n      const dashboardInfo = {\n        id,\n        title: dashboard_title,\n        slug: slug || '',\n        certifiedBy: certified_by || '',\n        certificationDetails: certification_details || '',\n        isManagedExternally: is_managed_externally || false,\n      };\n\n      form.setFieldsValue(dashboardInfo);\n      setDashboardInfo(dashboardInfo);\n      setOwners(owners);\n      setRoles(roles);\n      setColorScheme(metadata.color_scheme);\n\n      const metaDataCopy = omit(metadata, [\n        'positions',\n        'shared_label_colors',\n        'color_scheme_domain',\n      ]);\n\n      setJsonMetadata(metaDataCopy ? jsonStringify(metaDataCopy) : '');\n    },\n    [form],\n  );\n\n  const fetchDashboardDetails = useCallback(() => {\n    setIsLoading(true);\n    // We fetch the dashboard details because not all code\n    // that renders this component have all the values we need.\n    // At some point when we have a more consistent frontend\n    // datamodel, the dashboard could probably just be passed as a prop.\n    SupersetClient.get({\n      endpoint: `/api/v1/dashboard/${dashboardId}`,\n    }).then(response => {\n      const dashboard = response.json.result;\n      const jsonMetadataObj = dashboard.json_metadata?.length\n        ? JSON.parse(dashboard.json_metadata)\n        : {};\n\n      handleDashboardData({\n        ...dashboard,\n        metadata: jsonMetadataObj,\n      });\n\n      setIsLoading(false);\n    }, handleErrorResponse);\n  }, [dashboardId, handleDashboardData]);\n\n  const getJsonMetadata = () => {\n    try {\n      const jsonMetadataObj = jsonMetadata?.length\n        ? JSON.parse(jsonMetadata)\n        : {};\n      return jsonMetadataObj;\n    } catch (_) {\n      return {};\n    }\n  };\n\n  const handleOnChangeOwners = (owners: { value: number; label: string }[]) => {\n    const parsedOwners: Owners = ensureIsArray(owners).map(o => ({\n      id: o.value,\n      full_name: o.label,\n    }));\n    setOwners(parsedOwners);\n  };\n\n  const handleOnChangeRoles = (roles: { value: number; label: string }[]) => {\n    const parsedRoles: Roles = ensureIsArray(roles).map(r => ({\n      id: r.value,\n      name: r.label,\n    }));\n    setRoles(parsedRoles);\n  };\n\n  const handleOwnersSelectValue = () => {\n    const parsedOwners = (owners || []).map(\n      (owner: {\n        id: number;\n        first_name?: string;\n        last_name?: string;\n        full_name?: string;\n      }) => ({\n        value: owner.id,\n        label: owner.full_name || `${owner.first_name} ${owner.last_name}`,\n      }),\n    );\n    return parsedOwners;\n  };\n\n  const handleRolesSelectValue = () => {\n    const parsedRoles = (roles || []).map(\n      (role: { id: number; name: string }) => ({\n        value: role.id,\n        label: `${role.name}`,\n      }),\n    );\n    return parsedRoles;\n  };\n\n  const onColorSchemeChange = (\n    colorScheme = '',\n    { updateMetadata = true } = {},\n  ) => {\n    // check that color_scheme is valid\n    const colorChoices = categoricalSchemeRegistry.keys();\n    const jsonMetadataObj = getJsonMetadata();\n\n    // only fire if the color_scheme is present and invalid\n    if (colorScheme && !colorChoices.includes(colorScheme)) {\n      Modal.error({\n        title: t('Error'),\n        content: t('A valid color scheme is required'),\n        okButtonProps: { danger: true, className: 'btn-danger' },\n      });\n      throw new Error('A valid color scheme is required');\n    }\n\n    // update metadata to match selection\n    if (updateMetadata) {\n      jsonMetadataObj.color_scheme = colorScheme;\n      jsonMetadataObj.label_colors = jsonMetadataObj.label_colors || {};\n\n      setJsonMetadata(jsonStringify(jsonMetadataObj));\n    }\n    setColorScheme(colorScheme);\n  };\n\n  const onFinish = () => {\n    const { title, slug, certifiedBy, certificationDetails } =\n      form.getFieldsValue();\n    let currentColorScheme = colorScheme;\n    let colorNamespace = '';\n    let currentJsonMetadata = jsonMetadata;\n\n    // validate currentJsonMetadata\n    let metadata;\n    try {\n      if (\n        !currentJsonMetadata.startsWith('{') ||\n        !currentJsonMetadata.endsWith('}')\n      ) {\n        throw new Error();\n      }\n      metadata = JSON.parse(currentJsonMetadata);\n    } catch (error) {\n      addDangerToast(t('JSON metadata is invalid!'));\n      return;\n    }\n\n    // color scheme in json metadata has precedence over selection\n    currentColorScheme = metadata?.color_scheme || colorScheme;\n    colorNamespace = metadata?.color_namespace;\n\n    // filter shared_label_color from user input\n    if (metadata?.shared_label_colors) {\n      delete metadata.shared_label_colors;\n    }\n    if (metadata?.color_scheme_domain) {\n      delete metadata.color_scheme_domain;\n    }\n\n    const sharedLabelColor = getSharedLabelColor();\n    const categoricalNamespace =\n      CategoricalColorNamespace.getNamespace(colorNamespace);\n    categoricalNamespace.resetColors();\n    if (currentColorScheme) {\n      sharedLabelColor.updateColorMap(colorNamespace, currentColorScheme);\n      metadata.shared_label_colors = Object.fromEntries(\n        sharedLabelColor.getColorMap(),\n      );\n      metadata.color_scheme_domain =\n        categoricalSchemeRegistry.get(colorScheme)?.colors || [];\n    } else {\n      sharedLabelColor.reset();\n      metadata.shared_label_colors = {};\n      metadata.color_scheme_domain = [];\n    }\n\n    currentJsonMetadata = jsonStringify(metadata);\n\n    onColorSchemeChange(currentColorScheme, {\n      updateMetadata: false,\n    });\n\n    const moreOnSubmitProps: { roles?: Roles } = {};\n    const morePutProps: { roles?: number[]; tags?: (number | undefined)[] } =\n      {};\n    if (isFeatureEnabled(FeatureFlag.DashboardRbac)) {\n      moreOnSubmitProps.roles = roles;\n      morePutProps.roles = (roles || []).map(r => r.id);\n    }\n    if (isFeatureEnabled(FeatureFlag.TaggingSystem)) {\n      morePutProps.tags = tags.map(tag => tag.id);\n    }\n    const onSubmitProps = {\n      id: dashboardId,\n      title,\n      slug,\n      jsonMetadata: currentJsonMetadata,\n      owners,\n      colorScheme: currentColorScheme,\n      colorNamespace,\n      certifiedBy,\n      certificationDetails,\n      ...moreOnSubmitProps,\n    };\n    if (onlyApply) {\n      onSubmit(onSubmitProps);\n      onHide();\n      addSuccessToast(t('Dashboard properties updated'));\n    } else {\n      SupersetClient.put({\n        endpoint: `/api/v1/dashboard/${dashboardId}`,\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          dashboard_title: title,\n          slug: slug || null,\n          json_metadata: currentJsonMetadata || null,\n          owners: (owners || []).map(o => o.id),\n          certified_by: certifiedBy || null,\n          certification_details:\n            certifiedBy && certificationDetails ? certificationDetails : null,\n          ...morePutProps,\n        }),\n      }).then(() => {\n        onSubmit(onSubmitProps);\n        onHide();\n        addSuccessToast(t('The dashboard has been saved'));\n      }, handleErrorResponse);\n    }\n  };\n\n  const getRowsWithoutRoles = () => {\n    const jsonMetadataObj = getJsonMetadata();\n    const hasCustomLabelColors = !!Object.keys(\n      jsonMetadataObj?.label_colors || {},\n    ).length;\n\n    return (\n      <Row gutter={16}>\n        <Col xs={24} md={12}>\n          <h3 style={{ marginTop: '1em' }}>{t('Access')}</h3>\n          <StyledFormItem label={t('Owners')}>\n            <AsyncSelect\n              allowClear\n              ariaLabel={t('Owners')}\n              disabled={isLoading}\n              mode=\"multiple\"\n              onChange={handleOnChangeOwners}\n              options={(input, page, pageSize) =>\n                loadAccessOptions('owners', input, page, pageSize)\n              }\n              value={handleOwnersSelectValue()}\n            />\n          </StyledFormItem>\n          <p className=\"help-block\">\n            {t(\n              'Owners is a list of users who can alter the dashboard. Searchable by name or username.',\n            )}\n          </p>\n        </Col>\n        <Col xs={24} md={12}>\n          <h3 style={{ marginTop: '1em' }}>{t('Colors')}</h3>\n          <ColorSchemeControlWrapper\n            hasCustomLabelColors={hasCustomLabelColors}\n            onChange={onColorSchemeChange}\n            colorScheme={colorScheme}\n            labelMargin={4}\n          />\n        </Col>\n      </Row>\n    );\n  };\n\n  const getRowsWithRoles = () => {\n    const jsonMetadataObj = getJsonMetadata();\n    const hasCustomLabelColors = !!Object.keys(\n      jsonMetadataObj?.label_colors || {},\n    ).length;\n\n    return (\n      <>\n        <Row>\n          <Col xs={24} md={24}>\n            <h3 style={{ marginTop: '1em' }}>{t('Access')}</h3>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col xs={24} md={12}>\n            <StyledFormItem label={t('Owners')}>\n              <AsyncSelect\n                allowClear\n                allowNewOptions\n                ariaLabel={t('Owners')}\n                disabled={isLoading}\n                mode=\"multiple\"\n                onChange={handleOnChangeOwners}\n                options={(input, page, pageSize) =>\n                  loadAccessOptions('owners', input, page, pageSize)\n                }\n                value={handleOwnersSelectValue()}\n              />\n            </StyledFormItem>\n            <p className=\"help-block\">\n              {t(\n                'Owners is a list of users who can alter the dashboard. Searchable by name or username.',\n              )}\n            </p>\n          </Col>\n          <Col xs={24} md={12}>\n            <StyledFormItem label={t('Roles')}>\n              <AsyncSelect\n                allowClear\n                ariaLabel={t('Roles')}\n                disabled={isLoading}\n                mode=\"multiple\"\n                onChange={handleOnChangeRoles}\n                options={(input, page, pageSize) =>\n                  loadAccessOptions('roles', input, page, pageSize)\n                }\n                value={handleRolesSelectValue()}\n              />\n            </StyledFormItem>\n            <p className=\"help-block\">\n              {t(\n                'Roles is a list which defines access to the dashboard. Granting a role access to a dashboard will bypass dataset level checks. If no roles are defined, regular access permissions apply.',\n              )}\n            </p>\n          </Col>\n        </Row>\n        <Row>\n          <Col xs={24} md={12}>\n            <ColorSchemeControlWrapper\n              hasCustomLabelColors={hasCustomLabelColors}\n              onChange={onColorSchemeChange}\n              colorScheme={colorScheme}\n              labelMargin={4}\n            />\n          </Col>\n        </Row>\n      </>\n    );\n  };\n\n  useEffect(() => {\n    if (show) {\n      if (!currentDashboardInfo) {\n        fetchDashboardDetails();\n      } else {\n        handleDashboardData(currentDashboardInfo);\n      }\n    }\n\n    JsonEditor.preload();\n  }, [currentDashboardInfo, fetchDashboardDetails, handleDashboardData, show]);\n\n  useEffect(() => {\n    // the title can be changed inline in the dashboard, this catches it\n    if (\n      dashboardTitle &&\n      dashboardInfo &&\n      dashboardInfo.title !== dashboardTitle\n    ) {\n      form.setFieldsValue({\n        ...dashboardInfo,\n        title: dashboardTitle,\n      });\n    }\n  }, [dashboardInfo, dashboardTitle, form]);\n\n  useEffect(() => {\n    if (!isFeatureEnabled(FeatureFlag.TaggingSystem)) return;\n    try {\n      fetchTags(\n        {\n          objectType: OBJECT_TYPES.DASHBOARD,\n          objectId: dashboardId,\n          includeTypes: false,\n        },\n        (tags: TagType[]) => setTags(tags),\n        (error: Response) => {\n          addDangerToast(`Error fetching tags: ${error.text}`);\n        },\n      );\n    } catch (error) {\n      handleErrorResponse(error);\n    }\n  }, [dashboardId]);\n\n  const handleChangeTags = (tags: { label: string; value: number }[]) => {\n    const parsedTags: TagType[] = ensureIsArray(tags).map(r => ({\n      id: r.value,\n      name: r.label,\n    }));\n    setTags(parsedTags);\n  };\n\n  return (\n    <Modal\n      show={show}\n      onHide={onHide}\n      title={t('Dashboard properties')}\n      footer={\n        <>\n          <Button\n            htmlType=\"button\"\n            buttonSize=\"small\"\n            onClick={onHide}\n            data-test=\"properties-modal-cancel-button\"\n            cta\n          >\n            {t('Cancel')}\n          </Button>\n          <Button\n            data-test=\"properties-modal-apply-button\"\n            onClick={form.submit}\n            buttonSize=\"small\"\n            buttonStyle=\"primary\"\n            className=\"m-r-5\"\n            cta\n            disabled={dashboardInfo?.isManagedExternally}\n            tooltip={\n              dashboardInfo?.isManagedExternally\n                ? t(\n                    \"This dashboard is managed externally, and can't be edited in Superset\",\n                  )\n                : ''\n            }\n          >\n            {saveLabel}\n          </Button>\n        </>\n      }\n      responsive\n    >\n      <AntdForm\n        form={form}\n        onFinish={onFinish}\n        data-test=\"dashboard-edit-properties-form\"\n        layout=\"vertical\"\n        initialValues={dashboardInfo}\n      >\n        <Row>\n          <Col xs={24} md={24}>\n            <h3>{t('Basic information')}</h3>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col xs={24} md={12}>\n            <FormItem label={t('Name')} name=\"title\">\n              <Input\n                data-test=\"dashboard-title-input\"\n                type=\"text\"\n                disabled={isLoading}\n              />\n            </FormItem>\n          </Col>\n          <Col xs={24} md={12}>\n            <StyledFormItem label={t('URL slug')} name=\"slug\">\n              <Input type=\"text\" disabled={isLoading} />\n            </StyledFormItem>\n            <p className=\"help-block\">\n              {t('A readable URL for your dashboard')}\n            </p>\n          </Col>\n        </Row>\n        {isFeatureEnabled(FeatureFlag.DashboardRbac)\n          ? getRowsWithRoles()\n          : getRowsWithoutRoles()}\n        <Row>\n          <Col xs={24} md={24}>\n            <h3>{t('Certification')}</h3>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col xs={24} md={12}>\n            <StyledFormItem label={t('Certified by')} name=\"certifiedBy\">\n              <Input type=\"text\" disabled={isLoading} />\n            </StyledFormItem>\n            <p className=\"help-block\">\n              {t('Person or group that has certified this dashboard.')}\n            </p>\n          </Col>\n          <Col xs={24} md={12}>\n            <StyledFormItem\n              label={t('Certification details')}\n              name=\"certificationDetails\"\n            >\n              <Input type=\"text\" disabled={isLoading} />\n            </StyledFormItem>\n            <p className=\"help-block\">\n              {t('Any additional detail to show in the certification tooltip.')}\n            </p>\n          </Col>\n        </Row>\n        {isFeatureEnabled(FeatureFlag.TaggingSystem) ? (\n          <Row gutter={16}>\n            <Col xs={24} md={12}>\n              <h3 css={{ marginTop: '1em' }}>{t('Tags')}</h3>\n            </Col>\n          </Row>\n        ) : null}\n        {isFeatureEnabled(FeatureFlag.TaggingSystem) ? (\n          <Row gutter={16}>\n            <Col xs={24} md={12}>\n              <StyledFormItem>\n                <AsyncSelect\n                  ariaLabel=\"Tags\"\n                  mode=\"multiple\"\n                  value={tagsAsSelectValues}\n                  options={loadTags}\n                  onChange={handleChangeTags}\n                  allowClear\n                />\n              </StyledFormItem>\n              <p className=\"help-block\">\n                {t('A list of tags that have been applied to this chart.')}\n              </p>\n            </Col>\n          </Row>\n        ) : null}\n        <Row>\n          <Col xs={24} md={24}>\n            <h3 style={{ marginTop: '1em' }}>\n              <Button\n                buttonStyle=\"link\"\n                onClick={() => setIsAdvancedOpen(!isAdvancedOpen)}\n              >\n                <i\n                  className={`fa fa-angle-${isAdvancedOpen ? 'down' : 'right'}`}\n                  style={{ minWidth: '1em' }}\n                />\n                {t('Advanced')}\n              </Button>\n            </h3>\n            {isAdvancedOpen && (\n              <>\n                <StyledFormItem label={t('JSON metadata')}>\n                  <StyledJsonEditor\n                    showLoadingForImport\n                    name=\"json_metadata\"\n                    value={jsonMetadata}\n                    onChange={setJsonMetadata}\n                    tabSize={2}\n                    width=\"100%\"\n                    height=\"200px\"\n                    wrapEnabled\n                  />\n                </StyledFormItem>\n                <p className=\"help-block\">\n                  {t(\n                    'This JSON object is generated dynamically when clicking the save or overwrite button in the dashboard view. It is exposed here for reference and for power users who may want to alter specific parameters.',\n                  )}\n                  {onlyApply && (\n                    <>\n                      {' '}\n                      {t(\n                        'Please DO NOT overwrite the \"filter_scopes\" key.',\n                      )}{' '}\n                      <FilterScopeModal\n                        triggerNode={\n                          <span className=\"alert-link\">\n                            {t('Use \"%(menuName)s\" menu instead.', {\n                              menuName: t('Set filter mapping'),\n                            })}\n                          </span>\n                        }\n                      />\n                    </>\n                  )}\n                </p>\n              </>\n            )}\n          </Col>\n        </Row>\n      </AntdForm>\n    </Modal>\n  );\n};\n\nexport default withToasts(PropertiesModal);\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}