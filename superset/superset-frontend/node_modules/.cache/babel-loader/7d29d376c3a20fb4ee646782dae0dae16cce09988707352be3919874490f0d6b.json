{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useEffect, useMemo, useRef } from 'react';\nimport { Global } from '@emotion/react';\nimport { useHistory } from 'react-router-dom';\nimport { CategoricalColorNamespace, getSharedLabelColor, SharedLabelColorSource, t, useTheme } from '@superset-ui/core';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useToasts } from 'src/components/MessageToasts/withToasts';\nimport Loading from 'src/components/Loading';\nimport { useDashboard, useDashboardCharts, useDashboardDatasets } from 'src/hooks/apiResources';\nimport { hydrateDashboard } from 'src/dashboard/actions/hydrate';\nimport { setDatasources } from 'src/dashboard/actions/datasources';\nimport injectCustomCss from 'src/dashboard/util/injectCustomCss';\nimport { LocalStorageKeys, setItem } from 'src/utils/localStorageHelpers';\nimport { URL_PARAMS } from 'src/constants';\nimport { getUrlParam } from 'src/utils/urlUtils';\nimport { setDatasetsStatus } from 'src/dashboard/actions/dashboardState';\nimport { getFilterValue, getPermalinkValue } from 'src/dashboard/components/nativeFilters/FilterBar/keyValue';\nimport DashboardContainer from 'src/dashboard/containers/Dashboard';\nimport shortid from 'shortid';\nimport { chartContextMenuStyles, filterCardPopoverStyle, focusStyle, headerStyles, chartHeaderStyles } from '../styles';\nimport SyncDashboardState, { getDashboardContextLocalStorage } from '../components/SyncDashboardState';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nexport const DashboardPageIdContext = /*#__PURE__*/React.createContext('');\nconst DashboardBuilder = /*#__PURE__*/React.lazy(() => import(\n  /* webpackChunkName: \"DashboardContainer\" */\n  /* webpackPreload: true */\n  'src/dashboard/components/DashboardBuilder/DashboardBuilder'));\nconst originalDocumentTitle = document.title;\nexport const DashboardPage = ({ idOrSlug }) => {\n  const theme = useTheme();\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const dashboardPageId = useMemo(() => shortid.generate(), []);\n  const hasDashboardInfoInitiated = useSelector(({ dashboardInfo }) => dashboardInfo && Object.keys(dashboardInfo).length > 0);\n  const { addDangerToast } = useToasts();\n  const { result: dashboard, error: dashboardApiError } = useDashboard(idOrSlug);\n  const { result: charts, error: chartsApiError } = useDashboardCharts(idOrSlug);\n  const { result: datasets, error: datasetsApiError, status } = useDashboardDatasets(idOrSlug);\n  const isDashboardHydrated = useRef(false);\n  const error = dashboardApiError || chartsApiError;\n  const readyToRender = Boolean(dashboard && charts);\n  const { dashboard_title, css, metadata, id = 0 } = dashboard || {};\n  useEffect(() => {\n    // mark tab id as redundant when user closes browser tab - a new id will be\n    // generated next time user opens a dashboard and the old one won't be reused\n    const handleTabClose = () => {\n      const dashboardsContexts = getDashboardContextLocalStorage();\n      setItem(LocalStorageKeys.DashboardExploreContext, {\n        ...dashboardsContexts,\n        [dashboardPageId]: {\n          ...dashboardsContexts[dashboardPageId],\n          isRedundant: true\n        }\n      });\n    };\n    window.addEventListener('beforeunload', handleTabClose);\n    return () => {\n      window.removeEventListener('beforeunload', handleTabClose);\n    };\n  }, [dashboardPageId]);\n  useEffect(() => {\n    dispatch(setDatasetsStatus(status));\n  }, [dispatch, status]);\n  useEffect(() => {\n    // eslint-disable-next-line consistent-return\n    async function getDataMaskApplied() {\n      const permalinkKey = getUrlParam(URL_PARAMS.permalinkKey);\n      const nativeFilterKeyValue = getUrlParam(URL_PARAMS.nativeFiltersKey);\n      const isOldRison = getUrlParam(URL_PARAMS.nativeFilters);\n      let dataMask = nativeFilterKeyValue || {};\n      // activeTabs is initialized with undefined so that it doesn't override\n      // the currently stored value when hydrating\n      let activeTabs;\n      if (permalinkKey) {\n        const permalinkValue = await getPermalinkValue(permalinkKey);\n        if (permalinkValue) {\n          ({ dataMask, activeTabs } = permalinkValue.state);\n        }\n      } else\n      if (nativeFilterKeyValue) {\n        dataMask = await getFilterValue(id, nativeFilterKeyValue);\n      }\n      if (isOldRison) {\n        dataMask = isOldRison;\n      }\n      if (readyToRender) {\n        if (!isDashboardHydrated.current) {\n          isDashboardHydrated.current = true;\n        }\n        dispatch(hydrateDashboard({\n          history,\n          dashboard,\n          charts,\n          activeTabs,\n          dataMask\n        }));\n      }\n      return null;\n    }\n    if (id)\n    getDataMaskApplied();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [readyToRender]);\n  useEffect(() => {\n    if (dashboard_title) {\n      document.title = dashboard_title;\n    }\n    return () => {\n      document.title = originalDocumentTitle;\n    };\n  }, [dashboard_title]);\n  useEffect(() => {\n    if (typeof css === 'string') {\n      // returning will clean up custom css\n      // when dashboard unmounts or changes\n      return injectCustomCss(css);\n    }\n    return () => {};\n  }, [css]);\n  useEffect(() => {\n    const sharedLabelColor = getSharedLabelColor();\n    sharedLabelColor.source = SharedLabelColorSource.Dashboard;\n    return () => {\n      // clean up label color\n      const categoricalNamespace = CategoricalColorNamespace.getNamespace(metadata == null ? void 0 : metadata.color_namespace);\n      categoricalNamespace.resetColors();\n      sharedLabelColor.clear();\n    };\n  }, [metadata == null ? void 0 : metadata.color_namespace]);\n  useEffect(() => {\n    if (datasetsApiError) {\n      addDangerToast(t('Error loading chart datasources. Filters may not work correctly.'));\n    } else\n    {\n      dispatch(setDatasources(datasets));\n    }\n  }, [addDangerToast, datasets, datasetsApiError, dispatch]);\n  if (error)\n  throw error; // caught in error boundary\n  if (!readyToRender || !hasDashboardInfoInitiated)\n  return ___EmotionJSX(Loading, null);\n  return ___EmotionJSX(React.Fragment, null,\n  ___EmotionJSX(Global, { styles: [\n    filterCardPopoverStyle(theme),\n    headerStyles(theme),\n    chartContextMenuStyles(theme),\n    focusStyle(theme),\n    chartHeaderStyles(theme), process.env.NODE_ENV === \"production\" ? \"\" : \";label:DashboardPage;\", process.env.NODE_ENV === \"production\" ? \"\" : \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3Bhd2Fuay9Eb2N1bWVudHMvZGNpbS9zdXBlcnNldC9zdXBlcnNldC1mcm9udGVuZC9zcmMvZGFzaGJvYXJkL2NvbnRhaW5lcnMvRGFzaGJvYXJkUGFnZS50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBOEpjIiwiZmlsZSI6Ii9ob21lL3Bhd2Fuay9Eb2N1bWVudHMvZGNpbS9zdXBlcnNldC9zdXBlcnNldC1mcm9udGVuZC9zcmMvZGFzaGJvYXJkL2NvbnRhaW5lcnMvRGFzaGJvYXJkUGFnZS50c3giLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAoQVNGKSB1bmRlciBvbmVcbiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZVxuICogZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb25cbiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGVcbiAqIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGVcbiAqIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZVxuICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLFxuICogc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW5cbiAqIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXG4gKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGVcbiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnNcbiAqIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQgUmVhY3QsIHsgdXNlRWZmZWN0LCB1c2VNZW1vLCB1c2VSZWYgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBHbG9iYWwgfSBmcm9tICdAZW1vdGlvbi9yZWFjdCc7XG5pbXBvcnQgeyB1c2VIaXN0b3J5IH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XG5pbXBvcnQgeyBDYXRlZ29yaWNhbENvbG9yTmFtZXNwYWNlLCBnZXRTaGFyZWRMYWJlbENvbG9yLCBTaGFyZWRMYWJlbENvbG9yU291cmNlLCB0LCB1c2VUaGVtZSwgfSBmcm9tICdAc3VwZXJzZXQtdWkvY29yZSc7XG5pbXBvcnQgeyB1c2VEaXNwYXRjaCwgdXNlU2VsZWN0b3IgfSBmcm9tICdyZWFjdC1yZWR1eCc7XG5pbXBvcnQgeyB1c2VUb2FzdHMgfSBmcm9tICdzcmMvY29tcG9uZW50cy9NZXNzYWdlVG9hc3RzL3dpdGhUb2FzdHMnO1xuaW1wb3J0IExvYWRpbmcgZnJvbSAnc3JjL2NvbXBvbmVudHMvTG9hZGluZyc7XG5pbXBvcnQgeyB1c2VEYXNoYm9hcmQsIHVzZURhc2hib2FyZENoYXJ0cywgdXNlRGFzaGJvYXJkRGF0YXNldHMsIH0gZnJvbSAnc3JjL2hvb2tzL2FwaVJlc291cmNlcyc7XG5pbXBvcnQgeyBoeWRyYXRlRGFzaGJvYXJkIH0gZnJvbSAnc3JjL2Rhc2hib2FyZC9hY3Rpb25zL2h5ZHJhdGUnO1xuaW1wb3J0IHsgc2V0RGF0YXNvdXJjZXMgfSBmcm9tICdzcmMvZGFzaGJvYXJkL2FjdGlvbnMvZGF0YXNvdXJjZXMnO1xuaW1wb3J0IGluamVjdEN1c3RvbUNzcyBmcm9tICdzcmMvZGFzaGJvYXJkL3V0aWwvaW5qZWN0Q3VzdG9tQ3NzJztcbmltcG9ydCB7IExvY2FsU3RvcmFnZUtleXMsIHNldEl0ZW0gfSBmcm9tICdzcmMvdXRpbHMvbG9jYWxTdG9yYWdlSGVscGVycyc7XG5pbXBvcnQgeyBVUkxfUEFSQU1TIH0gZnJvbSAnc3JjL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBnZXRVcmxQYXJhbSB9IGZyb20gJ3NyYy91dGlscy91cmxVdGlscyc7XG5pbXBvcnQgeyBzZXREYXRhc2V0c1N0YXR1cyB9IGZyb20gJ3NyYy9kYXNoYm9hcmQvYWN0aW9ucy9kYXNoYm9hcmRTdGF0ZSc7XG5pbXBvcnQgeyBnZXRGaWx0ZXJWYWx1ZSwgZ2V0UGVybWFsaW5rVmFsdWUsIH0gZnJvbSAnc3JjL2Rhc2hib2FyZC9jb21wb25lbnRzL25hdGl2ZUZpbHRlcnMvRmlsdGVyQmFyL2tleVZhbHVlJztcbmltcG9ydCBEYXNoYm9hcmRDb250YWluZXIgZnJvbSAnc3JjL2Rhc2hib2FyZC9jb250YWluZXJzL0Rhc2hib2FyZCc7XG5pbXBvcnQgc2hvcnRpZCBmcm9tICdzaG9ydGlkJztcbmltcG9ydCB7IGNoYXJ0Q29udGV4dE1lbnVTdHlsZXMsIGZpbHRlckNhcmRQb3BvdmVyU3R5bGUsIGZvY3VzU3R5bGUsIGhlYWRlclN0eWxlcywgY2hhcnRIZWFkZXJTdHlsZXMsIH0gZnJvbSAnLi4vc3R5bGVzJztcbmltcG9ydCBTeW5jRGFzaGJvYXJkU3RhdGUsIHsgZ2V0RGFzaGJvYXJkQ29udGV4dExvY2FsU3RvcmFnZSwgfSBmcm9tICcuLi9jb21wb25lbnRzL1N5bmNEYXNoYm9hcmRTdGF0ZSc7XG5leHBvcnQgY29uc3QgRGFzaGJvYXJkUGFnZUlkQ29udGV4dCA9IFJlYWN0LmNyZWF0ZUNvbnRleHQoJycpO1xuY29uc3QgRGFzaGJvYXJkQnVpbGRlciA9IFJlYWN0LmxhenkoKCkgPT4gaW1wb3J0KFxuLyogd2VicGFja0NodW5rTmFtZTogXCJEYXNoYm9hcmRDb250YWluZXJcIiAqL1xuLyogd2VicGFja1ByZWxvYWQ6IHRydWUgKi9cbidzcmMvZGFzaGJvYXJkL2NvbXBvbmVudHMvRGFzaGJvYXJkQnVpbGRlci9EYXNoYm9hcmRCdWlsZGVyJykpO1xuY29uc3Qgb3JpZ2luYWxEb2N1bWVudFRpdGxlID0gZG9jdW1lbnQudGl0bGU7XG5leHBvcnQgY29uc3QgRGFzaGJvYXJkUGFnZSA9ICh7IGlkT3JTbHVnIH0pID0+IHtcbiAgICBjb25zdCB0aGVtZSA9IHVzZVRoZW1lKCk7XG4gICAgY29uc3QgZGlzcGF0Y2ggPSB1c2VEaXNwYXRjaCgpO1xuICAgIGNvbnN0IGhpc3RvcnkgPSB1c2VIaXN0b3J5KCk7XG4gICAgY29uc3QgZGFzaGJvYXJkUGFnZUlkID0gdXNlTWVtbygoKSA9PiBzaG9ydGlkLmdlbmVyYXRlKCksIFtdKTtcbiAgICBjb25zdCBoYXNEYXNoYm9hcmRJbmZvSW5pdGlhdGVkID0gdXNlU2VsZWN0b3IoKHsgZGFzaGJvYXJkSW5mbyB9KSA9PiBkYXNoYm9hcmRJbmZvICYmIE9iamVjdC5rZXlzKGRhc2hib2FyZEluZm8pLmxlbmd0aCA+IDApO1xuICAgIGNvbnN0IHsgYWRkRGFuZ2VyVG9hc3QgfSA9IHVzZVRvYXN0cygpO1xuICAgIGNvbnN0IHsgcmVzdWx0OiBkYXNoYm9hcmQsIGVycm9yOiBkYXNoYm9hcmRBcGlFcnJvciB9ID0gdXNlRGFzaGJvYXJkKGlkT3JTbHVnKTtcbiAgICBjb25zdCB7IHJlc3VsdDogY2hhcnRzLCBlcnJvcjogY2hhcnRzQXBpRXJyb3IgfSA9IHVzZURhc2hib2FyZENoYXJ0cyhpZE9yU2x1Zyk7XG4gICAgY29uc3QgeyByZXN1bHQ6IGRhdGFzZXRzLCBlcnJvcjogZGF0YXNldHNBcGlFcnJvciwgc3RhdHVzLCB9ID0gdXNlRGFzaGJvYXJkRGF0YXNldHMoaWRPclNsdWcpO1xuICAgIGNvbnN0IGlzRGFzaGJvYXJkSHlkcmF0ZWQgPSB1c2VSZWYoZmFsc2UpO1xuICAgIGNvbnN0IGVycm9yID0gZGFzaGJvYXJkQXBpRXJyb3IgfHwgY2hhcnRzQXBpRXJyb3I7XG4gICAgY29uc3QgcmVhZHlUb1JlbmRlciA9IEJvb2xlYW4oZGFzaGJvYXJkICYmIGNoYXJ0cyk7XG4gICAgY29uc3QgeyBkYXNoYm9hcmRfdGl0bGUsIGNzcywgbWV0YWRhdGEsIGlkID0gMCB9ID0gZGFzaGJvYXJkIHx8IHt9O1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIC8vIG1hcmsgdGFiIGlkIGFzIHJlZHVuZGFudCB3aGVuIHVzZXIgY2xvc2VzIGJyb3dzZXIgdGFiIC0gYSBuZXcgaWQgd2lsbCBiZVxuICAgICAgICAvLyBnZW5lcmF0ZWQgbmV4dCB0aW1lIHVzZXIgb3BlbnMgYSBkYXNoYm9hcmQgYW5kIHRoZSBvbGQgb25lIHdvbid0IGJlIHJldXNlZFxuICAgICAgICBjb25zdCBoYW5kbGVUYWJDbG9zZSA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGRhc2hib2FyZHNDb250ZXh0cyA9IGdldERhc2hib2FyZENvbnRleHRMb2NhbFN0b3JhZ2UoKTtcbiAgICAgICAgICAgIHNldEl0ZW0oTG9jYWxTdG9yYWdlS2V5cy5EYXNoYm9hcmRFeHBsb3JlQ29udGV4dCwge1xuICAgICAgICAgICAgICAgIC4uLmRhc2hib2FyZHNDb250ZXh0cyxcbiAgICAgICAgICAgICAgICBbZGFzaGJvYXJkUGFnZUlkXToge1xuICAgICAgICAgICAgICAgICAgICAuLi5kYXNoYm9hcmRzQ29udGV4dHNbZGFzaGJvYXJkUGFnZUlkXSxcbiAgICAgICAgICAgICAgICAgICAgaXNSZWR1bmRhbnQ6IHRydWUsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignYmVmb3JldW5sb2FkJywgaGFuZGxlVGFiQ2xvc2UpO1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsIGhhbmRsZVRhYkNsb3NlKTtcbiAgICAgICAgfTtcbiAgICB9LCBbZGFzaGJvYXJkUGFnZUlkXSk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgZGlzcGF0Y2goc2V0RGF0YXNldHNTdGF0dXMoc3RhdHVzKSk7XG4gICAgfSwgW2Rpc3BhdGNoLCBzdGF0dXNdKTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY29uc2lzdGVudC1yZXR1cm5cbiAgICAgICAgYXN5bmMgZnVuY3Rpb24gZ2V0RGF0YU1hc2tBcHBsaWVkKCkge1xuICAgICAgICAgICAgY29uc3QgcGVybWFsaW5rS2V5ID0gZ2V0VXJsUGFyYW0oVVJMX1BBUkFNUy5wZXJtYWxpbmtLZXkpO1xuICAgICAgICAgICAgY29uc3QgbmF0aXZlRmlsdGVyS2V5VmFsdWUgPSBnZXRVcmxQYXJhbShVUkxfUEFSQU1TLm5hdGl2ZUZpbHRlcnNLZXkpO1xuICAgICAgICAgICAgY29uc3QgaXNPbGRSaXNvbiA9IGdldFVybFBhcmFtKFVSTF9QQVJBTVMubmF0aXZlRmlsdGVycyk7XG4gICAgICAgICAgICBsZXQgZGF0YU1hc2sgPSBuYXRpdmVGaWx0ZXJLZXlWYWx1ZSB8fCB7fTtcbiAgICAgICAgICAgIC8vIGFjdGl2ZVRhYnMgaXMgaW5pdGlhbGl6ZWQgd2l0aCB1bmRlZmluZWQgc28gdGhhdCBpdCBkb2Vzbid0IG92ZXJyaWRlXG4gICAgICAgICAgICAvLyB0aGUgY3VycmVudGx5IHN0b3JlZCB2YWx1ZSB3aGVuIGh5ZHJhdGluZ1xuICAgICAgICAgICAgbGV0IGFjdGl2ZVRhYnM7XG4gICAgICAgICAgICBpZiAocGVybWFsaW5rS2V5KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGVybWFsaW5rVmFsdWUgPSBhd2FpdCBnZXRQZXJtYWxpbmtWYWx1ZShwZXJtYWxpbmtLZXkpO1xuICAgICAgICAgICAgICAgIGlmIChwZXJtYWxpbmtWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAoeyBkYXRhTWFzaywgYWN0aXZlVGFicyB9ID0gcGVybWFsaW5rVmFsdWUuc3RhdGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG5hdGl2ZUZpbHRlcktleVZhbHVlKSB7XG4gICAgICAgICAgICAgICAgZGF0YU1hc2sgPSBhd2FpdCBnZXRGaWx0ZXJWYWx1ZShpZCwgbmF0aXZlRmlsdGVyS2V5VmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlzT2xkUmlzb24pIHtcbiAgICAgICAgICAgICAgICBkYXRhTWFzayA9IGlzT2xkUmlzb247XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmVhZHlUb1JlbmRlcikge1xuICAgICAgICAgICAgICAgIGlmICghaXNEYXNoYm9hcmRIeWRyYXRlZC5jdXJyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGlzRGFzaGJvYXJkSHlkcmF0ZWQuY3VycmVudCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGRpc3BhdGNoKGh5ZHJhdGVEYXNoYm9hcmQoe1xuICAgICAgICAgICAgICAgICAgICBoaXN0b3J5LFxuICAgICAgICAgICAgICAgICAgICBkYXNoYm9hcmQsXG4gICAgICAgICAgICAgICAgICAgIGNoYXJ0cyxcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlVGFicyxcbiAgICAgICAgICAgICAgICAgICAgZGF0YU1hc2ssXG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlkKVxuICAgICAgICAgICAgZ2V0RGF0YU1hc2tBcHBsaWVkKCk7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9leGhhdXN0aXZlLWRlcHNcbiAgICB9LCBbcmVhZHlUb1JlbmRlcl0pO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGlmIChkYXNoYm9hcmRfdGl0bGUpIHtcbiAgICAgICAgICAgIGRvY3VtZW50LnRpdGxlID0gZGFzaGJvYXJkX3RpdGxlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICBkb2N1bWVudC50aXRsZSA9IG9yaWdpbmFsRG9jdW1lbnRUaXRsZTtcbiAgICAgICAgfTtcbiAgICB9LCBbZGFzaGJvYXJkX3RpdGxlXSk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKHR5cGVvZiBjc3MgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAvLyByZXR1cm5pbmcgd2lsbCBjbGVhbiB1cCBjdXN0b20gY3NzXG4gICAgICAgICAgICAvLyB3aGVuIGRhc2hib2FyZCB1bm1vdW50cyBvciBjaGFuZ2VzXG4gICAgICAgICAgICByZXR1cm4gaW5qZWN0Q3VzdG9tQ3NzKGNzcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICgpID0+IHsgfTtcbiAgICB9LCBbY3NzXSk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgY29uc3Qgc2hhcmVkTGFiZWxDb2xvciA9IGdldFNoYXJlZExhYmVsQ29sb3IoKTtcbiAgICAgICAgc2hhcmVkTGFiZWxDb2xvci5zb3VyY2UgPSBTaGFyZWRMYWJlbENvbG9yU291cmNlLkRhc2hib2FyZDtcbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIC8vIGNsZWFuIHVwIGxhYmVsIGNvbG9yXG4gICAgICAgICAgICBjb25zdCBjYXRlZ29yaWNhbE5hbWVzcGFjZSA9IENhdGVnb3JpY2FsQ29sb3JOYW1lc3BhY2UuZ2V0TmFtZXNwYWNlKG1ldGFkYXRhPy5jb2xvcl9uYW1lc3BhY2UpO1xuICAgICAgICAgICAgY2F0ZWdvcmljYWxOYW1lc3BhY2UucmVzZXRDb2xvcnMoKTtcbiAgICAgICAgICAgIHNoYXJlZExhYmVsQ29sb3IuY2xlYXIoKTtcbiAgICAgICAgfTtcbiAgICB9LCBbbWV0YWRhdGE/LmNvbG9yX25hbWVzcGFjZV0pO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGlmIChkYXRhc2V0c0FwaUVycm9yKSB7XG4gICAgICAgICAgICBhZGREYW5nZXJUb2FzdCh0KCdFcnJvciBsb2FkaW5nIGNoYXJ0IGRhdGFzb3VyY2VzLiBGaWx0ZXJzIG1heSBub3Qgd29yayBjb3JyZWN0bHkuJykpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZGlzcGF0Y2goc2V0RGF0YXNvdXJjZXMoZGF0YXNldHMpKTtcbiAgICAgICAgfVxuICAgIH0sIFthZGREYW5nZXJUb2FzdCwgZGF0YXNldHMsIGRhdGFzZXRzQXBpRXJyb3IsIGRpc3BhdGNoXSk7XG4gICAgaWYgKGVycm9yKVxuICAgICAgICB0aHJvdyBlcnJvcjsgLy8gY2F1Z2h0IGluIGVycm9yIGJvdW5kYXJ5XG4gICAgaWYgKCFyZWFkeVRvUmVuZGVyIHx8ICFoYXNEYXNoYm9hcmRJbmZvSW5pdGlhdGVkKVxuICAgICAgICByZXR1cm4gPExvYWRpbmcgLz47XG4gICAgcmV0dXJuICg8PlxuICAgICAgPEdsb2JhbCBzdHlsZXM9e1tcbiAgICAgICAgICAgIGZpbHRlckNhcmRQb3BvdmVyU3R5bGUodGhlbWUpLFxuICAgICAgICAgICAgaGVhZGVyU3R5bGVzKHRoZW1lKSxcbiAgICAgICAgICAgIGNoYXJ0Q29udGV4dE1lbnVTdHlsZXModGhlbWUpLFxuICAgICAgICAgICAgZm9jdXNTdHlsZSh0aGVtZSksXG4gICAgICAgICAgICBjaGFydEhlYWRlclN0eWxlcyh0aGVtZSksXG4gICAgICAgIF19Lz5cbiAgICAgIDxTeW5jRGFzaGJvYXJkU3RhdGUgZGFzaGJvYXJkUGFnZUlkPXtkYXNoYm9hcmRQYWdlSWR9Lz5cbiAgICAgIDxEYXNoYm9hcmRQYWdlSWRDb250ZXh0LlByb3ZpZGVyIHZhbHVlPXtkYXNoYm9hcmRQYWdlSWR9PlxuICAgICAgICA8RGFzaGJvYXJkQ29udGFpbmVyPlxuICAgICAgICAgIDxEYXNoYm9hcmRCdWlsZGVyIC8+XG4gICAgICAgIDwvRGFzaGJvYXJkQ29udGFpbmVyPlxuICAgICAgPC9EYXNoYm9hcmRQYWdlSWRDb250ZXh0LlByb3ZpZGVyPlxuICAgIDwvPik7XG59O1xuZXhwb3J0IGRlZmF1bHQgRGFzaGJvYXJkUGFnZTtcbiJdfQ== */\"] }\n  ),\n  ___EmotionJSX(SyncDashboardState, { dashboardPageId: dashboardPageId }),\n  ___EmotionJSX(DashboardPageIdContext.Provider, { value: dashboardPageId },\n  ___EmotionJSX(DashboardContainer, null,\n  ___EmotionJSX(DashboardBuilder, null)\n  )\n  )\n  );\n};__signature__(DashboardPage, \"useTheme{theme}\\nuseDispatch{dispatch}\\nuseHistory{history}\\nuseMemo{dashboardPageId}\\nuseSelector{hasDashboardInfoInitiated}\\nuseToasts{{ addDangerToast }}\\nuseDashboard{{ result: dashboard, error: dashboardApiError }}\\nuseDashboardCharts{{ result: charts, error: chartsApiError }}\\nuseDashboardDatasets{{ result: datasets, error: datasetsApiError, status, }}\\nuseRef{isDashboardHydrated}\\nuseEffect{}\\nuseEffect{}\\nuseEffect{}\\nuseEffect{}\\nuseEffect{}\\nuseEffect{}\\nuseEffect{}\", () => [useTheme, useDispatch, useHistory, useSelector, useToasts, useDashboard, useDashboardCharts, useDashboardDatasets]);const _default =\nDashboardPage;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(DashboardPageIdContext, \"DashboardPageIdContext\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/containers/DashboardPage.tsx\");reactHotLoader.register(DashboardBuilder, \"DashboardBuilder\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/containers/DashboardPage.tsx\");reactHotLoader.register(originalDocumentTitle, \"originalDocumentTitle\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/containers/DashboardPage.tsx\");reactHotLoader.register(DashboardPage, \"DashboardPage\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/containers/DashboardPage.tsx\");reactHotLoader.register(_default, \"default\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/containers/DashboardPage.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["React","useEffect","useMemo","useRef","Global","useHistory","CategoricalColorNamespace","getSharedLabelColor","SharedLabelColorSource","t","useTheme","useDispatch","useSelector","useToasts","Loading","useDashboard","useDashboardCharts","useDashboardDatasets","hydrateDashboard","setDatasources","injectCustomCss","LocalStorageKeys","setItem","URL_PARAMS","getUrlParam","setDatasetsStatus","getFilterValue","getPermalinkValue","DashboardContainer","shortid","chartContextMenuStyles","filterCardPopoverStyle","focusStyle","headerStyles","chartHeaderStyles","SyncDashboardState","getDashboardContextLocalStorage","jsx","___EmotionJSX","DashboardPageIdContext","createContext","DashboardBuilder","lazy","originalDocumentTitle","document","title","DashboardPage","idOrSlug","theme","dispatch","history","dashboardPageId","generate","hasDashboardInfoInitiated","dashboardInfo","Object","keys","length","addDangerToast","result","dashboard","error","dashboardApiError","charts","chartsApiError","datasets","datasetsApiError","status","isDashboardHydrated","readyToRender","Boolean","dashboard_title","css","metadata","id","handleTabClose","dashboardsContexts","DashboardExploreContext","isRedundant","window","addEventListener","removeEventListener","getDataMaskApplied","permalinkKey","nativeFilterKeyValue","nativeFiltersKey","isOldRison","nativeFilters","dataMask","activeTabs","permalinkValue","state","current","sharedLabelColor","source","Dashboard","categoricalNamespace","getNamespace","color_namespace","resetColors","clear","Fragment","styles","process","env","NODE_ENV","Provider","value","__signature__","_default","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/containers/DashboardPage.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { FC, useEffect, useMemo, useRef } from 'react';\nimport { Global } from '@emotion/react';\nimport { useHistory } from 'react-router-dom';\nimport {\n  CategoricalColorNamespace,\n  getSharedLabelColor,\n  SharedLabelColorSource,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useToasts } from 'src/components/MessageToasts/withToasts';\nimport Loading from 'src/components/Loading';\nimport {\n  useDashboard,\n  useDashboardCharts,\n  useDashboardDatasets,\n} from 'src/hooks/apiResources';\nimport { hydrateDashboard } from 'src/dashboard/actions/hydrate';\nimport { setDatasources } from 'src/dashboard/actions/datasources';\nimport injectCustomCss from 'src/dashboard/util/injectCustomCss';\n\nimport { LocalStorageKeys, setItem } from 'src/utils/localStorageHelpers';\nimport { URL_PARAMS } from 'src/constants';\nimport { getUrlParam } from 'src/utils/urlUtils';\nimport { setDatasetsStatus } from 'src/dashboard/actions/dashboardState';\nimport {\n  getFilterValue,\n  getPermalinkValue,\n} from 'src/dashboard/components/nativeFilters/FilterBar/keyValue';\nimport DashboardContainer from 'src/dashboard/containers/Dashboard';\n\nimport shortid from 'shortid';\nimport { RootState } from '../types';\nimport {\n  chartContextMenuStyles,\n  filterCardPopoverStyle,\n  focusStyle,\n  headerStyles,\n  chartHeaderStyles,\n} from '../styles';\nimport SyncDashboardState, {\n  getDashboardContextLocalStorage,\n} from '../components/SyncDashboardState';\n\nexport const DashboardPageIdContext = React.createContext('');\n\nconst DashboardBuilder = React.lazy(\n  () =>\n    import(\n      /* webpackChunkName: \"DashboardContainer\" */\n      /* webpackPreload: true */\n      'src/dashboard/components/DashboardBuilder/DashboardBuilder'\n    ),\n);\n\nconst originalDocumentTitle = document.title;\n\ntype PageProps = {\n  idOrSlug: string;\n};\n\nexport const DashboardPage: FC<PageProps> = ({ idOrSlug }: PageProps) => {\n  const theme = useTheme();\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const dashboardPageId = useMemo(() => shortid.generate(), []);\n  const hasDashboardInfoInitiated = useSelector<RootState, Boolean>(\n    ({ dashboardInfo }) =>\n      dashboardInfo && Object.keys(dashboardInfo).length > 0,\n  );\n  const { addDangerToast } = useToasts();\n  const { result: dashboard, error: dashboardApiError } =\n    useDashboard(idOrSlug);\n  const { result: charts, error: chartsApiError } =\n    useDashboardCharts(idOrSlug);\n  const {\n    result: datasets,\n    error: datasetsApiError,\n    status,\n  } = useDashboardDatasets(idOrSlug);\n  const isDashboardHydrated = useRef(false);\n\n  const error = dashboardApiError || chartsApiError;\n  const readyToRender = Boolean(dashboard && charts);\n  const { dashboard_title, css, metadata, id = 0 } = dashboard || {};\n\n  useEffect(() => {\n    // mark tab id as redundant when user closes browser tab - a new id will be\n    // generated next time user opens a dashboard and the old one won't be reused\n    const handleTabClose = () => {\n      const dashboardsContexts = getDashboardContextLocalStorage();\n      setItem(LocalStorageKeys.DashboardExploreContext, {\n        ...dashboardsContexts,\n        [dashboardPageId]: {\n          ...dashboardsContexts[dashboardPageId],\n          isRedundant: true,\n        },\n      });\n    };\n    window.addEventListener('beforeunload', handleTabClose);\n    return () => {\n      window.removeEventListener('beforeunload', handleTabClose);\n    };\n  }, [dashboardPageId]);\n\n  useEffect(() => {\n    dispatch(setDatasetsStatus(status));\n  }, [dispatch, status]);\n\n  useEffect(() => {\n    // eslint-disable-next-line consistent-return\n    async function getDataMaskApplied() {\n      const permalinkKey = getUrlParam(URL_PARAMS.permalinkKey);\n      const nativeFilterKeyValue = getUrlParam(URL_PARAMS.nativeFiltersKey);\n      const isOldRison = getUrlParam(URL_PARAMS.nativeFilters);\n\n      let dataMask = nativeFilterKeyValue || {};\n      // activeTabs is initialized with undefined so that it doesn't override\n      // the currently stored value when hydrating\n      let activeTabs: string[] | undefined;\n      if (permalinkKey) {\n        const permalinkValue = await getPermalinkValue(permalinkKey);\n        if (permalinkValue) {\n          ({ dataMask, activeTabs } = permalinkValue.state);\n        }\n      } else if (nativeFilterKeyValue) {\n        dataMask = await getFilterValue(id, nativeFilterKeyValue);\n      }\n      if (isOldRison) {\n        dataMask = isOldRison;\n      }\n\n      if (readyToRender) {\n        if (!isDashboardHydrated.current) {\n          isDashboardHydrated.current = true;\n        }\n        dispatch(\n          hydrateDashboard({\n            history,\n            dashboard,\n            charts,\n            activeTabs,\n            dataMask,\n          }),\n        );\n      }\n      return null;\n    }\n    if (id) getDataMaskApplied();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [readyToRender]);\n\n  useEffect(() => {\n    if (dashboard_title) {\n      document.title = dashboard_title;\n    }\n    return () => {\n      document.title = originalDocumentTitle;\n    };\n  }, [dashboard_title]);\n\n  useEffect(() => {\n    if (typeof css === 'string') {\n      // returning will clean up custom css\n      // when dashboard unmounts or changes\n      return injectCustomCss(css);\n    }\n    return () => {};\n  }, [css]);\n\n  useEffect(() => {\n    const sharedLabelColor = getSharedLabelColor();\n    sharedLabelColor.source = SharedLabelColorSource.Dashboard;\n    return () => {\n      // clean up label color\n      const categoricalNamespace = CategoricalColorNamespace.getNamespace(\n        metadata?.color_namespace,\n      );\n      categoricalNamespace.resetColors();\n      sharedLabelColor.clear();\n    };\n  }, [metadata?.color_namespace]);\n\n  useEffect(() => {\n    if (datasetsApiError) {\n      addDangerToast(\n        t('Error loading chart datasources. Filters may not work correctly.'),\n      );\n    } else {\n      dispatch(setDatasources(datasets));\n    }\n  }, [addDangerToast, datasets, datasetsApiError, dispatch]);\n\n  if (error) throw error; // caught in error boundary\n  if (!readyToRender || !hasDashboardInfoInitiated) return <Loading />;\n\n  return (\n    <>\n      <Global\n        styles={[\n          filterCardPopoverStyle(theme),\n          headerStyles(theme),\n          chartContextMenuStyles(theme),\n          focusStyle(theme),\n          chartHeaderStyles(theme),\n        ]}\n      />\n      <SyncDashboardState dashboardPageId={dashboardPageId} />\n      <DashboardPageIdContext.Provider value={dashboardPageId}>\n        <DashboardContainer>\n          <DashboardBuilder />\n        </DashboardContainer>\n      </DashboardPageIdContext.Provider>\n    </>\n  );\n};\n\nexport default DashboardPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}