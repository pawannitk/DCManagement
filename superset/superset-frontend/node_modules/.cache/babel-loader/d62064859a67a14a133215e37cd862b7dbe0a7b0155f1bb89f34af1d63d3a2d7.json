{"ast":null,"code":"import _uniqWith from \"lodash/uniqWith\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport cx from 'classnames';\nimport { styled, t, usePrevious } from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { setDirectPathToChild } from 'src/dashboard/actions/dashboardState';\nimport Badge from 'src/components/Badge';\nimport DetailsPanelPopover from './DetailsPanel';\nimport { IndicatorStatus, selectIndicatorsForChart, selectNativeIndicatorsForChart } from '../nativeFilters/selectors';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nconst StyledFilterCount = styled.div`\n  ${({ theme }) => `\n    display: flex;\n    justify-items: center;\n    align-items: center;\n    cursor: pointer;\n    margin-right: ${theme.gridUnit}px;\n    padding-left: ${theme.gridUnit * 2}px;\n    padding-right: ${theme.gridUnit * 2}px;\n    background: ${theme.colors.grayscale.light4};\n    border-radius: 4px;\n    height: 100%;\n    .anticon {\n      vertical-align: middle;\n      color: ${theme.colors.grayscale.base};\n      &:hover {\n        color: ${theme.colors.grayscale.light1};\n      }\n    }\n\n    .incompatible-count {\n      font-size: ${theme.typography.sizes.s}px;\n    }\n    &:focus-visible {\n      outline: 2px solid ${theme.colors.primary.dark2};\n    }\n  `}\n`;\nconst StyledBadge = styled(Badge)`\n  ${({ theme }) => `\n    vertical-align: middle;\n    margin-left: ${theme.gridUnit * 2}px;\n    &>sup {\n      padding: 0 ${theme.gridUnit}px;\n      min-width: ${theme.gridUnit * 4}px;\n      height: ${theme.gridUnit * 4}px;\n      line-height: 1.5;\n      font-weight: ${theme.typography.weights.medium};\n      font-size: ${theme.typography.sizes.s - 1}px;\n      box-shadow: none;\n    }\n  `}\n`;\nconst sortByStatus = (indicators) => {\n  const statuses = [\n  IndicatorStatus.Applied,\n  IndicatorStatus.Unset,\n  IndicatorStatus.Incompatible];\n\n  return indicators.sort((a, b) => statuses.indexOf(a.status) -\n  statuses.indexOf(b.status));\n};\nconst indicatorsInitialState = [];\nexport const FiltersBadge = ({ chartId }) => {\n  const dispatch = useDispatch();\n  const datasources = useSelector((state) => state.datasources);\n  const dashboardFilters = useSelector((state) => state.dashboardFilters);\n  const nativeFilters = useSelector((state) => {var _state$nativeFilters;return (_state$nativeFilters = state.nativeFilters) == null ? void 0 : _state$nativeFilters.filters;});\n  const chartConfiguration = useSelector((state) => {var _state$dashboardInfo$;return (_state$dashboardInfo$ = state.dashboardInfo.metadata) == null ? void 0 : _state$dashboardInfo$.chart_configuration;});\n  const chart = useSelector((state) => state.charts[chartId]);\n  const present = useSelector((state) => state.dashboardLayout.present);\n  const dataMask = useSelector((state) => state.dataMask);\n  const [nativeIndicators, setNativeIndicators] = useState(indicatorsInitialState);\n  const [dashboardIndicators, setDashboardIndicators] = useState(indicatorsInitialState);\n  const [popoverVisible, setPopoverVisible] = useState(false);\n  const popoverContentRef = useRef(null);\n  const popoverTriggerRef = useRef(null);\n  const onHighlightFilterSource = useCallback((path) => {\n    dispatch(setDirectPathToChild(path));\n  }, [dispatch]);\n  const handleKeyDown = (event) => {\n    if (event.key === 'Enter') {\n      setPopoverVisible(true);\n    }\n  };\n  const prevChart = usePrevious(chart);\n  const prevChartStatus = prevChart == null ? void 0 : prevChart.chartStatus;\n  const prevDashboardFilters = usePrevious(dashboardFilters);\n  const prevDatasources = usePrevious(datasources);\n  const showIndicators = (chart == null ? void 0 : chart.chartStatus) && ['rendered', 'success'].includes(chart.chartStatus);\n  useEffect(() => {\n    if (popoverVisible) {\n      setTimeout(() => {var _popoverContentRef$cu;\n        popoverContentRef == null ? void 0 : (_popoverContentRef$cu = popoverContentRef.current) == null ? void 0 : _popoverContentRef$cu.focus({ preventScroll: true });\n      });\n    }\n  }, [popoverVisible]);\n  useEffect(() => {\n    if (!showIndicators && dashboardIndicators.length > 0) {\n      setDashboardIndicators(indicatorsInitialState);\n    } else\n    if (prevChartStatus !== 'success') {var _chart$queriesRespons, _chart$queriesRespons2, _prevChart$queriesRes, _prevChart$queriesRes2, _chart$queriesRespons3, _chart$queriesRespons4, _prevChart$queriesRes3, _prevChart$queriesRes4;\n      if ((chart == null ? void 0 : (_chart$queriesRespons = chart.queriesResponse) == null ? void 0 : (_chart$queriesRespons2 = _chart$queriesRespons[0]) == null ? void 0 : _chart$queriesRespons2.rejected_filters) !== (\n      prevChart == null ? void 0 : (_prevChart$queriesRes = prevChart.queriesResponse) == null ? void 0 : (_prevChart$queriesRes2 = _prevChart$queriesRes[0]) == null ? void 0 : _prevChart$queriesRes2.rejected_filters) ||\n      (chart == null ? void 0 : (_chart$queriesRespons3 = chart.queriesResponse) == null ? void 0 : (_chart$queriesRespons4 = _chart$queriesRespons3[0]) == null ? void 0 : _chart$queriesRespons4.applied_filters) !== (\n      prevChart == null ? void 0 : (_prevChart$queriesRes3 = prevChart.queriesResponse) == null ? void 0 : (_prevChart$queriesRes4 = _prevChart$queriesRes3[0]) == null ? void 0 : _prevChart$queriesRes4.applied_filters) ||\n      dashboardFilters !== prevDashboardFilters ||\n      datasources !== prevDatasources) {\n        setDashboardIndicators(selectIndicatorsForChart(chartId, dashboardFilters, datasources, chart));\n      }\n    }\n  }, [\n  chart,\n  chartId,\n  dashboardFilters,\n  dashboardIndicators.length,\n  datasources,\n  prevChart == null ? void 0 : prevChart.queriesResponse,\n  prevChartStatus,\n  prevDashboardFilters,\n  prevDatasources,\n  showIndicators]\n  );\n  const prevNativeFilters = usePrevious(nativeFilters);\n  const prevDashboardLayout = usePrevious(present);\n  const prevDataMask = usePrevious(dataMask);\n  const prevChartConfig = usePrevious(chartConfiguration);\n  useEffect(() => {\n    if (!showIndicators && nativeIndicators.length > 0) {\n      setNativeIndicators(indicatorsInitialState);\n    } else\n    if (prevChartStatus !== 'success') {var _chart$queriesRespons5, _chart$queriesRespons6, _prevChart$queriesRes5, _prevChart$queriesRes6, _chart$queriesRespons7, _chart$queriesRespons8, _prevChart$queriesRes7, _prevChart$queriesRes8;\n      if ((chart == null ? void 0 : (_chart$queriesRespons5 = chart.queriesResponse) == null ? void 0 : (_chart$queriesRespons6 = _chart$queriesRespons5[0]) == null ? void 0 : _chart$queriesRespons6.rejected_filters) !== (\n      prevChart == null ? void 0 : (_prevChart$queriesRes5 = prevChart.queriesResponse) == null ? void 0 : (_prevChart$queriesRes6 = _prevChart$queriesRes5[0]) == null ? void 0 : _prevChart$queriesRes6.rejected_filters) ||\n      (chart == null ? void 0 : (_chart$queriesRespons7 = chart.queriesResponse) == null ? void 0 : (_chart$queriesRespons8 = _chart$queriesRespons7[0]) == null ? void 0 : _chart$queriesRespons8.applied_filters) !== (\n      prevChart == null ? void 0 : (_prevChart$queriesRes7 = prevChart.queriesResponse) == null ? void 0 : (_prevChart$queriesRes8 = _prevChart$queriesRes7[0]) == null ? void 0 : _prevChart$queriesRes8.applied_filters) ||\n      nativeFilters !== prevNativeFilters ||\n      present !== prevDashboardLayout ||\n      dataMask !== prevDataMask ||\n      prevChartConfig !== chartConfiguration) {\n        setNativeIndicators(selectNativeIndicatorsForChart(nativeFilters, dataMask, chartId, chart, present, chartConfiguration));\n      }\n    }\n  }, [\n  chart,\n  chartId,\n  chartConfiguration,\n  dataMask,\n  nativeFilters,\n  nativeIndicators.length,\n  present,\n  prevChart == null ? void 0 : prevChart.queriesResponse,\n  prevChartConfig,\n  prevChartStatus,\n  prevDashboardLayout,\n  prevDataMask,\n  prevNativeFilters,\n  showIndicators]\n  );\n  const indicators = useMemo(() => _uniqWith(sortByStatus([...dashboardIndicators, ...nativeIndicators]), (ind1, ind2) => ind1.column === ind2.column &&\n  ind1.name === ind2.name && (\n  ind1.status !== IndicatorStatus.Applied ||\n  ind2.status !== IndicatorStatus.Applied)), [dashboardIndicators, nativeIndicators]);\n  const appliedCrossFilterIndicators = useMemo(() => indicators.filter((indicator) => indicator.status === IndicatorStatus.CrossFilterApplied), [indicators]);\n  const appliedIndicators = useMemo(() => indicators.filter((indicator) => indicator.status === IndicatorStatus.Applied), [indicators]);\n  const filterCount = appliedIndicators.length + appliedCrossFilterIndicators.length;\n  if (!appliedCrossFilterIndicators.length && !appliedIndicators.length) {\n    return null;\n  }\n  return ___EmotionJSX(DetailsPanelPopover, { appliedCrossFilterIndicators: appliedCrossFilterIndicators, appliedIndicators: appliedIndicators, onHighlightFilterSource: onHighlightFilterSource, setPopoverVisible: setPopoverVisible, popoverVisible: popoverVisible, popoverContentRef: popoverContentRef, popoverTriggerRef: popoverTriggerRef },\n  ___EmotionJSX(StyledFilterCount, { \"aria-label\": t('Applied filters (%s)', filterCount), \"aria-haspopup\": \"true\", role: \"button\", ref: popoverTriggerRef, className: cx('filter-counts', !!appliedCrossFilterIndicators.length && 'has-cross-filters'), tabIndex: 0, onKeyDown: handleKeyDown },\n  ___EmotionJSX(Icons.Filter, { iconSize: \"m\" }),\n  ___EmotionJSX(StyledBadge, { \"data-test\": \"applied-filter-count\", className: \"applied-count\", count: filterCount, showZero: true })\n  )\n  );\n};__signature__(FiltersBadge, \"useDispatch{dispatch}\\nuseSelector{datasources}\\nuseSelector{dashboardFilters}\\nuseSelector{nativeFilters}\\nuseSelector{chartConfiguration}\\nuseSelector{chart}\\nuseSelector{present}\\nuseSelector{dataMask}\\nuseState{[nativeIndicators, setNativeIndicators](indicatorsInitialState)}\\nuseState{[dashboardIndicators, setDashboardIndicators](indicatorsInitialState)}\\nuseState{[popoverVisible, setPopoverVisible](false)}\\nuseRef{popoverContentRef}\\nuseRef{popoverTriggerRef}\\nuseCallback{onHighlightFilterSource}\\nusePrevious{prevChart}\\nusePrevious{prevDashboardFilters}\\nusePrevious{prevDatasources}\\nuseEffect{}\\nuseEffect{}\\nusePrevious{prevNativeFilters}\\nusePrevious{prevDashboardLayout}\\nusePrevious{prevDataMask}\\nusePrevious{prevChartConfig}\\nuseEffect{}\\nuseMemo{indicators}\\nuseMemo{appliedCrossFilterIndicators}\\nuseMemo{appliedIndicators}\", () => [useDispatch, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, usePrevious, usePrevious, usePrevious, usePrevious, usePrevious, usePrevious, usePrevious]);const _default = /*#__PURE__*/\nReact.memo(FiltersBadge);export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(StyledFilterCount, \"StyledFilterCount\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/components/FiltersBadge/index.tsx\");reactHotLoader.register(StyledBadge, \"StyledBadge\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/components/FiltersBadge/index.tsx\");reactHotLoader.register(sortByStatus, \"sortByStatus\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/components/FiltersBadge/index.tsx\");reactHotLoader.register(indicatorsInitialState, \"indicatorsInitialState\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/components/FiltersBadge/index.tsx\");reactHotLoader.register(FiltersBadge, \"FiltersBadge\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/components/FiltersBadge/index.tsx\");reactHotLoader.register(_default, \"default\", \"/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/components/FiltersBadge/index.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["React","useCallback","useEffect","useMemo","useRef","useState","useDispatch","useSelector","cx","styled","t","usePrevious","Icons","setDirectPathToChild","Badge","DetailsPanelPopover","IndicatorStatus","selectIndicatorsForChart","selectNativeIndicatorsForChart","jsx","___EmotionJSX","StyledFilterCount","div","theme","gridUnit","colors","grayscale","light4","base","light1","typography","sizes","s","primary","dark2","StyledBadge","weights","medium","sortByStatus","indicators","statuses","Applied","Unset","Incompatible","sort","a","b","indexOf","status","indicatorsInitialState","FiltersBadge","chartId","dispatch","datasources","state","dashboardFilters","nativeFilters","_state$nativeFilters","filters","chartConfiguration","_state$dashboardInfo$","dashboardInfo","metadata","chart_configuration","chart","charts","present","dashboardLayout","dataMask","nativeIndicators","setNativeIndicators","dashboardIndicators","setDashboardIndicators","popoverVisible","setPopoverVisible","popoverContentRef","popoverTriggerRef","onHighlightFilterSource","path","handleKeyDown","event","key","prevChart","prevChartStatus","chartStatus","prevDashboardFilters","prevDatasources","showIndicators","includes","setTimeout","_popoverContentRef$cu","current","focus","preventScroll","length","_chart$queriesRespons","_chart$queriesRespons2","_prevChart$queriesRes","_prevChart$queriesRes2","_chart$queriesRespons3","_chart$queriesRespons4","_prevChart$queriesRes3","_prevChart$queriesRes4","queriesResponse","rejected_filters","applied_filters","prevNativeFilters","prevDashboardLayout","prevDataMask","prevChartConfig","_chart$queriesRespons5","_chart$queriesRespons6","_prevChart$queriesRes5","_prevChart$queriesRes6","_chart$queriesRespons7","_chart$queriesRespons8","_prevChart$queriesRes7","_prevChart$queriesRes8","_uniqWith","ind1","ind2","column","name","appliedCrossFilterIndicators","filter","indicator","CrossFilterApplied","appliedIndicators","filterCount","role","ref","className","tabIndex","onKeyDown","Filter","iconSize","count","showZero","__signature__","_default","memo","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/home/pawank/Documents/dcim/superset/superset-frontend/src/dashboard/components/FiltersBadge/index.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { uniqWith } from 'lodash';\nimport cx from 'classnames';\nimport {\n  DataMaskStateWithId,\n  Filters,\n  JsonObject,\n  styled,\n  t,\n  usePrevious,\n} from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { setDirectPathToChild } from 'src/dashboard/actions/dashboardState';\nimport Badge from 'src/components/Badge';\nimport DetailsPanelPopover from './DetailsPanel';\nimport {\n  Indicator,\n  IndicatorStatus,\n  selectIndicatorsForChart,\n  selectNativeIndicatorsForChart,\n} from '../nativeFilters/selectors';\nimport { Chart, DashboardLayout, RootState } from '../../types';\n\nexport interface FiltersBadgeProps {\n  chartId: number;\n}\n\nconst StyledFilterCount = styled.div`\n  ${({ theme }) => `\n    display: flex;\n    justify-items: center;\n    align-items: center;\n    cursor: pointer;\n    margin-right: ${theme.gridUnit}px;\n    padding-left: ${theme.gridUnit * 2}px;\n    padding-right: ${theme.gridUnit * 2}px;\n    background: ${theme.colors.grayscale.light4};\n    border-radius: 4px;\n    height: 100%;\n    .anticon {\n      vertical-align: middle;\n      color: ${theme.colors.grayscale.base};\n      &:hover {\n        color: ${theme.colors.grayscale.light1};\n      }\n    }\n\n    .incompatible-count {\n      font-size: ${theme.typography.sizes.s}px;\n    }\n    &:focus-visible {\n      outline: 2px solid ${theme.colors.primary.dark2};\n    }\n  `}\n`;\n\nconst StyledBadge = styled(Badge)`\n  ${({ theme }) => `\n    vertical-align: middle;\n    margin-left: ${theme.gridUnit * 2}px;\n    &>sup {\n      padding: 0 ${theme.gridUnit}px;\n      min-width: ${theme.gridUnit * 4}px;\n      height: ${theme.gridUnit * 4}px;\n      line-height: 1.5;\n      font-weight: ${theme.typography.weights.medium};\n      font-size: ${theme.typography.sizes.s - 1}px;\n      box-shadow: none;\n    }\n  `}\n`;\n\nconst sortByStatus = (indicators: Indicator[]): Indicator[] => {\n  const statuses = [\n    IndicatorStatus.Applied,\n    IndicatorStatus.Unset,\n    IndicatorStatus.Incompatible,\n  ];\n  return indicators.sort(\n    (a, b) =>\n      statuses.indexOf(a.status as IndicatorStatus) -\n      statuses.indexOf(b.status as IndicatorStatus),\n  );\n};\n\nconst indicatorsInitialState: Indicator[] = [];\n\nexport const FiltersBadge = ({ chartId }: FiltersBadgeProps) => {\n  const dispatch = useDispatch();\n  const datasources = useSelector<RootState, any>(state => state.datasources);\n  const dashboardFilters = useSelector<RootState, any>(\n    state => state.dashboardFilters,\n  );\n  const nativeFilters = useSelector<RootState, Filters>(\n    state => state.nativeFilters?.filters,\n  );\n  const chartConfiguration = useSelector<RootState, JsonObject>(\n    state => state.dashboardInfo.metadata?.chart_configuration,\n  );\n  const chart = useSelector<RootState, Chart>(state => state.charts[chartId]);\n  const present = useSelector<RootState, DashboardLayout>(\n    state => state.dashboardLayout.present,\n  );\n  const dataMask = useSelector<RootState, DataMaskStateWithId>(\n    state => state.dataMask,\n  );\n\n  const [nativeIndicators, setNativeIndicators] = useState<Indicator[]>(\n    indicatorsInitialState,\n  );\n  const [dashboardIndicators, setDashboardIndicators] = useState<Indicator[]>(\n    indicatorsInitialState,\n  );\n  const [popoverVisible, setPopoverVisible] = useState(false);\n  const popoverContentRef = useRef<HTMLDivElement>(null);\n  const popoverTriggerRef = useRef<HTMLDivElement>(null);\n\n  const onHighlightFilterSource = useCallback(\n    (path: string[]) => {\n      dispatch(setDirectPathToChild(path));\n    },\n    [dispatch],\n  );\n\n  const handleKeyDown = (event: React.KeyboardEvent<HTMLDivElement>) => {\n    if (event.key === 'Enter') {\n      setPopoverVisible(true);\n    }\n  };\n\n  const prevChart = usePrevious(chart);\n  const prevChartStatus = prevChart?.chartStatus;\n  const prevDashboardFilters = usePrevious(dashboardFilters);\n  const prevDatasources = usePrevious(datasources);\n  const showIndicators =\n    chart?.chartStatus && ['rendered', 'success'].includes(chart.chartStatus);\n\n  useEffect(() => {\n    if (popoverVisible) {\n      setTimeout(() => {\n        popoverContentRef?.current?.focus({ preventScroll: true });\n      });\n    }\n  }, [popoverVisible]);\n\n  useEffect(() => {\n    if (!showIndicators && dashboardIndicators.length > 0) {\n      setDashboardIndicators(indicatorsInitialState);\n    } else if (prevChartStatus !== 'success') {\n      if (\n        chart?.queriesResponse?.[0]?.rejected_filters !==\n          prevChart?.queriesResponse?.[0]?.rejected_filters ||\n        chart?.queriesResponse?.[0]?.applied_filters !==\n          prevChart?.queriesResponse?.[0]?.applied_filters ||\n        dashboardFilters !== prevDashboardFilters ||\n        datasources !== prevDatasources\n      ) {\n        setDashboardIndicators(\n          selectIndicatorsForChart(\n            chartId,\n            dashboardFilters,\n            datasources,\n            chart,\n          ),\n        );\n      }\n    }\n  }, [\n    chart,\n    chartId,\n    dashboardFilters,\n    dashboardIndicators.length,\n    datasources,\n    prevChart?.queriesResponse,\n    prevChartStatus,\n    prevDashboardFilters,\n    prevDatasources,\n    showIndicators,\n  ]);\n\n  const prevNativeFilters = usePrevious(nativeFilters);\n  const prevDashboardLayout = usePrevious(present);\n  const prevDataMask = usePrevious(dataMask);\n  const prevChartConfig = usePrevious(chartConfiguration);\n\n  useEffect(() => {\n    if (!showIndicators && nativeIndicators.length > 0) {\n      setNativeIndicators(indicatorsInitialState);\n    } else if (prevChartStatus !== 'success') {\n      if (\n        chart?.queriesResponse?.[0]?.rejected_filters !==\n          prevChart?.queriesResponse?.[0]?.rejected_filters ||\n        chart?.queriesResponse?.[0]?.applied_filters !==\n          prevChart?.queriesResponse?.[0]?.applied_filters ||\n        nativeFilters !== prevNativeFilters ||\n        present !== prevDashboardLayout ||\n        dataMask !== prevDataMask ||\n        prevChartConfig !== chartConfiguration\n      ) {\n        setNativeIndicators(\n          selectNativeIndicatorsForChart(\n            nativeFilters,\n            dataMask,\n            chartId,\n            chart,\n            present,\n            chartConfiguration,\n          ),\n        );\n      }\n    }\n  }, [\n    chart,\n    chartId,\n    chartConfiguration,\n    dataMask,\n    nativeFilters,\n    nativeIndicators.length,\n    present,\n    prevChart?.queriesResponse,\n    prevChartConfig,\n    prevChartStatus,\n    prevDashboardLayout,\n    prevDataMask,\n    prevNativeFilters,\n    showIndicators,\n  ]);\n\n  const indicators = useMemo(\n    () =>\n      uniqWith(\n        sortByStatus([...dashboardIndicators, ...nativeIndicators]),\n        (ind1, ind2) =>\n          ind1.column === ind2.column &&\n          ind1.name === ind2.name &&\n          (ind1.status !== IndicatorStatus.Applied ||\n            ind2.status !== IndicatorStatus.Applied),\n      ),\n    [dashboardIndicators, nativeIndicators],\n  );\n\n  const appliedCrossFilterIndicators = useMemo(\n    () =>\n      indicators.filter(\n        indicator => indicator.status === IndicatorStatus.CrossFilterApplied,\n      ),\n    [indicators],\n  );\n  const appliedIndicators = useMemo(\n    () =>\n      indicators.filter(\n        indicator => indicator.status === IndicatorStatus.Applied,\n      ),\n    [indicators],\n  );\n  const filterCount =\n    appliedIndicators.length + appliedCrossFilterIndicators.length;\n\n  if (!appliedCrossFilterIndicators.length && !appliedIndicators.length) {\n    return null;\n  }\n\n  return (\n    <DetailsPanelPopover\n      appliedCrossFilterIndicators={appliedCrossFilterIndicators}\n      appliedIndicators={appliedIndicators}\n      onHighlightFilterSource={onHighlightFilterSource}\n      setPopoverVisible={setPopoverVisible}\n      popoverVisible={popoverVisible}\n      popoverContentRef={popoverContentRef}\n      popoverTriggerRef={popoverTriggerRef}\n    >\n      <StyledFilterCount\n        aria-label={t('Applied filters (%s)', filterCount)}\n        aria-haspopup=\"true\"\n        role=\"button\"\n        ref={popoverTriggerRef}\n        className={cx(\n          'filter-counts',\n          !!appliedCrossFilterIndicators.length && 'has-cross-filters',\n        )}\n        tabIndex={0}\n        onKeyDown={handleKeyDown}\n      >\n        <Icons.Filter iconSize=\"m\" />\n        <StyledBadge\n          data-test=\"applied-filter-count\"\n          className=\"applied-count\"\n          count={filterCount}\n          showZero\n        />\n      </StyledFilterCount>\n    </DetailsPanelPopover>\n  );\n};\n\nexport default React.memo(FiltersBadge);\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}